svhn_hu_greedy
wandb: Currently logged in as: eth_dlad_team32 (use `wandb login --relogin` to force relogin)
wandb: wandb version 0.12.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.7
wandb: Syncing run svhn_hu_greedy_run1
wandb:  View project at https://wandb.ai/fanconic/hidden_uncertainty
wandb:  View run at https://wandb.ai/fanconic/hidden_uncertainty/runs/grecqhnw
wandb: Run data is saved locally in /scratch_net/airfox/fanconic/semproj2/hidden_uncertainty_active_learning/wandb/run-20220107_222044-grecqhnw
wandb: Run `wandb offline` to turn off syncing.

Cuda is available:  True
Using downloaded and verified file: /tmp/train_32x32.mat
Downloading http://ufldl.stanford.edu/housenumbers/test_32x32.mat to /tmp/test_32x32.mat
  0% 0/64275384 [00:00<?, ?it/s]  0% 14336/64275384 [00:00<11:23, 94070.59it/s]  0% 33792/64275384 [00:00<09:28, 113084.64it/s]  0% 59392/64275384 [00:00<07:47, 137381.22it/s]  0% 94208/64275384 [00:00<06:12, 172380.46it/s]  0% 138240/64275384 [00:00<05:00, 213293.34it/s]  0% 192512/64275384 [00:00<04:05, 260545.26it/s]  0% 258048/64275384 [00:01<03:23, 314231.96it/s]  1% 338944/64275384 [00:01<02:47, 381263.48it/s]  1% 432128/64275384 [00:01<02:21, 450972.72it/s]  1% 541696/64275384 [00:01<02:00, 531045.70it/s]  1% 674816/64275384 [00:01<01:40, 632818.06it/s]  1% 831488/64275384 [00:01<01:24, 749557.66it/s]  2% 1016832/64275384 [00:02<01:11, 886624.26it/s]  2% 1242112/64275384 [00:02<00:59, 1059756.94it/s]  2% 1512448/64275384 [00:02<00:49, 1268897.56it/s]  3% 1824768/64275384 [00:02<00:41, 1496680.08it/s]  3% 2189312/64275384 [00:02<00:35, 1757501.68it/s]  4% 2612224/64275384 [00:02<00:30, 2051920.00it/s]  5% 3104768/64275384 [00:02<00:25, 2394424.13it/s]  6% 3672064/64275384 [00:03<00:21, 2780301.51it/s]  7% 4315136/64275384 [00:03<00:18, 3199297.45it/s]  8% 5039104/64275384 [00:03<00:16, 3648021.77it/s]  9% 5847040/64275384 [00:03<00:14, 4126162.50it/s] 11% 6755328/64275384 [00:03<00:12, 4657031.25it/s] 12% 7767040/64275384 [00:03<00:10, 5229067.82it/s] 14% 8885248/64275384 [00:04<00:09, 5837747.13it/s] 16% 10136576/64275384 [00:04<00:08, 6521754.19it/s] 18% 11539456/64275384 [00:04<00:06, 8076192.97it/s] 20% 12903424/64275384 [00:04<00:05, 9364867.95it/s] 22% 13911040/64275384 [00:04<00:05, 9260028.58it/s] 23% 14885888/64275384 [00:04<00:05, 8388272.20it/s] 26% 16719872/64275384 [00:04<00:04, 10855864.76it/s] 29% 18541568/64275384 [00:04<00:03, 12612929.97it/s] 31% 19879936/64275384 [00:04<00:03, 12361590.49it/s] 33% 21210112/64275384 [00:05<00:03, 11320868.67it/s] 37% 23738368/64275384 [00:05<00:02, 14841626.14it/s] 40% 25924608/64275384 [00:05<00:02, 16709324.14it/s] 43% 27678720/64275384 [00:05<00:02, 16074442.09it/s] 46% 29367296/64275384 [00:05<00:02, 16251806.01it/s] 49% 31501312/64275384 [00:05<00:01, 17675363.34it/s] 52% 33310720/64275384 [00:05<00:01, 16486890.95it/s] 55% 35144704/64275384 [00:05<00:01, 16301115.34it/s] 57% 36805632/64275384 [00:06<00:02, 11020484.40it/s] 61% 39057408/64275384 [00:06<00:01, 13309156.47it/s] 64% 41159680/64275384 [00:06<00:01, 15013213.31it/s] 67% 42894336/64275384 [00:06<00:01, 15070608.09it/s] 71% 45392896/64275384 [00:06<00:01, 17425154.00it/s] 74% 47287296/64275384 [00:06<00:01, 16855611.25it/s] 77% 49569792/64275384 [00:06<00:00, 18384733.64it/s] 80% 51504128/64275384 [00:06<00:00, 17670619.81it/s] 83% 53530624/64275384 [00:07<00:00, 17894809.17it/s] 86% 55369728/64275384 [00:07<00:00, 17943533.38it/s] 89% 57342976/64275384 [00:07<00:00, 18313441.67it/s] 92% 59201536/64275384 [00:07<00:00, 18285602.99it/s] 95% 61156352/64275384 [00:07<00:00, 18317180.39it/s] 98% 63063040/64275384 [00:07<00:00, 18500980.78it/s]64275456it [00:07, 8494405.72it/s]                   
2022-01-07 22:21.08 [info     ] Starting training              dataset=100 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
100
Fitting PCA...
0-th component log probs | Train: 5.106033400669025 | Val: -4203.7964527638
1-th component log probs | Train: 5.039186276680782 | Val: -5005.150795007844
2-th component log probs | Train: 5.029357767431335 | Val: -4418.499910849418
3-th component log probs | Train: 5.03271573243355 | Val: -3953.227989289586
4-th component log probs | Train: 5.098235169836419 | Val: -4441.448875996156
5-th component log probs | Train: 5.054620873386634 | Val: -4965.659834065094
6-th component log probs | Train: 5.012072197630608 | Val: -4005.735719983147
7-th component log probs | Train: 4.988885340704484 | Val: -4451.769981319936
8-th component log probs | Train: 5.090617273904933 | Val: -6274.6189303259125
9-th component log probs | Train: 5.068176881661402 | Val: -4334.782627877072
KEYWORD NR_SAMPLES:100 DIM:50 AVG_DIFF:21679599.5339
0-th component log probs | Train: 30.1995198640431 | Val: -2928.0975712279806
1-th component log probs | Train: 30.17445171127618 | Val: -3117.485945362563
2-th component log probs | Train: 30.17027326305389 | Val: -2987.065899445544
3-th component log probs | Train: 30.171336737049472 | Val: -2523.556913751202
4-th component log probs | Train: 30.192315562491405 | Val: -2940.4046565263984
5-th component log probs | Train: 30.179649776237454 | Val: -3239.9773828862662
6-th component log probs | Train: 30.16330972933465 | Val: -2601.2689661472814
7-th component log probs | Train: 30.157105527035363 | Val: -2827.5647949387726
8-th component log probs | Train: 30.190379767367677 | Val: -3820.574680958266
9-th component log probs | Train: 30.184245640884843 | Val: -2766.795687563053
KEYWORD NR_SAMPLES:100 DIM:100 AVG_DIFF:9157515.4518
best average differences at 100 dimensions: 9157515.451764602
2022-01-07 22:22.13 [info     ] Training complete              train_loss=0.5052050352096558
2022-01-07 22:22.13 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:22.16 [info     ] Testing complete               test_loss=2.351189136505127
{'dataset_size': 100,
 'end_test_accuracy': 0.09270064532756805,
 'end_test_loss': 2.351189136505127,
 'end_train_accuracy': 0.9861111044883728,
 'end_train_loss': 0.5052050352096558,
 'end_val_accuracy': 0.1584114283323288,
 'end_val_loss': 4.73745584487915}
2022-01-07 22:22.17 [info     ] Start Predict                  dataset=58506
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:22.52 [info     ] Starting training              dataset=200 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
200
Fitting PCA...
0-th component log probs | Train: 4.425430879563038 | Val: -2626.004097854851
1-th component log probs | Train: 3.887700008599986 | Val: -1269.2235734294525
2-th component log probs | Train: 4.155013456599297 | Val: -956.2477252192876
3-th component log probs | Train: 4.01867821156163 | Val: -1104.8803668893925
4-th component log probs | Train: 4.085332752577526 | Val: -1295.6285626846652
5-th component log probs | Train: 4.296181321792016 | Val: -1477.8321630096327
6-th component log probs | Train: 3.944138761149231 | Val: -888.8022821899725
7-th component log probs | Train: 4.439241283224478 | Val: -1105.5276646554962
8-th component log probs | Train: 4.257565847949469 | Val: -1208.6351838254116
9-th component log probs | Train: 4.549670392383039 | Val: -1982.5629306442365
KEYWORD NR_SAMPLES:200 DIM:50 AVG_DIFF:2204062.6332
Fitting PCA...
0-th component log probs | Train: 5.174978342676982 | Val: -1672.116900937667
1-th component log probs | Train: 4.898053853405089 | Val: -885.0093239398835
2-th component log probs | Train: 5.043798162453801 | Val: -656.8392931479596
3-th component log probs | Train: 4.968614915079306 | Val: -796.8081209496615
4-th component log probs | Train: 4.99838368499079 | Val: -970.5690104201874
5-th component log probs | Train: 5.113299893293025 | Val: -1010.8450104837405
6-th component log probs | Train: 4.924313672106729 | Val: -684.6851837272706
7-th component log probs | Train: 5.180370951346966 | Val: -819.9528093307857
8-th component log probs | Train: 5.103230313347037 | Val: -856.1282381662475
9-th component log probs | Train: 5.2419892422781365 | Val: -1355.5061685660569
KEYWORD NR_SAMPLES:200 DIM:100 AVG_DIFF:1042955.1054
Fitting PCA...
0-th component log probs | Train: 5.436055720543588 | Val: -1222.0730686023155
1-th component log probs | Train: 5.254184582459638 | Val: -643.2505412959281
2-th component log probs | Train: 5.352102402967636 | Val: -487.1714133361346
3-th component log probs | Train: 5.29967660003345 | Val: -600.919789882737
4-th component log probs | Train: 5.320635791707386 | Val: -716.4578702521396
5-th component log probs | Train: 5.396744475038928 | Val: -749.5665678193242
6-th component log probs | Train: 5.26738182857308 | Val: -525.9910308786274
7-th component log probs | Train: 5.436948441890557 | Val: -654.325727160645
8-th component log probs | Train: 5.394142457430072 | Val: -629.329257453645
9-th component log probs | Train: 5.484132862843869 | Val: -1000.8976638893647
KEYWORD NR_SAMPLES:200 DIM:150 AVG_DIFF:576878.2687
0-th component log probs | Train: 14.914223508727718 | Val: -1018.6192398205344
1-th component log probs | Train: 14.779278645908402 | Val: -567.97168940399
2-th component log probs | Train: 14.85205163693482 | Val: -454.1616401215381
3-th component log probs | Train: 14.812208946725269 | Val: -541.6651835286792
4-th component log probs | Train: 14.82875743316808 | Val: -640.6484807784731
5-th component log probs | Train: 14.884632576018017 | Val: -663.844586980019
6-th component log probs | Train: 14.785342656232848 | Val: -500.98725951296785
7-th component log probs | Train: 14.910769825540548 | Val: -598.9540735856551
8-th component log probs | Train: 14.884803004529914 | Val: -567.2855455725211
9-th component log probs | Train: 14.951391739340558 | Val: -853.7208879064228
KEYWORD NR_SAMPLES:200 DIM:200 AVG_DIFF:457052.7931
best average differences at 200 dimensions: 457052.7931169461
2022-01-07 22:24.00 [info     ] Training complete              train_loss=1.4200966358184814
2022-01-07 22:24.00 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:24.04 [info     ] Testing complete               test_loss=2.3975167274475098
{'dataset_size': 200,
 'end_test_accuracy': 0.12828879058361053,
 'end_test_loss': 2.3975167274475098,
 'end_train_accuracy': 0.75390625,
 'end_train_loss': 1.4200966358184814,
 'end_val_accuracy': 0.17137540876865387,
 'end_val_loss': 4.1675238609313965}
2022-01-07 22:24.04 [info     ] Start Predict                  dataset=58406
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:24.40 [info     ] Starting training              dataset=400 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
400
Fitting PCA...
0-th component log probs | Train: 3.322545439646659 | Val: -546.2316403432103
1-th component log probs | Train: 2.3566820774303223 | Val: -7.834413132615925
2-th component log probs | Train: 3.0693499198933853 | Val: -290.38725630323415
3-th component log probs | Train: 3.1014524684010216 | Val: -381.8043563669549
4-th component log probs | Train: 3.1886215569431116 | Val: -403.49826921070024
5-th component log probs | Train: 3.6435500641133154 | Val: -767.079818534596
6-th component log probs | Train: 3.354428643210339 | Val: -562.8438716613763
7-th component log probs | Train: 3.684237251772844 | Val: -696.4593678364537
8-th component log probs | Train: 3.2728219072316462 | Val: -680.2745593858829
9-th component log probs | Train: 4.27578864390348 | Val: -1660.1606679715326
KEYWORD NR_SAMPLES:400 DIM:50 AVG_DIFF:535015.5559
Fitting PCA...
0-th component log probs | Train: 4.546217567089524 | Val: -627.6961990617555
1-th component log probs | Train: 3.4647040504938493 | Val: -121.80421152908863
2-th component log probs | Train: 4.336155829327026 | Val: -479.0292800433989
3-th component log probs | Train: 4.396238114829597 | Val: -599.9233610667383
4-th component log probs | Train: 4.389109864543148 | Val: -506.9980327995459
5-th component log probs | Train: 4.712090472637527 | Val: -856.0017151978058
6-th component log probs | Train: 4.564655041066388 | Val: -652.8511559215443
7-th component log probs | Train: 4.754585119416999 | Val: -676.8566012205881
8-th component log probs | Train: 4.524334656304076 | Val: -1013.1755798894624
9-th component log probs | Train: 5.093864685059539 | Val: -1257.7307271835066
KEYWORD NR_SAMPLES:400 DIM:100 AVG_DIFF:555063.2653
Fitting PCA...
0-th component log probs | Train: 4.997946103091232 | Val: -530.9264087526698
1-th component log probs | Train: 4.176427814800077 | Val: -159.10013341448575
2-th component log probs | Train: 4.837806926888481 | Val: -410.30582769197036
3-th component log probs | Train: 4.88795831566512 | Val: -523.8760608907551
4-th component log probs | Train: 4.8696520804132035 | Val: -431.06236258354784
5-th component log probs | Train: 5.10786735731589 | Val: -679.9085979779287
6-th component log probs | Train: 5.010133211377021 | Val: -534.5826321069792
7-th component log probs | Train: 5.140722722778605 | Val: -566.1504146371645
8-th component log probs | Train: 4.983059598944137 | Val: -816.8019397040867
9-th component log probs | Train: 5.3798353596768465 | Val: -969.4189638330303
KEYWORD NR_SAMPLES:400 DIM:150 AVG_DIFF:367381.3387
Fitting PCA...
0-th component log probs | Train: 5.232768261936622 | Val: -439.64915953966124
1-th component log probs | Train: 4.5813804558208995 | Val: -154.0374493937421
2-th component log probs | Train: 5.106501772995048 | Val: -346.1553835229198
3-th component log probs | Train: 5.147934267185216 | Val: -444.45349308435254
4-th component log probs | Train: 5.12641848466683 | Val: -366.1348675210601
5-th component log probs | Train: 5.315645796104849 | Val: -554.2826325085293
6-th component log probs | Train: 5.243095013031888 | Val: -440.16528309677017
7-th component log probs | Train: 5.341837834032273 | Val: -476.2987540944564
8-th component log probs | Train: 5.221987392742306 | Val: -682.4824429908808
9-th component log probs | Train: 5.527477398111801 | Val: -779.0916976894566
KEYWORD NR_SAMPLES:400 DIM:200 AVG_DIFF:252320.5062
Fitting PCA...
0-th component log probs | Train: 5.377799082361426 | Val: -374.8583988125749
1-th component log probs | Train: 4.841910150955327 | Val: -141.07931441847987
2-th component log probs | Train: 5.273440258631003 | Val: -298.1236923107273
3-th component log probs | Train: 5.309077092800362 | Val: -385.1046183471832
4-th component log probs | Train: 5.287384577261724 | Val: -314.5962125456668
5-th component log probs | Train: 5.444214789921784 | Val: -464.40792771902017
6-th component log probs | Train: 5.386987967190801 | Val: -374.1344877079971
7-th component log probs | Train: 5.465859469897563 | Val: -402.9917866154925
8-th component log probs | Train: 5.37019326793544 | Val: -575.1787801536511
9-th component log probs | Train: 5.617014698013753 | Val: -652.9173565362026
KEYWORD NR_SAMPLES:400 DIM:250 AVG_DIFF:181899.4015
Fitting PCA...
0-th component log probs | Train: 5.477369330570025 | Val: -323.87951946872755
1-th component log probs | Train: 5.023537053995712 | Val: -127.43538368210643
2-th component log probs | Train: 5.388149738789465 | Val: -259.30817950085105
3-th component log probs | Train: 5.41920472800779 | Val: -335.98837448283274
4-th component log probs | Train: 5.398795710256454 | Val: -274.98789080398444
5-th component log probs | Train: 5.531814891726431 | Val: -399.17056367431474
6-th component log probs | Train: 5.485167580822118 | Val: -324.7736303524559
7-th component log probs | Train: 5.550353096209468 | Val: -348.7290313874728
8-th component log probs | Train: 5.470948169983182 | Val: -495.7407545224248
9-th component log probs | Train: 5.67771901543556 | Val: -561.9140093299244
KEYWORD NR_SAMPLES:400 DIM:300 AVG_DIFF:136645.5541
Fitting PCA...
0-th component log probs | Train: 5.549482840899871 | Val: -284.9126200231037
1-th component log probs | Train: 5.157307838568666 | Val: -116.14681952881011
2-th component log probs | Train: 5.4720124060935 | Val: -229.12569140679716
3-th component log probs | Train: 5.499255151416356 | Val: -296.09408594845723
4-th component log probs | Train: 5.480719531467056 | Val: -243.32247008590303
5-th component log probs | Train: 5.5956071543245605 | Val: -349.500922024377
6-th component log probs | Train: 5.556260604843482 | Val: -285.90651574147495
7-th component log probs | Train: 5.611958295851624 | Val: -307.07062976501464
8-th component log probs | Train: 5.543995327426191 | Val: -434.5752558855564
9-th component log probs | Train: 5.721596729794426 | Val: -491.4892729310199
KEYWORD NR_SAMPLES:400 DIM:350 AVG_DIFF:105975.6822
0-th component log probs | Train: 7.2810536343624666 | Val: -263.92408059213045
1-th component log probs | Train: 6.936672244214668 | Val: -115.31517657048745
2-th component log probs | Train: 7.212952171207049 | Val: -213.45364630782313
3-th component log probs | Train: 7.236949999957554 | Val: -274.0294046634152
4-th component log probs | Train: 7.220174978504603 | Val: -227.9661320934941
5-th component log probs | Train: 7.321283650546491 | Val: -320.3814375841681
6-th component log probs | Train: 7.28703274627242 | Val: -265.5738532936883
7-th component log probs | Train: 7.335646092173795 | Val: -283.2297843016122
8-th component log probs | Train: 7.276222018503251 | Val: -397.05745486036034
9-th component log probs | Train: 7.431702917486545 | Val: -446.9735891334066
KEYWORD NR_SAMPLES:400 DIM:400 AVG_DIFF:91066.3051
best average differences at 400 dimensions: 91066.30505902301
2022-01-07 22:26.09 [info     ] Training complete              train_loss=0.6042073369026184
2022-01-07 22:26.09 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:26.13 [info     ] Testing complete               test_loss=2.3502533435821533
{'dataset_size': 400,
 'end_test_accuracy': 0.2316492646932602,
 'end_test_loss': 2.3502533435821533,
 'end_train_accuracy': 0.9174107313156128,
 'end_train_loss': 0.6042073369026184,
 'end_val_accuracy': 0.43920230865478516,
 'end_val_loss': 2.7145745754241943}
2022-01-07 22:26.13 [info     ] Start Predict                  dataset=58206
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:26.49 [info     ] Starting training              dataset=600 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
600
Fitting PCA...
0-th component log probs | Train: 3.055620824482643 | Val: -156.1254138032927
1-th component log probs | Train: 2.5526321403038845 | Val: -14.14916549434239
2-th component log probs | Train: 2.6044627038371955 | Val: -21.066320798960877
3-th component log probs | Train: 2.4989383439827164 | Val: -18.698576551759796
4-th component log probs | Train: 2.867390057871642 | Val: -28.32912983234999
5-th component log probs | Train: 2.8283134476604537 | Val: -53.331489276807815
6-th component log probs | Train: 2.8692056042650873 | Val: -111.00812626433421
7-th component log probs | Train: 3.3964768281675735 | Val: -299.58014368836143
8-th component log probs | Train: 2.8544656974775973 | Val: -216.85447747769277
9-th component log probs | Train: 3.7572686297906337 | Val: -971.2635879770569
KEYWORD NR_SAMPLES:600 DIM:50 AVG_DIFF:113634.5315
Fitting PCA...
0-th component log probs | Train: 4.26239876504734 | Val: -433.6256026403319
1-th component log probs | Train: 3.36767565776335 | Val: -63.08124243293541
2-th component log probs | Train: 3.7006650034057635 | Val: -167.77443706702755
3-th component log probs | Train: 3.6838842231645 | Val: -217.96216215157799
4-th component log probs | Train: 3.9262471201628264 | Val: -164.07554678313446
5-th component log probs | Train: 4.023346156205535 | Val: -291.99073335532864
6-th component log probs | Train: 4.126668759225276 | Val: -431.05725701055667
7-th component log probs | Train: 4.530826422395249 | Val: -496.821105451435
8-th component log probs | Train: 4.172639014477657 | Val: -663.3498616831919
9-th component log probs | Train: 4.8050417843273845 | Val: -1069.8316151738259
KEYWORD NR_SAMPLES:600 DIM:100 AVG_DIFF:243570.9591
Fitting PCA...
0-th component log probs | Train: 4.778107942860473 | Val: -369.49723907194647
1-th component log probs | Train: 4.010297097027542 | Val: -113.19338905585488
2-th component log probs | Train: 4.359449716888809 | Val: -187.59950142190905
3-th component log probs | Train: 4.3539746487685145 | Val: -257.5480279682432
4-th component log probs | Train: 4.515417066000071 | Val: -168.34452692994788
5-th component log probs | Train: 4.602932545795972 | Val: -295.0670116160985
6-th component log probs | Train: 4.6800592024122185 | Val: -423.85052738599984
7-th component log probs | Train: 4.974686083291303 | Val: -421.3262960603466
8-th component log probs | Train: 4.724781234527439 | Val: -576.0001010029802
9-th component log probs | Train: 5.181623561984143 | Val: -826.2871254638021
KEYWORD NR_SAMPLES:600 DIM:150 AVG_DIFF:177653.3647
Fitting PCA...
0-th component log probs | Train: 5.05585680520312 | Val: -320.8490082890306
1-th component log probs | Train: 4.423697087902331 | Val: -121.3681721321228
2-th component log probs | Train: 4.724685973554923 | Val: -174.4835405846825
3-th component log probs | Train: 4.725366811791375 | Val: -237.74328326544713
4-th component log probs | Train: 4.841957173905769 | Val: -156.17930234740854
5-th component log probs | Train: 4.917067324821924 | Val: -262.17150783116205
6-th component log probs | Train: 4.979912730447618 | Val: -367.3591003784568
7-th component log probs | Train: 5.2094901458289815 | Val: -358.4650855762928
8-th component log probs | Train: 5.017359337856905 | Val: -494.0982194777583
9-th component log probs | Train: 5.375869541636087 | Val: -679.9445808077879
KEYWORD NR_SAMPLES:600 DIM:200 AVG_DIFF:130305.7043
Fitting PCA...
0-th component log probs | Train: 5.22964815981465 | Val: -279.8405776305859
1-th component log probs | Train: 4.697723129593213 | Val: -118.59742485979908
2-th component log probs | Train: 4.956110629344272 | Val: -158.2282460940845
3-th component log probs | Train: 4.9605465812906955 | Val: -216.66953778046368
4-th component log probs | Train: 5.0504523221340865 | Val: -140.17656366851705
5-th component log probs | Train: 5.115107562314105 | Val: -232.2947906057193
6-th component log probs | Train: 5.168357546110989 | Val: -320.43425058389926
7-th component log probs | Train: 5.355431711212156 | Val: -305.04630756665915
8-th component log probs | Train: 5.200492086366449 | Val: -431.9550577728985
9-th component log probs | Train: 5.49453592681157 | Val: -572.9244112693395
KEYWORD NR_SAMPLES:600 DIM:250 AVG_DIFF:98048.6020
Fitting PCA...
0-th component log probs | Train: 5.348602742842365 | Val: -248.14844995807985
1-th component log probs | Train: 4.891644948222829 | Val: -110.60283890640528
2-th component log probs | Train: 5.116023356023171 | Val: -143.14506737351203
3-th component log probs | Train: 5.121967855036889 | Val: -194.92842125674215
4-th component log probs | Train: 5.193260665060206 | Val: -126.78201145313476
5-th component log probs | Train: 5.2525838232420705 | Val: -206.6229174843325
6-th component log probs | Train: 5.297429899334537 | Val: -282.33291005056236
7-th component log probs | Train: 5.455824293967844 | Val: -265.429127375952
8-th component log probs | Train: 5.326225684657361 | Val: -377.300517369809
9-th component log probs | Train: 5.574546860602987 | Val: -495.7742643093418
KEYWORD NR_SAMPLES:600 DIM:300 AVG_DIFF:75822.4732
Fitting PCA...
0-th component log probs | Train: 5.4362022456014145 | Val: -219.8066176639929
1-th component log probs | Train: 5.0370821629222 | Val: -101.65125595931075
2-th component log probs | Train: 5.234505747299682 | Val: -129.2056214895277
3-th component log probs | Train: 5.240869982314781 | Val: -176.0650782776142
4-th component log probs | Train: 5.299373911474026 | Val: -114.77288308583785
5-th component log probs | Train: 5.353140063428979 | Val: -185.94693056485656
6-th component log probs | Train: 5.392367475448735 | Val: -250.38550818733628
7-th component log probs | Train: 5.52910806022278 | Val: -233.95089314622973
8-th component log probs | Train: 5.417744762737183 | Val: -333.7640154065551
9-th component log probs | Train: 5.632626125548767 | Val: -435.14389293427513
KEYWORD NR_SAMPLES:600 DIM:350 AVG_DIFF:59835.7680
Fitting PCA...
0-th component log probs | Train: 5.503158226270577 | Val: -197.96877652345728
1-th component log probs | Train: 5.149809924998115 | Val: -93.28516080900259
2-th component log probs | Train: 5.325689227554738 | Val: -117.55544498750035
3-th component log probs | Train: 5.331811674418657 | Val: -159.5352752175999
4-th component log probs | Train: 5.381656920698312 | Val: -104.51787231463891
5-th component log probs | Train: 5.430030500225272 | Val: -167.74920707884323
6-th component log probs | Train: 5.46487253122747 | Val: -224.8343750650398
7-th component log probs | Train: 5.585128821777733 | Val: -209.12303652187737
8-th component log probs | Train: 5.487355687700983 | Val: -298.81635161198403
9-th component log probs | Train: 5.676573330227951 | Val: -387.44257081971267
KEYWORD NR_SAMPLES:600 DIM:400 AVG_DIFF:48368.1732
Fitting PCA...
0-th component log probs | Train: 5.556269627054635 | Val: -179.48968371498688
1-th component log probs | Train: 5.240120062987462 | Val: -86.07359535407865
2-th component log probs | Train: 5.397922063636829 | Val: -107.3216939510961
3-th component log probs | Train: 5.403700350151723 | Val: -145.79584863874632
4-th component log probs | Train: 5.4470399949133395 | Val: -95.70871628609855
5-th component log probs | Train: 5.49103550889657 | Val: -152.4466177045115
6-th component log probs | Train: 5.522162307838758 | Val: -203.6018330704969
7-th component log probs | Train: 5.629232002520016 | Val: -188.97009853814833
8-th component log probs | Train: 5.542361030018626 | Val: -269.5976338836601
9-th component log probs | Train: 5.711018360525139 | Val: -348.99819759624353
KEYWORD NR_SAMPLES:600 DIM:450 AVG_DIFF:39822.4398
Fitting PCA...
0-th component log probs | Train: 5.5992230040221145 | Val: -164.17717147070695
1-th component log probs | Train: 5.31392754807864 | Val: -79.69597588617366
2-th component log probs | Train: 5.456514372700795 | Val: -98.73293475664478
3-th component log probs | Train: 5.461876861210685 | Val: -133.9197997198221
4-th component log probs | Train: 5.500513394222492 | Val: -88.05098876130673
5-th component log probs | Train: 5.540462477905409 | Val: -139.52711631000435
6-th component log probs | Train: 5.56855444253877 | Val: -186.0240634100048
7-th component log probs | Train: 5.664964410494433 | Val: -172.48616931852806
8-th component log probs | Train: 5.586783246045707 | Val: -245.65237881322764
9-th component log probs | Train: 5.738723108814403 | Val: -317.32234746187225
KEYWORD NR_SAMPLES:600 DIM:500 AVG_DIFF:33369.0605
0-th component log probs | Train: 5.608339701781216 | Val: -160.84736076007735
1-th component log probs | Train: 5.329670475686076 | Val: -78.30808646621047
2-th component log probs | Train: 5.468958312643516 | Val: -96.86875968354546
3-th component log probs | Train: 5.474204285017146 | Val: -131.39789277677102
4-th component log probs | Train: 5.511900661524236 | Val: -86.38580617066987
5-th component log probs | Train: 5.550950793121721 | Val: -136.80000596365662
6-th component log probs | Train: 5.578388302907892 | Val: -182.2460093335489
7-th component log probs | Train: 5.672536320099853 | Val: -168.94314700712417
8-th component log probs | Train: 5.596192648571827 | Val: -240.5463679512263
9-th component log probs | Train: 5.744581030650378 | Val: -310.588806964709
KEYWORD NR_SAMPLES:600 DIM:512 AVG_DIFF:32063.3283
best average differences at 512 dimensions: 32063.32834455215
2022-01-07 22:28.59 [info     ] Training complete              train_loss=0.3956490159034729
2022-01-07 22:28.59 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:29.03 [info     ] Testing complete               test_loss=1.9651857614517212
{'dataset_size': 600,
 'end_test_accuracy': 0.4942285716533661,
 'end_test_loss': 1.9651857614517212,
 'end_train_accuracy': 0.9906250238418579,
 'end_train_loss': 0.3956490159034729,
 'end_val_accuracy': 0.5681782960891724,
 'end_val_loss': 2.0229897499084473}
2022-01-07 22:29.03 [info     ] Start Predict                  dataset=58006
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:29.42 [info     ] Starting training              dataset=800 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
800
Fitting PCA...
0-th component log probs | Train: 2.8860350926238483 | Val: -43.04095387044884
1-th component log probs | Train: 2.4695215913503232 | Val: -4.4796712656788005
2-th component log probs | Train: 2.770523994447408 | Val: -17.093535677988044
3-th component log probs | Train: 2.502635109376378 | Val: -13.799112474937331
4-th component log probs | Train: 2.6035775513686463 | Val: -18.36288992476984
5-th component log probs | Train: 2.639999595948383 | Val: -18.235629696473254
6-th component log probs | Train: 2.5914303075375784 | Val: -19.065397914406
7-th component log probs | Train: 3.356109366083217 | Val: -152.35666150930123
8-th component log probs | Train: 2.738803439686157 | Val: -33.85654705637025
9-th component log probs | Train: 2.877559017756965 | Val: -112.96468321343761
KEYWORD NR_SAMPLES:800 DIM:50 AVG_DIFF:4360.0677
Fitting PCA...
0-th component log probs | Train: 3.9887624966963786 | Val: -182.10571168875046
1-th component log probs | Train: 3.1648624218409083 | Val: -18.857923262029022
2-th component log probs | Train: 3.680177928253596 | Val: -97.38967016678097
3-th component log probs | Train: 3.374862145800552 | Val: -118.56939324502333
4-th component log probs | Train: 3.51954856189219 | Val: -99.77113957406908
5-th component log probs | Train: 3.577374118023936 | Val: -122.25771692183353
6-th component log probs | Train: 3.546987538763017 | Val: -144.6622441065281
7-th component log probs | Train: 4.464152188038891 | Val: -333.9885151676278
8-th component log probs | Train: 3.7237344542230315 | Val: -209.71366030517999
9-th component log probs | Train: 4.147023995717454 | Val: -607.3375060877062
KEYWORD NR_SAMPLES:800 DIM:100 AVG_DIFF:64462.4798
Fitting PCA...
0-th component log probs | Train: 4.571819356204984 | Val: -188.07580376537064
1-th component log probs | Train: 3.7641892352573008 | Val: -52.438303211647224
2-th component log probs | Train: 4.29635583384372 | Val: -130.38721757791146
3-th component log probs | Train: 4.081930348524277 | Val: -204.37950050156243
4-th component log probs | Train: 4.159470039350268 | Val: -147.23821328323467
5-th component log probs | Train: 4.222225353900142 | Val: -174.64722189990243
6-th component log probs | Train: 4.211004256532668 | Val: -209.6154765669023
7-th component log probs | Train: 4.922044496227806 | Val: -297.65567284837203
8-th component log probs | Train: 4.35779407118943 | Val: -269.07077210254835
9-th component log probs | Train: 4.703251999337527 | Val: -543.1583941515884
KEYWORD NR_SAMPLES:800 DIM:150 AVG_DIFF:67119.0467
Fitting PCA...
0-th component log probs | Train: 4.890833086481644 | Val: -173.9760657114196
1-th component log probs | Train: 4.211134279963382 | Val: -68.99713714895445
2-th component log probs | Train: 4.66032590665417 | Val: -126.25320499603362
3-th component log probs | Train: 4.494280603444661 | Val: -202.8316519251501
4-th component log probs | Train: 4.551607047288003 | Val: -148.381136412901
5-th component log probs | Train: 4.606714470878565 | Val: -172.14989261313417
6-th component log probs | Train: 4.597788337612684 | Val: -203.1521807410262
7-th component log probs | Train: 5.16755499186017 | Val: -255.9496822973758
8-th component log probs | Train: 4.713851129732262 | Val: -248.61586020310685
9-th component log probs | Train: 5.000199066591701 | Val: -469.75852762473215
KEYWORD NR_SAMPLES:800 DIM:200 AVG_DIFF:55509.0653
Fitting PCA...
0-th component log probs | Train: 5.091553149874321 | Val: -157.93548095873496
1-th component log probs | Train: 4.514018428222666 | Val: -70.52843006724156
2-th component log probs | Train: 4.896490386658972 | Val: -116.90920728286777
3-th component log probs | Train: 4.763552181290767 | Val: -187.5294146608646
4-th component log probs | Train: 4.8041536442762265 | Val: -137.84807913748895
5-th component log probs | Train: 4.856237662584904 | Val: -158.91112208119807
6-th component log probs | Train: 4.846964801282158 | Val: -187.23039654397232
7-th component log probs | Train: 5.31959310595521 | Val: -223.33805043167237
8-th component log probs | Train: 4.943048171526163 | Val: -221.84704487327485
9-th component log probs | Train: 5.184849538221026 | Val: -410.0261358916781
KEYWORD NR_SAMPLES:800 DIM:250 AVG_DIFF:44607.5846
Fitting PCA...
0-th component log probs | Train: 5.230420677301236 | Val: -143.29408898025187
1-th component log probs | Train: 4.733242312710761 | Val: -67.85812038690254
2-th component log probs | Train: 5.061692629791677 | Val: -107.66355655133601
3-th component log probs | Train: 4.950283901847456 | Val: -171.58833182190494
4-th component log probs | Train: 4.982942244246443 | Val: -126.08816360227681
5-th component log probs | Train: 5.028887452610232 | Val: -145.16273094468275
6-th component log probs | Train: 5.021645047067226 | Val: -169.47305828257137
7-th component log probs | Train: 5.42368010453183 | Val: -197.2853792171088
8-th component log probs | Train: 5.102313928448747 | Val: -200.32450140814618
9-th component log probs | Train: 5.311577097141817 | Val: -363.3727612957037
KEYWORD NR_SAMPLES:800 DIM:300 AVG_DIFF:36229.8850
Fitting PCA...
0-th component log probs | Train: 5.331904144920641 | Val: -129.47973588345806
1-th component log probs | Train: 4.896788899245064 | Val: -64.29131213075401
2-th component log probs | Train: 5.183831939527686 | Val: -98.36701005086707
3-th component log probs | Train: 5.089305450362248 | Val: -156.3962605664472
4-th component log probs | Train: 5.116267711732163 | Val: -115.48583617263004
5-th component log probs | Train: 5.156977495553422 | Val: -132.00826177326866
6-th component log probs | Train: 5.1513193666304335 | Val: -153.05691923620898
7-th component log probs | Train: 5.49977882413425 | Val: -176.84756005251168
8-th component log probs | Train: 5.2201702974788775 | Val: -181.1581246347801
9-th component log probs | Train: 5.404275554347143 | Val: -321.692958529963
KEYWORD NR_SAMPLES:800 DIM:350 AVG_DIFF:29465.9359
Fitting PCA...
0-th component log probs | Train: 5.410250141175908 | Val: -118.0464155259976
1-th component log probs | Train: 5.02404337426039 | Val: -60.528022266150685
2-th component log probs | Train: 5.278632010250167 | Val: -89.9667776475442
3-th component log probs | Train: 5.196191912574436 | Val: -143.04589332680595
4-th component log probs | Train: 5.219032116689896 | Val: -106.16285121341562
5-th component log probs | Train: 5.255830180235315 | Val: -120.73918301076164
6-th component log probs | Train: 5.2509736153122715 | Val: -139.01977472688418
7-th component log probs | Train: 5.558345295886559 | Val: -159.34725230886062
8-th component log probs | Train: 5.311096434382752 | Val: -164.35403753366353
9-th component log probs | Train: 5.475159750150794 | Val: -288.23691159125485
KEYWORD NR_SAMPLES:800 DIM:400 AVG_DIFF:24331.7083
Fitting PCA...
0-th component log probs | Train: 5.472327534196556 | Val: -108.3461088339865
1-th component log probs | Train: 5.126129096730646 | Val: -56.603796116909315
2-th component log probs | Train: 5.354296828323662 | Val: -82.72812997751208
3-th component log probs | Train: 5.281102901081949 | Val: -131.221199139216
4-th component log probs | Train: 5.301153058704107 | Val: -97.48634837726411
5-th component log probs | Train: 5.334587766317351 | Val: -110.90217422703294
6-th component log probs | Train: 5.330332759745254 | Val: -127.13026868773024
7-th component log probs | Train: 5.604596711521214 | Val: -144.9001186214106
8-th component log probs | Train: 5.3835281659306755 | Val: -150.12214453376583
9-th component log probs | Train: 5.531146245804164 | Val: -260.3745964100748
KEYWORD NR_SAMPLES:800 DIM:450 AVG_DIFF:20358.8041
Fitting PCA...
0-th component log probs | Train: 5.522937689629932 | Val: -99.91144262029299
1-th component log probs | Train: 5.210057327466459 | Val: -53.00955969724286
2-th component log probs | Train: 5.416044815961929 | Val: -76.30124152285144
3-th component log probs | Train: 5.35074207073808 | Val: -120.69644124912125
4-th component log probs | Train: 5.368156585030563 | Val: -90.19966076736213
5-th component log probs | Train: 5.398854892017032 | Val: -102.14539948946202
6-th component log probs | Train: 5.395023736205195 | Val: -116.82866603862847
7-th component log probs | Train: 5.642209936949616 | Val: -132.70559232317842
8-th component log probs | Train: 5.442715039452675 | Val: -137.82813998596046
9-th component log probs | Train: 5.576451550250857 | Val: -237.25526296737564
KEYWORD NR_SAMPLES:800 DIM:500 AVG_DIFF:17250.9920
0-th component log probs | Train: 5.5337340006276845 | Val: -98.0389093124543
1-th component log probs | Train: 5.228016931869932 | Val: -52.149300670550154
2-th component log probs | Train: 5.429251607353793 | Val: -74.89014956556241
3-th component log probs | Train: 5.365553373439301 | Val: -118.38624732370357
4-th component log probs | Train: 5.382480434601452 | Val: -88.56491111461054
5-th component log probs | Train: 5.412547641594241 | Val: -100.19497574377132
6-th component log probs | Train: 5.408822856144555 | Val: -114.58383891411839
7-th component log probs | Train: 5.650240778722625 | Val: -130.05873076610047
8-th component log probs | Train: 5.455356019246827 | Val: -135.1344391807399
9-th component log probs | Train: 5.5860670363780045 | Val: -232.31893307919435
KEYWORD NR_SAMPLES:800 DIM:512 AVG_DIFF:16608.7989
best average differences at 50 dimensions: 4360.067716234226
2022-01-07 22:32.03 [info     ] Training complete              train_loss=0.3841167688369751
2022-01-07 22:32.03 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:32.07 [info     ] Testing complete               test_loss=1.5899419784545898
{'dataset_size': 800,
 'end_test_accuracy': 0.5785089135169983,
 'end_test_loss': 1.5899419784545898,
 'end_train_accuracy': 0.9987980723381042,
 'end_train_loss': 0.3841167688369751,
 'end_val_accuracy': 0.6514495611190796,
 'end_val_loss': 1.5794373750686646}
2022-01-07 22:32.07 [info     ] Start Predict                  dataset=57806
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:32.31 [info     ] Starting training              dataset=1000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
1000
Fitting PCA...
0-th component log probs | Train: 2.5817170924811643 | Val: -7.591549516149353
1-th component log probs | Train: 2.575031284660584 | Val: -4.1349693113108525
2-th component log probs | Train: 2.4723120203424918 | Val: -3.312891519116165
3-th component log probs | Train: 2.4401134831544598 | Val: -4.758083401774527
4-th component log probs | Train: 2.492715836076077 | Val: -7.031575767282921
5-th component log probs | Train: 2.647876696616475 | Val: -13.711901260342923
6-th component log probs | Train: 2.459675187580636 | Val: -8.943034702302098
7-th component log probs | Train: 2.944137972515266 | Val: -24.491798471116148
8-th component log probs | Train: 2.3697280609902194 | Val: -5.898564511077646
9-th component log probs | Train: 2.450130531224775 | Val: -10.252456473914464
KEYWORD NR_SAMPLES:1000 DIM:50 AVG_DIFF:179.4756
Fitting PCA...
0-th component log probs | Train: 3.4902028996185055 | Val: -65.8990379058301
1-th component log probs | Train: 3.2913833640101355 | Val: -15.381370354644131
2-th component log probs | Train: 3.2235195252698507 | Val: -15.77807602294559
3-th component log probs | Train: 3.2129517611494904 | Val: -29.227889435843352
4-th component log probs | Train: 3.318202735686716 | Val: -39.64969373141644
5-th component log probs | Train: 3.5475017195882956 | Val: -84.15626183176074
6-th component log probs | Train: 3.38226533751238 | Val: -103.51413958979762
7-th component log probs | Train: 3.995581254941437 | Val: -145.34816911659004
8-th component log probs | Train: 3.3070106255218272 | Val: -73.07695769221404
9-th component log probs | Train: 3.325486060316495 | Val: -62.88041198311283
KEYWORD NR_SAMPLES:1000 DIM:100 AVG_DIFF:6069.8238
Fitting PCA...
0-th component log probs | Train: 4.160801822850448 | Val: -108.05856382209491
1-th component log probs | Train: 3.8282378662146557 | Val: -33.57995602582737
2-th component log probs | Train: 3.8128489419209792 | Val: -42.6822278024742
3-th component log probs | Train: 3.8651714001976476 | Val: -83.57048745239081
4-th component log probs | Train: 3.980484583627363 | Val: -83.62619863683074
5-th component log probs | Train: 4.180890328962823 | Val: -137.4931845541444
6-th component log probs | Train: 4.076590627373953 | Val: -162.84358121547652
7-th component log probs | Train: 4.555671180862925 | Val: -160.2095756858354
8-th component log probs | Train: 4.044508066634595 | Val: -137.58499007563182
9-th component log probs | Train: 3.983882536300989 | Val: -119.94255692976672
KEYWORD NR_SAMPLES:1000 DIM:150 AVG_DIFF:14304.2019
Fitting PCA...
0-th component log probs | Train: 4.559212519752119 | Val: -111.77351307763028
1-th component log probs | Train: 4.234488403491774 | Val: -43.200363562596856
2-th component log probs | Train: 4.245001942233108 | Val: -55.11345292672922
3-th component log probs | Train: 4.310344415497033 | Val: -100.88677578650103
4-th component log probs | Train: 4.4068380341623685 | Val: -89.93795732951472
5-th component log probs | Train: 4.567294095396847 | Val: -135.3454648209517
6-th component log probs | Train: 4.494693334365396 | Val: -162.75842993786452
7-th component log probs | Train: 4.872284097620353 | Val: -147.37884251443342
8-th component log probs | Train: 4.474341794058644 | Val: -142.31380316974827
9-th component log probs | Train: 4.405516522016591 | Val: -127.85902346735382
KEYWORD NR_SAMPLES:1000 DIM:200 AVG_DIFF:15016.0997
Fitting PCA...
0-th component log probs | Train: 4.815351041908242 | Val: -110.13952494788121
1-th component log probs | Train: 4.524346868991852 | Val: -45.469646890757666
2-th component log probs | Train: 4.540585910104403 | Val: -56.98839073987351
3-th component log probs | Train: 4.604640405056032 | Val: -100.44122651523293
4-th component log probs | Train: 4.684594598984988 | Val: -86.90872570580692
5-th component log probs | Train: 4.8188212650897375 | Val: -128.45958459804393
6-th component log probs | Train: 4.763131854693509 | Val: -151.95997244145283
7-th component log probs | Train: 5.073759964362378 | Val: -132.3685130585822
8-th component log probs | Train: 4.748789823270075 | Val: -135.24185625946768
9-th component log probs | Train: 4.682985584413079 | Val: -124.1710433770149
KEYWORD NR_SAMPLES:1000 DIM:250 AVG_DIFF:13741.2342
Fitting PCA...
0-th component log probs | Train: 4.993544662509215 | Val: -101.53848778337012
1-th component log probs | Train: 4.733795224143207 | Val: -44.43042429275267
2-th component log probs | Train: 4.752570498673935 | Val: -55.229407214666516
3-th component log probs | Train: 4.812696792866016 | Val: -95.90759521606066
4-th component log probs | Train: 4.880133162646813 | Val: -81.85745442286881
5-th component log probs | Train: 4.9947941146575365 | Val: -118.1440962872199
6-th component log probs | Train: 4.950283675589507 | Val: -140.0211590808005
7-th component log probs | Train: 5.214206409782304 | Val: -118.90736103273886
8-th component log probs | Train: 4.939631851452793 | Val: -124.76854576347714
9-th component log probs | Train: 4.8772123867162795 | Val: -117.39173009712354
KEYWORD NR_SAMPLES:1000 DIM:300 AVG_DIFF:11939.0189
Fitting PCA...
0-th component log probs | Train: 5.125610811068484 | Val: -93.85887936126117
1-th component log probs | Train: 4.8916084220892415 | Val: -42.492370766373604
2-th component log probs | Train: 4.911103166596099 | Val: -52.654190458117924
3-th component log probs | Train: 4.967782908720121 | Val: -89.84041736430277
4-th component log probs | Train: 5.025059643312106 | Val: -76.10839723667846
5-th component log probs | Train: 5.125457084374816 | Val: -108.80346307831041
6-th component log probs | Train: 5.088649792990834 | Val: -127.85005966743141
7-th component log probs | Train: 5.317041859773178 | Val: -108.06080581964412
8-th component log probs | Train: 5.080083494198785 | Val: -115.08185467049704
9-th component log probs | Train: 5.0227587557742766 | Val: -108.34142006156569
KEYWORD NR_SAMPLES:1000 DIM:350 AVG_DIFF:10264.8622
Fitting PCA...
0-th component log probs | Train: 5.227339887684318 | Val: -86.8698581859004
1-th component log probs | Train: 5.015924459494762 | Val: -40.252954587396175
2-th component log probs | Train: 5.034844282168675 | Val: -49.437656568389876
3-th component log probs | Train: 5.087663628362565 | Val: -83.23028967751685
4-th component log probs | Train: 5.137584507224512 | Val: -70.78375595932404
5-th component log probs | Train: 5.226265469396389 | Val: -100.01901559300765
6-th component log probs | Train: 5.195396997019865 | Val: -117.05079433892925
7-th component log probs | Train: 5.396132885448982 | Val: -98.56511807155816
8-th component log probs | Train: 5.188042092642904 | Val: -105.47163346722505
9-th component log probs | Train: 5.13524284660512 | Val: -99.84434053300093
KEYWORD NR_SAMPLES:1000 DIM:400 AVG_DIFF:8800.8974
Fitting PCA...
0-th component log probs | Train: 5.308245792570825 | Val: -80.38029495081769
1-th component log probs | Train: 5.115781590632177 | Val: -38.04751600670826
2-th component log probs | Train: 5.134325386758614 | Val: -46.307853809518534
3-th component log probs | Train: 5.183185868361225 | Val: -77.1232636575642
4-th component log probs | Train: 5.227523320228628 | Val: -65.69909836043708
5-th component log probs | Train: 5.306549033318363 | Val: -91.84739901055265
6-th component log probs | Train: 5.280160142115553 | Val: -107.49378770587667
7-th component log probs | Train: 5.4590226115623235 | Val: -90.21067105765587
8-th component log probs | Train: 5.273963564670789 | Val: -97.24490113929184
9-th component log probs | Train: 5.224989695003732 | Val: -92.2655846631642
KEYWORD NR_SAMPLES:1000 DIM:450 AVG_DIFF:7576.7525
Fitting PCA...
0-th component log probs | Train: 5.374404197804179 | Val: -74.33428165264367
1-th component log probs | Train: 5.198424488880356 | Val: -35.71109115763622
2-th component log probs | Train: 5.216468218263133 | Val: -43.35309096612916
3-th component log probs | Train: 5.26132545028632 | Val: -71.6886478283141
4-th component log probs | Train: 5.301060060588103 | Val: -61.140436979677936
5-th component log probs | Train: 5.372523173506117 | Val: -84.8834136544019
6-th component log probs | Train: 5.349348531027242 | Val: -99.04211667477506
7-th component log probs | Train: 5.510414707904316 | Val: -83.03217820989248
8-th component log probs | Train: 5.34371715405108 | Val: -90.00996350899752
9-th component log probs | Train: 5.298750509521375 | Val: -85.3698206805982
KEYWORD NR_SAMPLES:1000 DIM:500 AVG_DIFF:6564.7018
0-th component log probs | Train: 5.388553860003117 | Val: -72.9920483549318
1-th component log probs | Train: 5.2162343532880655 | Val: -35.18478621227773
2-th component log probs | Train: 5.2340980381265245 | Val: -42.66636336853043
3-th component log probs | Train: 5.278048693612291 | Val: -70.44696166320986
4-th component log probs | Train: 5.3168127122799245 | Val: -60.12716381431198
5-th component log probs | Train: 5.386625666250488 | Val: -83.30409709547497
6-th component log probs | Train: 5.364134302120872 | Val: -97.15610441239888
7-th component log probs | Train: 5.521365916800187 | Val: -81.43017773373482
8-th component log probs | Train: 5.358605301850979 | Val: -88.38996872535506
9-th component log probs | Train: 5.314538140526135 | Val: -83.79183067101035
KEYWORD NR_SAMPLES:1000 DIM:512 AVG_DIFF:6346.8651
best average differences at 50 dimensions: 179.47561502088533
2022-01-07 22:34.40 [info     ] Training complete              train_loss=0.43831607699394226
2022-01-07 22:34.40 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:34.43 [info     ] Testing complete               test_loss=1.4460769891738892
{'dataset_size': 1000,
 'end_test_accuracy': 0.5710099339485168,
 'end_test_loss': 1.4460769891738892,
 'end_train_accuracy': 0.9818359613418579,
 'end_train_loss': 0.43831607699394226,
 'end_val_accuracy': 0.681806743144989,
 'end_val_loss': 1.4832139015197754}
2022-01-07 22:34.43 [info     ] Start Predict                  dataset=57606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:35.08 [info     ] Starting training              dataset=2000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
2000
Fitting PCA...
0-th component log probs | Train: 2.4922459154119787 | Val: -2.0518604024749596
1-th component log probs | Train: 2.101099721621341 | Val: 1.2413539692429743
2-th component log probs | Train: 2.412255639517547 | Val: -1.2325805458768044
3-th component log probs | Train: 2.2837514906213134 | Val: -0.7880421762680073
4-th component log probs | Train: 2.341461140189779 | Val: -0.228862120319283
5-th component log probs | Train: 2.496272788135074 | Val: -1.5798318895040762
6-th component log probs | Train: 2.024056526002304 | Val: 0.3058997161226861
7-th component log probs | Train: 2.598707671309086 | Val: -2.183439497130863
8-th component log probs | Train: 2.4228108530463683 | Val: -2.287734869009777
9-th component log probs | Train: 2.2402112230177837 | Val: -0.28572557945571075
KEYWORD NR_SAMPLES:2000 DIM:50 AVG_DIFF:13.0811
Fitting PCA...
0-th component log probs | Train: 3.1091086103402255 | Val: -5.838656023890519
1-th component log probs | Train: 2.688861795736757 | Val: 1.12774043227988
2-th component log probs | Train: 3.0218404222610764 | Val: -4.120220338567179
3-th component log probs | Train: 2.8864663240256507 | Val: -3.772358873336486
4-th component log probs | Train: 2.9524037804996603 | Val: -3.034681409344237
5-th component log probs | Train: 3.139841934904134 | Val: -6.219087167758635
6-th component log probs | Train: 2.6536623516407225 | Val: -1.6809481876630452
7-th component log probs | Train: 3.232610256584568 | Val: -7.4013821932822035
8-th component log probs | Train: 3.0650376473910157 | Val: -7.847195427970508
9-th component log probs | Train: 2.878091577977219 | Val: -3.6075857527948676
KEYWORD NR_SAMPLES:2000 DIM:100 AVG_DIFF:63.6689
Fitting PCA...
0-th component log probs | Train: 3.5281198544279513 | Val: -11.371704480305546
1-th component log probs | Train: 3.0697220095765836 | Val: 0.5502171561441797
2-th component log probs | Train: 3.4197945025595304 | Val: -7.735999227170381
3-th component log probs | Train: 3.3118382352368685 | Val: -8.633133886108004
4-th component log probs | Train: 3.386209358420032 | Val: -9.079612557139216
5-th component log probs | Train: 3.6190557578773195 | Val: -16.91322532432325
6-th component log probs | Train: 3.1518183889705886 | Val: -9.386552807763536
7-th component log probs | Train: 3.6827891466309306 | Val: -15.453121047293331
8-th component log probs | Train: 3.504870644686875 | Val: -16.586419774761197
9-th component log probs | Train: 3.32752517698938 | Val: -9.237074330860885
KEYWORD NR_SAMPLES:2000 DIM:150 AVG_DIFF:226.1228
Fitting PCA...
0-th component log probs | Train: 3.858857945845983 | Val: -18.505008128835826
1-th component log probs | Train: 3.3780887549382723 | Val: -0.6296280166425086
2-th component log probs | Train: 3.753106907582655 | Val: -12.725935555550688
3-th component log probs | Train: 3.698984816557959 | Val: -18.72712158033307
4-th component log probs | Train: 3.775690095170863 | Val: -17.313302154583237
5-th component log probs | Train: 4.0139402340200325 | Val: -27.607649182872585
6-th component log probs | Train: 3.635853465089198 | Val: -25.726333273331107
7-th component log probs | Train: 4.054596012303311 | Val: -24.213824720248574
8-th component log probs | Train: 3.877375999582861 | Val: -26.729751269540305
9-th component log probs | Train: 3.7031894940448256 | Val: -17.570273578998318
KEYWORD NR_SAMPLES:2000 DIM:200 AVG_DIFF:597.5711
Fitting PCA...
0-th component log probs | Train: 4.1392090862318 | Val: -23.569765576371342
1-th component log probs | Train: 3.651284044352797 | Val: -2.526020410579093
2-th component log probs | Train: 4.022129352966005 | Val: -16.637525953718562
3-th component log probs | Train: 4.025281418103723 | Val: -25.417149724663382
4-th component log probs | Train: 4.096671539422692 | Val: -22.88037399268864
5-th component log probs | Train: 4.320356933784929 | Val: -33.97401070437377
6-th component log probs | Train: 4.018551780935074 | Val: -35.15911601713591
7-th component log probs | Train: 4.340958193519846 | Val: -28.885107682284552
8-th component log probs | Train: 4.178356227154007 | Val: -34.03975110765182
9-th component log probs | Train: 4.026913743968111 | Val: -25.493398786678334
KEYWORD NR_SAMPLES:2000 DIM:250 AVG_DIFF:951.3360
Fitting PCA...
0-th component log probs | Train: 4.363284229815554 | Val: -26.577637596343525
1-th component log probs | Train: 3.8945640106700297 | Val: -4.674247898755336
2-th component log probs | Train: 4.243534968260756 | Val: -19.09913037887125
3-th component log probs | Train: 4.281297929878748 | Val: -29.316956051614675
4-th component log probs | Train: 4.346867666220772 | Val: -25.36743859349265
5-th component log probs | Train: 4.547650879470708 | Val: -35.31869658791331
6-th component log probs | Train: 4.301599517532155 | Val: -38.36972988319889
7-th component log probs | Train: 4.561149139587231 | Val: -30.8776982375119
8-th component log probs | Train: 4.412544415157317 | Val: -37.53901754303154
9-th component log probs | Train: 4.282534135806475 | Val: -29.34360530501725
KEYWORD NR_SAMPLES:2000 DIM:300 AVG_DIFF:1142.0643
Fitting PCA...
0-th component log probs | Train: 4.543616497449761 | Val: -28.055318113503333
1-th component log probs | Train: 4.107756028349036 | Val: -6.483831152135583
2-th component log probs | Train: 4.426307580736265 | Val: -20.48159763292684
3-th component log probs | Train: 4.485978224242612 | Val: -30.797947857132485
4-th component log probs | Train: 4.54239137204264 | Val: -26.624557682980218
5-th component log probs | Train: 4.723087451067347 | Val: -35.39036274561159
6-th component log probs | Train: 4.516306884351471 | Val: -39.24326678399634
7-th component log probs | Train: 4.730167772446017 | Val: -31.255896417541877
8-th component log probs | Train: 4.59736242478213 | Val: -38.68995699420748
9-th component log probs | Train: 4.484354187371999 | Val: -30.706203443633655
KEYWORD NR_SAMPLES:2000 DIM:350 AVG_DIFF:1223.0492
Fitting PCA...
0-th component log probs | Train: 4.691299377001248 | Val: -28.092507242696737
1-th component log probs | Train: 4.28959549495951 | Val: -7.694189132919556
2-th component log probs | Train: 4.5778488265067745 | Val: -20.84041017456718
3-th component log probs | Train: 4.648774235179994 | Val: -31.13812605561763
4-th component log probs | Train: 4.698415714635709 | Val: -26.34462970883417
5-th component log probs | Train: 4.861664514348853 | Val: -34.08266737003092
6-th component log probs | Train: 4.684531590560277 | Val: -38.54173177000768
7-th component log probs | Train: 4.865854808206255 | Val: -30.644108428499404
8-th component log probs | Train: 4.744360064495706 | Val: -37.83335266026704
9-th component log probs | Train: 4.646827620212147 | Val: -30.707377861095132
KEYWORD NR_SAMPLES:2000 DIM:400 AVG_DIFF:1210.3679
Fitting PCA...
0-th component log probs | Train: 4.8134149601228495 | Val: -27.45440312802467
1-th component log probs | Train: 4.4454832820957 | Val: -8.35887983582474
2-th component log probs | Train: 4.704553007837136 | Val: -20.535920263895658
3-th component log probs | Train: 4.7810992654941655 | Val: -30.641237494219954
4-th component log probs | Train: 4.825174195759107 | Val: -25.68570119656377
5-th component log probs | Train: 4.973326554614152 | Val: -32.616214782192614
6-th component log probs | Train: 4.8193440631278595 | Val: -37.09145969583222
7-th component log probs | Train: 4.9756440465687835 | Val: -29.46991575354285
8-th component log probs | Train: 4.864781756536433 | Val: -36.536167146288456
9-th component log probs | Train: 4.779365968946223 | Val: -29.816237641503342
KEYWORD NR_SAMPLES:2000 DIM:450 AVG_DIFF:1157.2987
Fitting PCA...
0-th component log probs | Train: 4.916606398627506 | Val: -26.470177826646008
1-th component log probs | Train: 4.57936670668517 | Val: -8.636344438438433
2-th component log probs | Train: 4.812459779266052 | Val: -19.843270030295834
3-th component log probs | Train: 4.891546431431219 | Val: -29.47448448350986
4-th component log probs | Train: 4.931173505508953 | Val: -24.653798769444705
5-th component log probs | Train: 5.066299129014265 | Val: -30.75897853292599
6-th component log probs | Train: 4.930216287110093 | Val: -35.38574029814571
7-th component log probs | Train: 5.066990178399126 | Val: -28.050909669948535
8-th component log probs | Train: 4.965684915470512 | Val: -34.72499824169454
9-th component log probs | Train: 4.889601673227823 | Val: -28.653318438812533
KEYWORD NR_SAMPLES:2000 DIM:500 AVG_DIFF:1079.6737
0-th component log probs | Train: 4.938934442441888 | Val: -26.2126556210769
1-th component log probs | Train: 4.608499193258541 | Val: -8.649838597654538
2-th component log probs | Train: 4.836107734902945 | Val: -19.661100608511553
3-th component log probs | Train: 4.915502162765835 | Val: -29.14784810825069
4-th component log probs | Train: 4.954301858024232 | Val: -24.33792093094839
5-th component log probs | Train: 5.086376719167105 | Val: -30.354936454657484
6-th component log probs | Train: 4.954126284324995 | Val: -34.91177896964957
7-th component log probs | Train: 5.086856885348691 | Val: -27.708234669299923
8-th component log probs | Train: 4.987556667432853 | Val: -34.2682129656578
9-th component log probs | Train: 4.913509095282097 | Val: -28.320632858402757
KEYWORD NR_SAMPLES:2000 DIM:512 AVG_DIFF:1059.4656
best average differences at 50 dimensions: 13.081141863217894
2022-01-07 22:37.58 [info     ] Training complete              train_loss=0.45905357599258423
2022-01-07 22:37.58 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:38.02 [info     ] Testing complete               test_loss=0.8761696219444275
{'dataset_size': 2000,
 'end_test_accuracy': 0.7245726585388184,
 'end_test_loss': 0.8761696219444275,
 'end_train_accuracy': 0.9609375,
 'end_train_loss': 0.45905357599258423,
 'end_val_accuracy': 0.7572486996650696,
 'end_val_loss': 1.0957207679748535}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:38.02 [info     ] Start Predict                  dataset=56606
2022-01-07 22:38.27 [info     ] Starting training              dataset=4000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
4000
Fitting PCA...
0-th component log probs | Train: 2.3995264206670313 | Val: -0.15394321166204045
1-th component log probs | Train: 2.207836365983069 | Val: 1.1536204274847648
2-th component log probs | Train: 2.0799937881530126 | Val: 1.0089476817921956
3-th component log probs | Train: 2.108794600340978 | Val: 0.5874016940633211
4-th component log probs | Train: 2.2142224747044144 | Val: 0.9082339356123185
5-th component log probs | Train: 2.242105217569705 | Val: 0.464138888417797
6-th component log probs | Train: 2.3221518999489668 | Val: -0.8005262882370403
7-th component log probs | Train: 2.0746891074736733 | Val: 1.2159063018847793
8-th component log probs | Train: 2.23602829610755 | Val: 0.07736182721613037
9-th component log probs | Train: 2.078955463343674 | Val: 0.6807491883972489
KEYWORD NR_SAMPLES:4000 DIM:50 AVG_DIFF:2.7922
Fitting PCA...
0-th component log probs | Train: 2.9805813805561807 | Val: -2.318957726187899
1-th component log probs | Train: 2.769211347945488 | Val: 1.0691307181109773
2-th component log probs | Train: 2.6132346764920036 | Val: 1.377849886028666
3-th component log probs | Train: 2.6623094404777974 | Val: 0.1288149521392349
4-th component log probs | Train: 2.784312120788479 | Val: 0.6208347164036002
5-th component log probs | Train: 2.8221730733244406 | Val: -0.4035168244659054
6-th component log probs | Train: 2.912595687847995 | Val: -2.551997169949892
7-th component log probs | Train: 2.631760332689471 | Val: 1.1545120470175845
8-th component log probs | Train: 2.814290156653672 | Val: -1.0936126579382324
9-th component log probs | Train: 2.646077685882382 | Val: 0.1279870694057941
KEYWORD NR_SAMPLES:4000 DIM:100 AVG_DIFF:10.9551
Fitting PCA...
0-th component log probs | Train: 3.3353079203430065 | Val: -3.8200570741706095
1-th component log probs | Train: 3.0980519401106625 | Val: 0.9129730737017955
2-th component log probs | Train: 2.912544276704145 | Val: 1.6155180862261036
3-th component log probs | Train: 2.9931299380540284 | Val: -0.2551326257416023
4-th component log probs | Train: 3.138802112350175 | Val: 0.015019165769898134
5-th component log probs | Train: 3.1987637087706227 | Val: -1.947831945664034
6-th component log probs | Train: 3.311353429522734 | Val: -5.604356551284549
7-th component log probs | Train: 2.9705942850203306 | Val: 0.8963333204522872
8-th component log probs | Train: 3.1789455593773503 | Val: -2.4216952241524634
9-th component log probs | Train: 3.0015409740098664 | Val: -0.4371704570935412
KEYWORD NR_SAMPLES:4000 DIM:150 AVG_DIFF:24.2484
Fitting PCA...
0-th component log probs | Train: 3.6157443685387056 | Val: -5.828012525190544
1-th component log probs | Train: 3.357008359228518 | Val: 0.5687053225262613
2-th component log probs | Train: 3.1368092611464706 | Val: 1.7283567535819666
3-th component log probs | Train: 3.242880872275687 | Val: -0.713411269287881
4-th component log probs | Train: 3.420144088313327 | Val: -1.1246361815860086
5-th component log probs | Train: 3.508209538964887 | Val: -4.663575134117452
6-th component log probs | Train: 3.653904276117296 | Val: -10.6619060707498
7-th component log probs | Train: 3.232793398605656 | Val: 0.5038850568731799
8-th component log probs | Train: 3.458685239398002 | Val: -4.311934658723052
9-th component log probs | Train: 3.2746410288079333 | Val: -1.3194259871789527
KEYWORD NR_SAMPLES:4000 DIM:200 AVG_DIFF:52.1728
Fitting PCA...
0-th component log probs | Train: 3.8485218601723825 | Val: -8.104662904258408
1-th component log probs | Train: 3.570601311006834 | Val: 0.04527294710889507
2-th component log probs | Train: 3.315359653942812 | Val: 1.7762921012679744
3-th component log probs | Train: 3.450165693311891 | Val: -1.3866648744851258
4-th component log probs | Train: 3.660241906221145 | Val: -2.77248753975091
5-th component log probs | Train: 3.7762837315192734 | Val: -7.942474045002939
6-th component log probs | Train: 3.9451841658613658 | Val: -15.033869056948056
7-th component log probs | Train: 3.4587587525127357 | Val: -0.2868817347884787
8-th component log probs | Train: 3.7009807054841706 | Val: -6.579363677075311
9-th component log probs | Train: 3.5045679785552872 | Val: -2.7720298669165544
KEYWORD NR_SAMPLES:4000 DIM:250 AVG_DIFF:92.2152
Fitting PCA...
0-th component log probs | Train: 4.041829631255279 | Val: -9.936506921800449
1-th component log probs | Train: 3.75723386402314 | Val: -0.6598467146067976
2-th component log probs | Train: 3.460850850644927 | Val: 1.7853214081208961
3-th component log probs | Train: 3.6306097512130813 | Val: -2.227939117717923
4-th component log probs | Train: 3.879609374348592 | Val: -4.642011797040855
5-th component log probs | Train: 4.011035341362785 | Val: -10.854012371898996
6-th component log probs | Train: 4.187331892634674 | Val: -18.283116432268848
7-th component log probs | Train: 3.657846087789197 | Val: -1.2812938534501783
8-th component log probs | Train: 3.9162521351587123 | Val: -9.244129502019947
9-th component log probs | Train: 3.7105429332748194 | Val: -4.744832235208653
KEYWORD NR_SAMPLES:4000 DIM:300 AVG_DIFF:137.9716
Fitting PCA...
0-th component log probs | Train: 4.209626219636615 | Val: -11.343311766073725
1-th component log probs | Train: 3.9258030391674 | Val: -1.3947675203067535
2-th component log probs | Train: 3.589697348680368 | Val: 1.7378075904867447
3-th component log probs | Train: 3.79492636557721 | Val: -3.3945671746390054
4-th component log probs | Train: 4.076132048571957 | Val: -6.333557902925874
5-th component log probs | Train: 4.213748642549192 | Val: -12.599402511772288
6-th component log probs | Train: 4.384588550004163 | Val: -19.871861171203783
7-th component log probs | Train: 3.842873627607915 | Val: -2.41782002144295
8-th component log probs | Train: 4.109699270388948 | Val: -11.562714836687983
9-th component log probs | Train: 3.898718653539954 | Val: -6.692821700388576
KEYWORD NR_SAMPLES:4000 DIM:350 AVG_DIFF:177.5614
Fitting PCA...
0-th component log probs | Train: 4.354113049744949 | Val: -12.478681130601966
1-th component log probs | Train: 4.076609474199247 | Val: -2.0751893990835093
2-th component log probs | Train: 3.7059905381745812 | Val: 1.6898721084370718
3-th component log probs | Train: 3.9458224640952775 | Val: -4.460688293571361
4-th component log probs | Train: 4.246886630922713 | Val: -7.489915002091289
5-th component log probs | Train: 4.385168098842804 | Val: -13.906415143333758
6-th component log probs | Train: 4.546841720532529 | Val: -20.8729577832299
7-th component log probs | Train: 4.013662697163384 | Val: -3.528128881225643
8-th component log probs | Train: 4.277316299819681 | Val: -13.236234449146792
9-th component log probs | Train: 4.07240557014443 | Val: -8.620421296672935
KEYWORD NR_SAMPLES:4000 DIM:400 AVG_DIFF:212.4112
Fitting PCA...
0-th component log probs | Train: 4.4774164827014395 | Val: -12.965429634442936
1-th component log probs | Train: 4.2140178812952085 | Val: -2.6423104521668184
2-th component log probs | Train: 3.8141369639084863 | Val: 1.574986879480061
3-th component log probs | Train: 4.085686523752011 | Val: -5.361646553019648
4-th component log probs | Train: 4.394910366812818 | Val: -8.381913055777128
5-th component log probs | Train: 4.528841133164704 | Val: -14.5682933328548
6-th component log probs | Train: 4.681063926162817 | Val: -21.264202845741146
7-th component log probs | Train: 4.165732690010683 | Val: -4.519546314961444
8-th component log probs | Train: 4.422023855384602 | Val: -14.40472150852247
9-th component log probs | Train: 4.225851175143191 | Val: -10.09710742006879
KEYWORD NR_SAMPLES:4000 DIM:450 AVG_DIFF:237.4290
Fitting PCA...
0-th component log probs | Train: 4.587957606146342 | Val: -13.064742703221336
1-th component log probs | Train: 4.34077074350573 | Val: -3.0087989692883577
2-th component log probs | Train: 3.9192862367701826 | Val: 1.4401238808728778
3-th component log probs | Train: 4.216678020536141 | Val: -6.038049116377673
4-th component log probs | Train: 4.525015893500969 | Val: -8.864004132712981
5-th component log probs | Train: 4.652176776202988 | Val: -14.578557322820002
6-th component log probs | Train: 4.7946704584026385 | Val: -20.85091516159176
7-th component log probs | Train: 4.304597082617592 | Val: -5.118184769543003
8-th component log probs | Train: 4.549080171480028 | Val: -14.743135013057312
9-th component log probs | Train: 4.36370911972478 | Val: -10.88676574319378
KEYWORD NR_SAMPLES:4000 DIM:500 AVG_DIFF:247.2991
0-th component log probs | Train: 4.613054804528818 | Val: -12.98988172685738
1-th component log probs | Train: 4.368843761580506 | Val: -3.067173222303227
2-th component log probs | Train: 3.9456557249073567 | Val: 1.4255790143910128
3-th component log probs | Train: 4.247323204459667 | Val: -6.150554358499528
4-th component log probs | Train: 4.5536931879983085 | Val: -8.907662997728325
5-th component log probs | Train: 4.679414339568057 | Val: -14.508282474447762
6-th component log probs | Train: 4.819404356537471 | Val: -20.70929320976714
7-th component log probs | Train: 4.336020463819112 | Val: -5.236568121046304
8-th component log probs | Train: 4.5771931715421825 | Val: -14.763799667240624
9-th component log probs | Train: 4.394587494165224 | Val: -11.000133476253511
KEYWORD NR_SAMPLES:4000 DIM:512 AVG_DIFF:247.9328
best average differences at 50 dimensions: 2.7921683117665097
2022-01-07 22:42.18 [info     ] Training complete              train_loss=0.38629573583602905
2022-01-07 22:42.18 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:42.22 [info     ] Testing complete               test_loss=0.7097108960151672
{'dataset_size': 4000,
 'end_test_accuracy': 0.779995858669281,
 'end_test_loss': 0.7097108960151672,
 'end_train_accuracy': 0.9739583134651184,
 'end_train_loss': 0.38629573583602905,
 'end_val_accuracy': 0.8262931704521179,
 'end_val_loss': 0.8246428370475769}
2022-01-07 22:42.22 [info     ] Start Predict                  dataset=54606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:42.49 [info     ] Starting training              dataset=6000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
6000
Fitting PCA...
0-th component log probs | Train: 2.2363925846063677 | Val: 0.5612391298545253
1-th component log probs | Train: 2.1325760034478187 | Val: 1.3786084813447896
2-th component log probs | Train: 2.1459753914269664 | Val: 1.0976031302292009
3-th component log probs | Train: 2.1095520746954555 | Val: 0.48438802713398615
4-th component log probs | Train: 1.9956878291417004 | Val: 1.292554026847424
5-th component log probs | Train: 2.2576012658627813 | Val: 0.9630612874043937
6-th component log probs | Train: 2.1919213944001203 | Val: 0.7290590710508041
7-th component log probs | Train: 2.159516519451116 | Val: 0.9828191510636989
8-th component log probs | Train: 2.1288971752589325 | Val: 0.6770233028361268
9-th component log probs | Train: 2.164418166747586 | Val: 0.9682123218408604
KEYWORD NR_SAMPLES:6000 DIM:50 AVG_DIFF:0.7214
Fitting PCA...
0-th component log probs | Train: 2.7838891190540607 | Val: 0.3224492980556896
1-th component log probs | Train: 2.6589782117999983 | Val: 1.6619314288700133
2-th component log probs | Train: 2.6804241975337693 | Val: 1.2379815938334242
3-th component log probs | Train: 2.6367573723061652 | Val: 0.2821702882051542
4-th component log probs | Train: 2.543131629171586 | Val: 1.4226916299023484
5-th component log probs | Train: 2.832441327984179 | Val: 0.5426341570997469
6-th component log probs | Train: 2.7581137976737766 | Val: 0.20092035675242412
7-th component log probs | Train: 2.7054654928975728 | Val: 0.9422407004599745
8-th component log probs | Train: 2.667948613490004 | Val: 0.33536763868211095
9-th component log probs | Train: 2.7117799741591333 | Val: 0.5843004869715669
KEYWORD NR_SAMPLES:6000 DIM:100 AVG_DIFF:3.3259
Fitting PCA...
0-th component log probs | Train: 3.1014076319318122 | Val: 0.09057043675987658
1-th component log probs | Train: 2.969075039965708 | Val: 1.8211952974071266
2-th component log probs | Train: 2.9870636607782566 | Val: 1.4595589764086585
3-th component log probs | Train: 2.9461339554039787 | Val: 0.3427317022396474
4-th component log probs | Train: 2.8645812256846193 | Val: 1.4956948147805154
5-th component log probs | Train: 3.1777333181423915 | Val: 0.020885130150457943
6-th component log probs | Train: 3.1042135961860455 | Val: -0.4834790761782613
7-th component log probs | Train: 3.025872009721385 | Val: 0.8927575414292568
8-th component log probs | Train: 3.0030322049210616 | Val: 0.02862257038983343
9-th component log probs | Train: 3.0412552399207993 | Val: 0.40520051342604124
KEYWORD NR_SAMPLES:6000 DIM:150 AVG_DIFF:5.8477
Fitting PCA...
0-th component log probs | Train: 3.346713599215994 | Val: -0.17475293841051107
1-th component log probs | Train: 3.201417062599514 | Val: 1.9265683866637304
2-th component log probs | Train: 3.2154552254621445 | Val: 1.6183291016721235
3-th component log probs | Train: 3.1861281265832755 | Val: 0.2999153838606489
4-th component log probs | Train: 3.1061805686747945 | Val: 1.5693458721233364
5-th component log probs | Train: 3.4405617571646916 | Val: -0.46489627219267393
6-th component log probs | Train: 3.373463694018189 | Val: -1.2008868358174325
7-th component log probs | Train: 3.2734442311137726 | Val: 0.7546460219837585
8-th component log probs | Train: 3.2636447571152765 | Val: -0.3701398484311586
9-th component log probs | Train: 3.2984274711993664 | Val: 0.13679114778028806
KEYWORD NR_SAMPLES:6000 DIM:200 AVG_DIFF:8.8896
Fitting PCA...
0-th component log probs | Train: 3.5491088423822448 | Val: -0.7141641779005699
1-th component log probs | Train: 3.388291846283578 | Val: 1.991108300428104
2-th component log probs | Train: 3.3955493159189207 | Val: 1.7056333930831433
3-th component log probs | Train: 3.3773677873029078 | Val: 0.058713415782727006
4-th component log probs | Train: 3.299442678032214 | Val: 1.5070558063193713
5-th component log probs | Train: 3.658218150290609 | Val: -1.172332683390699
6-th component log probs | Train: 3.5934374006583494 | Val: -2.416858288394089
7-th component log probs | Train: 3.482474608275535 | Val: 0.46782782349926955
8-th component log probs | Train: 3.475264222909166 | Val: -0.9388010627027752
9-th component log probs | Train: 3.508287814490192 | Val: -0.3470280994215992
KEYWORD NR_SAMPLES:6000 DIM:250 AVG_DIFF:13.9962
Fitting PCA...
0-th component log probs | Train: 3.7199487550005634 | Val: -1.2849393259148587
1-th component log probs | Train: 3.543869458656713 | Val: 1.964173576764055
2-th component log probs | Train: 3.5442010436233042 | Val: 1.718602476452255
3-th component log probs | Train: 3.5381022501043615 | Val: -0.19841438243208168
4-th component log probs | Train: 3.461823526580113 | Val: 1.344510675087172
5-th component log probs | Train: 3.8457991893097034 | Val: -2.184991071490642
6-th component log probs | Train: 3.786412815311803 | Val: -3.660431340751531
7-th component log probs | Train: 3.657399909880682 | Val: -0.03144758715143114
8-th component log probs | Train: 3.664654420204312 | Val: -1.8207402857616903
9-th component log probs | Train: 3.6880521205522103 | Val: -0.9165517269172346
KEYWORD NR_SAMPLES:6000 DIM:300 AVG_DIFF:21.1117
Fitting PCA...
0-th component log probs | Train: 3.872402686271203 | Val: -1.853976422845438
1-th component log probs | Train: 3.6796153634945066 | Val: 1.9042040579418447
2-th component log probs | Train: 3.6723496280522916 | Val: 1.646191124978622
3-th component log probs | Train: 3.6798348084278425 | Val: -0.587039496633042
4-th component log probs | Train: 3.606890394559005 | Val: 1.0813972634451503
5-th component log probs | Train: 4.013491676260392 | Val: -3.015985024016089
6-th component log probs | Train: 3.9643145022850836 | Val: -4.990614156433026
7-th component log probs | Train: 3.8148667780508383 | Val: -0.6117706958557257
8-th component log probs | Train: 3.8331146079522718 | Val: -2.9638805311075633
9-th component log probs | Train: 3.849507749076744 | Val: -1.619554428794019
KEYWORD NR_SAMPLES:6000 DIM:350 AVG_DIFF:30.0953
Fitting PCA...
0-th component log probs | Train: 4.010407150403704 | Val: -2.4905846835535823
1-th component log probs | Train: 3.799810563710165 | Val: 1.831723293112279
2-th component log probs | Train: 3.786458314123169 | Val: 1.5792455757179134
3-th component log probs | Train: 3.806168896523959 | Val: -1.0460912927461514
4-th component log probs | Train: 3.7392541199779252 | Val: 0.7569232145441915
5-th component log probs | Train: 4.163166184712033 | Val: -3.7365280620472894
6-th component log probs | Train: 4.122224010814113 | Val: -6.030691562820925
7-th component log probs | Train: 3.955873546378827 | Val: -1.0816760475199072
8-th component log probs | Train: 3.9862413786997157 | Val: -4.0491608788585625
9-th component log probs | Train: 3.992542426629475 | Val: -2.3694021096022633
KEYWORD NR_SAMPLES:6000 DIM:400 AVG_DIFF:39.5989
Fitting PCA...
0-th component log probs | Train: 4.1372928845213925 | Val: -3.0613400428622257
1-th component log probs | Train: 3.9111502727670993 | Val: 1.7235338433140044
2-th component log probs | Train: 3.8902052889961993 | Val: 1.4351079835239096
3-th component log probs | Train: 3.9222317633323383 | Val: -1.5407265385418092
4-th component log probs | Train: 3.861473478105029 | Val: 0.4306076938540452
5-th component log probs | Train: 4.2979326296965965 | Val: -4.235510289289231
6-th component log probs | Train: 4.263767750897276 | Val: -6.955655664547019
7-th component log probs | Train: 4.08632344199615 | Val: -1.590662556435367
8-th component log probs | Train: 4.125670258326207 | Val: -4.879947254568286
9-th component log probs | Train: 4.124896370867294 | Val: -3.004805039600519
KEYWORD NR_SAMPLES:6000 DIM:450 AVG_DIFF:48.8785
Fitting PCA...
0-th component log probs | Train: 4.256420124574146 | Val: -3.338266250295119
1-th component log probs | Train: 4.017511942729274 | Val: 1.6180416447700852
2-th component log probs | Train: 3.991621747901732 | Val: 1.3583339771452605
3-th component log probs | Train: 4.033560069250999 | Val: -1.8446766046304957
4-th component log probs | Train: 3.9818640423993115 | Val: 0.10626027530155557
5-th component log probs | Train: 4.420106598967239 | Val: -4.52379521208181
6-th component log probs | Train: 4.391938601486555 | Val: -7.4553256542149295
7-th component log probs | Train: 4.207764165406272 | Val: -1.9031102853105428
8-th component log probs | Train: 4.25411840047329 | Val: -5.554675474793069
9-th component log probs | Train: 4.246543799673042 | Val: -3.3849980466197556
KEYWORD NR_SAMPLES:6000 DIM:500 AVG_DIFF:55.7014
0-th component log probs | Train: 4.284021303809843 | Val: -3.3855071547432023
1-th component log probs | Train: 4.043643203689848 | Val: 1.5997753711920812
2-th component log probs | Train: 4.015654498041456 | Val: 1.3494863613439034
3-th component log probs | Train: 4.0602643054312555 | Val: -1.9025397465646483
4-th component log probs | Train: 4.011015599158496 | Val: 0.01801919108841559
5-th component log probs | Train: 4.447558325143775 | Val: -4.54224467139235
6-th component log probs | Train: 4.421346300929646 | Val: -7.495093939020531
7-th component log probs | Train: 4.235741417577265 | Val: -1.9995804753959634
8-th component log probs | Train: 4.283275251302871 | Val: -5.669955273891059
9-th component log probs | Train: 4.275213375882979 | Val: -3.467415406536623
KEYWORD NR_SAMPLES:6000 DIM:512 AVG_DIFF:56.9609
best average differences at 50 dimensions: 0.7213940709696381
2022-01-07 22:48.10 [info     ] Training complete              train_loss=0.3948192894458771
2022-01-07 22:48.10 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:48.14 [info     ] Testing complete               test_loss=0.580350935459137
{'dataset_size': 6000,
 'end_test_accuracy': 0.8310938477516174,
 'end_test_loss': 0.580350935459137,
 'end_train_accuracy': 0.9683067798614502,
 'end_train_loss': 0.3948192894458771,
 'end_val_accuracy': 0.8507940173149109,
 'end_val_loss': 0.6813192367553711}
2022-01-07 22:48.14 [info     ] Start Predict                  dataset=52606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:48.40 [info     ] Starting training              dataset=8000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
8000
Fitting PCA...
0-th component log probs | Train: 2.2349476600413305 | Val: 0.8281100173435489
1-th component log probs | Train: 2.101708280401905 | Val: 1.4626030515033088
2-th component log probs | Train: 2.002501916629655 | Val: 1.187022522195967
3-th component log probs | Train: 2.02491474598271 | Val: 1.0569510433732676
4-th component log probs | Train: 2.121713609598746 | Val: 1.3017678293429344
5-th component log probs | Train: 2.218757495781523 | Val: 0.8364387027621246
6-th component log probs | Train: 2.1584965107785163 | Val: 0.6937067849155796
7-th component log probs | Train: 2.1077278588039157 | Val: 1.182046526565145
8-th component log probs | Train: 2.0912024915818392 | Val: 0.8222016823193231
9-th component log probs | Train: 2.2043174869353503 | Val: 0.5511313871065252
KEYWORD NR_SAMPLES:8000 DIM:50 AVG_DIFF:0.3997
Fitting PCA...
0-th component log probs | Train: 2.767903874735956 | Val: 0.5791461025787584
1-th component log probs | Train: 2.6455565824924228 | Val: 1.7536667782472977
2-th component log probs | Train: 2.533791390485319 | Val: 1.4916856604607323
3-th component log probs | Train: 2.5450249092670014 | Val: 1.101133288912415
4-th component log probs | Train: 2.6740849688846833 | Val: 1.3150327501426675
5-th component log probs | Train: 2.7693916692691145 | Val: 0.22166501615674766
6-th component log probs | Train: 2.7051120542181666 | Val: 0.31902328874109276
7-th component log probs | Train: 2.646311032582847 | Val: 1.2549605989096553
8-th component log probs | Train: 2.6252997563607554 | Val: 0.3435738699449834
9-th component log probs | Train: 2.7482985259550814 | Val: 0.27474733616999514
KEYWORD NR_SAMPLES:8000 DIM:100 AVG_DIFF:2.7394
Fitting PCA...
0-th component log probs | Train: 3.068978763094625 | Val: 0.5301469528756416
1-th component log probs | Train: 2.9376925650890957 | Val: 1.995147295364965
2-th component log probs | Train: 2.8257996130713026 | Val: 1.7553831646176856
3-th component log probs | Train: 2.8369177537370964 | Val: 1.2743145172594346
4-th component log probs | Train: 2.9828386599446257 | Val: 1.4127850102143173
5-th component log probs | Train: 3.084709095742107 | Val: -0.13352834934205038
6-th component log probs | Train: 3.0227871246468556 | Val: -0.009218143799336704
7-th component log probs | Train: 2.9524903624162917 | Val: 1.3190028701878578
8-th component log probs | Train: 2.937571553409682 | Val: 0.19046087370491602
9-th component log probs | Train: 3.056247997986245 | Val: 0.2016607945947082
KEYWORD NR_SAMPLES:8000 DIM:150 AVG_DIFF:4.2764
Fitting PCA...
0-th component log probs | Train: 3.3035322090028836 | Val: 0.5012707236825616
1-th component log probs | Train: 3.1581286694007153 | Val: 2.1770433640005296
2-th component log probs | Train: 3.0444117182763266 | Val: 1.9535214865586332
3-th component log probs | Train: 3.0587747087463053 | Val: 1.4349283301242053
4-th component log probs | Train: 3.217133502608076 | Val: 1.5127193292654626
5-th component log probs | Train: 3.3247063744466203 | Val: -0.29133397147299106
6-th component log probs | Train: 3.2672537121843197 | Val: -0.31785593828926584
7-th component log probs | Train: 3.184319311183547 | Val: 1.2945124961646854
8-th component log probs | Train: 3.1787573672137603 | Val: 0.08994859887544607
9-th component log probs | Train: 3.2906331746663335 | Val: 0.005502679479678954
KEYWORD NR_SAMPLES:8000 DIM:200 AVG_DIFF:5.7020
Fitting PCA...
0-th component log probs | Train: 3.4914851769932755 | Val: 0.34642926705922295
1-th component log probs | Train: 3.334209653364797 | Val: 2.288892580125899
2-th component log probs | Train: 3.216046285327447 | Val: 2.1019863755312973
3-th component log probs | Train: 3.238455275736631 | Val: 1.4949369847093226
4-th component log probs | Train: 3.401482491741755 | Val: 1.5229573371220888
5-th component log probs | Train: 3.520288350693241 | Val: -0.5529321310127626
6-th component log probs | Train: 3.474804731181532 | Val: -0.8833439167350189
7-th component log probs | Train: 3.3714641817637907 | Val: 1.218162865407327
8-th component log probs | Train: 3.3745370254745515 | Val: -0.13806282106389403
9-th component log probs | Train: 3.4810806517009825 | Val: -0.17492685553143714
KEYWORD NR_SAMPLES:8000 DIM:250 AVG_DIFF:7.7496
Fitting PCA...
0-th component log probs | Train: 3.655396406875772 | Val: 0.06926622734721882
1-th component log probs | Train: 3.4790158863796417 | Val: 2.3575641999458674
2-th component log probs | Train: 3.3597860020735486 | Val: 2.1717733362917557
3-th component log probs | Train: 3.387528508470091 | Val: 1.5237919719552147
4-th component log probs | Train: 3.557858939451637 | Val: 1.4650855665196691
5-th component log probs | Train: 3.686765056644473 | Val: -0.9732426366688588
6-th component log probs | Train: 3.6540335275510465 | Val: -1.486490156947222
7-th component log probs | Train: 3.529025562760855 | Val: 1.0225380789309333
8-th component log probs | Train: 3.540206082977459 | Val: -0.6269854884688862
9-th component log probs | Train: 3.6412529833265848 | Val: -0.5874884448325953
KEYWORD NR_SAMPLES:8000 DIM:300 AVG_DIFF:10.8118
Fitting PCA...
0-th component log probs | Train: 3.7976458153974377 | Val: -0.34300915217089173
1-th component log probs | Train: 3.606591302635058 | Val: 2.3924311938568845
2-th component log probs | Train: 3.4823874488312296 | Val: 2.210587265944411
3-th component log probs | Train: 3.5140096140945976 | Val: 1.5119210527063645
4-th component log probs | Train: 3.6924941505438276 | Val: 1.346111283701653
5-th component log probs | Train: 3.8353724099779702 | Val: -1.5494971664028165
6-th component log probs | Train: 3.815114139517281 | Val: -2.2832239305231448
7-th component log probs | Train: 3.6665538662706134 | Val: 0.8634368939477676
8-th component log probs | Train: 3.6860698025944534 | Val: -1.0775436676997847
9-th component log probs | Train: 3.7841904867199356 | Val: -1.0923697644386439
KEYWORD NR_SAMPLES:8000 DIM:350 AVG_DIFF:14.8289
Fitting PCA...
0-th component log probs | Train: 3.9264990903382935 | Val: -0.7793508262005546
1-th component log probs | Train: 3.7172455583051844 | Val: 2.4036159766726795
2-th component log probs | Train: 3.5926076166838756 | Val: 2.2196625402193475
3-th component log probs | Train: 3.628732379458175 | Val: 1.4280516824082166
4-th component log probs | Train: 3.8152527343438525 | Val: 1.0982966863053731
5-th component log probs | Train: 3.97144615765938 | Val: -2.1862085245753606
6-th component log probs | Train: 3.959840491584129 | Val: -3.0269589020081837
7-th component log probs | Train: 3.791245742136112 | Val: 0.5930990618065085
8-th component log probs | Train: 3.818713243092436 | Val: -1.6807863789688864
9-th component log probs | Train: 3.911865311003232 | Val: -1.6505378151482204
KEYWORD NR_SAMPLES:8000 DIM:400 AVG_DIFF:19.7707
Fitting PCA...
0-th component log probs | Train: 4.044086509359632 | Val: -1.1276375688020395
1-th component log probs | Train: 3.8178251418035627 | Val: 2.371146797734672
2-th component log probs | Train: 3.691562500791487 | Val: 2.221990194503536
3-th component log probs | Train: 3.7343931255366574 | Val: 1.313340759761951
4-th component log probs | Train: 3.9274248505139506 | Val: 0.8840735349360452
5-th component log probs | Train: 4.095025355206105 | Val: -2.5701133562144807
6-th component log probs | Train: 4.094433383446551 | Val: -3.90033124400568
7-th component log probs | Train: 3.909050719119501 | Val: 0.3702768338239202
8-th component log probs | Train: 3.941381680091954 | Val: -2.3865665344235962
9-th component log probs | Train: 4.028235464485675 | Val: -2.0148584473242646
KEYWORD NR_SAMPLES:8000 DIM:450 AVG_DIFF:24.8387
Fitting PCA...
0-th component log probs | Train: 4.1534080386197445 | Val: -1.3474802881976884
1-th component log probs | Train: 3.914874096844769 | Val: 2.327473804412279
2-th component log probs | Train: 3.788690349441898 | Val: 2.1926837092955505
3-th component log probs | Train: 3.8356294645682394 | Val: 1.2162534918794192
4-th component log probs | Train: 4.034883321141804 | Val: 0.6421952826553183
5-th component log probs | Train: 4.208764285691136 | Val: -2.915787830608993
6-th component log probs | Train: 4.218080170687804 | Val: -4.470140112105741
7-th component log probs | Train: 4.01935496081457 | Val: 0.13977657566049723
8-th component log probs | Train: 4.05861599379087 | Val: -2.8713507551823323
9-th component log probs | Train: 4.136547591573886 | Val: -2.2784857371931735
KEYWORD NR_SAMPLES:8000 DIM:500 AVG_DIFF:29.1536
0-th component log probs | Train: 4.17982101269765 | Val: -1.3900911884289537
1-th component log probs | Train: 3.9393855164897125 | Val: 2.3030800146637884
2-th component log probs | Train: 3.8125507911931438 | Val: 2.1849006558081125
3-th component log probs | Train: 3.8599685765172693 | Val: 1.2089004114575788
4-th component log probs | Train: 4.061285232507365 | Val: 0.6165514118192221
5-th component log probs | Train: 4.234614466733605 | Val: -2.948738941131571
6-th component log probs | Train: 4.247099481268385 | Val: -4.546695886695609
7-th component log probs | Train: 4.045735566601992 | Val: 0.10640318216454077
8-th component log probs | Train: 4.085520010798443 | Val: -2.9403119329723797
9-th component log probs | Train: 4.162540135923506 | Val: -2.3444528278861707
KEYWORD NR_SAMPLES:8000 DIM:512 AVG_DIFF:29.9148
best average differences at 50 dimensions: 0.3996627003923612
2022-01-07 22:55.30 [info     ] Training complete              train_loss=0.2986711263656616
2022-01-07 22:55.30 [info     ] Starting evaluating            dataset=26032
2022-01-07 22:55.33 [info     ] Testing complete               test_loss=0.5138029456138611
{'dataset_size': 8000,
 'end_test_accuracy': 0.8452728986740112,
 'end_test_loss': 0.5138029456138611,
 'end_train_accuracy': 0.9890000224113464,
 'end_train_loss': 0.2986711263656616,
 'end_val_accuracy': 0.8832663893699646,
 'end_val_loss': 0.5335228443145752}
2022-01-07 22:55.34 [info     ] Start Predict                  dataset=50606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 22:56.01 [info     ] Starting training              dataset=10000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
10000
Fitting PCA...
0-th component log probs | Train: 1.9680827275342623 | Val: 1.5034548248774346
1-th component log probs | Train: 2.1122620902901184 | Val: 1.6466037886476335
2-th component log probs | Train: 1.9320654267765922 | Val: 1.509737832073236
3-th component log probs | Train: 1.8859698679484378 | Val: 1.4110656910296433
4-th component log probs | Train: 1.9821587649742578 | Val: 1.5737499109650939
5-th component log probs | Train: 2.0628519852739378 | Val: 1.5022419582641942
6-th component log probs | Train: 1.9549550924253676 | Val: 1.2652840824254996
7-th component log probs | Train: 1.9773450641475638 | Val: 1.582316981676951
8-th component log probs | Train: 1.8835154328191757 | Val: 1.1801288077923244
9-th component log probs | Train: 1.9936508500979955 | Val: 1.316546532603565
KEYWORD NR_SAMPLES:10000 DIM:50 AVG_DIFF:-1.1589
Fitting PCA...
0-th component log probs | Train: 2.482362190070335 | Val: 1.8418685552219842
1-th component log probs | Train: 2.6456321120904756 | Val: 2.0499004954908266
2-th component log probs | Train: 2.4379406968680524 | Val: 1.9183652190166898
3-th component log probs | Train: 2.39657403478271 | Val: 1.7435186534660834
4-th component log probs | Train: 2.5139762127614484 | Val: 1.8518996105540548
5-th component log probs | Train: 2.5827636650182297 | Val: 1.676876927050553
6-th component log probs | Train: 2.4611517443012394 | Val: 1.3920367006988397
7-th component log probs | Train: 2.504149076356502 | Val: 1.9494466918934106
8-th component log probs | Train: 2.38733795574206 | Val: 1.4435817789042087
9-th component log probs | Train: 2.51267461762367 | Val: 1.4849392933097512
KEYWORD NR_SAMPLES:10000 DIM:100 AVG_DIFF:-1.1234
Fitting PCA...
0-th component log probs | Train: 2.773163430310825 | Val: 2.046888757901519
1-th component log probs | Train: 2.9308743641267156 | Val: 2.2964546818931715
2-th component log probs | Train: 2.7245686938804043 | Val: 2.1748003494932187
3-th component log probs | Train: 2.6915333383103137 | Val: 1.9773732743934072
4-th component log probs | Train: 2.808858684903017 | Val: 2.0683669572253476
5-th component log probs | Train: 2.8857596748778307 | Val: 1.8190628838721885
6-th component log probs | Train: 2.7551887777900284 | Val: 1.4878443418019347
7-th component log probs | Train: 2.794780037394958 | Val: 2.1765851135750878
8-th component log probs | Train: 2.6881406418681144 | Val: 1.578190875516746
9-th component log probs | Train: 2.8039856790146285 | Val: 1.6707874676884518
KEYWORD NR_SAMPLES:10000 DIM:150 AVG_DIFF:-1.1363
Fitting PCA...
0-th component log probs | Train: 2.993626223909844 | Val: 2.1898182527313463
1-th component log probs | Train: 3.1427587696365586 | Val: 2.4504874244080344
2-th component log probs | Train: 2.9397751556594 | Val: 2.3644168753025627
3-th component log probs | Train: 2.9107724494576597 | Val: 2.1616801841815185
4-th component log probs | Train: 3.034408037054844 | Val: 2.2075653667805737
5-th component log probs | Train: 3.1120728244749634 | Val: 1.8781656691906645
6-th component log probs | Train: 2.985595853353219 | Val: 1.4675367050382158
7-th component log probs | Train: 3.0177027570982036 | Val: 2.321264857326832
8-th component log probs | Train: 2.9204357715639655 | Val: 1.6779354154053787
9-th component log probs | Train: 3.0205975155752167 | Val: 1.7796886156815308
KEYWORD NR_SAMPLES:10000 DIM:200 AVG_DIFF:-1.0402
Fitting PCA...
0-th component log probs | Train: 3.171877955099761 | Val: 2.2925534947668127
1-th component log probs | Train: 3.317180898911105 | Val: 2.5682087999838887
2-th component log probs | Train: 3.1159392220477007 | Val: 2.5215730181064493
3-th component log probs | Train: 3.089725875595282 | Val: 2.3013884564193248
4-th component log probs | Train: 3.2161446569317698 | Val: 2.296828857417185
5-th component log probs | Train: 3.305195745153224 | Val: 1.885952164081661
6-th component log probs | Train: 3.179691007280102 | Val: 1.3937449472484131
7-th component log probs | Train: 3.2011121359375116 | Val: 2.41786464908062
8-th component log probs | Train: 3.1120916930302798 | Val: 1.6937052968060484
9-th component log probs | Train: 3.2055548637499567 | Val: 1.8495376315107657
KEYWORD NR_SAMPLES:10000 DIM:250 AVG_DIFF:-0.8399
Fitting PCA...
0-th component log probs | Train: 3.3212403972194884 | Val: 2.356141810641863
1-th component log probs | Train: 3.4636038222336194 | Val: 2.6609744785162706
2-th component log probs | Train: 3.258669104979012 | Val: 2.6215030880793644
3-th component log probs | Train: 3.2382197282086005 | Val: 2.3856569629334277
4-th component log probs | Train: 3.36946199636518 | Val: 2.328886515200618
5-th component log probs | Train: 3.4647490680764284 | Val: 1.8281167809484224
6-th component log probs | Train: 3.346221498442056 | Val: 1.2411092986469057
7-th component log probs | Train: 3.3551996455139985 | Val: 2.461031572667027
8-th component log probs | Train: 3.2744703671822304 | Val: 1.6635924069256975
9-th component log probs | Train: 3.3620681478507866 | Val: 1.8452922257988644
KEYWORD NR_SAMPLES:10000 DIM:300 AVG_DIFF:-0.4796
Fitting PCA...
0-th component log probs | Train: 3.4488290093836547 | Val: 2.3674132528988903
1-th component log probs | Train: 3.588842163360696 | Val: 2.712065296857465
2-th component log probs | Train: 3.380352315509379 | Val: 2.691559136792364
3-th component log probs | Train: 3.3637975243744074 | Val: 2.4383821221751822
4-th component log probs | Train: 3.501202499972854 | Val: 2.319959963574507
5-th component log probs | Train: 3.6034335755334266 | Val: 1.7129221533818246
6-th component log probs | Train: 3.4916396128447396 | Val: 0.9700105951684334
7-th component log probs | Train: 3.4867569059066406 | Val: 2.4651262622267605
8-th component log probs | Train: 3.415014999354619 | Val: 1.5743310561729007
9-th component log probs | Train: 3.4977263085321577 | Val: 1.7894528707189716
KEYWORD NR_SAMPLES:10000 DIM:350 AVG_DIFF:0.0906
Fitting PCA...
0-th component log probs | Train: 3.5642357309902604 | Val: 2.350354126894062
1-th component log probs | Train: 3.6988992059769323 | Val: 2.7390404076323103
2-th component log probs | Train: 3.489137182799116 | Val: 2.745589989551473
3-th component log probs | Train: 3.4752116440930036 | Val: 2.4561187933762434
4-th component log probs | Train: 3.620751323321878 | Val: 2.260538149486303
5-th component log probs | Train: 3.7282412223486374 | Val: 1.5617136876256146
6-th component log probs | Train: 3.625391976925571 | Val: 0.6323545303629337
7-th component log probs | Train: 3.6032631127888717 | Val: 2.4522250719855596
8-th component log probs | Train: 3.541685858849117 | Val: 1.3835270826866117
9-th component log probs | Train: 3.6177867973109894 | Val: 1.7043285205880938
KEYWORD NR_SAMPLES:10000 DIM:400 AVG_DIFF:0.8847
Fitting PCA...
0-th component log probs | Train: 3.6682799163209108 | Val: 2.314951791177766
1-th component log probs | Train: 3.7987048118675038 | Val: 2.761773555859153
2-th component log probs | Train: 3.587917102434247 | Val: 2.7738591592157866
3-th component log probs | Train: 3.5762730267680887 | Val: 2.446345638596901
4-th component log probs | Train: 3.729187447225168 | Val: 2.198520860657888
5-th component log probs | Train: 3.8446109898730954 | Val: 1.377579738991864
6-th component log probs | Train: 3.7504022120635083 | Val: 0.21127115910333782
7-th component log probs | Train: 3.7111803729877018 | Val: 2.404125128072288
8-th component log probs | Train: 3.6581254979804614 | Val: 1.1475579656083006
9-th component log probs | Train: 3.7274632702814197 | Val: 1.5664791248086192
KEYWORD NR_SAMPLES:10000 DIM:450 AVG_DIFF:1.9280
Fitting PCA...
0-th component log probs | Train: 3.7689235760920856 | Val: 2.2714263357737328
1-th component log probs | Train: 3.8961186800057663 | Val: 2.7728541093690295
2-th component log probs | Train: 3.68590594850163 | Val: 2.784034346927955
3-th component log probs | Train: 3.6721576998732552 | Val: 2.433215646677055
4-th component log probs | Train: 3.8317462604865224 | Val: 2.1531361962530293
5-th component log probs | Train: 3.953582108965919 | Val: 1.2119110500884906
6-th component log probs | Train: 3.872701815190981 | Val: -0.15267986734459219
7-th component log probs | Train: 3.8146349258879764 | Val: 2.3426237455734937
8-th component log probs | Train: 3.770556998972804 | Val: 0.9033980017737153
9-th component log probs | Train: 3.8336124353444414 | Val: 1.40338839718251
KEYWORD NR_SAMPLES:10000 DIM:500 AVG_DIFF:3.0561
0-th component log probs | Train: 3.7930921129771082 | Val: 2.2636236964325387
1-th component log probs | Train: 3.919294054170417 | Val: 2.7826036437005643
2-th component log probs | Train: 3.7089266336147793 | Val: 2.790079502938169
3-th component log probs | Train: 3.6958461557672955 | Val: 2.429940200993955
4-th component log probs | Train: 3.8554754200112176 | Val: 2.1493257730364057
5-th component log probs | Train: 3.9802747288776574 | Val: 1.1892839272587779
6-th component log probs | Train: 3.9019799938827697 | Val: -0.23249059301442002
7-th component log probs | Train: 3.8382623231491646 | Val: 2.3337602618197644
8-th component log probs | Train: 3.7974185046356244 | Val: 0.8551656992745907
9-th component log probs | Train: 3.8588963387663378 | Val: 1.386952925097818
KEYWORD NR_SAMPLES:10000 DIM:512 AVG_DIFF:3.2955
best average differences at 50 dimensions: -1.1588521410609034
2022-01-07 23:03.39 [info     ] Training complete              train_loss=0.4139888286590576
2022-01-07 23:03.39 [info     ] Starting evaluating            dataset=26032
2022-01-07 23:03.43 [info     ] Testing complete               test_loss=0.5125217437744141
{'dataset_size': 10000,
 'end_test_accuracy': 0.8496110439300537,
 'end_test_loss': 0.5125217437744141,
 'end_train_accuracy': 0.9541202187538147,
 'end_train_loss': 0.4139888286590576,
 'end_val_accuracy': 0.878024160861969,
 'end_val_loss': 0.5618371367454529}
2022-01-07 23:03.43 [info     ] Start Predict                  dataset=48606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 23:04.17 [info     ] Starting training              dataset=20000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
20000
Fitting PCA...
0-th component log probs | Train: 2.136057601586424 | Val: 1.630418775918232
1-th component log probs | Train: 1.9886862567246477 | Val: 1.8207135004737427
2-th component log probs | Train: 1.8921279109480897 | Val: 1.4702243594032776
3-th component log probs | Train: 1.833136304098271 | Val: 1.54744875163789
4-th component log probs | Train: 2.0547235576454588 | Val: 1.894193496832662
5-th component log probs | Train: 2.0478442314301772 | Val: 1.7482066566493406
6-th component log probs | Train: 1.9338937973040669 | Val: 1.5507190527964358
7-th component log probs | Train: 1.911941353590361 | Val: 1.7046620258907517
8-th component log probs | Train: 1.9750458285180554 | Val: 1.391588434889946
9-th component log probs | Train: 2.056929342180183 | Val: 1.4952852035285176
KEYWORD NR_SAMPLES:20000 DIM:50 AVG_DIFF:-1.4749
Fitting PCA...
0-th component log probs | Train: 2.6525706324987417 | Val: 2.0518174408094056
1-th component log probs | Train: 2.5073578213560634 | Val: 2.3082084289581326
2-th component log probs | Train: 2.4112759863313786 | Val: 1.9829681559999561
3-th component log probs | Train: 2.346394739071622 | Val: 2.0177420928256535
4-th component log probs | Train: 2.5854268418871107 | Val: 2.3526833101089912
5-th component log probs | Train: 2.5673072618034567 | Val: 2.1925743272569584
6-th component log probs | Train: 2.4116493783067985 | Val: 1.9306882892487334
7-th component log probs | Train: 2.45263758489592 | Val: 2.143017615673879
8-th component log probs | Train: 2.4910377455611266 | Val: 1.6953011956147501
9-th component log probs | Train: 2.5840656712028425 | Val: 1.8064330591841737
KEYWORD NR_SAMPLES:20000 DIM:100 AVG_DIFF:-1.8030
Fitting PCA...
0-th component log probs | Train: 2.9375250203297134 | Val: 2.3079851474992767
1-th component log probs | Train: 2.798311969633763 | Val: 2.5899658093230484
2-th component log probs | Train: 2.6907353225539867 | Val: 2.291042845618736
3-th component log probs | Train: 2.634097871192239 | Val: 2.304634273024207
4-th component log probs | Train: 2.89478163195321 | Val: 2.594079826618178
5-th component log probs | Train: 2.8610148951494456 | Val: 2.4466914720742214
6-th component log probs | Train: 2.689131420622624 | Val: 2.1995583190469405
7-th component log probs | Train: 2.752835339303399 | Val: 2.3982082660259363
8-th component log probs | Train: 2.7852241866391405 | Val: 1.8945118322666377
9-th component log probs | Train: 2.885563099425765 | Val: 2.0372635785978424
KEYWORD NR_SAMPLES:20000 DIM:150 AVG_DIFF:-2.0215
Fitting PCA...
0-th component log probs | Train: 3.153285532280907 | Val: 2.4921827450427307
1-th component log probs | Train: 3.01779995649666 | Val: 2.794778483059158
2-th component log probs | Train: 2.896829804479306 | Val: 2.510489312378547
3-th component log probs | Train: 2.857190926132947 | Val: 2.510964104743262
4-th component log probs | Train: 3.127844953990604 | Val: 2.7718393080519124
5-th component log probs | Train: 3.084248172637878 | Val: 2.6308527195029274
6-th component log probs | Train: 2.9077807405912486 | Val: 2.402357477900444
7-th component log probs | Train: 2.9777375445089036 | Val: 2.579269160383099
8-th component log probs | Train: 3.0132865984802857 | Val: 2.0262161282855504
9-th component log probs | Train: 3.1150729699206177 | Val: 2.1822158821397424
KEYWORD NR_SAMPLES:20000 DIM:200 AVG_DIFF:-2.1554
Fitting PCA...
0-th component log probs | Train: 3.331485576425723 | Val: 2.6324468589917416
1-th component log probs | Train: 3.1984513975302935 | Val: 2.959102312833101
2-th component log probs | Train: 3.067634626946298 | Val: 2.6901717140212154
3-th component log probs | Train: 3.0390406575921585 | Val: 2.679803952643015
4-th component log probs | Train: 3.3182496572092695 | Val: 2.910727771536086
5-th component log probs | Train: 3.266008389621887 | Val: 2.776008432132808
6-th component log probs | Train: 3.0865941549271887 | Val: 2.5531718037994593
7-th component log probs | Train: 3.1625207758809477 | Val: 2.7145654742432774
8-th component log probs | Train: 3.199465771837468 | Val: 2.120019730047519
9-th component log probs | Train: 3.305852949983098 | Val: 2.260479781192619
KEYWORD NR_SAMPLES:20000 DIM:250 AVG_DIFF:-2.2330
Fitting PCA...
0-th component log probs | Train: 3.4806913891662377 | Val: 2.7277316206254176
1-th component log probs | Train: 3.3488119405949464 | Val: 3.0892956644785077
2-th component log probs | Train: 3.210908577904096 | Val: 2.8411900102136745
3-th component log probs | Train: 3.1901034721685884 | Val: 2.8144456254353014
4-th component log probs | Train: 3.475430654446335 | Val: 3.020834367220333
5-th component log probs | Train: 3.418730809404308 | Val: 2.8967881131039124
6-th component log probs | Train: 3.235506212154167 | Val: 2.672012451626083
7-th component log probs | Train: 3.3202176693128718 | Val: 2.815201558201552
8-th component log probs | Train: 3.355674575860669 | Val: 2.1640982195493956
9-th component log probs | Train: 3.4637112508713317 | Val: 2.3163992270953715
KEYWORD NR_SAMPLES:20000 DIM:300 AVG_DIFF:-2.2658
Fitting PCA...
0-th component log probs | Train: 3.6069375721715633 | Val: 2.8048919802803853
1-th component log probs | Train: 3.4764113838399386 | Val: 3.1960981640573305
2-th component log probs | Train: 3.331806139327647 | Val: 2.9633413331224445
3-th component log probs | Train: 3.3176277483464367 | Val: 2.919284656032285
4-th component log probs | Train: 3.6087009181575103 | Val: 3.108911303929197
5-th component log probs | Train: 3.5484485888433914 | Val: 2.9922346665573345
6-th component log probs | Train: 3.363023552075397 | Val: 2.7613692620492314
7-th component log probs | Train: 3.454902189288705 | Val: 2.8885030910049165
8-th component log probs | Train: 3.4902727110254004 | Val: 2.168283624250304
9-th component log probs | Train: 3.5971509042725267 | Val: 2.333097049300735
KEYWORD NR_SAMPLES:20000 DIM:350 AVG_DIFF:-2.2532
Fitting PCA...
0-th component log probs | Train: 3.7183737314083865 | Val: 2.848944460986989
1-th component log probs | Train: 3.587456899015085 | Val: 3.2818705531174137
2-th component log probs | Train: 3.438953022262593 | Val: 3.0653891724366233
3-th component log probs | Train: 3.429491169542958 | Val: 3.006570527245914
4-th component log probs | Train: 3.7237462670978196 | Val: 3.1741115407326506
5-th component log probs | Train: 3.661759428903883 | Val: 3.060131031709771
6-th component log probs | Train: 3.4745598255300716 | Val: 2.8309575591930294
7-th component log probs | Train: 3.5709793417973548 | Val: 2.9257678660134414
8-th component log probs | Train: 3.609983859074697 | Val: 2.160908569744196
9-th component log probs | Train: 3.713187035131412 | Val: 2.33694415742237
KEYWORD NR_SAMPLES:20000 DIM:400 AVG_DIFF:-2.2035
Fitting PCA...
0-th component log probs | Train: 3.8199592851515156 | Val: 2.889941596072505
1-th component log probs | Train: 3.686877168338923 | Val: 3.356336771348789
2-th component log probs | Train: 3.53457994213008 | Val: 3.1520719684508913
3-th component log probs | Train: 3.5299293068385467 | Val: 3.071712323742005
4-th component log probs | Train: 3.8278515770161734 | Val: 3.221235475109697
5-th component log probs | Train: 3.7658272776145965 | Val: 3.1272661551784666
6-th component log probs | Train: 3.575021675572417 | Val: 2.875976811624418
7-th component log probs | Train: 3.6741436261092963 | Val: 2.955721150699923
8-th component log probs | Train: 3.7186013423102335 | Val: 2.1122159654914947
9-th component log probs | Train: 3.820039571063844 | Val: 2.3023751981647163
KEYWORD NR_SAMPLES:20000 DIM:450 AVG_DIFF:-2.1070
Fitting PCA...
0-th component log probs | Train: 3.919410293969191 | Val: 2.932733287417229
1-th component log probs | Train: 3.7868653951281006 | Val: 3.4192365701211282
2-th component log probs | Train: 3.6334931818107625 | Val: 3.2388245688396418
3-th component log probs | Train: 3.6304355731893145 | Val: 3.131310339391114
4-th component log probs | Train: 3.9298287725846897 | Val: 3.2701745685945816
5-th component log probs | Train: 3.867509409498069 | Val: 3.185380475714182
6-th component log probs | Train: 3.679282452095191 | Val: 2.896668862587717
7-th component log probs | Train: 3.775324590915043 | Val: 2.9864085543639853
8-th component log probs | Train: 3.8280563817575066 | Val: 2.086851472028632
9-th component log probs | Train: 3.9236310645321484 | Val: 2.312022084133961
KEYWORD NR_SAMPLES:20000 DIM:500 AVG_DIFF:-2.0182
0-th component log probs | Train: 3.94418122078442 | Val: 2.956892456563816
1-th component log probs | Train: 3.81212497687773 | Val: 3.4404734898035816
2-th component log probs | Train: 3.6607152482923997 | Val: 3.2662923920639155
3-th component log probs | Train: 3.6574268891750323 | Val: 3.1466216046623483
4-th component log probs | Train: 3.955999993675374 | Val: 3.292125411899883
5-th component log probs | Train: 3.8954460965138624 | Val: 3.209702781334848
6-th component log probs | Train: 3.7063495671654483 | Val: 2.9187098792708577
7-th component log probs | Train: 3.8016150893681564 | Val: 3.00340736970775
8-th component log probs | Train: 3.8562108647896873 | Val: 2.1048217621914023
9-th component log probs | Train: 3.9487999218066645 | Val: 2.335475336474603
KEYWORD NR_SAMPLES:20000 DIM:512 AVG_DIFF:-2.0307
best average differences at 300 dimensions: -2.26580615637938
2022-01-07 23:17.29 [info     ] Training complete              train_loss=0.3367466330528259
2022-01-07 23:17.29 [info     ] Starting evaluating            dataset=26032
2022-01-07 23:17.33 [info     ] Testing complete               test_loss=0.3434441089630127
{'dataset_size': 20000,
 'end_test_accuracy': 0.8956668972969055,
 'end_test_loss': 0.3434441089630127,
 'end_train_accuracy': 0.9659045338630676,
 'end_train_loss': 0.3367466330528259,
 'end_val_accuracy': 0.9004607200622559,
 'end_val_loss': 0.45152977108955383}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 23:17.33 [info     ] Start Predict                  dataset=38606
2022-01-07 23:18.14 [info     ] Starting training              dataset=30000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
30000
Fitting PCA...
0-th component log probs | Train: 2.1098246510057193 | Val: 1.404568566247387
1-th component log probs | Train: 1.9432572109568331 | Val: 1.7351810037892688
2-th component log probs | Train: 1.9905893219503161 | Val: 1.5454995349633267
3-th component log probs | Train: 1.9561064978590381 | Val: 1.5283453951882446
4-th component log probs | Train: 2.0091449706642366 | Val: 1.5586255513053777
5-th component log probs | Train: 2.0132700345932895 | Val: 1.605539023050779
6-th component log probs | Train: 2.049604173811702 | Val: 1.4432374850639915
7-th component log probs | Train: 1.9625984014169338 | Val: 1.6000936390324152
8-th component log probs | Train: 2.0430887176812518 | Val: 1.332524236798333
9-th component log probs | Train: 1.9531386433125446 | Val: 1.4153088953401411
KEYWORD NR_SAMPLES:30000 DIM:50 AVG_DIFF:-1.2585
Fitting PCA...
0-th component log probs | Train: 2.692213807487299 | Val: 1.8719682602751486
1-th component log probs | Train: 2.527041184613654 | Val: 2.2896367035917096
2-th component log probs | Train: 2.5669276529655267 | Val: 2.068305431001523
3-th component log probs | Train: 2.52435996742351 | Val: 1.9789541723792201
4-th component log probs | Train: 2.5724257723564445 | Val: 2.08084261812522
5-th component log probs | Train: 2.575288516716423 | Val: 2.0747928110557923
6-th component log probs | Train: 2.6293239856004447 | Val: 1.7831594770567727
7-th component log probs | Train: 2.525404825540746 | Val: 2.082701806578477
8-th component log probs | Train: 2.617779171577787 | Val: 1.7874223707390924
9-th component log probs | Train: 2.5261936190953493 | Val: 1.854043047511348
KEYWORD NR_SAMPLES:30000 DIM:100 AVG_DIFF:-1.6051
Fitting PCA...
0-th component log probs | Train: 2.9655982073981018 | Val: 2.1608991822011103
1-th component log probs | Train: 2.8036896794552675 | Val: 2.576858708145844
2-th component log probs | Train: 2.8460101586841513 | Val: 2.363945533385789
3-th component log probs | Train: 2.8162779500552477 | Val: 2.2595283667624337
4-th component log probs | Train: 2.843268898285111 | Val: 2.3681498715801204
5-th component log probs | Train: 2.850541673717129 | Val: 2.3511823661257325
6-th component log probs | Train: 2.9084866353214673 | Val: 2.0400633300725755
7-th component log probs | Train: 2.8074675235232838 | Val: 2.3472110194187743
8-th component log probs | Train: 2.9081357285370704 | Val: 2.024588657710552
9-th component log probs | Train: 2.8002595813028215 | Val: 2.1310424944987627
KEYWORD NR_SAMPLES:30000 DIM:150 AVG_DIFF:-1.8713
Fitting PCA...
0-th component log probs | Train: 3.169642253953925 | Val: 2.3601908027634124
1-th component log probs | Train: 3.0114832547392107 | Val: 2.791759152909121
2-th component log probs | Train: 3.049130558843361 | Val: 2.572024831085332
3-th component log probs | Train: 3.030361593393931 | Val: 2.440349072435231
4-th component log probs | Train: 3.0465253429169357 | Val: 2.5773240433997184
5-th component log probs | Train: 3.0566339849394586 | Val: 2.545488940003418
6-th component log probs | Train: 3.117445495153262 | Val: 2.18662883049368
7-th component log probs | Train: 3.0140011399319855 | Val: 2.5185363818534787
8-th component log probs | Train: 3.1210514347462546 | Val: 2.212740761315314
9-th component log probs | Train: 3.00589030826236 | Val: 2.32527987019948
KEYWORD NR_SAMPLES:30000 DIM:200 AVG_DIFF:-2.0370
Fitting PCA...
0-th component log probs | Train: 3.337167906189502 | Val: 2.5296774405233555
1-th component log probs | Train: 3.18137516279002 | Val: 2.9613971465718847
2-th component log probs | Train: 3.216336982121791 | Val: 2.7183638927569285
3-th component log probs | Train: 3.2063269300372617 | Val: 2.5839033957014883
4-th component log probs | Train: 3.213560093559 | Val: 2.737785005160975
5-th component log probs | Train: 3.227038375023258 | Val: 2.7007658259233507
6-th component log probs | Train: 3.291355332006343 | Val: 2.3128641874667
7-th component log probs | Train: 3.184108379871257 | Val: 2.638023078662703
8-th component log probs | Train: 3.299331216058158 | Val: 2.3491668775807493
9-th component log probs | Train: 3.1758481363011106 | Val: 2.492514018668357
KEYWORD NR_SAMPLES:30000 DIM:250 AVG_DIFF:-2.1560
Fitting PCA...
0-th component log probs | Train: 3.4833395626579495 | Val: 2.6538024338339232
1-th component log probs | Train: 3.3269339008301557 | Val: 3.101642870820032
2-th component log probs | Train: 3.359453412657605 | Val: 2.858292270372447
3-th component log probs | Train: 3.3573371621074357 | Val: 2.694889815480985
4-th component log probs | Train: 3.3577261070781814 | Val: 2.869661203838957
5-th component log probs | Train: 3.374759075496994 | Val: 2.8114063450157656
6-th component log probs | Train: 3.4419710680663873 | Val: 2.3989052697896196
7-th component log probs | Train: 3.335197253959001 | Val: 2.7390741066631943
8-th component log probs | Train: 3.451257468960951 | Val: 2.4219724045612674
9-th component log probs | Train: 3.3228300569235167 | Val: 2.628292247118962
KEYWORD NR_SAMPLES:30000 DIM:300 AVG_DIFF:-2.2208
Fitting PCA...
0-th component log probs | Train: 3.6100187156296872 | Val: 2.7599044179378467
1-th component log probs | Train: 3.452435772085214 | Val: 3.219225155376189
2-th component log probs | Train: 3.4843139150134115 | Val: 2.9788171148282228
3-th component log probs | Train: 3.489040560952605 | Val: 2.784796957678036
4-th component log probs | Train: 3.4832571907838914 | Val: 2.985494957052798
5-th component log probs | Train: 3.5038939958536344 | Val: 2.9047686552192236
6-th component log probs | Train: 3.5734217719816326 | Val: 2.4452372472492425
7-th component log probs | Train: 3.4665359059453564 | Val: 2.814821385503856
8-th component log probs | Train: 3.5842452654020107 | Val: 2.4906939481046764
9-th component log probs | Train: 3.45097232261213 | Val: 2.7295661324558482
KEYWORD NR_SAMPLES:30000 DIM:350 AVG_DIFF:-2.2564
Fitting PCA...
0-th component log probs | Train: 3.722948910027877 | Val: 2.8468986250333095
1-th component log probs | Train: 3.5642148730663687 | Val: 3.3241769527732576
2-th component log probs | Train: 3.5953689094496157 | Val: 3.0752022377556467
3-th component log probs | Train: 3.60524694397348 | Val: 2.843755406075656
4-th component log probs | Train: 3.594533757764128 | Val: 3.085220598793376
5-th component log probs | Train: 3.618054421531671 | Val: 2.982516135295057
6-th component log probs | Train: 3.690455414625761 | Val: 2.4926015403989688
7-th component log probs | Train: 3.5843495046562497 | Val: 2.8652511305301904
8-th component log probs | Train: 3.7032983099450556 | Val: 2.5233809972373273
9-th component log probs | Train: 3.564958282675721 | Val: 2.821665120360523
KEYWORD NR_SAMPLES:30000 DIM:400 AVG_DIFF:-2.2625
Fitting PCA...
0-th component log probs | Train: 3.8255798648935007 | Val: 2.9336253092529394
1-th component log probs | Train: 3.668205931731959 | Val: 3.4191096070127642
2-th component log probs | Train: 3.6969173153423833 | Val: 3.1621750795005323
3-th component log probs | Train: 3.7096831118662066 | Val: 2.9046742292217598
4-th component log probs | Train: 3.697434243229918 | Val: 3.1794524667577324
5-th component log probs | Train: 3.724227966308062 | Val: 3.045394056278393
6-th component log probs | Train: 3.8007079049074397 | Val: 2.535919156833614
7-th component log probs | Train: 3.6938453375686007 | Val: 2.9092268798449124
8-th component log probs | Train: 3.812228990097774 | Val: 2.5674748420460998
9-th component log probs | Train: 3.669307660894312 | Val: 2.8867123715813316
KEYWORD NR_SAMPLES:30000 DIM:450 AVG_DIFF:-2.2646
Fitting PCA...
0-th component log probs | Train: 3.9284964441047454 | Val: 3.0421345835407667
1-th component log probs | Train: 3.7746963305442534 | Val: 3.5231715599581364
2-th component log probs | Train: 3.7963491194799763 | Val: 3.267293689865974
3-th component log probs | Train: 3.816801750927557 | Val: 2.9943582714466
4-th component log probs | Train: 3.803155112788753 | Val: 3.2841915474414787
5-th component log probs | Train: 3.8367057564358586 | Val: 3.1299646169773543
6-th component log probs | Train: 3.915585196499972 | Val: 2.6233083073377865
7-th component log probs | Train: 3.801783318674317 | Val: 2.990525239977219
8-th component log probs | Train: 3.9179569495401805 | Val: 2.654832605564206
9-th component log probs | Train: 3.775284188754782 | Val: 2.97382342028804
KEYWORD NR_SAMPLES:30000 DIM:500 AVG_DIFF:-2.3344
0-th component log probs | Train: 3.9584335098585783 | Val: 3.0849778064938267
1-th component log probs | Train: 3.8076398642102376 | Val: 3.5577232160618992
2-th component log probs | Train: 3.824897589737084 | Val: 3.3028170503876995
3-th component log probs | Train: 3.8466385536917143 | Val: 3.032219823314325
4-th component log probs | Train: 3.8349426438054075 | Val: 3.322613811212735
5-th component log probs | Train: 3.8694772401638455 | Val: 3.169252531908547
6-th component log probs | Train: 3.945930907814616 | Val: 2.6702709061950167
7-th component log probs | Train: 3.832828670806286 | Val: 3.026406530042242
8-th component log probs | Train: 3.948004317835702 | Val: 2.698929783931738
9-th component log probs | Train: 3.808132970437364 | Val: 3.016311060842138
KEYWORD NR_SAMPLES:30000 DIM:512 AVG_DIFF:-2.3903
best average differences at 512 dimensions: -2.390270365430519
2022-01-07 23:38.20 [info     ] Training complete              train_loss=0.2930993437767029
2022-01-07 23:38.20 [info     ] Starting evaluating            dataset=26032
2022-01-07 23:38.25 [info     ] Testing complete               test_loss=0.3335689902305603
{'dataset_size': 30000,
 'end_test_accuracy': 0.9039338231086731,
 'end_test_loss': 0.3335689902305603,
 'end_train_accuracy': 0.9707822203636169,
 'end_train_loss': 0.2930993437767029,
 'end_val_accuracy': 0.9143857359886169,
 'end_val_loss': 0.3708558976650238}
2022-01-07 23:38.25 [info     ] Start Predict                  dataset=28606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-07 23:39.11 [info     ] Starting training              dataset=40000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
40000
Fitting PCA...
0-th component log probs | Train: 2.1638499433955354 | Val: 0.9748769096484863
1-th component log probs | Train: 2.1226549423315744 | Val: 1.4216199695003495
2-th component log probs | Train: 1.921586184073721 | Val: 0.9065318494318128
3-th component log probs | Train: 2.0581040161239397 | Val: 1.0687740299873691
4-th component log probs | Train: 2.069046428107196 | Val: 0.9619875185113973
5-th component log probs | Train: 2.1655028547362467 | Val: 0.8372455730006317
6-th component log probs | Train: 2.199800860917526 | Val: 0.35851671858062034
7-th component log probs | Train: 2.11698850054405 | Val: 0.6539815481937675
8-th component log probs | Train: 2.121907325613025 | Val: 0.018394826101141484
9-th component log probs | Train: 2.179851560892945 | Val: 0.38444325506563315
KEYWORD NR_SAMPLES:40000 DIM:50 AVG_DIFF:1.2497
Fitting PCA...
0-th component log probs | Train: 2.775183542909106 | Val: 1.3462668859540516
1-th component log probs | Train: 2.7611380079674963 | Val: 1.999052186291911
2-th component log probs | Train: 2.52776116060934 | Val: 1.634224825686745
3-th component log probs | Train: 2.6818022869081313 | Val: 1.2970467590892243
4-th component log probs | Train: 2.6812060744362354 | Val: 1.4488357590113357
5-th component log probs | Train: 2.7697750635894627 | Val: 1.1173629292641798
6-th component log probs | Train: 2.8087194049595507 | Val: 0.34546078580711703
7-th component log probs | Train: 2.733192298143238 | Val: 1.1946123578440226
8-th component log probs | Train: 2.7473572875319543 | Val: -0.010479483092106383
9-th component log probs | Train: 2.7977091987637466 | Val: 0.14661796805028532
KEYWORD NR_SAMPLES:40000 DIM:100 AVG_DIFF:2.2138
Fitting PCA...
0-th component log probs | Train: 3.043414325966092 | Val: 1.6426040156562545
1-th component log probs | Train: 3.0367266957332615 | Val: 2.3305444323630007
2-th component log probs | Train: 2.7990408921318926 | Val: 2.003151582225715
3-th component log probs | Train: 2.9610714049906997 | Val: 1.642178107688252
4-th component log probs | Train: 2.950864598272247 | Val: 1.7774691836431762
5-th component log probs | Train: 3.0366153725968212 | Val: 1.4944424955103426
6-th component log probs | Train: 3.076648434769849 | Val: 0.7100901744220598
7-th component log probs | Train: 2.998283612829061 | Val: 1.5605338308928922
8-th component log probs | Train: 3.0222001285757334 | Val: 0.415835389085708
9-th component log probs | Train: 3.0648132065072495 | Val: 0.44829533436108876
KEYWORD NR_SAMPLES:40000 DIM:150 AVG_DIFF:1.5871
Fitting PCA...
0-th component log probs | Train: 3.237388023846414 | Val: 1.8667885494649956
1-th component log probs | Train: 3.2367648209876343 | Val: 2.5327513365421908
2-th component log probs | Train: 2.9953283376842146 | Val: 2.263622455555051
3-th component log probs | Train: 3.1619020202549235 | Val: 1.8469878284102832
4-th component log probs | Train: 3.146738879570855 | Val: 1.9995387415551773
5-th component log probs | Train: 3.2348396941586715 | Val: 1.7046325618683444
6-th component log probs | Train: 3.2731973065425457 | Val: 0.8884761281805548
7-th component log probs | Train: 3.190013005246345 | Val: 1.8145710808925553
8-th component log probs | Train: 3.2211406470829242 | Val: 0.6000233549794232
9-th component log probs | Train: 3.259308089583793 | Val: 0.5073112232759486
KEYWORD NR_SAMPLES:40000 DIM:200 AVG_DIFF:1.4294
Fitting PCA...
0-th component log probs | Train: 3.3977598313164017 | Val: 2.0320817013819172
1-th component log probs | Train: 3.4013432842008022 | Val: 2.6910454643651205
2-th component log probs | Train: 3.156261377370127 | Val: 2.461316141606939
3-th component log probs | Train: 3.3246177420850964 | Val: 1.9985224082673634
4-th component log probs | Train: 3.307238725259136 | Val: 2.1816139588950354
5-th component log probs | Train: 3.400182868948633 | Val: 1.8633748947326676
6-th component log probs | Train: 3.4350328747676597 | Val: 1.0439174827405493
7-th component log probs | Train: 3.3487535117112848 | Val: 1.9805907000785659
8-th component log probs | Train: 3.3860319745988288 | Val: 0.6871685240158506
9-th component log probs | Train: 3.4206792585762087 | Val: 0.5668403737789613
KEYWORD NR_SAMPLES:40000 DIM:250 AVG_DIFF:1.3751
Fitting PCA...
0-th component log probs | Train: 3.5394503865768168 | Val: 2.142032914345259
1-th component log probs | Train: 3.545664348407709 | Val: 2.8238230869277996
2-th component log probs | Train: 3.2963344221260074 | Val: 2.621263757910677
3-th component log probs | Train: 3.4699692346900193 | Val: 2.0954860683457093
4-th component log probs | Train: 3.448096115631088 | Val: 2.3147856143220555
5-th component log probs | Train: 3.5455643877326195 | Val: 1.965722700092615
6-th component log probs | Train: 3.5812676604341576 | Val: 1.1529023876277111
7-th component log probs | Train: 3.4894108589947073 | Val: 2.11534554917162
8-th component log probs | Train: 3.534151007962705 | Val: 0.6851070087591487
9-th component log probs | Train: 3.564589552877934 | Val: 0.6631623073067253
KEYWORD NR_SAMPLES:40000 DIM:300 AVG_DIFF:1.4340
Fitting PCA...
0-th component log probs | Train: 3.6661376017355694 | Val: 2.2492345037794443
1-th component log probs | Train: 3.67408040253314 | Val: 2.925821049213153
2-th component log probs | Train: 3.420151845767075 | Val: 2.758678963457628
3-th component log probs | Train: 3.5999783064867543 | Val: 2.1608648567747655
4-th component log probs | Train: 3.572509614909401 | Val: 2.402625639850056
5-th component log probs | Train: 3.675332872911491 | Val: 2.0355216706191075
6-th component log probs | Train: 3.709442160815663 | Val: 1.2229696102168945
7-th component log probs | Train: 3.6140947476873087 | Val: 2.2199743838693116
8-th component log probs | Train: 3.6628694687191845 | Val: 0.6772160365350987
9-th component log probs | Train: 3.693035984728143 | Val: 0.6659422057163756
KEYWORD NR_SAMPLES:40000 DIM:350 AVG_DIFF:1.6018
Fitting PCA...
0-th component log probs | Train: 3.780340823618675 | Val: 2.336467984533492
1-th component log probs | Train: 3.790194852914429 | Val: 3.021473337513638
2-th component log probs | Train: 3.532690871421801 | Val: 2.8767129245710374
3-th component log probs | Train: 3.716956913750676 | Val: 2.2376897665362283
4-th component log probs | Train: 3.6825328192301683 | Val: 2.4766418955112908
5-th component log probs | Train: 3.791404515009765 | Val: 2.1090427652337524
6-th component log probs | Train: 3.825919686335708 | Val: 1.2970149161121978
7-th component log probs | Train: 3.727082139976985 | Val: 2.31127837229094
8-th component log probs | Train: 3.779464013303918 | Val: 0.6695235939459574
9-th component log probs | Train: 3.808434551581166 | Val: 0.7266287899090635
KEYWORD NR_SAMPLES:40000 DIM:400 AVG_DIFF:1.7085
Fitting PCA...
0-th component log probs | Train: 3.8874006595256136 | Val: 2.4428247344297467
1-th component log probs | Train: 3.8987714913087967 | Val: 3.1247372433122873
2-th component log probs | Train: 3.6410977674613054 | Val: 2.988551664474478
3-th component log probs | Train: 3.8263353332083048 | Val: 2.32428722462848
4-th component log probs | Train: 3.7863596543046123 | Val: 2.58574477738664
5-th component log probs | Train: 3.8983115614328177 | Val: 2.2035920391524617
6-th component log probs | Train: 3.9352507201241056 | Val: 1.3901391225478712
7-th component log probs | Train: 3.8342088776163443 | Val: 2.4036736473177633
8-th component log probs | Train: 3.885951383270828 | Val: 0.6832565104656427
9-th component log probs | Train: 3.9175311200175065 | Val: 0.8440304330420287
KEYWORD NR_SAMPLES:40000 DIM:450 AVG_DIFF:1.6918
Fitting PCA...
0-th component log probs | Train: 3.997348290349472 | Val: 2.6285255680352306
1-th component log probs | Train: 4.008477934108297 | Val: 3.2699414661387918
2-th component log probs | Train: 3.761095231417729 | Val: 3.136917788917839
3-th component log probs | Train: 3.9388209494306716 | Val: 2.5016594568195885
4-th component log probs | Train: 3.8974435923253865 | Val: 2.760514261117954
5-th component log probs | Train: 4.008671789878383 | Val: 2.407595050924535
6-th component log probs | Train: 4.047452454555291 | Val: 1.6287784224387172
7-th component log probs | Train: 3.946939752564322 | Val: 2.563430332501327
8-th component log probs | Train: 3.994506394211161 | Val: 0.9438637231955064
9-th component log probs | Train: 4.0258310535170025 | Val: 1.1286680390499477
KEYWORD NR_SAMPLES:40000 DIM:500 AVG_DIFF:1.1224
0-th component log probs | Train: 4.035250289054686 | Val: 2.6941064829072228
1-th component log probs | Train: 4.046616201275757 | Val: 3.323032541452774
2-th component log probs | Train: 3.8030976767917752 | Val: 3.1912430044734834
3-th component log probs | Train: 3.9780240803186535 | Val: 2.5700726042765814
4-th component log probs | Train: 3.9369310920112 | Val: 2.823451732861733
5-th component log probs | Train: 4.047444268332703 | Val: 2.4775669384913597
6-th component log probs | Train: 4.084824230315184 | Val: 1.7151080338096831
7-th component log probs | Train: 3.9853031736804154 | Val: 2.6292359806772323
8-th component log probs | Train: 4.032629620961529 | Val: 1.0455598369693664
9-th component log probs | Train: 4.06283529655723 | Val: 1.2266610041635537
KEYWORD NR_SAMPLES:40000 DIM:512 AVG_DIFF:0.9108
best average differences at 512 dimensions: 0.9108190069569793
2022-01-08 00:07.45 [info     ] Training complete              train_loss=0.18319328129291534
2022-01-08 00:07.45 [info     ] Starting evaluating            dataset=26032
2022-01-08 00:07.48 [info     ] Testing complete               test_loss=0.29028671979904175
{'dataset_size': 40000,
 'end_test_accuracy': 0.9177799224853516,
 'end_test_loss': 0.29028671979904175,
 'end_train_accuracy': 0.9963750243186951,
 'end_train_loss': 0.18319328129291534,
 'end_val_accuracy': 0.9283222556114197,
 'end_val_loss': 0.341249018907547}
2022-01-08 00:07.49 [info     ] Start Predict                  dataset=18606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 00:08.27 [info     ] Starting training              dataset=50000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
50000
Fitting PCA...
0-th component log probs | Train: 2.133146876699494 | Val: 0.5706333307303632
1-th component log probs | Train: 1.962780307139626 | Val: 1.1798052412077191
2-th component log probs | Train: 1.9133039678067485 | Val: 0.5604763836054876
3-th component log probs | Train: 2.030230692316607 | Val: 0.447460458749918
4-th component log probs | Train: 2.052379475902896 | Val: 0.9517426294178458
5-th component log probs | Train: 2.0663884125970404 | Val: 1.0288470649148902
6-th component log probs | Train: 2.1135902457849274 | Val: -0.041678208257955346
7-th component log probs | Train: 2.0243940339152586 | Val: 0.557925783216431
8-th component log probs | Train: 2.1605792835266726 | Val: -0.6502718815023136
9-th component log probs | Train: 2.1953616622584162 | Val: 0.20009025082894039
KEYWORD NR_SAMPLES:50000 DIM:50 AVG_DIFF:2.3550
Fitting PCA...
0-th component log probs | Train: 2.77939128774297 | Val: 0.8623060661383782
1-th component log probs | Train: 2.631661194826185 | Val: 1.8748006946935893
2-th component log probs | Train: 2.5714927101458342 | Val: 1.2764883933326672
3-th component log probs | Train: 2.7066730066137867 | Val: 1.0771680599637308
4-th component log probs | Train: 2.695816595922474 | Val: 1.5555297718576502
5-th component log probs | Train: 2.7170491925778113 | Val: 1.5207846112558583
6-th component log probs | Train: 2.7677249715004395 | Val: 0.07125456643298157
7-th component log probs | Train: 2.6882015280530958 | Val: 1.0835843537267
8-th component log probs | Train: 2.830308459335469 | Val: -1.0394417012909367
9-th component log probs | Train: 2.843521006338544 | Val: 0.6379541233084586
KEYWORD NR_SAMPLES:50000 DIM:100 AVG_DIFF:3.2076
Fitting PCA...
0-th component log probs | Train: 3.0565977206328796 | Val: 1.3466825461553582
1-th component log probs | Train: 2.9153280341070307 | Val: 2.2724483095115047
2-th component log probs | Train: 2.8584961722191027 | Val: 1.7763367643240853
3-th component log probs | Train: 2.9954650624708354 | Val: 1.56114955868889
4-th component log probs | Train: 2.9736751082663373 | Val: 1.9643785535077096
5-th component log probs | Train: 3.0044686549948123 | Val: 1.9049923154549908
6-th component log probs | Train: 3.0433115709759173 | Val: 0.45645716736350694
7-th component log probs | Train: 2.9735978948297626 | Val: 1.5449994675946317
8-th component log probs | Train: 3.111323581179936 | Val: -0.6433876104329461
9-th component log probs | Train: 3.119096405547358 | Val: 1.1739606370847915
KEYWORD NR_SAMPLES:50000 DIM:150 AVG_DIFF:2.2049
Fitting PCA...
0-th component log probs | Train: 3.246531806620649 | Val: 1.6790336306279108
1-th component log probs | Train: 3.1071602005157284 | Val: 2.54163822344717
2-th component log probs | Train: 3.0534182365459754 | Val: 2.0684068135709195
3-th component log probs | Train: 3.1885169228763233 | Val: 1.8765443898487204
4-th component log probs | Train: 3.164288740406166 | Val: 2.215365941704962
5-th component log probs | Train: 3.198632251698153 | Val: 2.1692792741426463
6-th component log probs | Train: 3.2329553247051015 | Val: 0.7586811552514601
7-th component log probs | Train: 3.164975666177554 | Val: 1.8204048155903336
8-th component log probs | Train: 3.304627896364551 | Val: -0.4453638126664007
9-th component log probs | Train: 3.310505048724243 | Val: 1.5260676099534776
KEYWORD NR_SAMPLES:50000 DIM:200 AVG_DIFF:1.6395
Fitting PCA...
0-th component log probs | Train: 3.40384202929255 | Val: 1.8762398246340883
1-th component log probs | Train: 3.264095045562879 | Val: 2.740609364526078
2-th component log probs | Train: 3.210908251138881 | Val: 2.2895914489553375
3-th component log probs | Train: 3.3462643604542563 | Val: 2.0959646916185255
4-th component log probs | Train: 3.3226392056835805 | Val: 2.420749651498684
5-th component log probs | Train: 3.3577962148634515 | Val: 2.363070611454653
6-th component log probs | Train: 3.3915714694567654 | Val: 0.9970266884940696
7-th component log probs | Train: 3.323038408088082 | Val: 2.026216965227029
8-th component log probs | Train: 3.4640866648767625 | Val: -0.18223965659025368
9-th component log probs | Train: 3.470188332143666 | Val: 1.692741207981507
KEYWORD NR_SAMPLES:50000 DIM:250 AVG_DIFF:1.2373
Fitting PCA...
0-th component log probs | Train: 3.5413474550010857 | Val: 2.0457021158825293
1-th component log probs | Train: 3.4023592329732364 | Val: 2.910540363972158
2-th component log probs | Train: 3.347881206041274 | Val: 2.463425324973037
3-th component log probs | Train: 3.4850585856059193 | Val: 2.268253699335626
4-th component log probs | Train: 3.4595926791565823 | Val: 2.5767543259370607
5-th component log probs | Train: 3.4966929015131947 | Val: 2.513537552893922
6-th component log probs | Train: 3.52977691455793 | Val: 1.1679021186045364
7-th component log probs | Train: 3.4595724068523515 | Val: 2.20330921604714
8-th component log probs | Train: 3.6056138206952473 | Val: -0.06244358417322604
9-th component log probs | Train: 3.6091161069904727 | Val: 1.8257779689595173
KEYWORD NR_SAMPLES:50000 DIM:300 AVG_DIFF:1.0367
Fitting PCA...
0-th component log probs | Train: 3.6647645413995917 | Val: 2.171482960012526
1-th component log probs | Train: 3.526117369765222 | Val: 3.054318982083005
2-th component log probs | Train: 3.47076397250597 | Val: 2.6159523654776113
3-th component log probs | Train: 3.6093303926920552 | Val: 2.423385957356866
4-th component log probs | Train: 3.5827195526523625 | Val: 2.7101277707277176
5-th component log probs | Train: 3.6221095087251327 | Val: 2.635689127542815
6-th component log probs | Train: 3.6534848220865914 | Val: 1.3198217822781677
7-th component log probs | Train: 3.581524257514805 | Val: 2.3463851330236962
8-th component log probs | Train: 3.730465426495949 | Val: -0.025747945024251796
9-th component log probs | Train: 3.733895546552204 | Val: 1.9103711155204732
KEYWORD NR_SAMPLES:50000 DIM:350 AVG_DIFF:0.9568
Fitting PCA...
0-th component log probs | Train: 3.776465647046373 | Val: 2.2940575398812726
1-th component log probs | Train: 3.6407043312471696 | Val: 3.1807890882766405
2-th component log probs | Train: 3.5826501754396 | Val: 2.7560392038230326
3-th component log probs | Train: 3.7209126095355796 | Val: 2.541751883692556
4-th component log probs | Train: 3.69480066220837 | Val: 2.824197654693669
5-th component log probs | Train: 3.736365462051663 | Val: 2.746043766851539
6-th component log probs | Train: 3.7665833500423287 | Val: 1.4760196274075068
7-th component log probs | Train: 3.690360568808731 | Val: 2.47558035799451
8-th component log probs | Train: 3.843441756423648 | Val: 0.15756367307994187
9-th component log probs | Train: 3.8454239008925213 | Val: 1.9189299286126684
KEYWORD NR_SAMPLES:50000 DIM:400 AVG_DIFF:0.7870
Fitting PCA...
0-th component log probs | Train: 3.880042959160942 | Val: 2.4305854569329357
1-th component log probs | Train: 3.750374747154615 | Val: 3.301162175363009
2-th component log probs | Train: 3.6878365447092873 | Val: 2.8742404676616666
3-th component log probs | Train: 3.827023927738198 | Val: 2.6862376509752495
4-th component log probs | Train: 3.7991353540301906 | Val: 2.9497921738155686
5-th component log probs | Train: 3.841766911323054 | Val: 2.8641980305253827
6-th component log probs | Train: 3.870227772153961 | Val: 1.6459006577619186
7-th component log probs | Train: 3.7924979223273283 | Val: 2.607105880204329
8-th component log probs | Train: 3.9457764559716297 | Val: 0.32136982958518134
9-th component log probs | Train: 3.9477286057987917 | Val: 2.0420769614097485
KEYWORD NR_SAMPLES:50000 DIM:450 AVG_DIFF:0.5341
Fitting PCA...
0-th component log probs | Train: 4.002543672206166 | Val: 2.6472013527035845
1-th component log probs | Train: 3.8780317620813953 | Val: 3.4602448799067482
2-th component log probs | Train: 3.816880207177408 | Val: 3.063147979271261
3-th component log probs | Train: 3.9531553719822807 | Val: 2.894311948367631
4-th component log probs | Train: 3.925051877612976 | Val: 3.1375128995968664
5-th component log probs | Train: 3.9709757376986845 | Val: 3.0551330317469527
6-th component log probs | Train: 3.9935891100305985 | Val: 1.9272944465462134
7-th component log probs | Train: 3.9173484460043606 | Val: 2.809244791278406
8-th component log probs | Train: 4.067087024884878 | Val: 0.7104289216304026
9-th component log probs | Train: 4.070226215980413 | Val: 2.3026894385527332
KEYWORD NR_SAMPLES:50000 DIM:500 AVG_DIFF:-0.0959
0-th component log probs | Train: 4.044978512605006 | Val: 2.7190503341500114
1-th component log probs | Train: 3.922508712688082 | Val: 3.5138889056533036
2-th component log probs | Train: 3.863069163619358 | Val: 3.1258504915856657
3-th component log probs | Train: 3.996646607514692 | Val: 2.961215248952377
4-th component log probs | Train: 3.968911212466405 | Val: 3.1984208969723253
5-th component log probs | Train: 4.014564049523216 | Val: 3.118421587924401
6-th component log probs | Train: 4.035843831213959 | Val: 2.015368900314793
7-th component log probs | Train: 3.9612725414840755 | Val: 2.8771876962395115
8-th component log probs | Train: 4.107924890796184 | Val: 0.8261083118338245
9-th component log probs | Train: 4.111643435802742 | Val: 2.38318365060936
KEYWORD NR_SAMPLES:50000 DIM:512 AVG_DIFF:-0.2786
best average differences at 512 dimensions: -0.2785852051609706
2022-01-08 01:02.09 [info     ] Training complete              train_loss=0.14616045355796814
2022-01-08 01:02.09 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:02.13 [info     ] Testing complete               test_loss=0.2855985164642334
{'dataset_size': 50000,
 'end_test_accuracy': 0.9337376952171326,
 'end_test_loss': 0.2855985164642334,
 'end_train_accuracy': 0.9986213445663452,
 'end_train_loss': 0.14616045355796814,
 'end_val_accuracy': 0.9324277639389038,
 'end_val_loss': 0.39524388313293457}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:02.13 [info     ] Start Predict                  dataset=8606

wandb: Waiting for W&B process to finish, PID 30301... (success).
wandb: - 0.61MB of 0.61MB uploaded (0.00MB deduped)wandb: \ 0.61MB of 0.61MB uploaded (0.00MB deduped)wandb: | 0.61MB of 0.61MB uploaded (0.00MB deduped)wandb: / 0.61MB of 1.01MB uploaded (0.00MB deduped)wandb: - 0.61MB of 1.01MB uploaded (0.00MB deduped)wandb: \ 0.61MB of 1.01MB uploaded (0.00MB deduped)wandb: | 0.76MB of 1.01MB uploaded (0.00MB deduped)wandb: / 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: - 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: \ 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: | 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: / 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: - 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: \ 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:           accuracy_0 
wandb:           accuracy_1 
wandb:          accuracy_10 
wandb:          accuracy_11 
wandb:          accuracy_12 
wandb:          accuracy_13 
wandb:          accuracy_14 
wandb:           accuracy_2 
wandb:           accuracy_3 
wandb:           accuracy_4 
wandb:           accuracy_5 
wandb:           accuracy_6 
wandb:           accuracy_7 
wandb:           accuracy_8 
wandb:           accuracy_9 
wandb:              class_0 
wandb:              class_1 
wandb:              class_2 
wandb:              class_3 
wandb:              class_4 
wandb:              class_5 
wandb:              class_6 
wandb:              class_7 
wandb:              class_8 
wandb:              class_9 
wandb:         dataset_size 
wandb:    end_test_accuracy 
wandb:        end_test_loss 
wandb:   end_train_accuracy 
wandb:       end_train_loss 
wandb:     end_val_accuracy 
wandb:         end_val_loss 
wandb:                epoch 
wandb:               loss_0 
wandb:               loss_1 
wandb:              loss_10 
wandb:              loss_11 
wandb:              loss_12 
wandb:              loss_13 
wandb:              loss_14 
wandb:               loss_2 
wandb:               loss_3 
wandb:               loss_4 
wandb:               loss_5 
wandb:               loss_6 
wandb:               loss_7 
wandb:               loss_8 
wandb:               loss_9 
wandb:                 lr_0 
wandb:                 lr_1 
wandb:                lr_10 
wandb:                lr_11 
wandb:                lr_12 
wandb:                lr_13 
wandb:                lr_14 
wandb:                 lr_2 
wandb:                 lr_3 
wandb:                 lr_4 
wandb:                 lr_5 
wandb:                 lr_6 
wandb:                 lr_7 
wandb:                 lr_8 
wandb:                 lr_9 
wandb:       val_accuracy_0 
wandb:       val_accuracy_1 
wandb:      val_accuracy_10 
wandb:      val_accuracy_11 
wandb:      val_accuracy_12 
wandb:      val_accuracy_13 
wandb:      val_accuracy_14 
wandb:       val_accuracy_2 
wandb:       val_accuracy_3 
wandb:       val_accuracy_4 
wandb:       val_accuracy_5 
wandb:       val_accuracy_6 
wandb:       val_accuracy_7 
wandb:       val_accuracy_8 
wandb:       val_accuracy_9 
wandb:           val_loss_0 
wandb:           val_loss_1 
wandb:          val_loss_10 
wandb:          val_loss_11 
wandb:          val_loss_12 
wandb:          val_loss_13 
wandb:          val_loss_14 
wandb:           val_loss_2 
wandb:           val_loss_3 
wandb:           val_loss_4 
wandb:           val_loss_5 
wandb:           val_loss_6 
wandb:           val_loss_7 
wandb:           val_loss_8 
wandb:           val_loss_9 
wandb: 
wandb: Run summary:
wandb:           accuracy_0 0.98611
wandb:           accuracy_1 0.75391
wandb:          accuracy_10 0.95412
wandb:          accuracy_11 0.9659
wandb:          accuracy_12 0.97078
wandb:          accuracy_13 0.99638
wandb:          accuracy_14 0.99862
wandb:           accuracy_2 0.91741
wandb:           accuracy_3 0.99063
wandb:           accuracy_4 0.9988
wandb:           accuracy_5 0.98184
wandb:           accuracy_6 0.96094
wandb:           accuracy_7 0.97396
wandb:           accuracy_8 0.96831
wandb:           accuracy_9 0.989
wandb:              class_0 0.07246
wandb:              class_1 0.20356
wandb:              class_2 0.16542
wandb:              class_3 0.11116
wandb:              class_4 0.10432
wandb:              class_5 0.06662
wandb:              class_6 0.06776
wandb:              class_7 0.08216
wandb:              class_8 0.059
wandb:              class_9 0.06754
wandb:         dataset_size 50000
wandb:    end_test_accuracy 0.93374
wandb:        end_test_loss 0.2856
wandb:   end_train_accuracy 0.99862
wandb:       end_train_loss 0.14616
wandb:     end_val_accuracy 0.93243
wandb:         end_val_loss 0.39524
wandb:                epoch 51
wandb:               loss_0 0.50521
wandb:               loss_1 1.4201
wandb:              loss_10 0.41399
wandb:              loss_11 0.33675
wandb:              loss_12 0.2931
wandb:              loss_13 0.18319
wandb:              loss_14 0.14616
wandb:               loss_2 0.60421
wandb:               loss_3 0.39565
wandb:               loss_4 0.38412
wandb:               loss_5 0.43832
wandb:               loss_6 0.45905
wandb:               loss_7 0.3863
wandb:               loss_8 0.39482
wandb:               loss_9 0.29867
wandb:                 lr_0 0.001
wandb:                 lr_1 0.001
wandb:                lr_10 0.001
wandb:                lr_11 0.001
wandb:                lr_12 0.0001
wandb:                lr_13 0.0001
wandb:                lr_14 0.0001
wandb:                 lr_2 0.001
wandb:                 lr_3 0.0001
wandb:                 lr_4 0.0001
wandb:                 lr_5 0.0001
wandb:                 lr_6 0.0001
wandb:                 lr_7 0.001
wandb:                 lr_8 0.0001
wandb:                 lr_9 0.0001
wandb:       val_accuracy_0 0.15841
wandb:       val_accuracy_1 0.17138
wandb:      val_accuracy_10 0.87802
wandb:      val_accuracy_11 0.90046
wandb:      val_accuracy_12 0.91439
wandb:      val_accuracy_13 0.92832
wandb:      val_accuracy_14 0.93243
wandb:       val_accuracy_2 0.4392
wandb:       val_accuracy_3 0.56818
wandb:       val_accuracy_4 0.65145
wandb:       val_accuracy_5 0.68181
wandb:       val_accuracy_6 0.75725
wandb:       val_accuracy_7 0.82629
wandb:       val_accuracy_8 0.85079
wandb:       val_accuracy_9 0.88327
wandb:           val_loss_0 4.73746
wandb:           val_loss_1 4.16752
wandb:          val_loss_10 0.56184
wandb:          val_loss_11 0.45153
wandb:          val_loss_12 0.37086
wandb:          val_loss_13 0.34125
wandb:          val_loss_14 0.39524
wandb:           val_loss_2 2.71457
wandb:           val_loss_3 2.02299
wandb:           val_loss_4 1.57944
wandb:           val_loss_5 1.48321
wandb:           val_loss_6 1.09572
wandb:           val_loss_7 0.82464
wandb:           val_loss_8 0.68132
wandb:           val_loss_9 0.53352
wandb: 
wandb: Synced 6 W&B file(s), 30 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced svhn_hu_greedy_run1: https://wandb.ai/fanconic/hidden_uncertainty/runs/grecqhnw
wandb: Find logs at: ./wandb/run-20220107_222044-grecqhnw/logs/debug.log
wandb: 
wandb: wandb version 0.12.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.7
wandb: Syncing run svhn_hu_greedy_run2
wandb:  View project at https://wandb.ai/fanconic/hidden_uncertainty
wandb:  View run at https://wandb.ai/fanconic/hidden_uncertainty/runs/1ckncs6z
wandb: Run data is saved locally in /scratch_net/airfox/fanconic/semproj2/hidden_uncertainty_active_learning/wandb/run-20220108_010218-1ckncs6z
wandb: Run `wandb offline` to turn off syncing.

Cuda is available:  True
Using downloaded and verified file: /tmp/train_32x32.mat
Using downloaded and verified file: /tmp/test_32x32.mat
2022-01-08 01:02.42 [info     ] Starting training              dataset=100 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
100
Fitting PCA...
0-th component log probs | Train: 5.050723007445436 | Val: -3668.707185353608
1-th component log probs | Train: 5.068294651728788 | Val: -4809.714303918147
2-th component log probs | Train: 5.0383532480823465 | Val: -5506.371258589385
3-th component log probs | Train: 5.078368117528686 | Val: -4053.374536753377
4-th component log probs | Train: 5.055949703387041 | Val: -3971.431454002233
5-th component log probs | Train: 5.026680584534273 | Val: -4106.052731166228
6-th component log probs | Train: 5.022438760076854 | Val: -3968.2690762469047
7-th component log probs | Train: 5.060430974296838 | Val: -4013.6224582215277
8-th component log probs | Train: 5.022597010727804 | Val: -3855.621363662751
9-th component log probs | Train: 5.055161401198624 | Val: -5096.929584327258
KEYWORD NR_SAMPLES:100 DIM:50 AVG_DIFF:18915345.8391
0-th component log probs | Train: 30.17888223903077 | Val: -2490.5361226765585
1-th component log probs | Train: 30.183201237692096 | Val: -3097.947100303789
2-th component log probs | Train: 30.172903269951394 | Val: -3354.424094358885
3-th component log probs | Train: 30.187513448314633 | Val: -2609.7528455899565
4-th component log probs | Train: 30.177731118357435 | Val: -2711.149389950102
5-th component log probs | Train: 30.167455750269124 | Val: -2621.0660198275655
6-th component log probs | Train: 30.167689552074307 | Val: -2563.863573057039
7-th component log probs | Train: 30.179598543485337 | Val: -2723.2849803081454
8-th component log probs | Train: 30.167318867321978 | Val: -2518.4973323472695
9-th component log probs | Train: 30.176994425578705 | Val: -3226.1921505338246
KEYWORD NR_SAMPLES:100 DIM:100 AVG_DIFF:8054601.2186
best average differences at 100 dimensions: 8054601.218638326
2022-01-08 01:03.51 [info     ] Training complete              train_loss=0.5826843976974487
2022-01-08 01:03.51 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:03.55 [info     ] Testing complete               test_loss=2.3687632083892822
{'dataset_size': 100,
 'end_test_accuracy': 0.07803542166948318,
 'end_test_loss': 2.3687632083892822,
 'end_train_accuracy': 0.9765625,
 'end_train_loss': 0.5826843976974487,
 'end_val_accuracy': 0.15413019061088562,
 'end_val_loss': 5.417810440063477}
2022-01-08 01:03.55 [info     ] Start Predict                  dataset=58506
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:04.31 [info     ] Starting training              dataset=200 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
200
Fitting PCA...
0-th component log probs | Train: 4.163615860730957 | Val: -1184.0068877906572
1-th component log probs | Train: 4.119475430292039 | Val: -1535.830780255963
2-th component log probs | Train: 3.9706422511977286 | Val: -1612.6256255504088
3-th component log probs | Train: 3.764301645699662 | Val: -1415.220149930624
4-th component log probs | Train: 4.7218491766763115 | Val: -1559.7252047431514
5-th component log probs | Train: 4.020692344227479 | Val: -814.479521051806
6-th component log probs | Train: 4.203368845007266 | Val: -997.4353359930824
7-th component log probs | Train: 4.455739809070984 | Val: -1518.3670994499194
8-th component log probs | Train: 3.963214641276581 | Val: -1093.6718509540128
9-th component log probs | Train: 4.525985592223366 | Val: -2316.889678692783
KEYWORD NR_SAMPLES:200 DIM:50 AVG_DIFF:2145762.4657
Fitting PCA...
0-th component log probs | Train: 5.044307498047505 | Val: -885.8718559864456
1-th component log probs | Train: 5.02289274061099 | Val: -1017.4966458473505
2-th component log probs | Train: 4.935453802785763 | Val: -1100.075571559144
3-th component log probs | Train: 4.829480175272169 | Val: -976.3830327663967
4-th component log probs | Train: 5.341951272649619 | Val: -978.2070407726527
5-th component log probs | Train: 4.968265148904478 | Val: -635.1321193164848
6-th component log probs | Train: 5.062692747907442 | Val: -737.3175368497753
7-th component log probs | Train: 5.2056600583388475 | Val: -949.9496902352461
8-th component log probs | Train: 4.940014513942981 | Val: -792.07999007365
9-th component log probs | Train: 5.236196760929107 | Val: -1406.0328601122167
KEYWORD NR_SAMPLES:200 DIM:100 AVG_DIFF:950005.2234
Fitting PCA...
0-th component log probs | Train: 5.352560094628052 | Val: -661.6767244966428
1-th component log probs | Train: 5.336495558478231 | Val: -746.4093336922377
2-th component log probs | Train: 5.2728449136339846 | Val: -804.7209849519965
3-th component log probs | Train: 5.205635049083728 | Val: -716.6460341007052
4-th component log probs | Train: 5.555176958016223 | Val: -702.719716365765
5-th component log probs | Train: 5.298763388229932 | Val: -485.9002187444737
6-th component log probs | Train: 5.362876291814547 | Val: -548.7784356386763
7-th component log probs | Train: 5.462859933840204 | Val: -688.0209662550631
8-th component log probs | Train: 5.2801303693097035 | Val: -589.3695176218741
9-th component log probs | Train: 5.480444715803799 | Val: -1011.3569420043833
KEYWORD NR_SAMPLES:200 DIM:150 AVG_DIFF:511265.3944
0-th component log probs | Train: 14.852250216312802 | Val: -581.820001776229
1-th component log probs | Train: 14.838682271940137 | Val: -654.9027278703828
2-th component log probs | Train: 14.787942226036 | Val: -695.9475985960705
3-th component log probs | Train: 14.742096782745135 | Val: -624.4910416679093
4-th component log probs | Train: 15.005705572740299 | Val: -611.4863263464074
5-th component log probs | Train: 14.811661942825525 | Val: -448.2774902907124
6-th component log probs | Train: 14.859458010195974 | Val: -496.06298586961424
7-th component log probs | Train: 14.936042576762576 | Val: -598.8552672139056
8-th component log probs | Train: 14.795643859883109 | Val: -532.1765592434759
9-th component log probs | Train: 14.947790492990539 | Val: -846.1387607866573
KEYWORD NR_SAMPLES:200 DIM:200 AVG_DIFF:400979.9490
best average differences at 200 dimensions: 400979.94901697466
2022-01-08 01:05.55 [info     ] Training complete              train_loss=1.470196008682251
2022-01-08 01:05.55 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:05.59 [info     ] Testing complete               test_loss=2.503453254699707
{'dataset_size': 200,
 'end_test_accuracy': 0.14259572327136993,
 'end_test_loss': 2.503453254699707,
 'end_train_accuracy': 0.70703125,
 'end_train_loss': 1.470196008682251,
 'end_val_accuracy': 0.15716592967510223,
 'end_val_loss': 3.7722668647766113}
2022-01-08 01:05.59 [info     ] Start Predict                  dataset=58406
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:06.37 [info     ] Starting training              dataset=400 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
400
Fitting PCA...
0-th component log probs | Train: 3.9487562570368335 | Val: -880.5421394084875
1-th component log probs | Train: 2.7576861560627046 | Val: -52.634793193234714
2-th component log probs | Train: 3.242360161899439 | Val: -387.236286798259
3-th component log probs | Train: 3.042551735801823 | Val: -475.642535049354
4-th component log probs | Train: 3.4941908698352084 | Val: -336.2350111722991
5-th component log probs | Train: 3.162614676616172 | Val: -216.45311525365864
6-th component log probs | Train: 3.492648107392709 | Val: -609.5217580969199
7-th component log probs | Train: 4.1421490539435775 | Val: -942.7385333878011
8-th component log probs | Train: 3.4790246622668417 | Val: -710.2395038221304
9-th component log probs | Train: 3.4840249247176738 | Val: -862.3950223944992
KEYWORD NR_SAMPLES:400 DIM:50 AVG_DIFF:386763.6447
Fitting PCA...
0-th component log probs | Train: 4.883089508344985 | Val: -850.915710614365
1-th component log probs | Train: 4.007210869139813 | Val: -276.397404366247
2-th component log probs | Train: 4.4593782392856225 | Val: -486.0396090100923
3-th component log probs | Train: 4.216889013777635 | Val: -898.4390222960812
4-th component log probs | Train: 4.571178268389431 | Val: -552.9205753501625
5-th component log probs | Train: 4.3503034242825676 | Val: -571.9866187424165
6-th component log probs | Train: 4.631863001272624 | Val: -665.8077226261684
7-th component log probs | Train: 5.007056964722782 | Val: -856.5682023864674
8-th component log probs | Train: 4.621119660774037 | Val: -766.220557080253
9-th component log probs | Train: 4.5957164326741955 | Val: -935.5691948684168
KEYWORD NR_SAMPLES:400 DIM:100 AVG_DIFF:518612.5570
Fitting PCA...
0-th component log probs | Train: 5.227467295869857 | Val: -684.0866394495253
1-th component log probs | Train: 4.5981694786826885 | Val: -276.30473253593266
2-th component log probs | Train: 4.927791495811475 | Val: -427.0768652971929
3-th component log probs | Train: 4.736108581533357 | Val: -780.1958518628771
4-th component log probs | Train: 4.99603138606225 | Val: -507.7917417352638
5-th component log probs | Train: 4.836697365918517 | Val: -512.9237580452981
6-th component log probs | Train: 5.055241409140748 | Val: -528.1499977661528
7-th component log probs | Train: 5.3206408706572 | Val: -674.7962977770088
8-th component log probs | Train: 5.0462603525411 | Val: -628.6567767113344
9-th component log probs | Train: 5.020753293319598 | Val: -763.1330699556223
KEYWORD NR_SAMPLES:400 DIM:150 AVG_DIFF:363212.3602
Fitting PCA...
0-th component log probs | Train: 5.4089985709808985 | Val: -558.9775065199168
1-th component log probs | Train: 4.916702511321708 | Val: -244.53727928968246
2-th component log probs | Train: 5.174253562583778 | Val: -367.78743255789317
3-th component log probs | Train: 5.019077424053219 | Val: -647.6834068217267
4-th component log probs | Train: 5.222809686533591 | Val: -436.3588879683177
5-th component log probs | Train: 5.098012116453305 | Val: -437.7550280253639
6-th component log probs | Train: 5.276956027489122 | Val: -432.26132392727243
7-th component log probs | Train: 5.481941637840427 | Val: -551.3182174366056
8-th component log probs | Train: 5.270074454118396 | Val: -522.8514167751301
9-th component log probs | Train: 5.2468778759878365 | Val: -622.1536611643955
KEYWORD NR_SAMPLES:400 DIM:200 AVG_DIFF:251582.5173
Fitting PCA...
0-th component log probs | Train: 5.520585423248508 | Val: -475.6955201558879
1-th component log probs | Train: 5.118602114303807 | Val: -214.77098300259755
2-th component log probs | Train: 5.327976949103329 | Val: -313.9386878627372
3-th component log probs | Train: 5.198780043875043 | Val: -547.3911940393045
4-th component log probs | Train: 5.365895611123118 | Val: -374.0006227984978
5-th component log probs | Train: 5.262716151338313 | Val: -376.4377105114227
6-th component log probs | Train: 5.41392113148692 | Val: -364.01227965274666
7-th component log probs | Train: 5.58070847380729 | Val: -465.02162676980873
8-th component log probs | Train: 5.408492702921683 | Val: -439.8872879737947
9-th component log probs | Train: 5.386234816386161 | Val: -528.5297135348056
KEYWORD NR_SAMPLES:400 DIM:250 AVG_DIFF:182221.7957
Fitting PCA...
0-th component log probs | Train: 5.596331579455433 | Val: -410.97676767177086
1-th component log probs | Train: 5.257249889302801 | Val: -188.83072654632483
2-th component log probs | Train: 5.434006355286816 | Val: -272.3921714436519
3-th component log probs | Train: 5.323517189942436 | Val: -472.9381449372999
4-th component log probs | Train: 5.464507628448778 | Val: -326.5979414718744
5-th component log probs | Train: 5.377177426774992 | Val: -329.7536194441475
6-th component log probs | Train: 5.507776098624227 | Val: -312.39817244582156
7-th component log probs | Train: 5.6475264863341 | Val: -399.320451898469
8-th component log probs | Train: 5.502413439945575 | Val: -379.6693494549702
9-th component log probs | Train: 5.4827811176445636 | Val: -453.50718724238925
KEYWORD NR_SAMPLES:400 DIM:300 AVG_DIFF:136734.1731
Fitting PCA...
0-th component log probs | Train: 5.65148907449793 | Val: -359.9865635755466
1-th component log probs | Train: 5.359108275480779 | Val: -168.2656628806218
2-th component log probs | Train: 5.511552721580987 | Val: -240.01287330409622
3-th component log probs | Train: 5.415334737075887 | Val: -415.4122134496739
4-th component log probs | Train: 5.537000490080176 | Val: -287.77946368515325
5-th component log probs | Train: 5.461408314208768 | Val: -291.1059404102074
6-th component log probs | Train: 5.575722571849544 | Val: -273.89084358054185
7-th component log probs | Train: 5.695822636739318 | Val: -349.32773354891077
8-th component log probs | Train: 5.5709240515595715 | Val: -332.9120246328306
9-th component log probs | Train: 5.553498291509451 | Val: -396.9071399695875
KEYWORD NR_SAMPLES:400 DIM:350 AVG_DIFF:105900.5716
0-th component log probs | Train: 7.370292174983497 | Val: -329.25827276001576
1-th component log probs | Train: 7.114065911371383 | Val: -159.9060292624228
2-th component log probs | Train: 7.247466207708276 | Val: -223.10515227250866
3-th component log probs | Train: 7.162908796484364 | Val: -379.36893711899035
4-th component log probs | Train: 7.26952713598918 | Val: -265.4824165321638
5-th component log probs | Train: 7.203030797354138 | Val: -269.19230094122224
6-th component log probs | Train: 7.304069814462168 | Val: -252.8934574892316
7-th component log probs | Train: 7.409235760430543 | Val: -319.2731078067355
8-th component log probs | Train: 7.299627240739744 | Val: -307.39014076519044
9-th component log probs | Train: 7.2843358876266375 | Val: -362.49079690592896
KEYWORD NR_SAMPLES:400 DIM:400 AVG_DIFF:90752.7468
best average differences at 400 dimensions: 90752.74681966745
2022-01-08 01:08.36 [info     ] Training complete              train_loss=0.43932056427001953
2022-01-08 01:08.36 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:08.40 [info     ] Testing complete               test_loss=2.5317602157592773
{'dataset_size': 400,
 'end_test_accuracy': 0.35979729890823364,
 'end_test_loss': 2.5317602157592773,
 'end_train_accuracy': 0.9620535969734192,
 'end_train_loss': 0.43932056427001953,
 'end_val_accuracy': 0.4642663896083832,
 'end_val_loss': 2.7831482887268066}
2022-01-08 01:08.40 [info     ] Start Predict                  dataset=58206
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:09.17 [info     ] Starting training              dataset=600 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
600
Fitting PCA...
0-th component log probs | Train: 2.8699250584608276 | Val: -100.43505222053356
1-th component log probs | Train: 2.49243175567535 | Val: -9.293979997275684
2-th component log probs | Train: 2.833015039803154 | Val: -50.8788955492026
3-th component log probs | Train: 2.626903780112169 | Val: -39.553292109520164
4-th component log probs | Train: 3.0760151602197774 | Val: -119.62540056134036
5-th component log probs | Train: 2.9732992585567173 | Val: -66.17144349027053
6-th component log probs | Train: 3.0459379713049115 | Val: -205.43620367919573
7-th component log probs | Train: 3.3284573951014997 | Val: -190.2159950613461
8-th component log probs | Train: 2.966517138604019 | Val: -349.8666330871601
9-th component log probs | Train: 2.962125976007009 | Val: -147.67078622293693
KEYWORD NR_SAMPLES:600 DIM:50 AVG_DIFF:26469.6521
Fitting PCA...
0-th component log probs | Train: 4.104073632949574 | Val: -433.6077582276163
1-th component log probs | Train: 3.3344578773033047 | Val: -69.30078004261476
2-th component log probs | Train: 3.9734055468046448 | Val: -244.15252610680966
3-th component log probs | Train: 3.628505239224763 | Val: -286.2795748460891
4-th component log probs | Train: 4.236594555125535 | Val: -354.73923957997874
5-th component log probs | Train: 4.066083460729286 | Val: -295.68860987226253
6-th component log probs | Train: 4.320565214599752 | Val: -560.3304827570154
7-th component log probs | Train: 4.490094835080037 | Val: -379.13532212591434
8-th component log probs | Train: 4.250249127693288 | Val: -828.8446060566582
9-th component log probs | Train: 4.138858177247895 | Val: -658.6369524382976
KEYWORD NR_SAMPLES:600 DIM:100 AVG_DIFF:216462.6019
Fitting PCA...
0-th component log probs | Train: 4.662025689660468 | Val: -424.73994607374584
1-th component log probs | Train: 4.021323393951872 | Val: -124.44287256947227
2-th component log probs | Train: 4.557438778440996 | Val: -256.00569172236476
3-th component log probs | Train: 4.283754704538068 | Val: -338.6885214190117
4-th component log probs | Train: 4.753560895301947 | Val: -339.34475493079157
5-th component log probs | Train: 4.618713316338373 | Val: -303.7752750923465
6-th component log probs | Train: 4.828152788889758 | Val: -500.5082023269653
7-th component log probs | Train: 4.944716467616902 | Val: -369.16428229677024
8-th component log probs | Train: 4.778806491296561 | Val: -726.2142448977148
9-th component log probs | Train: 4.681074601929398 | Val: -608.3797676719339
KEYWORD NR_SAMPLES:600 DIM:150 AVG_DIFF:190943.0809
Fitting PCA...
0-th component log probs | Train: 4.9636749239596725 | Val: -376.51981589557204
1-th component log probs | Train: 4.446323621417747 | Val: -134.52726567523678
2-th component log probs | Train: 4.8769597397052005 | Val: -237.37330820536877
3-th component log probs | Train: 4.660109580055702 | Val: -316.23823902152975
4-th component log probs | Train: 5.033921444871082 | Val: -299.74802015814134
5-th component log probs | Train: 4.9217955262796345 | Val: -277.2152150349414
6-th component log probs | Train: 5.098528973778369 | Val: -432.80376831730155
7-th component log probs | Train: 5.186384318097798 | Val: -315.1555892558602
8-th component log probs | Train: 5.059650927012592 | Val: -620.1463559038122
9-th component log probs | Train: 4.977262128940293 | Val: -524.1761259710281
KEYWORD NR_SAMPLES:600 DIM:200 AVG_DIFF:146779.4744
Fitting PCA...
0-th component log probs | Train: 5.155186784973316 | Val: -329.59527088759484
1-th component log probs | Train: 4.721996554694567 | Val: -127.53672382529338
2-th component log probs | Train: 5.079583566454852 | Val: -214.30079893713796
3-th component log probs | Train: 4.90100879535547 | Val: -282.6981502516655
4-th component log probs | Train: 5.210214571179401 | Val: -261.58234246183
5-th component log probs | Train: 5.115700743800539 | Val: -247.88408701201882
6-th component log probs | Train: 5.266833140844801 | Val: -370.45354159400415
7-th component log probs | Train: 5.336443061897259 | Val: -272.94345221042374
8-th component log probs | Train: 5.235214072373804 | Val: -527.8185678630464
9-th component log probs | Train: 5.163752512054757 | Val: -450.9300952209175
KEYWORD NR_SAMPLES:600 DIM:250 AVG_DIFF:110943.7603
Fitting PCA...
0-th component log probs | Train: 5.287062418849785 | Val: -290.1283883480229
1-th component log probs | Train: 4.915595049410468 | Val: -119.01016244163603
2-th component log probs | Train: 5.220450873688712 | Val: -193.22820081735543
3-th component log probs | Train: 5.069388337412866 | Val: -253.46314795344193
4-th component log probs | Train: 5.331942947022936 | Val: -230.40192039147811
5-th component log probs | Train: 5.250491626607858 | Val: -221.35750712901682
6-th component log probs | Train: 5.381782697941387 | Val: -323.9333134700365
7-th component log probs | Train: 5.439097109791888 | Val: -240.64776988306082
8-th component log probs | Train: 5.35493714851476 | Val: -459.63960564544095
9-th component log probs | Train: 5.292130885191359 | Val: -393.85758113994495
KEYWORD NR_SAMPLES:600 DIM:300 AVG_DIFF:86304.3725
Fitting PCA...
0-th component log probs | Train: 5.383541027697303 | Val: -257.92974224856056
1-th component log probs | Train: 5.060246811159626 | Val: -109.15630834788311
2-th component log probs | Train: 5.324378692811592 | Val: -174.65625351515777
3-th component log probs | Train: 5.1936046373663824 | Val: -227.7517142623796
4-th component log probs | Train: 5.421166966942556 | Val: -205.26855383441406
5-th component log probs | Train: 5.349547173856723 | Val: -199.74854236477816
6-th component log probs | Train: 5.465852277713524 | Val: -286.4328492543813
7-th component log probs | Train: 5.51426632126145 | Val: -214.71998461403626
8-th component log probs | Train: 5.442742644003779 | Val: -405.32460488380707
9-th component log probs | Train: 5.386325871204394 | Val: -349.07335325717025
KEYWORD NR_SAMPLES:600 DIM:350 AVG_DIFF:68600.0758
Fitting PCA...
0-th component log probs | Train: 5.4573180320105195 | Val: -231.8876836584086
1-th component log probs | Train: 5.171729710529706 | Val: -100.3526927344201
2-th component log probs | Train: 5.4042333421600945 | Val: -158.36564158640977
3-th component log probs | Train: 5.289192642332809 | Val: -205.57986144673023
4-th component log probs | Train: 5.489821410735225 | Val: -184.83052837049775
5-th component log probs | Train: 5.426073119120361 | Val: -180.91590190035106
6-th component log probs | Train: 5.529824007568961 | Val: -256.7588271753656
7-th component log probs | Train: 5.571674675564436 | Val: -193.55899944743481
8-th component log probs | Train: 5.509675788677927 | Val: -361.8373769446105
9-th component log probs | Train: 5.458987412751223 | Val: -312.4740848204519
KEYWORD NR_SAMPLES:600 DIM:400 AVG_DIFF:55635.9770
Fitting PCA...
0-th component log probs | Train: 5.515585862678567 | Val: -210.49554363189714
1-th component log probs | Train: 5.260437720185775 | Val: -92.84683201415072
2-th component log probs | Train: 5.467725587903789 | Val: -144.5409358745248
3-th component log probs | Train: 5.36517328370615 | Val: -187.146318854283
4-th component log probs | Train: 5.544189029425839 | Val: -168.17089117209207
5-th component log probs | Train: 5.486992414477027 | Val: -164.54345518284748
6-th component log probs | Train: 5.580267180814394 | Val: -232.18808581482517
7-th component log probs | Train: 5.6171710593130815 | Val: -175.93449246374783
8-th component log probs | Train: 5.562372233088401 | Val: -326.4730046097454
9-th component log probs | Train: 5.516645260290797 | Val: -282.4763468174732
KEYWORD NR_SAMPLES:600 DIM:450 AVG_DIFF:45960.3467
Fitting PCA...
0-th component log probs | Train: 5.56265750718283 | Val: -192.554059838384
1-th component log probs | Train: 5.332664741546113 | Val: -86.23865129643853
2-th component log probs | Train: 5.519351844362314 | Val: -133.0207393023903
3-th component log probs | Train: 5.4269230474537675 | Val: -171.50348075278217
4-th component log probs | Train: 5.588303175956971 | Val: -154.2512469886729
5-th component log probs | Train: 5.5366031369174955 | Val: -150.96392949313156
6-th component log probs | Train: 5.62092412973322 | Val: -212.03943247795522
7-th component log probs | Train: 5.65408043811141 | Val: -161.2651417772433
8-th component log probs | Train: 5.604813883170034 | Val: -297.6156547686967
9-th component log probs | Train: 5.563440227897564 | Val: -257.48388052778876
KEYWORD NR_SAMPLES:600 DIM:500 AVG_DIFF:38636.5902
0-th component log probs | Train: 5.572630665355788 | Val: -188.6736548600139
1-th component log probs | Train: 5.348004286909224 | Val: -84.78759910496827
2-th component log probs | Train: 5.530330503982103 | Val: -130.528454043727
3-th component log probs | Train: 5.440051875474723 | Val: -168.16385328915106
4-th component log probs | Train: 5.597664213879811 | Val: -151.21806754992258
5-th component log probs | Train: 5.547166688017827 | Val: -148.0021484620233
6-th component log probs | Train: 5.629537481660397 | Val: -207.74105188601638
7-th component log probs | Train: 5.661908112992077 | Val: -158.06594641534153
8-th component log probs | Train: 5.613797417682986 | Val: -291.4275106680423
9-th component log probs | Train: 5.573382839319336 | Val: -252.13070468020135
KEYWORD NR_SAMPLES:600 DIM:512 AVG_DIFF:37143.4414
best average differences at 50 dimensions: 26469.65212485051
2022-01-08 01:13.45 [info     ] Training complete              train_loss=0.28332698345184326
2022-01-08 01:13.45 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:13.49 [info     ] Testing complete               test_loss=1.8139444589614868
{'dataset_size': 600,
 'end_test_accuracy': 0.5927646160125732,
 'end_test_loss': 1.8139444589614868,
 'end_train_accuracy': 0.9958333969116211,
 'end_train_loss': 0.28332698345184326,
 'end_val_accuracy': 0.6119770407676697,
 'end_val_loss': 1.750905990600586}
2022-01-08 01:13.49 [info     ] Start Predict                  dataset=58006
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:14.16 [info     ] Starting training              dataset=800 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
800
Fitting PCA...
0-th component log probs | Train: 2.7430764767783637 | Val: -24.67308912819075
1-th component log probs | Train: 2.491053984816587 | Val: -7.884767741339127
2-th component log probs | Train: 2.7448761150850665 | Val: -20.25205568449665
3-th component log probs | Train: 2.6175501387582614 | Val: -21.569783466739377
4-th component log probs | Train: 3.0079277375131426 | Val: -61.79518223359562
5-th component log probs | Train: 2.8263013558868844 | Val: -20.318847642494898
6-th component log probs | Train: 2.721840622735732 | Val: -29.925375085735514
7-th component log probs | Train: 3.0861374219430027 | Val: -80.04017085525288
8-th component log probs | Train: 2.640460317025935 | Val: -40.952615799080526
9-th component log probs | Train: 2.779539004656134 | Val: -26.561419177688776
KEYWORD NR_SAMPLES:800 DIM:50 AVG_DIFF:1777.9376
Fitting PCA...
0-th component log probs | Train: 3.797736584263323 | Val: -178.0381602681691
1-th component log probs | Train: 3.2984328789704374 | Val: -40.57672839177451
2-th component log probs | Train: 3.662001988596196 | Val: -113.25195162303916
3-th component log probs | Train: 3.451045075924076 | Val: -136.88510577560453
4-th component log probs | Train: 4.066746240454423 | Val: -257.77129570784655
5-th component log probs | Train: 3.771764742532444 | Val: -131.32229405886096
6-th component log probs | Train: 3.659091886160913 | Val: -159.20579724174408
7-th component log probs | Train: 4.22013704920528 | Val: -328.1967264472235
8-th component log probs | Train: 3.6888492814388703 | Val: -350.8877953942353
9-th component log probs | Train: 3.7634268510631728 | Val: -184.64257117369357
KEYWORD NR_SAMPLES:800 DIM:100 AVG_DIFF:45529.0135
Fitting PCA...
0-th component log probs | Train: 4.419244690470735 | Val: -200.90746416933277
1-th component log probs | Train: 3.938393921239087 | Val: -86.10162487211132
2-th component log probs | Train: 4.29306665166284 | Val: -141.70332690799924
3-th component log probs | Train: 4.087422984211095 | Val: -210.16567332496658
4-th component log probs | Train: 4.618204981725913 | Val: -248.96242342486744
5-th component log probs | Train: 4.3654108041424635 | Val: -177.34589195366047
6-th component log probs | Train: 4.281000156482433 | Val: -219.19439588357426
7-th component log probs | Train: 4.739920702206429 | Val: -299.7698035758773
8-th component log probs | Train: 4.345115672070017 | Val: -378.8566743269731
9-th component log probs | Train: 4.371624766890934 | Val: -232.4427515377027
KEYWORD NR_SAMPLES:800 DIM:150 AVG_DIFF:56259.5267
Fitting PCA...
0-th component log probs | Train: 4.768010919508038 | Val: -190.3548773066592
1-th component log probs | Train: 4.369948840470266 | Val: -95.70660160375536
2-th component log probs | Train: 4.660676457985201 | Val: -138.31847060035227
3-th component log probs | Train: 4.486925523637225 | Val: -220.214298826801
4-th component log probs | Train: 4.924006323229786 | Val: -228.52821293994612
5-th component log probs | Train: 4.71459403566029 | Val: -169.63221556247606
6-th component log probs | Train: 4.650344065595525 | Val: -210.12045554759317
7-th component log probs | Train: 5.022125920341667 | Val: -259.62354340618714
8-th component log probs | Train: 4.712272907121488 | Val: -347.6306980495456
9-th component log probs | Train: 4.724115698300203 | Val: -224.0828083627209
KEYWORD NR_SAMPLES:800 DIM:200 AVG_DIFF:49866.4899
Fitting PCA...
0-th component log probs | Train: 4.98973202674843 | Val: -171.24262685406617
1-th component log probs | Train: 4.653238977486846 | Val: -94.81833218924996
2-th component log probs | Train: 4.897133037864246 | Val: -128.4011807386795
3-th component log probs | Train: 4.750933289591127 | Val: -205.13466183005343
4-th component log probs | Train: 5.117464196905641 | Val: -203.72866462279978
5-th component log probs | Train: 4.940906582756692 | Val: -157.48340277953633
6-th component log probs | Train: 4.887538851652108 | Val: -193.0216082053595
7-th component log probs | Train: 5.199962383453236 | Val: -228.02045083407393
8-th component log probs | Train: 4.944484042278479 | Val: -314.2020058631432
9-th component log probs | Train: 4.948505481698685 | Val: -205.8291244631689
KEYWORD NR_SAMPLES:800 DIM:250 AVG_DIFF:41451.4568
Fitting PCA...
0-th component log probs | Train: 5.144147113375749 | Val: -154.66940733166038
1-th component log probs | Train: 4.85342871460655 | Val: -89.88929907448997
2-th component log probs | Train: 5.0615842822495605 | Val: -117.63057632823072
3-th component log probs | Train: 4.9365987987803885 | Val: -187.74517496375944
4-th component log probs | Train: 5.251286926241235 | Val: -181.9837369840058
5-th component log probs | Train: 5.098992794734195 | Val: -143.00178247794653
6-th component log probs | Train: 5.054703868206086 | Val: -176.0611930823821
7-th component log probs | Train: 5.322464068771245 | Val: -202.15565597556107
8-th component log probs | Train: 5.1060729045132724 | Val: -279.3313376124808
9-th component log probs | Train: 5.106698543728451 | Val: -186.64665120086192
KEYWORD NR_SAMPLES:800 DIM:300 AVG_DIFF:33893.0224
Fitting PCA...
0-th component log probs | Train: 5.25761387553229 | Val: -140.2363630103811
1-th component log probs | Train: 5.00296617259558 | Val: -84.37173374038696
2-th component log probs | Train: 5.184621638537409 | Val: -106.63030997997018
3-th component log probs | Train: 5.075583540827828 | Val: -170.50766013411013
4-th component log probs | Train: 5.349777772119346 | Val: -163.04694048320079
5-th component log probs | Train: 5.216097687539471 | Val: -129.96628426750306
6-th component log probs | Train: 5.178443160902753 | Val: -159.21797196924922
7-th component log probs | Train: 5.412552413281219 | Val: -180.44631539325033
8-th component log probs | Train: 5.225558338563084 | Val: -250.28061036221362
9-th component log probs | Train: 5.223346261869894 | Val: -168.57390246522573
KEYWORD NR_SAMPLES:800 DIM:350 AVG_DIFF:27773.1984
Fitting PCA...
0-th component log probs | Train: 5.345141527854025 | Val: -127.52082871570573
1-th component log probs | Train: 5.118992807935936 | Val: -78.56618373434695
2-th component log probs | Train: 5.279357924102935 | Val: -97.55732037133357
3-th component log probs | Train: 5.183106673444114 | Val: -156.3119265446901
4-th component log probs | Train: 5.425889045001481 | Val: -147.18271486865922
5-th component log probs | Train: 5.306928092234015 | Val: -118.38626609243774
6-th component log probs | Train: 5.273940277177734 | Val: -144.96640882392583
7-th component log probs | Train: 5.481466437098048 | Val: -162.94390166665954
8-th component log probs | Train: 5.3171918695728495 | Val: -225.88807733765236
9-th component log probs | Train: 5.313658869641289 | Val: -153.06096918548735
KEYWORD NR_SAMPLES:800 DIM:400 AVG_DIFF:23079.2046
Fitting PCA...
0-th component log probs | Train: 5.414634856350137 | Val: -116.75360114256549
1-th component log probs | Train: 5.211486322099437 | Val: -73.06779997371815
2-th component log probs | Train: 5.354963876825609 | Val: -89.41905711147228
3-th component log probs | Train: 5.268882194604236 | Val: -143.48746882694607
4-th component log probs | Train: 5.486305358769415 | Val: -134.08279047309975
5-th component log probs | Train: 5.379271550844288 | Val: -108.47276187747713
6-th component log probs | Train: 5.3500189163662375 | Val: -132.90816289485355
7-th component log probs | Train: 5.536098171215572 | Val: -148.13562816094648
8-th component log probs | Train: 5.389769636506294 | Val: -205.70974310373538
9-th component log probs | Train: 5.38567445625537 | Val: -140.02776287904126
KEYWORD NR_SAMPLES:800 DIM:450 AVG_DIFF:19433.5571
Fitting PCA...
0-th component log probs | Train: 5.471135194529825 | Val: -107.56441400029915
1-th component log probs | Train: 5.287481723598167 | Val: -68.07367824695687
2-th component log probs | Train: 5.416897952285355 | Val: -82.4498194601959
3-th component log probs | Train: 5.339142824490996 | Val: -132.14163452704034
4-th component log probs | Train: 5.535430887258249 | Val: -123.1460917549225
5-th component log probs | Train: 5.438568663484209 | Val: -99.91250756256348
6-th component log probs | Train: 5.412315764079081 | Val: -122.23398547383955
7-th component log probs | Train: 5.580520875699335 | Val: -135.64421050294547
8-th component log probs | Train: 5.4487630399864 | Val: -188.29821075010344
9-th component log probs | Train: 5.444591230560464 | Val: -128.7557824787015
KEYWORD NR_SAMPLES:800 DIM:500 AVG_DIFF:16541.2056
0-th component log probs | Train: 5.4831655737635465 | Val: -105.5630215175514
1-th component log probs | Train: 5.30374841797653 | Val: -66.95354479130259
2-th component log probs | Train: 5.430128834711815 | Val: -80.9402460349597
3-th component log probs | Train: 5.354180489316054 | Val: -129.6024157331158
4-th component log probs | Train: 5.545938662677624 | Val: -120.76250827921265
5-th component log probs | Train: 5.45128896827498 | Val: -98.01275038353806
6-th component log probs | Train: 5.4256278978666765 | Val: -119.92589890649893
7-th component log probs | Train: 5.5899951009050834 | Val: -132.95091381994055
8-th component log probs | Train: 5.461320919716121 | Val: -184.47334600178152
9-th component log probs | Train: 5.457172156142089 | Val: -126.25181920461893
KEYWORD NR_SAMPLES:800 DIM:512 AVG_DIFF:15937.8589
best average differences at 50 dimensions: 1777.9376016643444
2022-01-08 01:17.01 [info     ] Training complete              train_loss=0.27228158712387085
2022-01-08 01:17.01 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:17.05 [info     ] Testing complete               test_loss=1.5484251976013184
{'dataset_size': 800,
 'end_test_accuracy': 0.6176930069923401,
 'end_test_loss': 1.5484251976013184,
 'end_train_accuracy': 0.9963942170143127,
 'end_train_loss': 0.27228158712387085,
 'end_val_accuracy': 0.6776897311210632,
 'end_val_loss': 1.4851679801940918}
2022-01-08 01:17.05 [info     ] Start Predict                  dataset=57806
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:17.30 [info     ] Starting training              dataset=1000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
1000
Fitting PCA...
0-th component log probs | Train: 2.7676602913968216 | Val: -18.76290139195028
1-th component log probs | Train: 2.4511768330176076 | Val: -3.364353136564234
2-th component log probs | Train: 2.585548695775453 | Val: -9.199093941676455
3-th component log probs | Train: 2.586725450626161 | Val: -20.385664688014472
4-th component log probs | Train: 2.810764941317377 | Val: -15.001201367956421
5-th component log probs | Train: 2.8828564968584094 | Val: -27.09929163328929
6-th component log probs | Train: 2.522476762929084 | Val: -19.70686914900016
7-th component log probs | Train: 2.932290581958454 | Val: -39.99692471566628
8-th component log probs | Train: 2.623020652600069 | Val: -18.064549260663696
9-th component log probs | Train: 2.6133623771987655 | Val: -18.927496716802768
KEYWORD NR_SAMPLES:1000 DIM:50 AVG_DIFF:579.9743
Fitting PCA...
0-th component log probs | Train: 3.751170913575694 | Val: -138.73438686150345
1-th component log probs | Train: 3.1187568576818885 | Val: -14.216437620645506
2-th component log probs | Train: 3.332692977016162 | Val: -41.70240942062772
3-th component log probs | Train: 3.3127670545590737 | Val: -70.24922145312881
4-th component log probs | Train: 3.6006908938642104 | Val: -63.06524227368797
5-th component log probs | Train: 3.7635095034984256 | Val: -129.35787331008677
6-th component log probs | Train: 3.3417178405431383 | Val: -84.35572547281276
7-th component log probs | Train: 3.9049849747738534 | Val: -177.71467726631326
8-th component log probs | Train: 3.4404861600201304 | Val: -121.0436916171147
9-th component log probs | Train: 3.453573102463369 | Val: -110.47119878803719
KEYWORD NR_SAMPLES:1000 DIM:100 AVG_DIFF:12031.0437
Fitting PCA...
0-th component log probs | Train: 4.371638528562277 | Val: -170.8229073978734
1-th component log probs | Train: 3.6511132080411093 | Val: -35.26127822700235
2-th component log probs | Train: 3.928209721466136 | Val: -92.04824945616375
3-th component log probs | Train: 3.91941123605642 | Val: -144.75287312392956
4-th component log probs | Train: 4.195524580408796 | Val: -109.34330111606435
5-th component log probs | Train: 4.346473556431807 | Val: -171.3495500778176
6-th component log probs | Train: 3.9979122394855344 | Val: -149.42736049843592
7-th component log probs | Train: 4.484920899883219 | Val: -204.7419571224258
8-th component log probs | Train: 4.069744026180517 | Val: -208.48807534392193
9-th component log probs | Train: 4.104424059595237 | Val: -182.53378900854696
KEYWORD NR_SAMPLES:1000 DIM:150 AVG_DIFF:25608.1009
Fitting PCA...
0-th component log probs | Train: 4.725136060127971 | Val: -165.61870596126533
1-th component log probs | Train: 4.090479217720293 | Val: -50.847360548731615
2-th component log probs | Train: 4.341919822481159 | Val: -102.64087384543818
3-th component log probs | Train: 4.335709344118498 | Val: -160.2604372311312
4-th component log probs | Train: 4.561604968746909 | Val: -118.15198713275304
5-th component log probs | Train: 4.691984941532699 | Val: -165.60471124436884
6-th component log probs | Train: 4.417197697096892 | Val: -160.92048718895225
7-th component log probs | Train: 4.81368803237523 | Val: -188.62825791659938
8-th component log probs | Train: 4.472136702670185 | Val: -216.42036980457624
9-th component log probs | Train: 4.506474765375834 | Val: -185.15254958685125
KEYWORD NR_SAMPLES:1000 DIM:200 AVG_DIFF:26566.6618
Fitting PCA...
0-th component log probs | Train: 4.952079679708409 | Val: -150.4286308792014
1-th component log probs | Train: 4.399862920444158 | Val: -55.25892660244052
2-th component log probs | Train: 4.622899451791216 | Val: -100.31366898021443
3-th component log probs | Train: 4.618933267645557 | Val: -157.37568940465547
4-th component log probs | Train: 4.806589334123023 | Val: -112.51285647721474
5-th component log probs | Train: 4.918923558906538 | Val: -153.6596775150858
6-th component log probs | Train: 4.694598224301191 | Val: -153.45708953545994
7-th component log probs | Train: 5.022428254836888 | Val: -169.78317039021348
8-th component log probs | Train: 4.736998648442822 | Val: -203.41532558984878
9-th component log probs | Train: 4.768892439353906 | Val: -175.21872981222597
KEYWORD NR_SAMPLES:1000 DIM:250 AVG_DIFF:23659.0614
Fitting PCA...
0-th component log probs | Train: 5.110072855659941 | Val: -137.85308086096018
1-th component log probs | Train: 4.627599724177946 | Val: -54.7662368765868
2-th component log probs | Train: 4.824152018354673 | Val: -95.06179793688335
3-th component log probs | Train: 4.81938203347384 | Val: -150.9993663033679
4-th component log probs | Train: 4.9819778984422305 | Val: -104.84583061490311
5-th component log probs | Train: 5.078719121255298 | Val: -139.40437044490218
6-th component log probs | Train: 4.889479704813813 | Val: -144.6425598504707
7-th component log probs | Train: 5.16851694630674 | Val: -152.04743609031976
8-th component log probs | Train: 4.924363902979234 | Val: -187.099678955648
9-th component log probs | Train: 4.953066023171561 | Val: -163.75332945687288
KEYWORD NR_SAMPLES:1000 DIM:300 AVG_DIFF:20490.2529
Fitting PCA...
0-th component log probs | Train: 5.227324490945245 | Val: -127.03233859160625
1-th component log probs | Train: 4.800327889364747 | Val: -52.86309666305061
2-th component log probs | Train: 4.974956076896303 | Val: -88.3159348439664
3-th component log probs | Train: 4.970330198804181 | Val: -139.12264960212823
4-th component log probs | Train: 5.111251210698705 | Val: -97.53405397306825
5-th component log probs | Train: 5.196487167752282 | Val: -127.26577627512323
6-th component log probs | Train: 5.033913483963385 | Val: -133.3596947308535
7-th component log probs | Train: 5.276552677796776 | Val: -137.07787424522328
8-th component log probs | Train: 5.06313055493501 | Val: -172.49440677514738
9-th component log probs | Train: 5.089935679079425 | Val: -150.2354521059015
KEYWORD NR_SAMPLES:1000 DIM:350 AVG_DIFF:17466.1506
Fitting PCA...
0-th component log probs | Train: 5.317220995632504 | Val: -116.43813764412808
1-th component log probs | Train: 4.936585256703134 | Val: -50.22757506986883
2-th component log probs | Train: 5.09228429306747 | Val: -81.7943331299687
3-th component log probs | Train: 5.087817258423677 | Val: -128.60668636435443
4-th component log probs | Train: 5.212234955563923 | Val: -90.10046707252306
5-th component log probs | Train: 5.2881706620365465 | Val: -116.27464672733451
6-th component log probs | Train: 5.14600678006092 | Val: -122.79867923798275
7-th component log probs | Train: 5.359819198602512 | Val: -124.83519495622883
8-th component log probs | Train: 5.17099444710358 | Val: -157.9249224333478
9-th component log probs | Train: 5.195368004504491 | Val: -138.32542282134207
KEYWORD NR_SAMPLES:1000 DIM:400 AVG_DIFF:14879.9392
Fitting PCA...
0-th component log probs | Train: 5.388758397320948 | Val: -107.25205782206986
1-th component log probs | Train: 5.045798241634128 | Val: -47.209445889850194
2-th component log probs | Train: 5.1862270268963 | Val: -75.8448137119329
3-th component log probs | Train: 5.182067165003754 | Val: -118.81028822668124
4-th component log probs | Train: 5.293098549654637 | Val: -83.39838202727206
5-th component log probs | Train: 5.36140276216795 | Val: -107.0074655907788
6-th component log probs | Train: 5.235309237795627 | Val: -113.0816786070733
7-th component log probs | Train: 5.426062661895235 | Val: -114.13685558455947
8-th component log probs | Train: 5.2572231854666835 | Val: -145.29699343660135
9-th component log probs | Train: 5.279441131966007 | Val: -127.09005874645356
KEYWORD NR_SAMPLES:1000 DIM:450 AVG_DIFF:12737.3225
Fitting PCA...
0-th component log probs | Train: 5.447200006371409 | Val: -98.8773799447454
1-th component log probs | Train: 5.136192691979073 | Val: -44.321394069533625
2-th component log probs | Train: 5.263449438203836 | Val: -70.44107953278093
3-th component log probs | Train: 5.25972773058028 | Val: -109.83615890667328
4-th component log probs | Train: 5.359712542260429 | Val: -77.35194182953826
5-th component log probs | Train: 5.4215615567059965 | Val: -98.6852346313793
6-th component log probs | Train: 5.308412097004444 | Val: -104.25049910171214
7-th component log probs | Train: 5.48049196139065 | Val: -104.90154052214132
8-th component log probs | Train: 5.327995724876753 | Val: -133.80366827082585
9-th component log probs | Train: 5.348311356011525 | Val: -117.23684832818803
KEYWORD NR_SAMPLES:1000 DIM:500 AVG_DIFF:10951.9148
0-th component log probs | Train: 5.459646387295513 | Val: -97.03281084098064
1-th component log probs | Train: 5.155617266076322 | Val: -43.625247604486646
2-th component log probs | Train: 5.280011717898454 | Val: -69.21552498945978
3-th component log probs | Train: 5.276405629382775 | Val: -107.8406309897245
4-th component log probs | Train: 5.37405409247848 | Val: -75.94649010614023
5-th component log probs | Train: 5.434431291978625 | Val: -96.84818763712859
6-th component log probs | Train: 5.324008562978545 | Val: -102.2566468695953
7-th component log probs | Train: 5.4921145527993085 | Val: -102.877558564991
8-th component log probs | Train: 5.343162028780296 | Val: -131.23932601185743
9-th component log probs | Train: 5.3630119902028595 | Val: -115.10547813854232
KEYWORD NR_SAMPLES:1000 DIM:512 AVG_DIFF:10573.1095
best average differences at 50 dimensions: 579.9743187470116
2022-01-08 01:20.38 [info     ] Training complete              train_loss=0.25034478306770325
2022-01-08 01:20.38 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:20.42 [info     ] Testing complete               test_loss=1.47282075881958
{'dataset_size': 1000,
 'end_test_accuracy': 0.6432483196258545,
 'end_test_loss': 1.47282075881958,
 'end_train_accuracy': 1.0,
 'end_train_loss': 0.25034478306770325,
 'end_val_accuracy': 0.697431743144989,
 'end_val_loss': 1.3869339227676392}
2022-01-08 01:20.43 [info     ] Start Predict                  dataset=57606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:21.10 [info     ] Starting training              dataset=2000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
2000
Fitting PCA...
0-th component log probs | Train: 2.5361703451901496 | Val: -3.5939708644277064
1-th component log probs | Train: 2.3871037927780616 | Val: -0.19428183347461997
2-th component log probs | Train: 2.633940069112374 | Val: -4.250640412735325
3-th component log probs | Train: 2.3641121553588125 | Val: -3.386783960564661
4-th component log probs | Train: 2.460760047020974 | Val: -4.052052678368802
5-th component log probs | Train: 2.554774143313015 | Val: -3.6368104038671123
6-th component log probs | Train: 2.4953784384740385 | Val: -4.511589081285384
7-th component log probs | Train: 2.776655133064911 | Val: -9.323355039798967
8-th component log probs | Train: 2.489739351023405 | Val: -5.7515366348084696
9-th component log probs | Train: 2.4874739429028923 | Val: -5.383050492282173
KEYWORD NR_SAMPLES:2000 DIM:50 AVG_DIFF:57.4921
Fitting PCA...
0-th component log probs | Train: 3.199156868407892 | Val: -12.365454153146292
1-th component log probs | Train: 2.9732532392547952 | Val: -2.308679220312611
2-th component log probs | Train: 3.2280507280403556 | Val: -9.435414064368137
3-th component log probs | Train: 2.9203423244290487 | Val: -5.497016377813198
4-th component log probs | Train: 3.1087625205517853 | Val: -11.543019660537494
5-th component log probs | Train: 3.1437101942200996 | Val: -6.830524486976068
6-th component log probs | Train: 3.0867180532553022 | Val: -8.835859957303269
7-th component log probs | Train: 3.506378928722313 | Val: -31.648613326810988
8-th component log probs | Train: 3.0711165737507633 | Val: -14.229199349715449
9-th component log probs | Train: 3.1804253349099696 | Val: -19.515198829580193
KEYWORD NR_SAMPLES:2000 DIM:100 AVG_DIFF:313.0154
Fitting PCA...
0-th component log probs | Train: 3.724394734690302 | Val: -28.17888424483156
1-th component log probs | Train: 3.345270008056557 | Val: -4.23976174279295
2-th component log probs | Train: 3.6532541182125184 | Val: -17.045471284004673
3-th component log probs | Train: 3.267844316808675 | Val: -7.4770799522510485
4-th component log probs | Train: 3.6132354104156033 | Val: -27.673382894763254
5-th component log probs | Train: 3.5131137790752707 | Val: -11.049452959489441
6-th component log probs | Train: 3.4658105601588853 | Val: -13.263218919705832
7-th component log probs | Train: 4.03940000058262 | Val: -55.57721924159297
8-th component log probs | Train: 3.4503209462626327 | Val: -22.616650097383797
9-th component log probs | Train: 3.6908300118427864 | Val: -45.57070355914028
KEYWORD NR_SAMPLES:2000 DIM:150 AVG_DIFF:998.3043
Fitting PCA...
0-th component log probs | Train: 4.134609756438757 | Val: -40.86717780533869
1-th component log probs | Train: 3.65464267988245 | Val: -7.618847853412681
2-th component log probs | Train: 4.001013630086714 | Val: -25.23677632575805
3-th component log probs | Train: 3.547633493982758 | Val: -11.092914056785965
4-th component log probs | Train: 4.024359759295487 | Val: -44.1660266818328
5-th component log probs | Train: 3.8058292304593064 | Val: -15.225766685627477
6-th component log probs | Train: 3.7610553554167687 | Val: -19.034826130914315
7-th component log probs | Train: 4.409622818962628 | Val: -63.61774348862484
8-th component log probs | Train: 3.7648490062212843 | Val: -32.034607989422334
9-th component log probs | Train: 4.107144967200058 | Val: -61.406373651070176
KEYWORD NR_SAMPLES:2000 DIM:200 AVG_DIFF:1694.7260
Fitting PCA...
0-th component log probs | Train: 4.433429606666265 | Val: -44.230213524633506
1-th component log probs | Train: 3.9292703282477768 | Val: -11.375362794962834
2-th component log probs | Train: 4.278688369440783 | Val: -28.850427193369907
3-th component log probs | Train: 3.7871722088066906 | Val: -15.02622569895447
4-th component log probs | Train: 4.33287648356183 | Val: -50.432768707541214
5-th component log probs | Train: 4.057656518386845 | Val: -19.061631607416043
6-th component log probs | Train: 4.020547589874656 | Val: -25.47796455424352
7-th component log probs | Train: 4.668212164212051 | Val: -63.86318111411299
8-th component log probs | Train: 4.038444605557994 | Val: -41.403356867199456
9-th component log probs | Train: 4.405992260054191 | Val: -65.42309449752824
KEYWORD NR_SAMPLES:2000 DIM:250 AVG_DIFF:2046.0559
Fitting PCA...
0-th component log probs | Train: 4.651763532934363 | Val: -45.47067522708897
1-th component log probs | Train: 4.1634181766691345 | Val: -14.44375420326632
2-th component log probs | Train: 4.495545939480831 | Val: -30.35579215499464
3-th component log probs | Train: 4.005097896461127 | Val: -20.410371833602376
4-th component log probs | Train: 4.5629648952936535 | Val: -52.15963532861087
5-th component log probs | Train: 4.270545011509811 | Val: -21.910238958393034
6-th component log probs | Train: 4.2415552413049 | Val: -29.473345955460736
7-th component log probs | Train: 4.8516961582974725 | Val: -61.79683226911969
8-th component log probs | Train: 4.268871390607222 | Val: -47.3026015940871
9-th component log probs | Train: 4.628277563790867 | Val: -65.26988648754961
KEYWORD NR_SAMPLES:2000 DIM:300 AVG_DIFF:2208.4788
Fitting PCA...
0-th component log probs | Train: 4.816654050632511 | Val: -44.66962298899238
1-th component log probs | Train: 4.35992232548907 | Val: -15.818668738046558
2-th component log probs | Train: 4.666687793124291 | Val: -30.356186213881667
3-th component log probs | Train: 4.195923076245934 | Val: -23.50433571509586
4-th component log probs | Train: 4.738688608608778 | Val: -51.334503054305095
5-th component log probs | Train: 4.445432677611949 | Val: -23.599699483983922
6-th component log probs | Train: 4.426139848505512 | Val: -31.13860592652251
7-th component log probs | Train: 4.991250946171029 | Val: -58.190203255962096
8-th component log probs | Train: 4.456778885339618 | Val: -49.68790593570192
9-th component log probs | Train: 4.796497824290396 | Val: -62.86296030989759
KEYWORD NR_SAMPLES:2000 DIM:350 AVG_DIFF:2193.8065
Fitting PCA...
0-th component log probs | Train: 4.946883920513414 | Val: -42.61191063436811
1-th component log probs | Train: 4.521675668991196 | Val: -16.36210405497584
2-th component log probs | Train: 4.805666284742474 | Val: -29.62821486137332
3-th component log probs | Train: 4.360790241035769 | Val: -25.296067716020662
4-th component log probs | Train: 4.876815314067969 | Val: -49.15301717239808
5-th component log probs | Train: 4.593148949012857 | Val: -23.921604580574265
6-th component log probs | Train: 4.578942108485923 | Val: -31.521661312979518
7-th component log probs | Train: 5.099862873275279 | Val: -54.85361997856041
8-th component log probs | Train: 4.612119775869319 | Val: -50.00814896852857
9-th component log probs | Train: 4.928726807097333 | Val: -60.044040830264606
KEYWORD NR_SAMPLES:2000 DIM:400 AVG_DIFF:2098.1415
Fitting PCA...
0-th component log probs | Train: 5.051228675827136 | Val: -40.542337400900436
1-th component log probs | Train: 4.658035851615588 | Val: -16.285281488408227
2-th component log probs | Train: 4.918955781721452 | Val: -28.437827427939936
3-th component log probs | Train: 4.503849621910523 | Val: -25.968155587484553
4-th component log probs | Train: 4.987970610057589 | Val: -46.756541078763824
5-th component log probs | Train: 4.719876727661388 | Val: -23.69226114452311
6-th component log probs | Train: 4.708105630766997 | Val: -31.165118569667523
7-th component log probs | Train: 5.18713401809593 | Val: -51.29666964751081
8-th component log probs | Train: 4.741074023558207 | Val: -48.93130070643403
9-th component log probs | Train: 5.035611636212966 | Val: -56.68241625200942
KEYWORD NR_SAMPLES:2000 DIM:450 AVG_DIFF:1958.0263
Fitting PCA...
0-th component log probs | Train: 5.137933690073583 | Val: -38.301782055631506
1-th component log probs | Train: 4.7742827623526995 | Val: -15.925437707844415
2-th component log probs | Train: 5.014447596561209 | Val: -26.894324841351462
3-th component log probs | Train: 4.628613431922435 | Val: -25.786559013545737
4-th component log probs | Train: 5.0804996357884376 | Val: -44.15445823277212
5-th component log probs | Train: 4.827398586624508 | Val: -22.865960778439543
6-th component log probs | Train: 4.818631088114301 | Val: -30.069829489909925
7-th component log probs | Train: 5.259621463528173 | Val: -47.976473224112624
8-th component log probs | Train: 4.850983524636295 | Val: -47.137215217016006
9-th component log probs | Train: 5.123809501751364 | Val: -53.44546119414209
KEYWORD NR_SAMPLES:2000 DIM:500 AVG_DIFF:1798.6719
0-th component log probs | Train: 5.156722174393143 | Val: -37.72737247438974
1-th component log probs | Train: 4.799788168448406 | Val: -15.78272373006125
2-th component log probs | Train: 5.035238926516042 | Val: -26.54592830029634
3-th component log probs | Train: 4.656302264435715 | Val: -25.646948154962296
4-th component log probs | Train: 5.1004431365898455 | Val: -43.5747098751225
5-th component log probs | Train: 4.851229533795597 | Val: -22.605943670070324
6-th component log probs | Train: 4.842981674424985 | Val: -29.777523509751873
7-th component log probs | Train: 5.275352732463544 | Val: -47.186959598454095
8-th component log probs | Train: 4.8751355500994915 | Val: -46.55653957445986
9-th component log probs | Train: 5.142786677342731 | Val: -52.58955200829818
KEYWORD NR_SAMPLES:2000 DIM:512 AVG_DIFF:1757.8617
best average differences at 50 dimensions: 57.492058251682025
2022-01-08 01:24.35 [info     ] Training complete              train_loss=0.27514928579330444
2022-01-08 01:24.35 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:24.39 [info     ] Testing complete               test_loss=0.9364128112792969
{'dataset_size': 2000,
 'end_test_accuracy': 0.748963475227356,
 'end_test_loss': 0.9364128112792969,
 'end_train_accuracy': 0.99853515625,
 'end_train_loss': 0.27514928579330444,
 'end_val_accuracy': 0.7934622168540955,
 'end_val_loss': 0.9191848039627075}
2022-01-08 01:24.39 [info     ] Start Predict                  dataset=56606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:25.07 [info     ] Starting training              dataset=4000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
4000
Fitting PCA...
0-th component log probs | Train: 2.340267638143649 | Val: 0.3869852546452302
1-th component log probs | Train: 2.1264986895211395 | Val: 1.4169914670441277
2-th component log probs | Train: 2.0892949632736433 | Val: 1.3562268875442471
3-th component log probs | Train: 2.0165587375002105 | Val: 0.6255001064672612
4-th component log probs | Train: 2.13955268813192 | Val: 1.0221369042688322
5-th component log probs | Train: 2.2171281222888775 | Val: 1.097627673188669
6-th component log probs | Train: 2.1815251747820867 | Val: 0.5953403926720855
7-th component log probs | Train: 2.192697125955207 | Val: 1.0655150473773267
8-th component log probs | Train: 2.0090287894629544 | Val: 0.5712448445677146
9-th component log probs | Train: 2.0758140731034898 | Val: 0.5872074197039676
KEYWORD NR_SAMPLES:4000 DIM:50 AVG_DIFF:0.8638
Fitting PCA...
0-th component log probs | Train: 2.9085607791418386 | Val: -0.5771870476043663
1-th component log probs | Train: 2.6675027941134988 | Val: 1.5510911104212048
2-th component log probs | Train: 2.6068946543082925 | Val: 1.5392190567958663
3-th component log probs | Train: 2.555760278181615 | Val: 0.6494504241011496
4-th component log probs | Train: 2.70685773530881 | Val: 0.7521880883626048
5-th component log probs | Train: 2.7780966751602363 | Val: 0.6501909950677401
6-th component log probs | Train: 2.72676359473802 | Val: 0.43578279422164534
7-th component log probs | Train: 2.7364837849891335 | Val: 0.8933338335168614
8-th component log probs | Train: 2.5336564227979723 | Val: 0.40857612093304396
9-th component log probs | Train: 2.621895851461046 | Val: -0.1536435417290154
KEYWORD NR_SAMPLES:4000 DIM:100 AVG_DIFF:4.1236
Fitting PCA...
0-th component log probs | Train: 3.2744460351823594 | Val: -1.9606407161373876
1-th component log probs | Train: 3.000906917319032 | Val: 1.5163350947623542
2-th component log probs | Train: 2.9282091906020007 | Val: 1.6036141810594513
3-th component log probs | Train: 2.875077754412955 | Val: 0.6159242600295083
4-th component log probs | Train: 3.067999881063014 | Val: 0.17059453850860676
5-th component log probs | Train: 3.1351386135020176 | Val: 0.13999822877973414
6-th component log probs | Train: 3.057968592901585 | Val: 0.08457253779569844
7-th component log probs | Train: 3.0792221930673493 | Val: 0.4104048969207475
8-th component log probs | Train: 2.8502719478827117 | Val: 0.29955487589561236
9-th component log probs | Train: 2.971257911756662 | Val: -0.9651614360367969
KEYWORD NR_SAMPLES:4000 DIM:150 AVG_DIFF:8.9884
Fitting PCA...
0-th component log probs | Train: 3.5759743185727815 | Val: -4.050459349779092
1-th component log probs | Train: 3.259893294995788 | Val: 1.3398816913056837
2-th component log probs | Train: 3.177074567864814 | Val: 1.5135892018489756
3-th component log probs | Train: 3.1212757514263627 | Val: 0.4474475116946725
4-th component log probs | Train: 3.3493984697712094 | Val: -0.4910206240274395
5-th component log probs | Train: 3.422118488905625 | Val: -0.9080190085247004
6-th component log probs | Train: 3.31767041919028 | Val: -0.5536965427712988
7-th component log probs | Train: 3.3494740248325936 | Val: -0.293584197181664
8-th component log probs | Train: 3.1004825723267704 | Val: -0.07613256332612366
9-th component log probs | Train: 3.255141489225526 | Val: -2.315879538331132
KEYWORD NR_SAMPLES:4000 DIM:200 AVG_DIFF:18.0039
Fitting PCA...
0-th component log probs | Train: 3.83667934937145 | Val: -6.968462429472993
1-th component log probs | Train: 3.4712143947076046 | Val: 1.0561571795203133
2-th component log probs | Train: 3.378166638666407 | Val: 1.3167915294405652
3-th component log probs | Train: 3.3235030530765033 | Val: 0.08455000993069822
4-th component log probs | Train: 3.5909813879528363 | Val: -1.7544979714336153
5-th component log probs | Train: 3.658890787672511 | Val: -2.1982852059948774
6-th component log probs | Train: 3.532798212981499 | Val: -1.4409918415715643
7-th component log probs | Train: 3.5785377035069463 | Val: -1.2187587071494175
8-th component log probs | Train: 3.3047789895771666 | Val: -0.5973785491710698
9-th component log probs | Train: 3.493814593427624 | Val: -4.196241133734321
KEYWORD NR_SAMPLES:4000 DIM:250 AVG_DIFF:33.8238
Fitting PCA...
0-th component log probs | Train: 4.065661548497855 | Val: -9.507860016243164
1-th component log probs | Train: 3.6593988508167716 | Val: 0.5561142385680725
2-th component log probs | Train: 3.5518291436605707 | Val: 0.9732255820335675
3-th component log probs | Train: 3.494480617126704 | Val: -0.42570542500190317
4-th component log probs | Train: 3.8020947622297 | Val: -3.276767787250036
5-th component log probs | Train: 3.8577892521033283 | Val: -3.3492987013512163
6-th component log probs | Train: 3.7232953742331887 | Val: -2.545515800192075
7-th component log probs | Train: 3.7843574416313652 | Val: -2.612377299843276
8-th component log probs | Train: 3.480146944087439 | Val: -1.402598345481384
9-th component log probs | Train: 3.714791105246789 | Val: -6.643578175750264
KEYWORD NR_SAMPLES:4000 DIM:300 AVG_DIFF:55.7528
Fitting PCA...
0-th component log probs | Train: 4.263510946108125 | Val: -11.247888993857247
1-th component log probs | Train: 3.8312389903059416 | Val: -0.0886244048571982
2-th component log probs | Train: 3.7036319976272005 | Val: 0.6058884559007012
3-th component log probs | Train: 3.648346056472379 | Val: -1.1589544322247516
4-th component log probs | Train: 3.9913523097101216 | Val: -4.887553751723882
5-th component log probs | Train: 4.032473862602228 | Val: -4.39429699022436
6-th component log probs | Train: 3.8953580667298833 | Val: -3.698411078379036
7-th component log probs | Train: 3.9707579084363367 | Val: -4.137322681053066
8-th component log probs | Train: 3.6393128509620665 | Val: -2.4051447065125395
9-th component log probs | Train: 3.9162646199911912 | Val: -9.610723690133137
KEYWORD NR_SAMPLES:4000 DIM:350 AVG_DIFF:82.2465
Fitting PCA...
0-th component log probs | Train: 4.429123338418371 | Val: -12.167501333434176
1-th component log probs | Train: 3.989194800160113 | Val: -0.7950935138430835
2-th component log probs | Train: 3.8446831385247986 | Val: 0.10558597541385197
3-th component log probs | Train: 3.7900497729710816 | Val: -2.089670938000517
4-th component log probs | Train: 4.162869609584587 | Val: -6.206985490085394
5-th component log probs | Train: 4.1847133485809165 | Val: -5.210747251844665
6-th component log probs | Train: 4.051885408977928 | Val: -4.642839777369146
7-th component log probs | Train: 4.136779160543573 | Val: -5.289255597256282
8-th component log probs | Train: 3.78724769008461 | Val: -3.6142389598400335
9-th component log probs | Train: 4.095482114952121 | Val: -11.911647027695368
KEYWORD NR_SAMPLES:4000 DIM:400 AVG_DIFF:106.9979
Fitting PCA...
0-th component log probs | Train: 4.5679860346765375 | Val: -12.759019343541546
1-th component log probs | Train: 4.135734247133493 | Val: -1.3974688206277082
2-th component log probs | Train: 3.9765029651999324 | Val: -0.33618461135975447
3-th component log probs | Train: 3.9233129419092294 | Val: -2.9476127902279505
4-th component log probs | Train: 4.311222217903978 | Val: -7.313501561281424
5-th component log probs | Train: 4.319507298904937 | Val: -5.838443581586022
6-th component log probs | Train: 4.192347681768383 | Val: -5.489111915878832
7-th component log probs | Train: 4.285308543767088 | Val: -6.10060515264639
8-th component log probs | Train: 3.9271874659765302 | Val: -4.736783766263686
9-th component log probs | Train: 4.2529210758935445 | Val: -13.376479280948253
KEYWORD NR_SAMPLES:4000 DIM:450 AVG_DIFF:128.2722
Fitting PCA...
0-th component log probs | Train: 4.686700387552923 | Val: -12.82862803366752
1-th component log probs | Train: 4.268155074280148 | Val: -1.8478184677958243
2-th component log probs | Train: 4.101210861735099 | Val: -0.7173072697402652
3-th component log probs | Train: 4.050912688228742 | Val: -3.721324009886748
4-th component log probs | Train: 4.442225358048764 | Val: -7.710705980158105
5-th component log probs | Train: 4.440656508667661 | Val: -6.148702844477696
6-th component log probs | Train: 4.320174955574558 | Val: -5.943451513461964
7-th component log probs | Train: 4.416144611910971 | Val: -6.6630326880241375
8-th component log probs | Train: 4.0585895915901835 | Val: -5.6493171396358735
9-th component log probs | Train: 4.39161826549932 | Val: -14.050955501216151
KEYWORD NR_SAMPLES:4000 DIM:500 AVG_DIFF:141.5389
0-th component log probs | Train: 4.712835069950498 | Val: -12.800175732984956
1-th component log probs | Train: 4.2985569926747935 | Val: -1.9148629495532377
2-th component log probs | Train: 4.130735670831093 | Val: -0.7839810315767128
3-th component log probs | Train: 4.081689214142279 | Val: -3.88527367069458
4-th component log probs | Train: 4.47150497710053 | Val: -7.796296120877517
5-th component log probs | Train: 4.4682201968787885 | Val: -6.143508869797077
6-th component log probs | Train: 4.349431022130902 | Val: -5.995601193163676
7-th component log probs | Train: 4.445830758168344 | Val: -6.74045558515317
8-th component log probs | Train: 4.090217040239346 | Val: -5.848962418454153
9-th component log probs | Train: 4.422514837100718 | Val: -14.123408825527378
KEYWORD NR_SAMPLES:4000 DIM:512 AVG_DIFF:143.6971
best average differences at 50 dimensions: 0.863796282114798
2022-01-08 01:29.12 [info     ] Training complete              train_loss=0.4194057285785675
2022-01-08 01:29.12 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:29.16 [info     ] Testing complete               test_loss=0.6656011343002319
{'dataset_size': 4000,
 'end_test_accuracy': 0.7951730489730835,
 'end_test_loss': 0.6656011343002319,
 'end_train_accuracy': 0.9563491940498352,
 'end_train_loss': 0.4194057285785675,
 'end_val_accuracy': 0.8368863463401794,
 'end_val_loss': 0.7323819994926453}
2022-01-08 01:29.16 [info     ] Start Predict                  dataset=54606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:29.44 [info     ] Starting training              dataset=6000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
6000
Fitting PCA...
0-th component log probs | Train: 2.154734515524803 | Val: 1.451411315607824
1-th component log probs | Train: 2.002569589800598 | Val: 1.4663216638601535
2-th component log probs | Train: 2.0597431083655877 | Val: 1.4938833775634937
3-th component log probs | Train: 2.110863373825906 | Val: 0.954668334507937
4-th component log probs | Train: 2.1289423253595974 | Val: 1.0449981328274158
5-th component log probs | Train: 2.2926741666844634 | Val: 0.47520376271952575
6-th component log probs | Train: 2.076634265048683 | Val: 1.009282879174016
7-th component log probs | Train: 2.120822109739359 | Val: 1.1677383779656125
8-th component log probs | Train: 2.051844819087444 | Val: 1.0193402722812737
9-th component log probs | Train: 2.1853372574264975 | Val: 0.9049904597366012
KEYWORD NR_SAMPLES:6000 DIM:50 AVG_DIFF:0.0682
Fitting PCA...
0-th component log probs | Train: 2.7269034374579473 | Val: 1.3161490727566922
1-th component log probs | Train: 2.5371594544119325 | Val: 1.7508244130863355
2-th component log probs | Train: 2.6001585035026427 | Val: 1.7551394140099406
3-th component log probs | Train: 2.664349931528189 | Val: 1.0622645232318746
4-th component log probs | Train: 2.6825973605425624 | Val: 0.8140153038411089
5-th component log probs | Train: 2.8640044222161904 | Val: 0.0641241395374661
6-th component log probs | Train: 2.6136337370118654 | Val: 1.0874926601383574
7-th component log probs | Train: 2.6684625132835227 | Val: 1.367385831902439
8-th component log probs | Train: 2.6084969858535696 | Val: 0.9462655215518258
9-th component log probs | Train: 2.761837023796569 | Val: 0.28508956216619946
KEYWORD NR_SAMPLES:6000 DIM:100 AVG_DIFF:1.9691
Fitting PCA...
0-th component log probs | Train: 3.0721733309436225 | Val: 1.097539384620743
1-th component log probs | Train: 2.843290301773427 | Val: 1.9798090447425725
2-th component log probs | Train: 2.9199042107464965 | Val: 1.8762416138849922
3-th component log probs | Train: 2.9889441766293534 | Val: 1.118494010645641
4-th component log probs | Train: 3.0181908229181245 | Val: 0.7285085486209067
5-th component log probs | Train: 3.1895590882951645 | Val: -0.09133465118924192
6-th component log probs | Train: 2.9389917860269597 | Val: 1.077154168889352
7-th component log probs | Train: 2.9772239819278634 | Val: 1.4788704451931036
8-th component log probs | Train: 2.9427816711934134 | Val: 0.8644380384334214
9-th component log probs | Train: 3.1072711667922555 | Val: -0.17879176529418483
KEYWORD NR_SAMPLES:6000 DIM:150 AVG_DIFF:3.6118
Fitting PCA...
0-th component log probs | Train: 3.3386620158155145 | Val: 0.7144104934767896
1-th component log probs | Train: 3.073824104100214 | Val: 2.1471303828019837
2-th component log probs | Train: 3.168358615247014 | Val: 1.9584846981735033
3-th component log probs | Train: 3.2327080162485435 | Val: 1.114335368740148
4-th component log probs | Train: 3.277565832781214 | Val: 0.41199220473711295
5-th component log probs | Train: 3.4316718167998785 | Val: -0.18532376898492758
6-th component log probs | Train: 3.1900042572352367 | Val: 0.9319567518607551
7-th component log probs | Train: 3.20956228132784 | Val: 1.5420271167168171
8-th component log probs | Train: 3.1905213360731364 | Val: 0.8165184585680503
9-th component log probs | Train: 3.3726773034959994 | Val: -0.7934496229231937
KEYWORD NR_SAMPLES:6000 DIM:200 AVG_DIFF:5.7205
Fitting PCA...
0-th component log probs | Train: 3.56129691336797 | Val: 0.056697090480123016
1-th component log probs | Train: 3.2540408786979125 | Val: 2.248812996285905
2-th component log probs | Train: 3.362562982366432 | Val: 1.9487975190110316
3-th component log probs | Train: 3.4226275104680877 | Val: 1.0635602629453524
4-th component log probs | Train: 3.4894319609683593 | Val: -0.14651423905500915
5-th component log probs | Train: 3.6306928901777415 | Val: -0.6313607566318401
6-th component log probs | Train: 3.3909689341955986 | Val: 0.7224253331056217
7-th component log probs | Train: 3.3981399047415164 | Val: 1.5398857242351547
8-th component log probs | Train: 3.387466435187184 | Val: 0.6452998839570522
9-th component log probs | Train: 3.592916028646898 | Val: -1.646787180341403
KEYWORD NR_SAMPLES:6000 DIM:250 AVG_DIFF:9.1989
Fitting PCA...
0-th component log probs | Train: 3.756200820130041 | Val: -0.8899358282382305
1-th component log probs | Train: 3.403577146125595 | Val: 2.2908539528181007
2-th component log probs | Train: 3.5257372462283536 | Val: 1.823262794897349
3-th component log probs | Train: 3.5817280612872127 | Val: 0.9304438364984653
4-th component log probs | Train: 3.6700745060236684 | Val: -0.8722701286025114
5-th component log probs | Train: 3.798060794180557 | Val: -1.0783003650904244
6-th component log probs | Train: 3.5589400176449626 | Val: 0.33305715726840607
7-th component log probs | Train: 3.5539508677224223 | Val: 1.43533739654624
8-th component log probs | Train: 3.550995820969352 | Val: 0.3387391938200337
9-th component log probs | Train: 3.7786754665847586 | Val: -2.4758716858828715
KEYWORD NR_SAMPLES:6000 DIM:300 AVG_DIFF:13.9662
Fitting PCA...
0-th component log probs | Train: 3.9311608691715483 | Val: -1.8339126691034453
1-th component log probs | Train: 3.532724377917204 | Val: 2.3003517639897244
2-th component log probs | Train: 3.670384368421261 | Val: 1.661871176266354
3-th component log probs | Train: 3.7208413948827173 | Val: 0.6772548078541863
4-th component log probs | Train: 3.834933785177712 | Val: -1.6518321811756065
5-th component log probs | Train: 3.9465554636336075 | Val: -1.4511696663929787
6-th component log probs | Train: 3.7121405676198673 | Val: -0.1866673741057002
7-th component log probs | Train: 3.687738793226082 | Val: 1.3013227482160636
8-th component log probs | Train: 3.6973025957233085 | Val: -0.055657762419076544
9-th component log probs | Train: 3.9460559812799625 | Val: -3.4845513342648347
KEYWORD NR_SAMPLES:6000 DIM:350 AVG_DIFF:20.0210
Fitting PCA...
0-th component log probs | Train: 4.090686370723551 | Val: -2.7202542011070383
1-th component log probs | Train: 3.647170049355698 | Val: 2.279843032591055
2-th component log probs | Train: 3.800035002399878 | Val: 1.4502684781471604
3-th component log probs | Train: 3.8457730348242367 | Val: 0.43953264765935485
4-th component log probs | Train: 3.9846854377767005 | Val: -2.4528821250925485
5-th component log probs | Train: 4.078175015195391 | Val: -1.831760033626599
6-th component log probs | Train: 3.8531935047207373 | Val: -0.7754080852194123
7-th component log probs | Train: 3.8071995871856985 | Val: 1.1503308037342999
8-th component log probs | Train: 3.8307109687618093 | Val: -0.5407973477279165
9-th component log probs | Train: 4.09492890537571 | Val: -4.394006815826711
KEYWORD NR_SAMPLES:6000 DIM:400 AVG_DIFF:26.8802
Fitting PCA...
0-th component log probs | Train: 4.2335365832366625 | Val: -3.4528958662768425
1-th component log probs | Train: 3.751882527959933 | Val: 2.2253667772886967
2-th component log probs | Train: 3.9188045534690072 | Val: 1.2228103909435564
3-th component log probs | Train: 3.9605783813812985 | Val: 0.1773446032513148
4-th component log probs | Train: 4.121802647551389 | Val: -3.027359432869501
5-th component log probs | Train: 4.198508165039969 | Val: -2.1219542742943958
6-th component log probs | Train: 3.983280469154076 | Val: -1.383387220074594
7-th component log probs | Train: 3.9176290981530144 | Val: 0.9864914576309146
8-th component log probs | Train: 3.9548335283839466 | Val: -1.0050659112315121
9-th component log probs | Train: 4.229608392941914 | Val: -4.969228024699491
KEYWORD NR_SAMPLES:6000 DIM:450 AVG_DIFF:33.2011
Fitting PCA...
0-th component log probs | Train: 4.363284316621147 | Val: -3.8642442675585493
1-th component log probs | Train: 3.8533919811161486 | Val: 2.1489052533836754
2-th component log probs | Train: 4.034092341281804 | Val: 1.03681368093185
3-th component log probs | Train: 4.070116388746955 | Val: -0.04529104134887706
4-th component log probs | Train: 4.248166284727861 | Val: -3.385811815197156
5-th component log probs | Train: 4.3072645399052725 | Val: -2.3196944857008917
6-th component log probs | Train: 4.109717178919487 | Val: -1.8523508638117638
7-th component log probs | Train: 4.022404983815485 | Val: 0.8497294255877696
8-th component log probs | Train: 4.073832731853888 | Val: -1.3950883490232502
9-th component log probs | Train: 4.351713397063788 | Val: -5.388033488299498
KEYWORD NR_SAMPLES:6000 DIM:500 AVG_DIFF:38.3311
0-th component log probs | Train: 4.393108439789632 | Val: -3.9289125715970017
1-th component log probs | Train: 3.8783865800250226 | Val: 2.136409089982079
2-th component log probs | Train: 4.060969928597485 | Val: 1.0072066840548295
3-th component log probs | Train: 4.096788324829862 | Val: -0.09061667117648127
4-th component log probs | Train: 4.277340992917457 | Val: -3.4276588417225824
5-th component log probs | Train: 4.333332446879052 | Val: -2.3151449792175183
6-th component log probs | Train: 4.140110645097524 | Val: -1.915166156589643
7-th component log probs | Train: 4.046990846647205 | Val: 0.8289435166472919
8-th component log probs | Train: 4.103354753484572 | Val: -1.434648759871254
9-th component log probs | Train: 4.379634049999568 | Val: -5.427623728827815
KEYWORD NR_SAMPLES:6000 DIM:512 AVG_DIFF:39.1161
best average differences at 50 dimensions: 0.06824658133031788
2022-01-08 01:34.36 [info     ] Training complete              train_loss=0.40127426385879517
2022-01-08 01:34.36 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:34.41 [info     ] Testing complete               test_loss=0.5434732437133789
{'dataset_size': 6000,
 'end_test_accuracy': 0.834280252456665,
 'end_test_loss': 0.5434732437133789,
 'end_train_accuracy': 0.9689162373542786,
 'end_train_loss': 0.40127426385879517,
 'end_val_accuracy': 0.8539384603500366,
 'end_val_loss': 0.6410937309265137}
2022-01-08 01:34.41 [info     ] Start Predict                  dataset=52606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:35.10 [info     ] Starting training              dataset=8000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
8000
Fitting PCA...
0-th component log probs | Train: 1.9862058232803848 | Val: 1.5285402590308286
1-th component log probs | Train: 1.9369151372704405 | Val: 1.4719489125661696
2-th component log probs | Train: 1.9250146888619013 | Val: 1.5706382275680377
3-th component log probs | Train: 1.9654984665029067 | Val: 1.239753044414433
4-th component log probs | Train: 2.0622430519207375 | Val: 1.4728680580325686
5-th component log probs | Train: 2.032790969742117 | Val: 1.476239349290221
6-th component log probs | Train: 2.002851197080871 | Val: 1.3127196792982427
7-th component log probs | Train: 2.001336663945521 | Val: 1.3786180823236096
8-th component log probs | Train: 1.9238509132104769 | Val: 1.2888701703958219
9-th component log probs | Train: 2.0499720080348505 | Val: 1.239368650638413
KEYWORD NR_SAMPLES:8000 DIM:50 AVG_DIFF:-1.0320
Fitting PCA...
0-th component log probs | Train: 2.512902025693103 | Val: 1.7495989790567965
1-th component log probs | Train: 2.456332597146644 | Val: 1.8523013377607005
2-th component log probs | Train: 2.4449289225567066 | Val: 1.9081804104367577
3-th component log probs | Train: 2.4874315072677318 | Val: 1.5175474454820703
4-th component log probs | Train: 2.6007987277925775 | Val: 1.6875385041242346
5-th component log probs | Train: 2.5625254947450995 | Val: 1.6668400592756243
6-th component log probs | Train: 2.521179686672893 | Val: 1.558943992831762
7-th component log probs | Train: 2.518340612639252 | Val: 1.6852123914169308
8-th component log probs | Train: 2.4464096806846873 | Val: 1.4681463441115514
9-th component log probs | Train: 2.5879266111990287 | Val: 1.4330735177282072
KEYWORD NR_SAMPLES:8000 DIM:100 AVG_DIFF:-0.8804
Fitting PCA...
0-th component log probs | Train: 2.8252940349007267 | Val: 1.8460470325013842
1-th component log probs | Train: 2.753313048063743 | Val: 2.075112319843603
2-th component log probs | Train: 2.7533546987230597 | Val: 2.1144617388656615
3-th component log probs | Train: 2.791597987738882 | Val: 1.7088312118251994
4-th component log probs | Train: 2.9124266857418863 | Val: 1.8729325139097865
5-th component log probs | Train: 2.874643713256285 | Val: 1.7874835558740216
6-th component log probs | Train: 2.8258786704502357 | Val: 1.6974998259471952
7-th component log probs | Train: 2.8173632453813746 | Val: 1.849209224161166
8-th component log probs | Train: 2.756069811214127 | Val: 1.634529613241707
9-th component log probs | Train: 2.8992064196514935 | Val: 1.506437493523316
KEYWORD NR_SAMPLES:8000 DIM:150 AVG_DIFF:-0.7422
Fitting PCA...
0-th component log probs | Train: 3.0687223480641794 | Val: 1.8308758186291838
1-th component log probs | Train: 2.9758376561974655 | Val: 2.2392532370349594
2-th component log probs | Train: 2.9867894467936407 | Val: 2.2616323671425342
3-th component log probs | Train: 3.0149171820850142 | Val: 1.8657841134176514
4-th component log probs | Train: 3.14413143509816 | Val: 1.9628973874049833
5-th component log probs | Train: 3.1059804713723786 | Val: 1.8667783405002778
6-th component log probs | Train: 3.058622608386355 | Val: 1.74437714843223
7-th component log probs | Train: 3.042231093556477 | Val: 1.9494467531152977
8-th component log probs | Train: 2.995085866262739 | Val: 1.7368293101248522
9-th component log probs | Train: 3.1381273633690467 | Val: 1.5275585710253348
KEYWORD NR_SAMPLES:8000 DIM:200 AVG_DIFF:-0.5035
Fitting PCA...
0-th component log probs | Train: 3.2752914177954446 | Val: 1.6869159558537619
1-th component log probs | Train: 3.1547942176591186 | Val: 2.3571750837487757
2-th component log probs | Train: 3.1724814092311076 | Val: 2.3271693152629167
3-th component log probs | Train: 3.1972296947015497 | Val: 1.9553938791933267
4-th component log probs | Train: 3.3302605296450634 | Val: 1.9846937433084115
5-th component log probs | Train: 3.2927194157349384 | Val: 1.8987639507436582
6-th component log probs | Train: 3.2481977350464084 | Val: 1.7088212187559297
7-th component log probs | Train: 3.22662615095234 | Val: 2.0098386921613645
8-th component log probs | Train: 3.1863365899587284 | Val: 1.7908055003710122
9-th component log probs | Train: 3.336215812550873 | Val: 1.4907222336683559
KEYWORD NR_SAMPLES:8000 DIM:250 AVG_DIFF:-0.0837
Fitting PCA...
0-th component log probs | Train: 3.4483421633300777 | Val: 1.4752137133401724
1-th component log probs | Train: 3.3005649469606264 | Val: 2.436193221580584
2-th component log probs | Train: 3.329469346856732 | Val: 2.349218003362114
3-th component log probs | Train: 3.3463940211798677 | Val: 1.9845477655937445
4-th component log probs | Train: 3.4845515304377397 | Val: 1.9497611072634211
5-th component log probs | Train: 3.448680609187553 | Val: 1.8701901028687564
6-th component log probs | Train: 3.4102431224252956 | Val: 1.6430370378237193
7-th component log probs | Train: 3.3798623733849276 | Val: 2.0079934190516724
8-th component log probs | Train: 3.342984789400822 | Val: 1.7799950748700357
9-th component log probs | Train: 3.4977456254656745 | Val: 1.3813941859520635
KEYWORD NR_SAMPLES:8000 DIM:300 AVG_DIFF:0.5352
Fitting PCA...
0-th component log probs | Train: 3.605173690425558 | Val: 1.1041323031709933
1-th component log probs | Train: 3.424624157894248 | Val: 2.4797607830257715
2-th component log probs | Train: 3.4623105312025175 | Val: 2.3423417483934603
3-th component log probs | Train: 3.472879892052893 | Val: 1.9847673654255156
4-th component log probs | Train: 3.6177093122788753 | Val: 1.8923224315579725
5-th component log probs | Train: 3.5844809219871823 | Val: 1.7912989635344907
6-th component log probs | Train: 3.549574363991595 | Val: 1.4870397308203707
7-th component log probs | Train: 3.511516057273496 | Val: 1.9784842859319565
8-th component log probs | Train: 3.478038288951596 | Val: 1.6804187813228044
9-th component log probs | Train: 3.6416514096022032 | Val: 1.152808963448066
KEYWORD NR_SAMPLES:8000 DIM:350 AVG_DIFF:1.4946
Fitting PCA...
0-th component log probs | Train: 3.7520841191538628 | Val: 0.6224484252789508
1-th component log probs | Train: 3.5354554697458096 | Val: 2.494017188087093
2-th component log probs | Train: 3.582304168888408 | Val: 2.2803290602610393
3-th component log probs | Train: 3.5874216052370786 | Val: 1.937783283850551
4-th component log probs | Train: 3.7388911529488142 | Val: 1.7970871638260688
5-th component log probs | Train: 3.7046688910480396 | Val: 1.6650148726228307
6-th component log probs | Train: 3.6752066584194356 | Val: 1.3038159119418973
7-th component log probs | Train: 3.6291580934837007 | Val: 1.8936795648721847
8-th component log probs | Train: 3.599142701092306 | Val: 1.5715220359476985
9-th component log probs | Train: 3.7700368076360284 | Val: 0.8456339003288538
KEYWORD NR_SAMPLES:8000 DIM:400 AVG_DIFF:2.8114
Fitting PCA...
0-th component log probs | Train: 3.889796330147291 | Val: 0.08630072957213747
1-th component log probs | Train: 3.636396471107184 | Val: 2.4885191335105437
2-th component log probs | Train: 3.6921014276847552 | Val: 2.1888589347969325
3-th component log probs | Train: 3.6903197081898322 | Val: 1.8839389132852706
4-th component log probs | Train: 3.8479997479039585 | Val: 1.6788438334286893
5-th component log probs | Train: 3.8166556390656448 | Val: 1.5274477496954082
6-th component log probs | Train: 3.7941756219661587 | Val: 1.0227432446701388
7-th component log probs | Train: 3.737193430644764 | Val: 1.7784050963594595
8-th component log probs | Train: 3.7116516477902177 | Val: 1.3801965845756805
9-th component log probs | Train: 3.888324875987794 | Val: 0.5575184153908403
KEYWORD NR_SAMPLES:8000 DIM:450 AVG_DIFF:4.4708
Fitting PCA...
0-th component log probs | Train: 4.021194405405876 | Val: -0.35642219054744584
1-th component log probs | Train: 3.7332187926012246 | Val: 2.4692413263693456
2-th component log probs | Train: 3.797919519475713 | Val: 2.083561781329763
3-th component log probs | Train: 3.787592516542588 | Val: 1.8216582741637808
4-th component log probs | Train: 3.9557097700899178 | Val: 1.5485116997116224
5-th component log probs | Train: 3.9243452438478386 | Val: 1.3684946122031976
6-th component log probs | Train: 3.9079760794194605 | Val: 0.7561654807867957
7-th component log probs | Train: 3.8424335367007316 | Val: 1.6434885728276378
8-th component log probs | Train: 3.82038220260321 | Val: 1.1857595829968175
9-th component log probs | Train: 4.000708917552417 | Val: 0.29892129898584735
KEYWORD NR_SAMPLES:8000 DIM:500 AVG_DIFF:6.2486
0-th component log probs | Train: 4.052158178784858 | Val: -0.4472155709419801
1-th component log probs | Train: 3.7572361290658995 | Val: 2.465963323136226
2-th component log probs | Train: 3.8234444815233233 | Val: 2.0653041775616106
3-th component log probs | Train: 3.811589684273805 | Val: 1.8138051754389546
4-th component log probs | Train: 3.982094516067156 | Val: 1.5266616881942425
5-th component log probs | Train: 3.950471879246023 | Val: 1.3534751260859905
6-th component log probs | Train: 3.9348537128656704 | Val: 0.6912386588602798
7-th component log probs | Train: 3.869020834631342 | Val: 1.6131057754451312
8-th component log probs | Train: 3.8476137085590074 | Val: 1.143496887852565
9-th component log probs | Train: 4.028135057274267 | Val: 0.25663221008618897
KEYWORD NR_SAMPLES:8000 DIM:512 AVG_DIFF:6.6432
best average differences at 50 dimensions: -1.0320173100590906
2022-01-08 01:41.36 [info     ] Training complete              train_loss=0.39946839213371277
2022-01-08 01:41.36 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:41.40 [info     ] Testing complete               test_loss=0.4894813597202301
{'dataset_size': 8000,
 'end_test_accuracy': 0.8502636551856995,
 'end_test_loss': 0.4894813597202301,
 'end_train_accuracy': 0.9578750133514404,
 'end_train_loss': 0.39946839213371277,
 'end_val_accuracy': 0.8689262270927429,
 'end_val_loss': 0.5984511971473694}
2022-01-08 01:41.40 [info     ] Start Predict                  dataset=50606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:42.09 [info     ] Starting training              dataset=10000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
10000
Fitting PCA...
0-th component log probs | Train: 2.2001377926773285 | Val: 1.3348719395429827
1-th component log probs | Train: 2.0191589215289314 | Val: 1.4272304395819386
2-th component log probs | Train: 2.1209249561108514 | Val: 1.621026376877123
3-th component log probs | Train: 2.0399156850042197 | Val: 0.8166002939471092
4-th component log probs | Train: 2.0677511286085735 | Val: 1.3015209494590483
5-th component log probs | Train: 2.054378141702893 | Val: 1.1515602721583793
6-th component log probs | Train: 2.105538677224655 | Val: 0.5945197218444125
7-th component log probs | Train: 2.059528635717192 | Val: 1.1919669772424484
8-th component log probs | Train: 2.083498652637839 | Val: 0.5340561366417098
9-th component log probs | Train: 2.1659371355202808 | Val: 1.1232838601297104
KEYWORD NR_SAMPLES:10000 DIM:50 AVG_DIFF:-0.0325
Fitting PCA...
0-th component log probs | Train: 2.7363599880979086 | Val: 1.3410895743695554
1-th component log probs | Train: 2.5511976852839697 | Val: 1.7375574640820641
2-th component log probs | Train: 2.6537403992866575 | Val: 1.6942011930762653
3-th component log probs | Train: 2.5514591529419564 | Val: 0.943071388101694
4-th component log probs | Train: 2.5921681839514115 | Val: 1.4709339676650406
5-th component log probs | Train: 2.577713232066235 | Val: 1.4173090446979832
6-th component log probs | Train: 2.629403264643908 | Val: 0.60197072271764
7-th component log probs | Train: 2.594466361079853 | Val: 1.3030741027024604
8-th component log probs | Train: 2.614254212763252 | Val: 0.27843460951056215
9-th component log probs | Train: 2.6994708761590984 | Val: 1.1118290566225446
KEYWORD NR_SAMPLES:10000 DIM:100 AVG_DIFF:1.0575
Fitting PCA...
0-th component log probs | Train: 3.0369587731320595 | Val: 1.392797624983567
1-th component log probs | Train: 2.830902432160667 | Val: 1.9828459147973325
2-th component log probs | Train: 2.942274718637965 | Val: 1.8953405098367002
3-th component log probs | Train: 2.83582360807008 | Val: 1.2813432082444711
4-th component log probs | Train: 2.882364955737261 | Val: 1.654471235742951
5-th component log probs | Train: 2.8560282202229623 | Val: 1.6227006299790807
6-th component log probs | Train: 2.9142451321415574 | Val: 0.8120369600228012
7-th component log probs | Train: 2.882958902154408 | Val: 1.4681576015986995
8-th component log probs | Train: 2.900323064415706 | Val: 0.3621140710384897
9-th component log probs | Train: 2.9914772478943017 | Val: 1.1753584382201747
KEYWORD NR_SAMPLES:10000 DIM:150 AVG_DIFF:1.2478
Fitting PCA...
0-th component log probs | Train: 3.2684377257789516 | Val: 1.305742534903365
1-th component log probs | Train: 3.040289971973062 | Val: 2.1329704916939414
2-th component log probs | Train: 3.1627668047625654 | Val: 1.9915968623285902
3-th component log probs | Train: 3.0496008169760427 | Val: 1.4917270522346409
4-th component log probs | Train: 3.098426347739602 | Val: 1.8505160332607686
5-th component log probs | Train: 3.0734434158638146 | Val: 1.711780373041788
6-th component log probs | Train: 3.130485139291532 | Val: 0.9118640743661011
7-th component log probs | Train: 3.0992587472434643 | Val: 1.5697623526131184
8-th component log probs | Train: 3.1248806309623407 | Val: 0.4457530162170613
9-th component log probs | Train: 3.220150682218865 | Val: 1.2378746980678896
KEYWORD NR_SAMPLES:10000 DIM:200 AVG_DIFF:1.5605
Fitting PCA...
0-th component log probs | Train: 3.4605483691726113 | Val: 1.1705388566278156
1-th component log probs | Train: 3.2159713846712945 | Val: 2.268744947426586
2-th component log probs | Train: 3.342041935874432 | Val: 2.0687679174116127
3-th component log probs | Train: 3.223919797451801 | Val: 1.6087426915639458
4-th component log probs | Train: 3.273836221676226 | Val: 1.9668843954847803
5-th component log probs | Train: 3.2503027796959123 | Val: 1.7594548891719546
6-th component log probs | Train: 3.308613208609657 | Val: 0.873183607254425
7-th component log probs | Train: 3.2791636651970135 | Val: 1.6503532930640266
8-th component log probs | Train: 3.3050323063874574 | Val: 0.46031537428203323
9-th component log probs | Train: 3.4051794822970076 | Val: 1.1791167912718616
KEYWORD NR_SAMPLES:10000 DIM:250 AVG_DIFF:2.0928
Fitting PCA...
0-th component log probs | Train: 3.6200207169299694 | Val: 0.986372003645583
1-th component log probs | Train: 3.3586463418573045 | Val: 2.364915296780614
2-th component log probs | Train: 3.4931401085620095 | Val: 2.0810786480669017
3-th component log probs | Train: 3.369849408042118 | Val: 1.6545338986239864
4-th component log probs | Train: 3.419188008531324 | Val: 2.005552173409425
5-th component log probs | Train: 3.3972808597435558 | Val: 1.777156104746544
6-th component log probs | Train: 3.4617613647185896 | Val: 0.8259043269959983
7-th component log probs | Train: 3.4289437174514195 | Val: 1.6941774617828265
8-th component log probs | Train: 3.4557019920068397 | Val: 0.3968336529910012
9-th component log probs | Train: 3.5616413430728566 | Val: 1.0822587005353357
KEYWORD NR_SAMPLES:10000 DIM:300 AVG_DIFF:2.8075
Fitting PCA...
0-th component log probs | Train: 3.761788113074092 | Val: 0.7446005012744957
1-th component log probs | Train: 3.4808591764084666 | Val: 2.426277161564003
2-th component log probs | Train: 3.622595632310722 | Val: 2.081119905487585
3-th component log probs | Train: 3.4925746560360698 | Val: 1.6766942632241062
4-th component log probs | Train: 3.543903128937751 | Val: 1.9783939077783184
5-th component log probs | Train: 3.5262640836769754 | Val: 1.7099457276675734
6-th component log probs | Train: 3.59561237661635 | Val: 0.6263518799726273
7-th component log probs | Train: 3.558783169738127 | Val: 1.66484196044725
8-th component log probs | Train: 3.585971077510783 | Val: 0.2958226373200853
9-th component log probs | Train: 3.6968385700657285 | Val: 0.8820955344002092
KEYWORD NR_SAMPLES:10000 DIM:350 AVG_DIFF:3.8704
Fitting PCA...
0-th component log probs | Train: 3.8876153147185875 | Val: 0.474976818355415
1-th component log probs | Train: 3.5906581872680636 | Val: 2.467982746708051
2-th component log probs | Train: 3.7394408157442296 | Val: 2.014370400461962
3-th component log probs | Train: 3.603116845993353 | Val: 1.656156074423046
4-th component log probs | Train: 3.654595088861775 | Val: 1.9440487144947631
5-th component log probs | Train: 3.641527228106892 | Val: 1.5914370615924944
6-th component log probs | Train: 3.717672239004305 | Val: 0.382616172640553
7-th component log probs | Train: 3.6738347370133346 | Val: 1.5958420869616818
8-th component log probs | Train: 3.703264217547972 | Val: 0.12779539301431833
9-th component log probs | Train: 3.816709270342214 | Val: 0.6829306275484507
KEYWORD NR_SAMPLES:10000 DIM:400 AVG_DIFF:5.1909
Fitting PCA...
0-th component log probs | Train: 4.002031363917787 | Val: 0.24611755234149127
1-th component log probs | Train: 3.6869552763991034 | Val: 2.486251876188953
2-th component log probs | Train: 3.8470213967983042 | Val: 1.9502065864672584
3-th component log probs | Train: 3.704266729764161 | Val: 1.5372686011369603
4-th component log probs | Train: 3.756764768435798 | Val: 1.8636836041463947
5-th component log probs | Train: 3.7459953030145283 | Val: 1.4616647367288391
6-th component log probs | Train: 3.8290714692217747 | Val: 0.07320196202315644
7-th component log probs | Train: 3.779042103724916 | Val: 1.479772307541828
8-th component log probs | Train: 3.81027194725365 | Val: -0.06313487895268885
9-th component log probs | Train: 3.927701634173388 | Val: 0.4944254667803109
KEYWORD NR_SAMPLES:10000 DIM:450 AVG_DIFF:6.7299
Fitting PCA...
0-th component log probs | Train: 4.107878355953665 | Val: 0.05946043970041039
1-th component log probs | Train: 3.780814598395013 | Val: 2.507421340417828
2-th component log probs | Train: 3.953597401215279 | Val: 1.8993460656079069
3-th component log probs | Train: 3.8047035901377875 | Val: 1.4511695533445697
4-th component log probs | Train: 3.8568222207080187 | Val: 1.7908373430894218
5-th component log probs | Train: 3.847229603147706 | Val: 1.362988671402197
6-th component log probs | Train: 3.9398918923900457 | Val: -0.18759021845637863
7-th component log probs | Train: 3.881417475031363 | Val: 1.4063041113226458
8-th component log probs | Train: 3.916398267275794 | Val: -0.3152414843624085
9-th component log probs | Train: 4.033688764669921 | Val: 0.3924026721706897
KEYWORD NR_SAMPLES:10000 DIM:500 AVG_DIFF:8.2171
0-th component log probs | Train: 4.1337385265914195 | Val: 0.04677608312058524
1-th component log probs | Train: 3.803660549304313 | Val: 2.5152911493819152
2-th component log probs | Train: 3.980518728992875 | Val: 1.8960369347320114
3-th component log probs | Train: 3.830264053721386 | Val: 1.425908229458578
4-th component log probs | Train: 3.8794994871776294 | Val: 1.7870898311802135
5-th component log probs | Train: 3.8711289288896893 | Val: 1.3448238554441219
6-th component log probs | Train: 3.9661075172230307 | Val: -0.2188190837244268
7-th component log probs | Train: 3.9053330171549265 | Val: 1.3978015586616162
8-th component log probs | Train: 3.940953452340856 | Val: -0.3650374988164305
9-th component log probs | Train: 4.0602888738773695 | Val: 0.39214933491647463
KEYWORD NR_SAMPLES:10000 DIM:512 AVG_DIFF:8.4826
best average differences at 50 dimensions: -0.03252452367260199
2022-01-08 01:50.30 [info     ] Training complete              train_loss=0.2607485055923462
2022-01-08 01:50.30 [info     ] Starting evaluating            dataset=26032
2022-01-08 01:50.34 [info     ] Testing complete               test_loss=0.4454997777938843
{'dataset_size': 10000,
 'end_test_accuracy': 0.8681408166885376,
 'end_test_loss': 0.4454997777938843,
 'end_train_accuracy': 0.9945262670516968,
 'end_train_loss': 0.2607485055923462,
 'end_val_accuracy': 0.903070867061615,
 'end_val_loss': 0.44975048303604126}
2022-01-08 01:50.34 [info     ] Start Predict                  dataset=48606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 01:51.09 [info     ] Starting training              dataset=20000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
20000
Fitting PCA...
0-th component log probs | Train: 2.056857673631655 | Val: 1.660117834611763
1-th component log probs | Train: 1.9979376343272635 | Val: 1.7206674545478096
2-th component log probs | Train: 1.9647232997024262 | Val: 1.725844272729477
3-th component log probs | Train: 1.9905454793661417 | Val: 1.3874863522735992
4-th component log probs | Train: 2.028635141301693 | Val: 1.706531749232025
5-th component log probs | Train: 2.10443081745883 | Val: 1.4829933355386766
6-th component log probs | Train: 2.040618459695532 | Val: 1.3332909201731562
7-th component log probs | Train: 2.117479804076851 | Val: 1.4966767118958697
8-th component log probs | Train: 1.963523182759899 | Val: 1.3182898116837698
9-th component log probs | Train: 2.097105729569785 | Val: 1.49527693224249
KEYWORD NR_SAMPLES:20000 DIM:50 AVG_DIFF:-1.2518
Fitting PCA...
0-th component log probs | Train: 2.5996014595288646 | Val: 2.0548640468675003
1-th component log probs | Train: 2.560597970239678 | Val: 2.2318312098898656
2-th component log probs | Train: 2.5194495783149247 | Val: 2.186998434541339
3-th component log probs | Train: 2.5426951039932897 | Val: 1.7741796503998701
4-th component log probs | Train: 2.5528490292221684 | Val: 2.124827864612555
5-th component log probs | Train: 2.6664075508186156 | Val: 1.8532276994853223
6-th component log probs | Train: 2.5964896064973155 | Val: 1.7830521651463103
7-th component log probs | Train: 2.691900290961698 | Val: 1.729702681311138
8-th component log probs | Train: 2.4962931273180375 | Val: 1.5492197725020176
9-th component log probs | Train: 2.637802691322867 | Val: 1.793857165364171
KEYWORD NR_SAMPLES:20000 DIM:100 AVG_DIFF:-1.3935
Fitting PCA...
0-th component log probs | Train: 2.884087037157647 | Val: 2.3264233921866393
1-th component log probs | Train: 2.8528463430116 | Val: 2.5278574015558477
2-th component log probs | Train: 2.8105415345442344 | Val: 2.4589059634187773
3-th component log probs | Train: 2.8234726860822947 | Val: 2.0585287457497072
4-th component log probs | Train: 2.844697048598951 | Val: 2.378232709305247
5-th component log probs | Train: 2.952674765881367 | Val: 2.1468072295098994
6-th component log probs | Train: 2.884149766736628 | Val: 2.070548568461768
7-th component log probs | Train: 2.9937089937662673 | Val: 2.008540240954483
8-th component log probs | Train: 2.7822784617460368 | Val: 1.7868064173041356
9-th component log probs | Train: 2.914705422356093 | Val: 2.0256976909287023
KEYWORD NR_SAMPLES:20000 DIM:150 AVG_DIFF:-1.6382
Fitting PCA...
0-th component log probs | Train: 3.0999396894329765 | Val: 2.5222385296605982
1-th component log probs | Train: 3.0734603170488026 | Val: 2.74145400197865
2-th component log probs | Train: 3.0290485375098433 | Val: 2.6688813548045185
3-th component log probs | Train: 3.039142525590093 | Val: 2.276267781206279
4-th component log probs | Train: 3.0670950481645276 | Val: 2.5709953156404115
5-th component log probs | Train: 3.170498983650804 | Val: 2.3116904580893918
6-th component log probs | Train: 3.099745830769835 | Val: 2.2976519701061573
7-th component log probs | Train: 3.2196018051540283 | Val: 2.1472249734022633
8-th component log probs | Train: 3.0035178321821547 | Val: 1.9622551521741642
9-th component log probs | Train: 3.1304279832530466 | Val: 2.228133280264565
KEYWORD NR_SAMPLES:20000 DIM:200 AVG_DIFF:-1.7896
Fitting PCA...
0-th component log probs | Train: 3.2812428959561726 | Val: 2.670912443280789
1-th component log probs | Train: 3.254283983923164 | Val: 2.9077659398919007
2-th component log probs | Train: 3.2117532504381177 | Val: 2.81568324103251
3-th component log probs | Train: 3.218164987032973 | Val: 2.4396235251961955
4-th component log probs | Train: 3.2501831885181187 | Val: 2.718865491803752
5-th component log probs | Train: 3.3545330842248613 | Val: 2.437282440907949
6-th component log probs | Train: 3.279947473232854 | Val: 2.439932058257164
7-th component log probs | Train: 3.407256260251635 | Val: 2.2478213747765707
8-th component log probs | Train: 3.1850341704525795 | Val: 2.1135536755925224
9-th component log probs | Train: 3.3120500926766865 | Val: 2.382184326472758
KEYWORD NR_SAMPLES:20000 DIM:250 AVG_DIFF:-1.8732
Fitting PCA...
0-th component log probs | Train: 3.4344014551415376 | Val: 2.78615940961224
1-th component log probs | Train: 3.4058299728479904 | Val: 3.039906501935397
2-th component log probs | Train: 3.363079447928612 | Val: 2.925825672807854
3-th component log probs | Train: 3.367456504829233 | Val: 2.569838314201455
4-th component log probs | Train: 3.402738153632645 | Val: 2.8236792910482342
5-th component log probs | Train: 3.508241409628908 | Val: 2.5283544769062494
6-th component log probs | Train: 3.4288649769244457 | Val: 2.5575537688324186
7-th component log probs | Train: 3.5650624705506506 | Val: 2.300852246010172
8-th component log probs | Train: 3.3385723352412295 | Val: 2.2123130049616306
9-th component log probs | Train: 3.464402695969848 | Val: 2.475509227894393
KEYWORD NR_SAMPLES:20000 DIM:300 AVG_DIFF:-1.8939
Fitting PCA...
0-th component log probs | Train: 3.56504015710352 | Val: 2.871225886335426
1-th component log probs | Train: 3.5328344105963883 | Val: 3.1392717893024678
2-th component log probs | Train: 3.491707164050348 | Val: 3.011230750475572
3-th component log probs | Train: 3.4937791331557473 | Val: 2.6648643543182735
4-th component log probs | Train: 3.5324118881451096 | Val: 2.8976607701174375
5-th component log probs | Train: 3.6387685841483624 | Val: 2.6013588266704795
6-th component log probs | Train: 3.5579456614722664 | Val: 2.6256708344049025
7-th component log probs | Train: 3.6966210608742562 | Val: 2.3287520358597424
8-th component log probs | Train: 3.469804678753147 | Val: 2.2787426637094814
9-th component log probs | Train: 3.5939494978042723 | Val: 2.5533843677890418
KEYWORD NR_SAMPLES:20000 DIM:350 AVG_DIFF:-1.8697
Fitting PCA...
0-th component log probs | Train: 3.6802290832334656 | Val: 2.925394664076533
1-th component log probs | Train: 3.6440896847091286 | Val: 3.2205895578214525
2-th component log probs | Train: 3.603302450858343 | Val: 3.0857956503076345
3-th component log probs | Train: 3.605457329293619 | Val: 2.7266871771607786
4-th component log probs | Train: 3.6462642239733363 | Val: 2.949343773872352
5-th component log probs | Train: 3.75309180670484 | Val: 2.6551204515575653
6-th component log probs | Train: 3.670364228619085 | Val: 2.6557408600564094
7-th component log probs | Train: 3.8152575418305505 | Val: 2.3214764281870703
8-th component log probs | Train: 3.58463396935427 | Val: 2.3147809356652034
9-th component log probs | Train: 3.7096614402911947 | Val: 2.6178421121646003
KEYWORD NR_SAMPLES:20000 DIM:400 AVG_DIFF:-1.7927
Fitting PCA...
0-th component log probs | Train: 3.7860480282962903 | Val: 2.9734147252865855
1-th component log probs | Train: 3.7443015605664507 | Val: 3.279649751399191
2-th component log probs | Train: 3.7056752852350328 | Val: 3.14803786575901
3-th component log probs | Train: 3.7063839962199694 | Val: 2.7737007086383363
4-th component log probs | Train: 3.7494547200119746 | Val: 2.9824101137446637
5-th component log probs | Train: 3.8595955636453985 | Val: 2.6791925207362155
6-th component log probs | Train: 3.773796438388432 | Val: 2.685892081014395
7-th component log probs | Train: 3.9235166070955305 | Val: 2.3050749273780466
8-th component log probs | Train: 3.68764048151611 | Val: 2.2990311222981497
9-th component log probs | Train: 3.8157198982012916 | Val: 2.652712324606137
KEYWORD NR_SAMPLES:20000 DIM:450 AVG_DIFF:-1.6657
Fitting PCA...
0-th component log probs | Train: 3.887241653867414 | Val: 3.0279159394667357
1-th component log probs | Train: 3.838987888318008 | Val: 3.3476462089354047
2-th component log probs | Train: 3.809042797495588 | Val: 3.2163228524414995
3-th component log probs | Train: 3.806739820777606 | Val: 2.8113178893805166
4-th component log probs | Train: 3.8476631890795283 | Val: 3.036347088007399
5-th component log probs | Train: 3.9625212772413763 | Val: 2.721033886659541
6-th component log probs | Train: 3.875657040433689 | Val: 2.7246559192338804
7-th component log probs | Train: 4.027092580339553 | Val: 2.3225228233580557
8-th component log probs | Train: 3.7888546845966324 | Val: 2.307449908414138
9-th component log probs | Train: 3.9178479335483485 | Val: 2.7028306606564203
KEYWORD NR_SAMPLES:20000 DIM:500 AVG_DIFF:-1.5795
0-th component log probs | Train: 3.9110585487292706 | Val: 3.0474364109817014
1-th component log probs | Train: 3.8633280608710336 | Val: 3.3698663444251302
2-th component log probs | Train: 3.8349969480367228 | Val: 3.239807073194137
3-th component log probs | Train: 3.831186766183034 | Val: 2.831687107800732
4-th component log probs | Train: 3.8726859535438645 | Val: 3.0545942499309047
5-th component log probs | Train: 3.9850567849110785 | Val: 2.7487982167466742
6-th component log probs | Train: 3.9001680824840226 | Val: 2.746256833644264
7-th component log probs | Train: 4.0506350396368695 | Val: 2.3460379359939894
8-th component log probs | Train: 3.8131590704569884 | Val: 2.3295317788246237
9-th component log probs | Train: 3.9424986119191145 | Val: 2.7269548433476607
KEYWORD NR_SAMPLES:20000 DIM:512 AVG_DIFF:-1.5985
best average differences at 300 dimensions: -1.893921988549383
2022-01-08 02:04.43 [info     ] Training complete              train_loss=0.33494532108306885
2022-01-08 02:04.43 [info     ] Starting evaluating            dataset=26032
2022-01-08 02:04.46 [info     ] Testing complete               test_loss=0.31578773260116577
{'dataset_size': 20000,
 'end_test_accuracy': 0.9051494002342224,
 'end_test_loss': 0.31578773260116577,
 'end_train_accuracy': 0.9675019979476929,
 'end_train_loss': 0.33494532108306885,
 'end_val_accuracy': 0.9124301671981812,
 'end_val_loss': 0.4069836139678955}
2022-01-08 02:04.47 [info     ] Start Predict                  dataset=38606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 02:05.27 [info     ] Starting training              dataset=30000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
30000
Fitting PCA...
0-th component log probs | Train: 2.1013833975014915 | Val: 1.6529479477298499
1-th component log probs | Train: 1.8818044942915357 | Val: 1.721151776162823
2-th component log probs | Train: 1.8437540275135875 | Val: 1.6376806442722085
3-th component log probs | Train: 1.990321135667443 | Val: 1.4390840920265187
4-th component log probs | Train: 1.859123546243734 | Val: 1.5567070997059285
5-th component log probs | Train: 1.9491498831929104 | Val: 1.5180407700515803
6-th component log probs | Train: 1.8961090200808004 | Val: 1.4411231776937439
7-th component log probs | Train: 2.0391255964844714 | Val: 1.556159348655409
8-th component log probs | Train: 1.9452663103025578 | Val: 1.370404455477482
9-th component log probs | Train: 2.0359780915802017 | Val: 1.4655069048571678
KEYWORD NR_SAMPLES:30000 DIM:50 AVG_DIFF:-1.3412
Fitting PCA...
0-th component log probs | Train: 2.684114868654594 | Val: 2.0507059817399256
1-th component log probs | Train: 2.4308503910051975 | Val: 2.245522205398473
2-th component log probs | Train: 2.402966755551138 | Val: 2.147706480179339
3-th component log probs | Train: 2.5693735290403055 | Val: 1.8801385312870518
4-th component log probs | Train: 2.424295351070824 | Val: 2.047092219107334
5-th component log probs | Train: 2.5179016668238035 | Val: 1.9910309173879333
6-th component log probs | Train: 2.467003710739843 | Val: 1.9223147113184889
7-th component log probs | Train: 2.6134522759636036 | Val: 2.054765607057706
8-th component log probs | Train: 2.510588196435475 | Val: 1.7901507075831666
9-th component log probs | Train: 2.610348023533959 | Val: 1.8250960407528813
KEYWORD NR_SAMPLES:30000 DIM:100 AVG_DIFF:-1.6814
Fitting PCA...
0-th component log probs | Train: 2.957090899184665 | Val: 2.3111555820483685
1-th component log probs | Train: 2.7077733180350756 | Val: 2.5294696506082888
2-th component log probs | Train: 2.6859625004988756 | Val: 2.4319213238847985
3-th component log probs | Train: 2.8496094293889436 | Val: 2.1741409248925794
4-th component log probs | Train: 2.702989422687667 | Val: 2.330779718783626
5-th component log probs | Train: 2.7843816031266737 | Val: 2.2683674757451655
6-th component log probs | Train: 2.7412253165095612 | Val: 2.1959321835062315
7-th component log probs | Train: 2.8881232410033326 | Val: 2.334054139908376
8-th component log probs | Train: 2.792890315333542 | Val: 2.04462712301961
9-th component log probs | Train: 2.8805080276042445 | Val: 2.066544564857299
KEYWORD NR_SAMPLES:30000 DIM:150 AVG_DIFF:-1.9486
Fitting PCA...
0-th component log probs | Train: 3.152052790848743 | Val: 2.5094525057704997
1-th component log probs | Train: 2.9084249303028704 | Val: 2.727205001761458
2-th component log probs | Train: 2.8872082023082584 | Val: 2.633831689561151
3-th component log probs | Train: 3.050038546632477 | Val: 2.3513485767184177
4-th component log probs | Train: 2.904813874176625 | Val: 2.5461709503679013
5-th component log probs | Train: 2.9794478576276 | Val: 2.467292990775663
6-th component log probs | Train: 2.9380644568659022 | Val: 2.370997698220043
7-th component log probs | Train: 3.0894235657847364 | Val: 2.5241577384320006
8-th component log probs | Train: 2.997501488074875 | Val: 2.2276750375043566
9-th component log probs | Train: 3.075404671864099 | Val: 2.251678328633
KEYWORD NR_SAMPLES:30000 DIM:200 AVG_DIFF:-2.1308
Fitting PCA...
0-th component log probs | Train: 3.3175259993855426 | Val: 2.6550822714315307
1-th component log probs | Train: 3.078473298139814 | Val: 2.881752873593374
2-th component log probs | Train: 3.0539473058438924 | Val: 2.7973625624538543
3-th component log probs | Train: 3.2156927457335236 | Val: 2.5080266232318738
4-th component log probs | Train: 3.071657628070932 | Val: 2.7115227509178013
5-th component log probs | Train: 3.1437514050847226 | Val: 2.6175172221012013
6-th component log probs | Train: 3.103184374969204 | Val: 2.5313702773119564
7-th component log probs | Train: 3.2581932338413004 | Val: 2.6654186350702336
8-th component log probs | Train: 3.1682398505393445 | Val: 2.3685359051339505
9-th component log probs | Train: 3.243734540949764 | Val: 2.379289275536207
KEYWORD NR_SAMPLES:30000 DIM:250 AVG_DIFF:-2.2600
Fitting PCA...
0-th component log probs | Train: 3.4615761082909593 | Val: 2.7784523212963643
1-th component log probs | Train: 3.223341524985852 | Val: 3.011855473113207
2-th component log probs | Train: 3.195869594996419 | Val: 2.9282923547114144
3-th component log probs | Train: 3.3623132442998362 | Val: 2.602078790188032
4-th component log probs | Train: 3.215018500759637 | Val: 2.8451804167694594
5-th component log probs | Train: 3.286766983563515 | Val: 2.7469413445358613
6-th component log probs | Train: 3.247398167697582 | Val: 2.645382709842724
7-th component log probs | Train: 3.4052594436904373 | Val: 2.780650215391048
8-th component log probs | Train: 3.3178337487751914 | Val: 2.4529742279797095
9-th component log probs | Train: 3.388867018579423 | Val: 2.4910737353139365
KEYWORD NR_SAMPLES:30000 DIM:300 AVG_DIFF:-2.3387
Fitting PCA...
0-th component log probs | Train: 3.587062594308084 | Val: 2.873750181315396
1-th component log probs | Train: 3.3496954295538584 | Val: 3.121088182894171
2-th component log probs | Train: 3.3196979962691042 | Val: 3.039693997099712
3-th component log probs | Train: 3.4900908557123924 | Val: 2.6832523454435453
4-th component log probs | Train: 3.339796434182597 | Val: 2.9581720353264367
5-th component log probs | Train: 3.412638420303947 | Val: 2.8454460502745604
6-th component log probs | Train: 3.3737095322177386 | Val: 2.734765038749072
7-th component log probs | Train: 3.5333030022969503 | Val: 2.8618663762610934
8-th component log probs | Train: 3.4483849202784023 | Val: 2.5286761855761104
9-th component log probs | Train: 3.5183166853037013 | Val: 2.561546530050337
KEYWORD NR_SAMPLES:30000 DIM:350 AVG_DIFF:-2.3830
Fitting PCA...
0-th component log probs | Train: 3.6983049157740666 | Val: 2.9515634970918785
1-th component log probs | Train: 3.460747748780323 | Val: 3.215640818385919
2-th component log probs | Train: 3.4293654025585925 | Val: 3.1365655407982036
3-th component log probs | Train: 3.6042883911098875 | Val: 2.750852516977149
4-th component log probs | Train: 3.4504197017687397 | Val: 3.0467494319233164
5-th component log probs | Train: 3.525789543898116 | Val: 2.925818782552619
6-th component log probs | Train: 3.484993635952051 | Val: 2.7981658612868996
7-th component log probs | Train: 3.646316047560214 | Val: 2.945677765947646
8-th component log probs | Train: 3.562802764343046 | Val: 2.590391431366277
9-th component log probs | Train: 3.6325941385383778 | Val: 2.604981696086872
KEYWORD NR_SAMPLES:30000 DIM:400 AVG_DIFF:-2.4048
Fitting PCA...
0-th component log probs | Train: 3.798874053653898 | Val: 3.022877573554925
1-th component log probs | Train: 3.5613708661780774 | Val: 3.299272980056251
2-th component log probs | Train: 3.5283353038090497 | Val: 3.221339047871473
3-th component log probs | Train: 3.7083969096479006 | Val: 2.8057514989631422
4-th component log probs | Train: 3.552918241627037 | Val: 3.1192582497065025
5-th component log probs | Train: 3.6301526789571166 | Val: 2.987132014272545
6-th component log probs | Train: 3.586666624670153 | Val: 2.858689965362669
7-th component log probs | Train: 3.7476354210018434 | Val: 3.0144458602301407
8-th component log probs | Train: 3.667854962912242 | Val: 2.62158041358027
9-th component log probs | Train: 3.739287924483228 | Val: 2.6532841276048176
KEYWORD NR_SAMPLES:30000 DIM:450 AVG_DIFF:-2.4081
Fitting PCA...
0-th component log probs | Train: 3.897833044850133 | Val: 3.1201471939791627
1-th component log probs | Train: 3.6641927444694935 | Val: 3.3845420763572975
2-th component log probs | Train: 3.627708420636429 | Val: 3.3120818795599685
3-th component log probs | Train: 3.8090971996642877 | Val: 2.8933231328319557
4-th component log probs | Train: 3.6544056286427944 | Val: 3.2073978685259505
5-th component log probs | Train: 3.733509890820416 | Val: 3.082446837009729
6-th component log probs | Train: 3.6888464698982566 | Val: 2.9533154188593254
7-th component log probs | Train: 3.8477585254148914 | Val: 3.1033715137064415
8-th component log probs | Train: 3.771078496494674 | Val: 2.6968472073920973
9-th component log probs | Train: 3.839722672750842 | Val: 2.7519548027739904
KEYWORD NR_SAMPLES:30000 DIM:500 AVG_DIFF:-2.4828
0-th component log probs | Train: 3.9247012314762033 | Val: 3.1563046338953433
1-th component log probs | Train: 3.694771952711843 | Val: 3.4163727969477877
2-th component log probs | Train: 3.6588381308217834 | Val: 3.3459082842300023
3-th component log probs | Train: 3.8374788900164245 | Val: 2.9326256731956053
4-th component log probs | Train: 3.683893787434653 | Val: 3.2415284205769948
5-th component log probs | Train: 3.763102024457625 | Val: 3.1194632859721274
6-th component log probs | Train: 3.719012872742559 | Val: 2.9914153065016245
7-th component log probs | Train: 3.8755704091528194 | Val: 3.1370166561673587
8-th component log probs | Train: 3.8004276402748185 | Val: 2.7371870851977587
9-th component log probs | Train: 3.8676920012764193 | Val: 2.7941234707420417
KEYWORD NR_SAMPLES:30000 DIM:512 AVG_DIFF:-2.5319
best average differences at 512 dimensions: -2.5319474083806455
2022-01-08 02:24.55 [info     ] Training complete              train_loss=0.3172425329685211
2022-01-08 02:24.55 [info     ] Starting evaluating            dataset=26032
2022-01-08 02:24.59 [info     ] Testing complete               test_loss=0.2934683859348297
{'dataset_size': 30000,
 'end_test_accuracy': 0.9147216081619263,
 'end_test_loss': 0.2934683859348297,
 'end_train_accuracy': 0.9683058261871338,
 'end_train_loss': 0.3172425329685211,
 'end_val_accuracy': 0.910718560218811,
 'end_val_loss': 0.3733985722064972}
2022-01-08 02:24.59 [info     ] Start Predict                  dataset=28606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 02:25.42 [info     ] Starting training              dataset=40000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
40000
Fitting PCA...
0-th component log probs | Train: 2.0525192232076943 | Val: 1.6952380712377983
1-th component log probs | Train: 1.9486260835374252 | Val: 1.7457111999960941
2-th component log probs | Train: 1.8256692980168678 | Val: 1.4967899730818413
3-th component log probs | Train: 1.8871548049941695 | Val: 1.5171128728337513
4-th component log probs | Train: 1.9581618971134278 | Val: 1.612786191864806
5-th component log probs | Train: 1.992609310412992 | Val: 1.4277749755186115
6-th component log probs | Train: 2.0182373451725346 | Val: 1.5650378547348096
7-th component log probs | Train: 1.9102564567869251 | Val: 1.5322610861958486
8-th component log probs | Train: 2.030412649635643 | Val: 1.3075879818519638
9-th component log probs | Train: 2.030449108413491 | Val: 1.4305307287399525
KEYWORD NR_SAMPLES:40000 DIM:50 AVG_DIFF:-1.3248
Fitting PCA...
0-th component log probs | Train: 2.637512059866552 | Val: 2.129916404916045
1-th component log probs | Train: 2.5498722711747677 | Val: 2.2905604412907596
2-th component log probs | Train: 2.4391154333739564 | Val: 2.050224808521736
3-th component log probs | Train: 2.503238931213683 | Val: 2.0325594766118433
4-th component log probs | Train: 2.5463635027524827 | Val: 2.0963526355554882
5-th component log probs | Train: 2.5842321307473193 | Val: 1.986942222187157
6-th component log probs | Train: 2.6151768158341993 | Val: 2.0349900348145358
7-th component log probs | Train: 2.5013835311458226 | Val: 2.069862988567224
8-th component log probs | Train: 2.622071765762995 | Val: 1.667098273501465
9-th component log probs | Train: 2.609215498897706 | Val: 1.8178785781866724
KEYWORD NR_SAMPLES:40000 DIM:100 AVG_DIFF:-1.6858
Fitting PCA...
0-th component log probs | Train: 2.9148980506615065 | Val: 2.412799142319974
1-th component log probs | Train: 2.8404135535922803 | Val: 2.598824603942329
2-th component log probs | Train: 2.731131022832198 | Val: 2.3621251258868967
3-th component log probs | Train: 2.7944506370456557 | Val: 2.3333481342864184
4-th component log probs | Train: 2.8281520262941093 | Val: 2.4014013547500785
5-th component log probs | Train: 2.8671421143955285 | Val: 2.304766855881509
6-th component log probs | Train: 2.9039549410581156 | Val: 2.3152606395923705
7-th component log probs | Train: 2.792442397892176 | Val: 2.3753767300172073
8-th component log probs | Train: 2.9106755961088115 | Val: 1.970687542786723
9-th component log probs | Train: 2.8889330106781066 | Val: 2.1308882499094293
KEYWORD NR_SAMPLES:40000 DIM:150 AVG_DIFF:-2.0069
Fitting PCA...
0-th component log probs | Train: 3.111457040851896 | Val: 2.5925755110034756
1-th component log probs | Train: 3.0485743804517678 | Val: 2.8165366833731675
2-th component log probs | Train: 2.9385488325011395 | Val: 2.575951194886439
3-th component log probs | Train: 3.005504935397539 | Val: 2.545580344776709
4-th component log probs | Train: 3.032179124527325 | Val: 2.612261173829375
5-th component log probs | Train: 3.0672466877655973 | Val: 2.5065830216848357
6-th component log probs | Train: 3.1124273494211416 | Val: 2.504024605208995
7-th component log probs | Train: 3.0028230114450634 | Val: 2.582144996675433
8-th component log probs | Train: 3.1202651006913356 | Val: 2.1433445870575594
9-th component log probs | Train: 3.088414374382207 | Val: 2.332173374912831
KEYWORD NR_SAMPLES:40000 DIM:200 AVG_DIFF:-2.1981
Fitting PCA...
0-th component log probs | Train: 3.2770535239444887 | Val: 2.7427292095386
1-th component log probs | Train: 3.2188020014535668 | Val: 2.9900068018426116
2-th component log probs | Train: 3.1045408370791767 | Val: 2.752662327693027
3-th component log probs | Train: 3.1786779292810357 | Val: 2.716176629632518
4-th component log probs | Train: 3.2004465115547296 | Val: 2.7776947010950064
5-th component log probs | Train: 3.2364936700228104 | Val: 2.6757882529274726
6-th component log probs | Train: 3.281744163378658 | Val: 2.624591451027421
7-th component log probs | Train: 3.174456542650012 | Val: 2.7519928998340375
8-th component log probs | Train: 3.293998541349164 | Val: 2.262940281727668
9-th component log probs | Train: 3.254876905889568 | Val: 2.48758081633015
KEYWORD NR_SAMPLES:40000 DIM:250 AVG_DIFF:-2.3351
Fitting PCA...
0-th component log probs | Train: 3.422562771885765 | Val: 2.861158300173999
1-th component log probs | Train: 3.365724747814996 | Val: 3.1289041196418075
2-th component log probs | Train: 3.249356719219206 | Val: 2.897532536187332
3-th component log probs | Train: 3.3294520530930116 | Val: 2.8487914342689145
4-th component log probs | Train: 3.3460222846811423 | Val: 2.9048353987644444
5-th component log probs | Train: 3.3833712418561634 | Val: 2.816592230134552
6-th component log probs | Train: 3.4306992877008717 | Val: 2.729697075166167
7-th component log probs | Train: 3.3223522537252124 | Val: 2.8887084204528364
8-th component log probs | Train: 3.4474094128401913 | Val: 2.3473218106058944
9-th component log probs | Train: 3.40063979834309 | Val: 2.617021781857875
KEYWORD NR_SAMPLES:40000 DIM:300 AVG_DIFF:-2.4295
Fitting PCA...
0-th component log probs | Train: 3.550498019665766 | Val: 2.965038447775879
1-th component log probs | Train: 3.495801941136106 | Val: 3.2467161428501767
2-th component log probs | Train: 3.3743167550210567 | Val: 3.0200802638115745
3-th component log probs | Train: 3.4617113575219562 | Val: 2.957101619962143
4-th component log probs | Train: 3.4728905460874637 | Val: 3.0073775302708574
5-th component log probs | Train: 3.513187348120968 | Val: 2.928796793761562
6-th component log probs | Train: 3.560842439394323 | Val: 2.8192981797802648
7-th component log probs | Train: 3.452648562629634 | Val: 2.9974597927526188
8-th component log probs | Train: 3.5807373837012206 | Val: 2.4011506772979527
9-th component log probs | Train: 3.5307567157985607 | Val: 2.7172737373982434
KEYWORD NR_SAMPLES:40000 DIM:350 AVG_DIFF:-2.4907
Fitting PCA...
0-th component log probs | Train: 3.6665453538000197 | Val: 3.052835657287988
1-th component log probs | Train: 3.6109735716007774 | Val: 3.3488997309288213
2-th component log probs | Train: 3.487962423200508 | Val: 3.131752913773817
3-th component log probs | Train: 3.580583082734308 | Val: 3.052239753471481
4-th component log probs | Train: 3.585501064369166 | Val: 3.10146454981038
5-th component log probs | Train: 3.630216999611831 | Val: 3.0124135930268614
6-th component log probs | Train: 3.678585487082086 | Val: 2.89202278774678
7-th component log probs | Train: 3.5703954531999917 | Val: 3.094360022756558
8-th component log probs | Train: 3.701265860588414 | Val: 2.4563442441233176
9-th component log probs | Train: 3.6473472735386316 | Val: 2.8030230870642394
KEYWORD NR_SAMPLES:40000 DIM:400 AVG_DIFF:-2.5370
Fitting PCA...
0-th component log probs | Train: 3.775200476046225 | Val: 3.137904236597792
1-th component log probs | Train: 3.7194578357238646 | Val: 3.4472543677828194
2-th component log probs | Train: 3.592044064774363 | Val: 3.2349947494850664
3-th component log probs | Train: 3.6919607867806143 | Val: 3.139225243787042
4-th component log probs | Train: 3.688479277656481 | Val: 3.1833616482033196
5-th component log probs | Train: 3.737506529594266 | Val: 3.0980295277688628
6-th component log probs | Train: 3.787600494112699 | Val: 2.960730714758006
7-th component log probs | Train: 3.678611577632788 | Val: 3.187812563733848
8-th component log probs | Train: 3.8134939740747544 | Val: 2.4980299370274617
9-th component log probs | Train: 3.7566651713692587 | Val: 2.875251004227582
KEYWORD NR_SAMPLES:40000 DIM:450 AVG_DIFF:-2.5753
Fitting PCA...
0-th component log probs | Train: 3.8864089881998845 | Val: 3.2544513968907456
1-th component log probs | Train: 3.8335140797373266 | Val: 3.5596762411734746
2-th component log probs | Train: 3.6999230200018096 | Val: 3.3550527099795597
3-th component log probs | Train: 3.8066776522054586 | Val: 3.2540849482684693
4-th component log probs | Train: 3.793629814147029 | Val: 3.3014235364269147
5-th component log probs | Train: 3.849615498150416 | Val: 3.20957314821014
6-th component log probs | Train: 3.900795363472721 | Val: 3.0784551790179018
7-th component log probs | Train: 3.794911183270739 | Val: 3.2993040765439003
8-th component log probs | Train: 3.924682018869722 | Val: 2.618825715105827
9-th component log probs | Train: 3.867891215112033 | Val: 2.9911953509007656
KEYWORD NR_SAMPLES:40000 DIM:500 AVG_DIFF:-2.6976
0-th component log probs | Train: 3.920651205358755 | Val: 3.29804721496798
1-th component log probs | Train: 3.8695839950252813 | Val: 3.5992717766517686
2-th component log probs | Train: 3.7366757090294027 | Val: 3.3971274028111504
3-th component log probs | Train: 3.842605234744198 | Val: 3.298706750341417
4-th component log probs | Train: 3.8292993456052096 | Val: 3.3444655212647425
5-th component log probs | Train: 3.884914446648855 | Val: 3.2553720121599947
6-th component log probs | Train: 3.9359677313957753 | Val: 3.126595859238854
7-th component log probs | Train: 3.830531616353481 | Val: 3.341108849170154
8-th component log probs | Train: 3.959103748801736 | Val: 2.673824247967538
9-th component log probs | Train: 3.9032203482615424 | Val: 3.0407508807121126
KEYWORD NR_SAMPLES:40000 DIM:512 AVG_DIFF:-2.7582
best average differences at 512 dimensions: -2.7581645513199304
2022-01-08 02:50.11 [info     ] Training complete              train_loss=0.29947778582572937
2022-01-08 02:50.11 [info     ] Starting evaluating            dataset=26032
2022-01-08 02:50.15 [info     ] Testing complete               test_loss=0.285925030708313
{'dataset_size': 40000,
 'end_test_accuracy': 0.9157708883285522,
 'end_test_loss': 0.285925030708313,
 'end_train_accuracy': 0.9686999917030334,
 'end_train_loss': 0.29947778582572937,
 'end_val_accuracy': 0.9202709794044495,
 'end_val_loss': 0.33788758516311646}
2022-01-08 02:50.15 [info     ] Start Predict                  dataset=18606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 02:50.54 [info     ] Starting training              dataset=50000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
50000
Fitting PCA...
0-th component log probs | Train: 2.178987642552819 | Val: 0.8849227099991546
1-th component log probs | Train: 2.0171809854612968 | Val: 1.08813165662653
2-th component log probs | Train: 1.9678900333684248 | Val: 0.9649234498680206
3-th component log probs | Train: 2.0337176295977515 | Val: 0.9221955525739194
4-th component log probs | Train: 2.075753459688901 | Val: 0.45458423114444607
5-th component log probs | Train: 2.1210023931080535 | Val: 0.5873624555063192
6-th component log probs | Train: 2.1405859246588412 | Val: 0.7861359005394237
7-th component log probs | Train: 2.112823988114677 | Val: 0.717700436172354
8-th component log probs | Train: 2.143797727341391 | Val: 0.31282962070287995
9-th component log probs | Train: 2.21412845044559 | Val: 0.36359717568457217
KEYWORD NR_SAMPLES:50000 DIM:50 AVG_DIFF:1.3235
Fitting PCA...
0-th component log probs | Train: 2.7891592371342115 | Val: 1.3242196249848206
1-th component log probs | Train: 2.6357138022176554 | Val: 1.7335848678116346
2-th component log probs | Train: 2.5797543442140416 | Val: 1.6384067190094262
3-th component log probs | Train: 2.6730208741166424 | Val: 1.4860730875914627
4-th component log probs | Train: 2.700842806095839 | Val: 1.0269751775259026
5-th component log probs | Train: 2.747334476199275 | Val: 1.130483461578003
6-th component log probs | Train: 2.770828122727116 | Val: 1.2893604764580422
7-th component log probs | Train: 2.7366551908481793 | Val: 1.2834179111886597
8-th component log probs | Train: 2.774575834962603 | Val: 0.5714856909769516
9-th component log probs | Train: 2.8299185385254373 | Val: 0.4861974380201631
KEYWORD NR_SAMPLES:50000 DIM:100 AVG_DIFF:1.3354
Fitting PCA...
0-th component log probs | Train: 3.067846065562369 | Val: 1.667488699076522
1-th component log probs | Train: 2.9168671605690624 | Val: 2.12483472297501
2-th component log probs | Train: 2.8596688271139676 | Val: 2.0385328001550582
3-th component log probs | Train: 2.9560740574751656 | Val: 1.8722292430461243
4-th component log probs | Train: 2.984250468061688 | Val: 1.4292428171917264
5-th component log probs | Train: 3.0184821378792717 | Val: 1.5447513833241637
6-th component log probs | Train: 3.0442927634830355 | Val: 1.625964004593819
7-th component log probs | Train: 3.013075404202902 | Val: 1.716828203153414
8-th component log probs | Train: 3.0587069164799656 | Val: 0.9172943635478348
9-th component log probs | Train: 3.0995807210939668 | Val: 0.8196695321406556
KEYWORD NR_SAMPLES:50000 DIM:150 AVG_DIFF:0.6746
Fitting PCA...
0-th component log probs | Train: 3.2666611918441375 | Val: 1.903645242218523
1-th component log probs | Train: 3.1201856606345033 | Val: 2.3697788114781746
2-th component log probs | Train: 3.0594319575253888 | Val: 2.2775496173518963
3-th component log probs | Train: 3.156180649813539 | Val: 2.1044260409263797
4-th component log probs | Train: 3.182933272925652 | Val: 1.6759106934278247
5-th component log probs | Train: 3.2128306968605425 | Val: 1.7824424541840946
6-th component log probs | Train: 3.237932322694113 | Val: 1.8352712227578227
7-th component log probs | Train: 3.2103387227704587 | Val: 1.9695622372268118
8-th component log probs | Train: 3.2622035466912083 | Val: 1.0574017229724617
9-th component log probs | Train: 3.2950519155996503 | Val: 0.939962932631187
KEYWORD NR_SAMPLES:50000 DIM:200 AVG_DIFF:0.4454
Fitting PCA...
0-th component log probs | Train: 3.4340361833759028 | Val: 2.0976733528036062
1-th component log probs | Train: 3.288736137998827 | Val: 2.5605950263274493
2-th component log probs | Train: 3.225320671894472 | Val: 2.449778642648705
3-th component log probs | Train: 3.3233074821353465 | Val: 2.2776203911714483
4-th component log probs | Train: 3.3503612478996465 | Val: 1.8239720218955002
5-th component log probs | Train: 3.3792230041284084 | Val: 1.967612715543956
6-th component log probs | Train: 3.4048333443749166 | Val: 2.0039265968088773
7-th component log probs | Train: 3.377116494155612 | Val: 2.129355663408133
8-th component log probs | Train: 3.4326042365004352 | Val: 1.1526711105793443
9-th component log probs | Train: 3.462214461333244 | Val: 1.0262264111789061
KEYWORD NR_SAMPLES:50000 DIM:250 AVG_DIFF:0.3496
Fitting PCA...
0-th component log probs | Train: 3.581444352579342 | Val: 2.2319321777464847
1-th component log probs | Train: 3.4338319210504014 | Val: 2.7200882601185365
2-th component log probs | Train: 3.368778971338117 | Val: 2.6011821252735308
3-th component log probs | Train: 3.4686545498234267 | Val: 2.4100306952314225
4-th component log probs | Train: 3.4961270912935127 | Val: 1.9690926056284552
5-th component log probs | Train: 3.524323752237056 | Val: 2.1224480580731178
6-th component log probs | Train: 3.551878034208393 | Val: 2.108594268678393
7-th component log probs | Train: 3.522913498103143 | Val: 2.2772375780018637
8-th component log probs | Train: 3.582392522705721 | Val: 1.2335236312612523
9-th component log probs | Train: 3.6111828582780467 | Val: 1.1075550019626141
KEYWORD NR_SAMPLES:50000 DIM:300 AVG_DIFF:0.2976
Fitting PCA...
0-th component log probs | Train: 3.7133176975632534 | Val: 2.3400008149809035
1-th component log probs | Train: 3.566408943569628 | Val: 2.8442383624710725
2-th component log probs | Train: 3.4994805553828896 | Val: 2.725431157788682
3-th component log probs | Train: 3.599375640781904 | Val: 2.4953102297030583
4-th component log probs | Train: 3.630250845446604 | Val: 2.0696739959228907
5-th component log probs | Train: 3.656042495883655 | Val: 2.2368629005861593
6-th component log probs | Train: 3.6846551138735633 | Val: 2.2110559204330085
7-th component log probs | Train: 3.65392201663156 | Val: 2.3525393725197423
8-th component log probs | Train: 3.7182388032926763 | Val: 1.2287898934633075
9-th component log probs | Train: 3.7465606230044504 | Val: 1.1570111013827085
KEYWORD NR_SAMPLES:50000 DIM:350 AVG_DIFF:0.3782
Fitting PCA...
0-th component log probs | Train: 3.831911522486423 | Val: 2.4192168044821996
1-th component log probs | Train: 3.688738139169517 | Val: 2.933983675573435
2-th component log probs | Train: 3.6173370274682775 | Val: 2.8329474967796964
3-th component log probs | Train: 3.7186407137096866 | Val: 2.590865514190747
4-th component log probs | Train: 3.7515101034380227 | Val: 2.151196851853432
5-th component log probs | Train: 3.7750104347863673 | Val: 2.355977512727048
6-th component log probs | Train: 3.8039797939719424 | Val: 2.277870804273844
7-th component log probs | Train: 3.7721886792990973 | Val: 2.4455490129181277
8-th component log probs | Train: 3.840105932629309 | Val: 1.2115726384283896
9-th component log probs | Train: 3.8678069764192022 | Val: 1.1610804387617994
KEYWORD NR_SAMPLES:50000 DIM:400 AVG_DIFF:0.4971
Fitting PCA...
0-th component log probs | Train: 3.9383429033098913 | Val: 2.512426090327853
1-th component log probs | Train: 3.8036541439893656 | Val: 3.041191026883858
2-th component log probs | Train: 3.7309886642300887 | Val: 2.949408318815524
3-th component log probs | Train: 3.83061842307434 | Val: 2.6977525662908337
4-th component log probs | Train: 3.86362131826672 | Val: 2.2215862764843397
5-th component log probs | Train: 3.888003257790091 | Val: 2.49284549473661
6-th component log probs | Train: 3.914519206531342 | Val: 2.4020826170183884
7-th component log probs | Train: 3.8820926988655544 | Val: 2.560723194968811
8-th component log probs | Train: 3.951048131953769 | Val: 1.2766998203081579
9-th component log probs | Train: 3.976385705420846 | Val: 1.2772971849923438
KEYWORD NR_SAMPLES:50000 DIM:450 AVG_DIFF:0.4190
Fitting PCA...
0-th component log probs | Train: 4.057019385493232 | Val: 2.7095943296897005
1-th component log probs | Train: 3.928878657357052 | Val: 3.215494279742699
2-th component log probs | Train: 3.8568258472478676 | Val: 3.1177222697807663
3-th component log probs | Train: 3.955831996015643 | Val: 2.888175397543973
4-th component log probs | Train: 3.981776309088324 | Val: 2.443135076937169
5-th component log probs | Train: 4.010986687769191 | Val: 2.6993580202691954
6-th component log probs | Train: 4.033646731952039 | Val: 2.610706882574029
7-th component log probs | Train: 4.0041294555286795 | Val: 2.7630021652347856
8-th component log probs | Train: 4.0692682737892225 | Val: 1.549188606886173
9-th component log probs | Train: 4.090991026180254 | Val: 1.5865832546557697
KEYWORD NR_SAMPLES:50000 DIM:500 AVG_DIFF:-0.1297
0-th component log probs | Train: 4.094937253590204 | Val: 2.775256796734628
1-th component log probs | Train: 3.969344012156256 | Val: 3.271128075873319
2-th component log probs | Train: 3.8983084277080327 | Val: 3.1747122987164835
3-th component log probs | Train: 3.996666864281832 | Val: 2.9512000918361188
4-th component log probs | Train: 4.020227401714516 | Val: 2.514859914964868
5-th component log probs | Train: 4.050659399569212 | Val: 2.766515349432751
6-th component log probs | Train: 4.072505950085355 | Val: 2.6799380836652618
7-th component log probs | Train: 4.043248122976497 | Val: 2.8281225697325025
8-th component log probs | Train: 4.107848165928446 | Val: 1.640705500651195
9-th component log probs | Train: 4.128624747462605 | Val: 1.6782830415472982
KEYWORD NR_SAMPLES:50000 DIM:512 AVG_DIFF:-0.3013
best average differences at 512 dimensions: -0.3013167600113384
2022-01-08 03:27.13 [info     ] Training complete              train_loss=0.17279747128486633
2022-01-08 03:27.13 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:27.17 [info     ] Testing complete               test_loss=0.2817862629890442
{'dataset_size': 50000,
 'end_test_accuracy': 0.9203904867172241,
 'end_test_loss': 0.2817862629890442,
 'end_train_accuracy': 0.9968030452728271,
 'end_train_loss': 0.17279747128486633,
 'end_val_accuracy': 0.9344747066497803,
 'end_val_loss': 0.3189474642276764}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:27.17 [info     ] Start Predict                  dataset=8606

wandb: Waiting for W&B process to finish, PID 3761... (success).
wandb: - 0.53MB of 0.53MB uploaded (0.00MB deduped)wandb: \ 0.53MB of 0.53MB uploaded (0.00MB deduped)wandb: | 0.53MB of 0.53MB uploaded (0.00MB deduped)wandb: / 0.53MB of 0.92MB uploaded (0.00MB deduped)wandb: - 0.53MB of 0.92MB uploaded (0.00MB deduped)wandb: \ 0.89MB of 0.92MB uploaded (0.00MB deduped)wandb: | 0.92MB of 0.92MB uploaded (0.00MB deduped)wandb: / 0.92MB of 0.92MB uploaded (0.00MB deduped)wandb: - 0.92MB of 0.92MB uploaded (0.00MB deduped)wandb: \ 0.92MB of 0.92MB uploaded (0.00MB deduped)wandb: | 0.92MB of 0.92MB uploaded (0.00MB deduped)wandb: / 0.92MB of 0.92MB uploaded (0.00MB deduped)wandb: - 0.92MB of 0.92MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:           accuracy_0 
wandb:           accuracy_1 
wandb:          accuracy_10 
wandb:          accuracy_11 
wandb:          accuracy_12 
wandb:          accuracy_13 
wandb:          accuracy_14 
wandb:           accuracy_2 
wandb:           accuracy_3 
wandb:           accuracy_4 
wandb:           accuracy_5 
wandb:           accuracy_6 
wandb:           accuracy_7 
wandb:           accuracy_8 
wandb:           accuracy_9 
wandb:              class_0 
wandb:              class_1 
wandb:              class_2 
wandb:              class_3 
wandb:              class_4 
wandb:              class_5 
wandb:              class_6 
wandb:              class_7 
wandb:              class_8 
wandb:              class_9 
wandb:         dataset_size 
wandb:    end_test_accuracy 
wandb:        end_test_loss 
wandb:   end_train_accuracy 
wandb:       end_train_loss 
wandb:     end_val_accuracy 
wandb:         end_val_loss 
wandb:                epoch 
wandb:               loss_0 
wandb:               loss_1 
wandb:              loss_10 
wandb:              loss_11 
wandb:              loss_12 
wandb:              loss_13 
wandb:              loss_14 
wandb:               loss_2 
wandb:               loss_3 
wandb:               loss_4 
wandb:               loss_5 
wandb:               loss_6 
wandb:               loss_7 
wandb:               loss_8 
wandb:               loss_9 
wandb:                 lr_0 
wandb:                 lr_1 
wandb:                lr_10 
wandb:                lr_11 
wandb:                lr_12 
wandb:                lr_13 
wandb:                lr_14 
wandb:                 lr_2 
wandb:                 lr_3 
wandb:                 lr_4 
wandb:                 lr_5 
wandb:                 lr_6 
wandb:                 lr_7 
wandb:                 lr_8 
wandb:                 lr_9 
wandb:       val_accuracy_0 
wandb:       val_accuracy_1 
wandb:      val_accuracy_10 
wandb:      val_accuracy_11 
wandb:      val_accuracy_12 
wandb:      val_accuracy_13 
wandb:      val_accuracy_14 
wandb:       val_accuracy_2 
wandb:       val_accuracy_3 
wandb:       val_accuracy_4 
wandb:       val_accuracy_5 
wandb:       val_accuracy_6 
wandb:       val_accuracy_7 
wandb:       val_accuracy_8 
wandb:       val_accuracy_9 
wandb:           val_loss_0 
wandb:           val_loss_1 
wandb:          val_loss_10 
wandb:          val_loss_11 
wandb:          val_loss_12 
wandb:          val_loss_13 
wandb:          val_loss_14 
wandb:           val_loss_2 
wandb:           val_loss_3 
wandb:           val_loss_4 
wandb:           val_loss_5 
wandb:           val_loss_6 
wandb:           val_loss_7 
wandb:           val_loss_8 
wandb:           val_loss_9 
wandb: 
wandb: Run summary:
wandb:           accuracy_0 0.97656
wandb:           accuracy_1 0.70703
wandb:          accuracy_10 0.99453
wandb:          accuracy_11 0.9675
wandb:          accuracy_12 0.96831
wandb:          accuracy_13 0.9687
wandb:          accuracy_14 0.9968
wandb:           accuracy_2 0.96205
wandb:           accuracy_3 0.99583
wandb:           accuracy_4 0.99639
wandb:           accuracy_5 1.0
wandb:           accuracy_6 0.99854
wandb:           accuracy_7 0.95635
wandb:           accuracy_8 0.96892
wandb:           accuracy_9 0.95788
wandb:              class_0 0.06208
wandb:              class_1 0.19926
wandb:              class_2 0.16114
wandb:              class_3 0.10184
wandb:              class_4 0.10824
wandb:              class_5 0.09104
wandb:              class_6 0.07626
wandb:              class_7 0.08108
wandb:              class_8 0.05162
wandb:              class_9 0.06744
wandb:         dataset_size 50000
wandb:    end_test_accuracy 0.92039
wandb:        end_test_loss 0.28179
wandb:   end_train_accuracy 0.9968
wandb:       end_train_loss 0.1728
wandb:     end_val_accuracy 0.93447
wandb:         end_val_loss 0.31895
wandb:                epoch 34
wandb:               loss_0 0.58268
wandb:               loss_1 1.4702
wandb:              loss_10 0.26075
wandb:              loss_11 0.33495
wandb:              loss_12 0.31724
wandb:              loss_13 0.29948
wandb:              loss_14 0.1728
wandb:               loss_2 0.43932
wandb:               loss_3 0.28333
wandb:               loss_4 0.27228
wandb:               loss_5 0.25034
wandb:               loss_6 0.27515
wandb:               loss_7 0.41941
wandb:               loss_8 0.40127
wandb:               loss_9 0.39947
wandb:                 lr_0 0.001
wandb:                 lr_1 0.001
wandb:                lr_10 0.0001
wandb:                lr_11 0.001
wandb:                lr_12 0.001
wandb:                lr_13 0.001
wandb:                lr_14 0.0001
wandb:                 lr_2 0.0001
wandb:                 lr_3 1e-05
wandb:                 lr_4 0.0001
wandb:                 lr_5 0.0001
wandb:                 lr_6 0.0001
wandb:                 lr_7 0.001
wandb:                 lr_8 0.001
wandb:                 lr_9 0.001
wandb:       val_accuracy_0 0.15413
wandb:       val_accuracy_1 0.15717
wandb:      val_accuracy_10 0.90307
wandb:      val_accuracy_11 0.91243
wandb:      val_accuracy_12 0.91072
wandb:      val_accuracy_13 0.92027
wandb:      val_accuracy_14 0.93447
wandb:       val_accuracy_2 0.46427
wandb:       val_accuracy_3 0.61198
wandb:       val_accuracy_4 0.67769
wandb:       val_accuracy_5 0.69743
wandb:       val_accuracy_6 0.79346
wandb:       val_accuracy_7 0.83689
wandb:       val_accuracy_8 0.85394
wandb:       val_accuracy_9 0.86893
wandb:           val_loss_0 5.41781
wandb:           val_loss_1 3.77227
wandb:          val_loss_10 0.44975
wandb:          val_loss_11 0.40698
wandb:          val_loss_12 0.3734
wandb:          val_loss_13 0.33789
wandb:          val_loss_14 0.31895
wandb:           val_loss_2 2.78315
wandb:           val_loss_3 1.75091
wandb:           val_loss_4 1.48517
wandb:           val_loss_5 1.38693
wandb:           val_loss_6 0.91918
wandb:           val_loss_7 0.73238
wandb:           val_loss_8 0.64109
wandb:           val_loss_9 0.59845
wandb: 
wandb: Synced 6 W&B file(s), 30 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced svhn_hu_greedy_run2: https://wandb.ai/fanconic/hidden_uncertainty/runs/1ckncs6z
wandb: Find logs at: ./wandb/run-20220108_010218-1ckncs6z/logs/debug.log
wandb: 
wandb: wandb version 0.12.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.7
wandb: Syncing run svhn_hu_greedy_run3
wandb:  View project at https://wandb.ai/fanconic/hidden_uncertainty
wandb:  View run at https://wandb.ai/fanconic/hidden_uncertainty/runs/1eli4w7y
wandb: Run data is saved locally in /scratch_net/airfox/fanconic/semproj2/hidden_uncertainty_active_learning/wandb/run-20220108_032723-1eli4w7y
wandb: Run `wandb offline` to turn off syncing.

Cuda is available:  True
Using downloaded and verified file: /tmp/train_32x32.mat
Using downloaded and verified file: /tmp/test_32x32.mat
2022-01-08 03:27.45 [info     ] Starting training              dataset=100 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
100
Fitting PCA...
0-th component log probs | Train: 5.034067514423633 | Val: -3850.3507117888435
1-th component log probs | Train: 5.030956479270104 | Val: -4141.218633429995
2-th component log probs | Train: 5.0416623877319156 | Val: -4297.709928396636
3-th component log probs | Train: 5.076850569293635 | Val: -4663.188831206468
4-th component log probs | Train: 5.069892706510677 | Val: -4752.022054928795
5-th component log probs | Train: 5.049614681779423 | Val: -4732.424968096767
6-th component log probs | Train: 5.017995422763002 | Val: -4665.948844349382
7-th component log probs | Train: 5.104531068863283 | Val: -4779.5379304468715
8-th component log probs | Train: 5.0404692919452705 | Val: -5031.536673618295
9-th component log probs | Train: 5.041380524128707 | Val: -6079.36721166374
KEYWORD NR_SAMPLES:100 DIM:50 AVG_DIFF:22458020.7648
0-th component log probs | Train: 30.16911759349575 | Val: -2682.3493374034683
1-th component log probs | Train: 30.169405614884404 | Val: -2732.117053915346
2-th component log probs | Train: 30.174691446233936 | Val: -2841.467649087897
3-th component log probs | Train: 30.187046328389293 | Val: -3144.6986774022494
4-th component log probs | Train: 30.182753714179178 | Val: -3103.797591632443
5-th component log probs | Train: 30.17597463989813 | Val: -3100.1470948468254
6-th component log probs | Train: 30.166126260166685 | Val: -3163.7516798358715
7-th component log probs | Train: 30.19519694978701 | Val: -3326.4871739544033
8-th component log probs | Train: 30.174343999592985 | Val: -3247.172947611037
9-th component log probs | Train: 30.17678786853465 | Val: -3721.919580644364
KEYWORD NR_SAMPLES:100 DIM:100 AVG_DIFF:9925369.1097
best average differences at 100 dimensions: 9925369.109673772
2022-01-08 03:28.53 [info     ] Training complete              train_loss=0.5688618421554565
2022-01-08 03:28.53 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:28.57 [info     ] Testing complete               test_loss=2.3016998767852783
{'dataset_size': 100,
 'end_test_accuracy': 0.15411292016506195,
 'end_test_loss': 2.3016998767852783,
 'end_train_accuracy': 0.9505208730697632,
 'end_train_loss': 0.5688618421554565,
 'end_val_accuracy': 0.17111404240131378,
 'end_val_loss': 5.3745222091674805}
2022-01-08 03:28.57 [info     ] Start Predict                  dataset=58506
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:29.32 [info     ] Starting training              dataset=200 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
200
Fitting PCA...
0-th component log probs | Train: 4.267944749745037 | Val: -1270.048639622397
1-th component log probs | Train: 3.7015708327189767 | Val: -1333.439527993955
2-th component log probs | Train: 3.9842124550414355 | Val: -1189.3267467919034
3-th component log probs | Train: 4.015609140857217 | Val: -1904.244446329665
4-th component log probs | Train: 4.61592885146492 | Val: -2166.4243640809327
5-th component log probs | Train: 3.980765946067344 | Val: -1678.7049360262076
6-th component log probs | Train: 3.9758729948655134 | Val: -1333.7168115387822
7-th component log probs | Train: 4.635222615283271 | Val: -1917.0132004196987
8-th component log probs | Train: 4.086957589891715 | Val: -1346.3531223792256
9-th component log probs | Train: 4.663037748267893 | Val: -2046.6258929399348
KEYWORD NR_SAMPLES:200 DIM:50 AVG_DIFF:2755193.8650
Fitting PCA...
0-th component log probs | Train: 5.104324188742788 | Val: -892.7622626590089
1-th component log probs | Train: 4.784332333712073 | Val: -1003.4664528086093
2-th component log probs | Train: 4.937669175743687 | Val: -879.2853626988255
3-th component log probs | Train: 4.956320081072754 | Val: -1386.3867600599963
4-th component log probs | Train: 5.28080120816885 | Val: -1354.3257122871153
5-th component log probs | Train: 4.933642800586692 | Val: -1222.7787482914698
6-th component log probs | Train: 4.944157282636365 | Val: -950.0836649857397
7-th component log probs | Train: 5.291446444295927 | Val: -1228.3590191872104
8-th component log probs | Train: 5.005078532386223 | Val: -947.2317976651767
9-th component log probs | Train: 5.304148854665582 | Val: -1303.4268331992946
KEYWORD NR_SAMPLES:200 DIM:100 AVG_DIFF:1296089.9148
Fitting PCA...
0-th component log probs | Train: 5.393753291052515 | Val: -661.0559983222664
1-th component log probs | Train: 5.1727471635313735 | Val: -743.9848283268337
2-th component log probs | Train: 5.275990759203689 | Val: -664.5233335887534
3-th component log probs | Train: 5.286255245325796 | Val: -1089.0429405639577
4-th component log probs | Train: 5.509373657872093 | Val: -979.2078681168235
5-th component log probs | Train: 5.270488289449952 | Val: -913.4033585165137
6-th component log probs | Train: 5.282672863578823 | Val: -704.4028244595743
7-th component log probs | Train: 5.517008590718816 | Val: -901.2095983646171
8-th component log probs | Train: 5.326677356165484 | Val: -692.6333452722095
9-th component log probs | Train: 5.526727478373272 | Val: -947.6944972125395
KEYWORD NR_SAMPLES:200 DIM:150 AVG_DIFF:719509.2251
0-th component log probs | Train: 14.884106779624258 | Val: -603.5251981744169
1-th component log probs | Train: 14.715201518887069 | Val: -676.57236643209
2-th component log probs | Train: 14.792036019380223 | Val: -611.1878858782762
3-th component log probs | Train: 14.798539845557968 | Val: -962.7730245199733
4-th component log probs | Train: 14.969397977820613 | Val: -850.9985150942769
5-th component log probs | Train: 14.788856817393409 | Val: -801.1381569921202
6-th component log probs | Train: 14.799384986993012 | Val: -639.8623368673659
7-th component log probs | Train: 14.974062029719427 | Val: -796.7802677201329
8-th component log probs | Train: 14.834006112165786 | Val: -626.191436191745
9-th component log probs | Train: 14.980308269104745 | Val: -837.5226802014541
KEYWORD NR_SAMPLES:200 DIM:200 AVG_DIFF:585605.1491
best average differences at 200 dimensions: 585605.1491296114
2022-01-08 03:30.44 [info     ] Training complete              train_loss=1.2123463153839111
2022-01-08 03:30.44 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:30.49 [info     ] Testing complete               test_loss=2.2887024879455566
{'dataset_size': 200,
 'end_test_accuracy': 0.15036343038082123,
 'end_test_loss': 2.2887024879455566,
 'end_train_accuracy': 0.75,
 'end_train_loss': 1.2123463153839111,
 'end_val_accuracy': 0.19213511049747467,
 'end_val_loss': 4.3926591873168945}
2022-01-08 03:30.49 [info     ] Start Predict                  dataset=58406
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:31.32 [info     ] Starting training              dataset=400 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
400
Fitting PCA...
0-th component log probs | Train: 4.379789833692287 | Val: -1358.5008249419047
1-th component log probs | Train: 2.399874554885326 | Val: -29.179363773803416
2-th component log probs | Train: 2.6563265792678323 | Val: -59.78850509965237
3-th component log probs | Train: 3.1708733851383553 | Val: -606.6803348680871
4-th component log probs | Train: 2.6352008278151264 | Val: -83.24158351083219
5-th component log probs | Train: 3.438223558533567 | Val: -327.1340357358066
6-th component log probs | Train: 3.4602232898384306 | Val: -683.5979696813089
7-th component log probs | Train: 3.7317163595333374 | Val: -855.0200729944452
8-th component log probs | Train: 3.8345183591638223 | Val: -913.0802100419037
9-th component log probs | Train: 4.060588492241414 | Val: -1319.4665407010723
KEYWORD NR_SAMPLES:400 DIM:50 AVG_DIFF:615910.7479
Fitting PCA...
0-th component log probs | Train: 5.138694156452998 | Val: -1059.6014407410862
1-th component log probs | Train: 3.4656605316591538 | Val: -252.5085259517703
2-th component log probs | Train: 4.012361922023605 | Val: -365.5689789466695
3-th component log probs | Train: 4.455433122603102 | Val: -722.564160312605
4-th component log probs | Train: 3.9868486419470743 | Val: -376.5921865993522
5-th component log probs | Train: 4.589125753518054 | Val: -503.6420001157716
6-th component log probs | Train: 4.62108947491931 | Val: -721.2771038816915
7-th component log probs | Train: 4.767014037842223 | Val: -862.2590333059544
8-th component log probs | Train: 4.843205700602233 | Val: -854.6067864698465
9-th component log probs | Train: 4.96626333526467 | Val: -980.279136116787
KEYWORD NR_SAMPLES:400 DIM:100 AVG_DIFF:526220.5515
Fitting PCA...
0-th component log probs | Train: 5.410182792074082 | Val: -815.5692132522265
1-th component log probs | Train: 4.169942114720893 | Val: -288.1928979975905
2-th component log probs | Train: 4.606677540624723 | Val: -359.87235474677084
3-th component log probs | Train: 4.934518853614367 | Val: -618.3827556617014
4-th component log probs | Train: 4.5862199236223935 | Val: -368.06812420961603
5-th component log probs | Train: 5.019157764743616 | Val: -452.8050447722016
6-th component log probs | Train: 5.046127352099759 | Val: -587.063845363102
7-th component log probs | Train: 5.144865410616397 | Val: -679.2856187822899
8-th component log probs | Train: 5.207661722029111 | Val: -681.467892806946
9-th component log probs | Train: 5.288535311822959 | Val: -770.7364040354386
KEYWORD NR_SAMPLES:400 DIM:150 AVG_DIFF:352772.5625
Fitting PCA...
0-th component log probs | Train: 5.54922167586191 | Val: -661.8698373653884
1-th component log probs | Train: 4.578299645198332 | Val: -269.09098631482516
2-th component log probs | Train: 4.927117423917431 | Val: -310.93453885716616
3-th component log probs | Train: 5.184664664188458 | Val: -521.6056386631641
4-th component log probs | Train: 4.909750578729711 | Val: -323.4466345844137
5-th component log probs | Train: 5.246102327478686 | Val: -387.7546734547016
6-th component log probs | Train: 5.269837815277275 | Val: -490.0433246590702
7-th component log probs | Train: 5.343218797669283 | Val: -567.0057203007209
8-th component log probs | Train: 5.395182879107157 | Val: -562.2910785943077
9-th component log probs | Train: 5.455952706384702 | Val: -624.4306955796229
KEYWORD NR_SAMPLES:400 DIM:200 AVG_DIFF:245654.9005
Fitting PCA...
0-th component log probs | Train: 5.634341920881348 | Val: -553.6615835901739
1-th component log probs | Train: 4.837970794436485 | Val: -243.9607835148243
2-th component log probs | Train: 5.127832843260898 | Val: -269.0888273206318
3-th component log probs | Train: 5.339445618750102 | Val: -446.26972661376607
4-th component log probs | Train: 5.113647918904708 | Val: -277.5281302747145
5-th component log probs | Train: 5.386829035208836 | Val: -340.17861705818973
6-th component log probs | Train: 5.407392319748544 | Val: -416.6616503759921
7-th component log probs | Train: 5.46635367700171 | Val: -480.8814228012988
8-th component log probs | Train: 5.510406566470277 | Val: -475.02716770319614
9-th component log probs | Train: 5.558888322121995 | Val: -521.6348003590708
KEYWORD NR_SAMPLES:400 DIM:250 AVG_DIFF:178071.1101
Fitting PCA...
0-th component log probs | Train: 5.692156442686021 | Val: -475.78823543937796
1-th component log probs | Train: 5.018721028382204 | Val: -220.48648381610354
2-th component log probs | Train: 5.265826164285091 | Val: -236.31905289315952
3-th component log probs | Train: 5.445075948676144 | Val: -393.3499223153177
4-th component log probs | Train: 5.253748623271728 | Val: -243.80174245074664
5-th component log probs | Train: 5.4829501671749 | Val: -297.7144258851846
6-th component log probs | Train: 5.5012597154462535 | Val: -360.1671553789573
7-th component log probs | Train: 5.55091991254789 | Val: -415.1347109933651
8-th component log probs | Train: 5.588547015209663 | Val: -408.1306014385519
9-th component log probs | Train: 5.628556818254598 | Val: -448.6365633982495
KEYWORD NR_SAMPLES:400 DIM:300 AVG_DIFF:134574.3608
Fitting PCA...
0-th component log probs | Train: 5.73403502422473 | Val: -416.10083268853793
1-th component log probs | Train: 5.152530365730036 | Val: -197.89085175975075
2-th component log probs | Train: 5.366965606550466 | Val: -209.66683910343997
3-th component log probs | Train: 5.521703426974366 | Val: -346.08213540792144
4-th component log probs | Train: 5.356399122465606 | Val: -216.5664546132842
5-th component log probs | Train: 5.55342650873193 | Val: -264.4975411418162
6-th component log probs | Train: 5.56937329670025 | Val: -319.2372304065064
7-th component log probs | Train: 5.6123358428422385 | Val: -363.6967593197341
8-th component log probs | Train: 5.645111124261672 | Val: -357.3363547174581
9-th component log probs | Train: 5.679230982527982 | Val: -392.9292597402093
KEYWORD NR_SAMPLES:400 DIM:350 AVG_DIFF:104683.0161
0-th component log probs | Train: 7.442606622441254 | Val: -379.44921764329115
1-th component log probs | Train: 6.9319912567157855 | Val: -189.8311889004099
2-th component log probs | Train: 7.121014839686826 | Val: -196.86794360988577
3-th component log probs | Train: 7.256717235203843 | Val: -318.7628794043519
4-th component log probs | Train: 7.111714098518602 | Val: -204.8317580810932
5-th component log probs | Train: 7.2841495005728545 | Val: -245.1965723942572
6-th component log probs | Train: 7.2980575713812055 | Val: -294.79234696785716
7-th component log probs | Train: 7.335972442056406 | Val: -333.25240785853185
8-th component log probs | Train: 7.364805614440183 | Val: -327.25318535166645
9-th component log probs | Train: 7.394565892864694 | Val: -358.42241021205547
KEYWORD NR_SAMPLES:400 DIM:400 AVG_DIFF:90086.6833
best average differences at 400 dimensions: 90086.68327452795
2022-01-08 03:32.57 [info     ] Training complete              train_loss=0.6833957433700562
2022-01-08 03:32.57 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:33.01 [info     ] Testing complete               test_loss=2.2659878730773926
{'dataset_size': 400,
 'end_test_accuracy': 0.19740478694438934,
 'end_test_loss': 2.2659878730773926,
 'end_train_accuracy': 0.9553571343421936,
 'end_train_loss': 0.6833957433700562,
 'end_val_accuracy': 0.44387099146842957,
 'end_val_loss': 2.5930092334747314}
2022-01-08 03:33.01 [info     ] Start Predict                  dataset=58206
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:33.39 [info     ] Starting training              dataset=600 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
600
Fitting PCA...
0-th component log probs | Train: 3.5781543916681713 | Val: -587.1568163479101
1-th component log probs | Train: 2.373038305699791 | Val: -4.677427830473258
2-th component log probs | Train: 2.6027514939461414 | Val: -29.48591758697196
3-th component log probs | Train: 2.86033970321577 | Val: -185.98099680150082
4-th component log probs | Train: 2.596374183707513 | Val: -16.85358739631865
5-th component log probs | Train: 2.8538634571068253 | Val: -76.46462546924732
6-th component log probs | Train: 2.8160345515387313 | Val: -62.44186430824503
7-th component log probs | Train: 3.0436965131550533 | Val: -101.86477328294895
8-th component log probs | Train: 3.3225708229376045 | Val: -529.5930687798813
9-th component log probs | Train: 3.4720794701311943 | Val: -568.0990564898168
KEYWORD NR_SAMPLES:600 DIM:50 AVG_DIFF:102049.7612
Fitting PCA...
0-th component log probs | Train: 4.6610256721807755 | Val: -708.8613670251561
1-th component log probs | Train: 3.115112475452271 | Val: -28.845924123306713
2-th component log probs | Train: 3.6994139324658244 | Val: -177.72116950976064
3-th component log probs | Train: 4.188679541078112 | Val: -712.3392825977085
4-th component log probs | Train: 3.6467417493985383 | Val: -170.33258640791072
5-th component log probs | Train: 4.032196753716618 | Val: -365.3959155172196
6-th component log probs | Train: 3.983518202927895 | Val: -363.0702251512438
7-th component log probs | Train: 4.31012111502412 | Val: -288.39905872859026
8-th component log probs | Train: 4.542634208659292 | Val: -827.4624114279242
9-th component log probs | Train: 4.619739556903685 | Val: -738.9946638707385
KEYWORD NR_SAMPLES:600 DIM:100 AVG_DIFF:269319.0712
Fitting PCA...
0-th component log probs | Train: 5.066950503753507 | Val: -606.6802882499659
1-th component log probs | Train: 3.7177725418467866 | Val: -73.59734716515635
2-th component log probs | Train: 4.350857415280578 | Val: -199.77408395531214
3-th component log probs | Train: 4.7358076920833545 | Val: -616.7079575593988
4-th component log probs | Train: 4.301318725155862 | Val: -213.0450222176042
5-th component log probs | Train: 4.598473491297436 | Val: -369.22650534559574
6-th component log probs | Train: 4.565581858082531 | Val: -349.58673627360844
7-th component log probs | Train: 4.817914073965416 | Val: -269.18172735808093
8-th component log probs | Train: 4.994458824779842 | Val: -721.4625744545997
9-th component log probs | Train: 5.043931671061104 | Val: -628.2223188059257
KEYWORD NR_SAMPLES:600 DIM:150 AVG_DIFF:212836.9321
Fitting PCA...
0-th component log probs | Train: 5.281043287904094 | Val: -508.7876741737342
1-th component log probs | Train: 4.171071392050026 | Val: -87.29617130442392
2-th component log probs | Train: 4.716169112152662 | Val: -185.03008284350986
3-th component log probs | Train: 5.025120246579713 | Val: -523.639781459493
4-th component log probs | Train: 4.66832794538175 | Val: -205.59583584622422
5-th component log probs | Train: 4.911051034164912 | Val: -325.09929205781185
6-th component log probs | Train: 4.886334484110093 | Val: -312.4341682468861
7-th component log probs | Train: 5.087076103378734 | Val: -236.77460361361216
8-th component log probs | Train: 5.229472636484926 | Val: -605.238943747994
9-th component log probs | Train: 5.26725116935943 | Val: -530.6312554017626
KEYWORD NR_SAMPLES:600 DIM:200 AVG_DIFF:156380.9764
Fitting PCA...
0-th component log probs | Train: 5.414759421511178 | Val: -437.1859631913738
1-th component log probs | Train: 4.483754389415167 | Val: -90.57228592375877
2-th component log probs | Train: 4.948933754564925 | Val: -171.37569889805854
3-th component log probs | Train: 5.205966622637916 | Val: -448.7912105495743
4-th component log probs | Train: 4.90663794047188 | Val: -188.0297418251019
5-th component log probs | Train: 5.107480890767807 | Val: -288.61027759400264
6-th component log probs | Train: 5.089368675475013 | Val: -277.3654398130768
7-th component log probs | Train: 5.255609187928651 | Val: -209.16501227554147
8-th component log probs | Train: 5.374644672308157 | Val: -512.7023185913057
9-th component log probs | Train: 5.40464516178947 | Val: -461.1001016870197
KEYWORD NR_SAMPLES:600 DIM:250 AVG_DIFF:118050.1670
Fitting PCA...
0-th component log probs | Train: 5.506503261902543 | Val: -379.17686143361834
1-th component log probs | Train: 4.7075521045706 | Val: -87.08933983708181
2-th component log probs | Train: 5.1113706931128995 | Val: -152.97628798833932
3-th component log probs | Train: 5.3300957872588475 | Val: -392.0609671766196
4-th component log probs | Train: 5.072140371220876 | Val: -171.8229176560374
5-th component log probs | Train: 5.244524803562023 | Val: -255.85281825005964
6-th component log probs | Train: 5.229824835916476 | Val: -246.29546700225487
7-th component log probs | Train: 5.371252296516346 | Val: -185.894090482252
8-th component log probs | Train: 5.47343898961731 | Val: -445.99340901140874
9-th component log probs | Train: 5.498292811827642 | Val: -403.15362829674103
KEYWORD NR_SAMPLES:600 DIM:300 AVG_DIFF:91216.9436
Fitting PCA...
0-th component log probs | Train: 5.573198213149998 | Val: -334.28869713973467
1-th component log probs | Train: 4.87588645171733 | Val: -81.874675285205
2-th component log probs | Train: 5.230662006029596 | Val: -138.94276108091788
3-th component log probs | Train: 5.420358465061016 | Val: -346.87677888880626
4-th component log probs | Train: 5.1956789057176405 | Val: -155.93338248842014
5-th component log probs | Train: 5.345202238200038 | Val: -229.36710936309413
6-th component log probs | Train: 5.332783333169011 | Val: -219.85451301828815
7-th component log probs | Train: 5.456065740718453 | Val: -167.3045379127114
8-th component log probs | Train: 5.545219522596139 | Val: -392.1291293367757
9-th component log probs | Train: 5.56632862044717 | Val: -356.522428263931
KEYWORD NR_SAMPLES:600 DIM:350 AVG_DIFF:72121.5255
Fitting PCA...
0-th component log probs | Train: 5.623970260363965 | Val: -299.1715303340838
1-th component log probs | Train: 5.00718117147106 | Val: -76.21368567981547
2-th component log probs | Train: 5.322279500929983 | Val: -126.303548016557
3-th component log probs | Train: 5.489556057526208 | Val: -310.43123201162075
4-th component log probs | Train: 5.290916941438617 | Val: -142.10161448056283
5-th component log probs | Train: 5.422981707773176 | Val: -206.65700024730225
6-th component log probs | Train: 5.412023037201873 | Val: -198.46049083008472
7-th component log probs | Train: 5.520970838992395 | Val: -151.68680753417485
8-th component log probs | Train: 5.59974864879537 | Val: -349.68024098279545
9-th component log probs | Train: 5.618150463438739 | Val: -318.3390314193268
KEYWORD NR_SAMPLES:600 DIM:400 AVG_DIFF:58296.0366
Fitting PCA...
0-th component log probs | Train: 5.663994864621012 | Val: -270.2386994297915
1-th component log probs | Train: 5.112703718495874 | Val: -71.16137744694123
2-th component log probs | Train: 5.3949707673812854 | Val: -115.49315639890303
3-th component log probs | Train: 5.544187839342226 | Val: -280.76660952112354
4-th component log probs | Train: 5.366646015936133 | Val: -130.5414157813958
5-th component log probs | Train: 5.484486926916319 | Val: -187.78031709589027
6-th component log probs | Train: 5.4747652399708375 | Val: -180.77474097668266
7-th component log probs | Train: 5.572169646412665 | Val: -138.24426033278684
8-th component log probs | Train: 5.642626275662038 | Val: -315.2727117539417
9-th component log probs | Train: 5.658854048175495 | Val: -287.71583072168744
KEYWORD NR_SAMPLES:600 DIM:450 AVG_DIFF:48075.5523
Fitting PCA...
0-th component log probs | Train: 5.6963215564075655 | Val: -246.44569432976667
1-th component log probs | Train: 5.199021419360028 | Val: -66.44920025452168
2-th component log probs | Train: 5.453939445843257 | Val: -106.40288838269404
3-th component log probs | Train: 5.588392188472849 | Val: -256.06116908845286
4-th component log probs | Train: 5.428206635270351 | Val: -120.47761601491705
5-th component log probs | Train: 5.534483840667804 | Val: -172.08474763774228
6-th component log probs | Train: 5.525768179357452 | Val: -165.71014796827606
7-th component log probs | Train: 5.613593171550143 | Val: -126.92966122241583
8-th component log probs | Train: 5.677138426473274 | Val: -286.9859480825312
9-th component log probs | Train: 5.691718719713011 | Val: -262.2257483093038
KEYWORD NR_SAMPLES:600 DIM:500 AVG_DIFF:40321.3052
0-th component log probs | Train: 5.703166661010773 | Val: -241.38457962327345
1-th component log probs | Train: 5.21743801800409 | Val: -65.38981041608653
2-th component log probs | Train: 5.466450888089302 | Val: -104.41551506110034
3-th component log probs | Train: 5.597762006121732 | Val: -250.8023783128927
4-th component log probs | Train: 5.4413068777645766 | Val: -118.2875908109783
5-th component log probs | Train: 5.54510491547399 | Val: -168.64162086960565
6-th component log probs | Train: 5.53659852830354 | Val: -162.43937490248499
7-th component log probs | Train: 5.622372969395042 | Val: -124.5035785637782
8-th component log probs | Train: 5.684438835177915 | Val: -280.9959966527702
9-th component log probs | Train: 5.698672640955758 | Val: -256.7753154243536
KEYWORD NR_SAMPLES:600 DIM:512 AVG_DIFF:38750.3265
best average differences at 512 dimensions: 38750.32650302871
2022-01-08 03:37.37 [info     ] Training complete              train_loss=0.37160685658454895
2022-01-08 03:37.37 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:37.41 [info     ] Testing complete               test_loss=1.7415671348571777
{'dataset_size': 600,
 'end_test_accuracy': 0.6019144058227539,
 'end_test_loss': 1.7415671348571777,
 'end_train_accuracy': 0.9927083849906921,
 'end_train_loss': 0.37160685658454895,
 'end_val_accuracy': 0.611846387386322,
 'end_val_loss': 1.7080748081207275}
2022-01-08 03:37.41 [info     ] Start Predict                  dataset=58006
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:38.17 [info     ] Starting training              dataset=800 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
800
Fitting PCA...
0-th component log probs | Train: 2.806360561298635 | Val: -35.951538207403296
1-th component log probs | Train: 2.1895055105556587 | Val: -1.995798660257113
2-th component log probs | Train: 2.467180322425463 | Val: -10.712397199897833
3-th component log probs | Train: 2.3486986561883527 | Val: -9.514632972101577
4-th component log probs | Train: 2.578430513404248 | Val: -15.045518163085859
5-th component log probs | Train: 2.5743482375285036 | Val: -16.85062445482651
6-th component log probs | Train: 2.6271765889562433 | Val: -25.882746207289546
7-th component log probs | Train: 2.809597797469586 | Val: -44.70332164909475
8-th component log probs | Train: 2.4515340777614565 | Val: -19.143963558602103
9-th component log probs | Train: 2.665775255350713 | Val: -49.30619762403072
KEYWORD NR_SAMPLES:800 DIM:50 AVG_DIFF:898.8916
Fitting PCA...
0-th component log probs | Train: 3.9824498258298555 | Val: -231.35882215382605
1-th component log probs | Train: 2.8915220765919725 | Val: -10.774984313734407
2-th component log probs | Train: 3.4153852879201723 | Val: -90.40804527364122
3-th component log probs | Train: 3.339543455631009 | Val: -125.86259852604188
4-th component log probs | Train: 3.545554058931896 | Val: -117.82791304858216
5-th component log probs | Train: 3.5388648718608704 | Val: -124.94819446090479
6-th component log probs | Train: 3.70356377894675 | Val: -189.68708224110165
7-th component log probs | Train: 4.048962797788007 | Val: -252.0746357171884
8-th component log probs | Train: 3.6411286625774673 | Val: -282.2959805458724
9-th component log probs | Train: 3.9696640580849647 | Val: -342.76445036059624
KEYWORD NR_SAMPLES:800 DIM:100 AVG_DIFF:41906.0579
Fitting PCA...
0-th component log probs | Train: 4.56994856039181 | Val: -252.83210858522133
1-th component log probs | Train: 3.46414694816956 | Val: -37.815977306241095
2-th component log probs | Train: 4.116262870844414 | Val: -155.31834014544347
3-th component log probs | Train: 4.061353191068547 | Val: -206.5472762199563
4-th component log probs | Train: 4.219095622275033 | Val: -192.98200907231035
5-th component log probs | Train: 4.198966310957031 | Val: -176.60082516756398
6-th component log probs | Train: 4.351946720882585 | Val: -216.65574411217492
7-th component log probs | Train: 4.622188844689873 | Val: -262.3239856916962
8-th component log probs | Train: 4.3369333345363135 | Val: -325.6344504165185
9-th component log probs | Train: 4.572962026069612 | Val: -351.44176737679607
KEYWORD NR_SAMPLES:800 DIM:150 AVG_DIFF:56722.2509
Fitting PCA...
0-th component log probs | Train: 4.89119237465867 | Val: -231.76597869421954
1-th component log probs | Train: 3.942957984515679 | Val: -63.935861358187395
2-th component log probs | Train: 4.524475303521527 | Val: -156.92685455912687
3-th component log probs | Train: 4.4871110621406185 | Val: -202.37693790154418
4-th component log probs | Train: 4.606731671311558 | Val: -187.1650246860694
5-th component log probs | Train: 4.586528237477776 | Val: -171.52532242300566
6-th component log probs | Train: 4.714808538875751 | Val: -204.95229581339754
7-th component log probs | Train: 4.932792014101535 | Val: -234.40046774812615
8-th component log probs | Train: 4.715031340119188 | Val: -296.78248448480934
9-th component log probs | Train: 4.898467200566803 | Val: -315.45081709354827
KEYWORD NR_SAMPLES:800 DIM:200 AVG_DIFF:49409.5610
Fitting PCA...
0-th component log probs | Train: 5.093778154701933 | Val: -208.64475304408597
1-th component log probs | Train: 4.287681587481482 | Val: -70.46868166215998
2-th component log probs | Train: 4.788648770245641 | Val: -147.64437399028478
3-th component log probs | Train: 4.760884684996782 | Val: -185.97098111578302
4-th component log probs | Train: 4.856186586229214 | Val: -171.73840798359274
5-th component log probs | Train: 4.838310977259884 | Val: -157.65296071312488
6-th component log probs | Train: 4.946413571024211 | Val: -185.62229319396366
7-th component log probs | Train: 5.127916905205128 | Val: -207.65781626033464
8-th component log probs | Train: 4.95203820685528 | Val: -264.6203458453391
9-th component log probs | Train: 5.1025132502054324 | Val: -277.48444122190523
KEYWORD NR_SAMPLES:800 DIM:250 AVG_DIFF:40447.2571
Fitting PCA...
0-th component log probs | Train: 5.23258490558421 | Val: -188.57590675914327
1-th component log probs | Train: 4.537203930017455 | Val: -70.13892866734747
2-th component log probs | Train: 4.9728348093367964 | Val: -136.54814723981377
3-th component log probs | Train: 4.9514093456747075 | Val: -168.74791357441651
4-th component log probs | Train: 5.027567966376911 | Val: -156.71819959402438
5-th component log probs | Train: 5.013334298515743 | Val: -143.0385120025746
6-th component log probs | Train: 5.107215851935232 | Val: -167.21388102470763
7-th component log probs | Train: 5.262432892588925 | Val: -188.32674515036393
8-th component log probs | Train: 5.1153129355545195 | Val: -236.38689195086127
9-th component log probs | Train: 5.2421851635060115 | Val: -246.39827792740948
KEYWORD NR_SAMPLES:800 DIM:300 AVG_DIFF:33193.8603
Fitting PCA...
0-th component log probs | Train: 5.33467360959724 | Val: -170.99517632160848
1-th component log probs | Train: 4.726567672912328 | Val: -67.39126641016463
2-th component log probs | Train: 5.108236585309875 | Val: -125.14750913989337
3-th component log probs | Train: 5.091166032333734 | Val: -153.83023432034977
4-th component log probs | Train: 5.15541012992543 | Val: -142.79310691176212
5-th component log probs | Train: 5.142895592283842 | Val: -130.26235709072776
6-th component log probs | Train: 5.225170641676422 | Val: -152.49687636605628
7-th component log probs | Train: 5.361090427363258 | Val: -169.82624834515653
8-th component log probs | Train: 5.2346505694645975 | Val: -213.42232335057452
9-th component log probs | Train: 5.344104143954538 | Val: -220.9406668118232
KEYWORD NR_SAMPLES:800 DIM:350 AVG_DIFF:27486.8738
Fitting PCA...
0-th component log probs | Train: 5.413207893023205 | Val: -155.3588428954384
1-th component log probs | Train: 4.873417826980278 | Val: -64.28605358533872
2-th component log probs | Train: 5.2128050298919115 | Val: -115.37332440861286
3-th component log probs | Train: 5.198928682742331 | Val: -140.19958404071085
4-th component log probs | Train: 5.253972849097577 | Val: -130.17382390454725
5-th component log probs | Train: 5.242675394238558 | Val: -118.89646514770527
6-th component log probs | Train: 5.316008900093228 | Val: -139.02900882831594
7-th component log probs | Train: 5.436339754558193 | Val: -154.04167177301196
8-th component log probs | Train: 5.325781925422814 | Val: -193.87211433416928
9-th component log probs | Train: 5.422219489951167 | Val: -199.23755940950872
KEYWORD NR_SAMPLES:800 DIM:400 AVG_DIFF:22930.8257
Fitting PCA...
0-th component log probs | Train: 5.475129444842887 | Val: -142.19112675400547
1-th component log probs | Train: 4.991190038167766 | Val: -60.82914134978288
2-th component log probs | Train: 5.295996692294924 | Val: -106.30137014124172
3-th component log probs | Train: 5.284226455298878 | Val: -128.85181278929852
4-th component log probs | Train: 5.332240167384524 | Val: -119.7760551009704
5-th component log probs | Train: 5.3222744241909785 | Val: -109.3430797884361
6-th component log probs | Train: 5.3881842219830896 | Val: -127.47010642951568
7-th component log probs | Train: 5.4961297381400644 | Val: -140.96684470601946
8-th component log probs | Train: 5.397914190078865 | Val: -176.6917491193768
9-th component log probs | Train: 5.483841389236296 | Val: -181.46291818059777
KEYWORD NR_SAMPLES:800 DIM:450 AVG_DIFF:19388.6666
Fitting PCA...
0-th component log probs | Train: 5.525541203147659 | Val: -130.77032664688582
1-th component log probs | Train: 5.088168878912175 | Val: -57.417793043107146
2-th component log probs | Train: 5.363923734138091 | Val: -98.26715683414879
3-th component log probs | Train: 5.35355564727493 | Val: -118.91627263594522
4-th component log probs | Train: 5.396309050978181 | Val: -110.58255806444791
5-th component log probs | Train: 5.387401816936968 | Val: -100.84796258867347
6-th component log probs | Train: 5.447030231758713 | Val: -117.35357806028111
7-th component log probs | Train: 5.544639187293803 | Val: -129.7234020296668
8-th component log probs | Train: 5.456301565721202 | Val: -162.10308821539985
9-th component log probs | Train: 5.533719120210708 | Val: -166.3565788974544
KEYWORD NR_SAMPLES:800 DIM:500 AVG_DIFF:16559.5195
0-th component log probs | Train: 5.536300968338835 | Val: -128.26822993117392
1-th component log probs | Train: 5.1089166045149765 | Val: -56.645883226704555
2-th component log probs | Train: 5.378432862787223 | Val: -96.4827664052796
3-th component log probs | Train: 5.368317849502809 | Val: -116.7447245342919
4-th component log probs | Train: 5.410000017419706 | Val: -108.55948251758682
5-th component log probs | Train: 5.401296556820415 | Val: -98.99308353044071
6-th component log probs | Train: 5.459576871698923 | Val: -115.15715207753176
7-th component log probs | Train: 5.554972123993168 | Val: -127.24413389946615
8-th component log probs | Train: 5.468694049302821 | Val: -158.94488738370308
9-th component log probs | Train: 5.54431769003243 | Val: -163.1036151188737
KEYWORD NR_SAMPLES:800 DIM:512 AVG_DIFF:15971.9929
best average differences at 50 dimensions: 898.891595402472
2022-01-08 03:40.25 [info     ] Training complete              train_loss=0.4980762302875519
2022-01-08 03:40.25 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:40.28 [info     ] Testing complete               test_loss=1.6266452074050903
{'dataset_size': 800,
 'end_test_accuracy': 0.531825840473175,
 'end_test_loss': 1.6266452074050903,
 'end_train_accuracy': 0.9819711446762085,
 'end_train_loss': 0.4980762302875519,
 'end_val_accuracy': 0.6298536658287048,
 'end_val_loss': 1.7765638828277588}
2022-01-08 03:40.29 [info     ] Start Predict                  dataset=57806
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:40.53 [info     ] Starting training              dataset=1000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
1000
Fitting PCA...
0-th component log probs | Train: 2.6719173146837174 | Val: -11.062073679058301
1-th component log probs | Train: 2.3357797804393137 | Val: -2.0933103091089196
2-th component log probs | Train: 2.569981626906614 | Val: -6.574254416475379
3-th component log probs | Train: 2.3875585582457495 | Val: -7.424654753114337
4-th component log probs | Train: 2.506921509378854 | Val: -10.119812836602351
5-th component log probs | Train: 2.6902852021322405 | Val: -22.0482815496979
6-th component log probs | Train: 2.6523040935055855 | Val: -16.141416543697083
7-th component log probs | Train: 2.7979248213871815 | Val: -23.37972852539588
8-th component log probs | Train: 2.526304024585809 | Val: -14.532635452059111
9-th component log probs | Train: 2.519739274362727 | Val: -12.802989232940778
KEYWORD NR_SAMPLES:1000 DIM:50 AVG_DIFF:285.0013
Fitting PCA...
0-th component log probs | Train: 3.4274792665007565 | Val: -42.224653199845115
1-th component log probs | Train: 3.013647019015404 | Val: -9.199202319777784
2-th component log probs | Train: 3.3240044658970507 | Val: -26.82813507179941
3-th component log probs | Train: 3.1741860190138658 | Val: -59.35690523979767
4-th component log probs | Train: 3.3598411527050094 | Val: -57.46774151108986
5-th component log probs | Train: 3.5719896082754063 | Val: -92.90581255359693
6-th component log probs | Train: 3.5975765527776367 | Val: -127.22908214588745
7-th component log probs | Train: 3.769083566277029 | Val: -113.90681333722581
8-th component log probs | Train: 3.514524251628775 | Val: -150.06733572242143
9-th component log probs | Train: 3.5277292187223686 | Val: -151.27798737840013
KEYWORD NR_SAMPLES:1000 DIM:100 AVG_DIFF:9940.6414
Fitting PCA...
0-th component log probs | Train: 4.020874255530506 | Val: -83.57070326220544
1-th component log probs | Train: 3.51859249496672 | Val: -25.739876369085113
2-th component log probs | Train: 3.9311977716525237 | Val: -58.004277581231946
3-th component log probs | Train: 3.861692307250662 | Val: -135.16117929955595
4-th component log probs | Train: 4.007723741059565 | Val: -120.48624515019148
5-th component log probs | Train: 4.1826066794021495 | Val: -142.9736860099024
6-th component log probs | Train: 4.243111251115524 | Val: -168.7112934823088
7-th component log probs | Train: 4.378597114185142 | Val: -144.02762880616592
8-th component log probs | Train: 4.201503338203898 | Val: -231.00997642160416
9-th component log probs | Train: 4.227297129341341 | Val: -208.53456608760024
KEYWORD NR_SAMPLES:1000 DIM:150 AVG_DIFF:22269.3331
Fitting PCA...
0-th component log probs | Train: 4.4201326956425655 | Val: -95.11218463643621
1-th component log probs | Train: 3.9532045247365923 | Val: -41.66651808780849
2-th component log probs | Train: 4.348314817063165 | Val: -69.40217213447002
3-th component log probs | Train: 4.3127072562978706 | Val: -151.40089659917476
4-th component log probs | Train: 4.4207839306472545 | Val: -132.06386214154776
5-th component log probs | Train: 4.564584627156732 | Val: -148.67222277063925
6-th component log probs | Train: 4.621192784251785 | Val: -168.6496668529692
7-th component log probs | Train: 4.728461243221141 | Val: -136.26897516278814
8-th component log probs | Train: 4.595692431807517 | Val: -225.88302689729986
9-th component log probs | Train: 4.619082649082243 | Val: -201.80446804528492
KEYWORD NR_SAMPLES:1000 DIM:200 AVG_DIFF:23078.8394
Fitting PCA...
0-th component log probs | Train: 4.687592222426343 | Val: -96.93082289828253
1-th component log probs | Train: 4.274864642123377 | Val: -48.47821558501706
2-th component log probs | Train: 4.628057346413864 | Val: -68.4776571392922
3-th component log probs | Train: 4.610301994050596 | Val: -146.27864263241554
4-th component log probs | Train: 4.692382875180495 | Val: -126.4647024653035
5-th component log probs | Train: 4.814147939562618 | Val: -139.3201170340572
6-th component log probs | Train: 4.866567191935039 | Val: -155.98798903614005
7-th component log probs | Train: 4.955463468751501 | Val: -124.17121415786205
8-th component log probs | Train: 4.849926348298782 | Val: -208.31408569238351
9-th component log probs | Train: 4.869623895948652 | Val: -183.77637169541904
KEYWORD NR_SAMPLES:1000 DIM:250 AVG_DIFF:20407.0271
Fitting PCA...
0-th component log probs | Train: 4.877828978166754 | Val: -93.85809416631855
1-th component log probs | Train: 4.516490862948549 | Val: -50.090783084962126
2-th component log probs | Train: 4.826762918056959 | Val: -64.84580208580941
3-th component log probs | Train: 4.81791662335685 | Val: -136.28608044854795
4-th component log probs | Train: 4.884744092667684 | Val: -117.94699056470215
5-th component log probs | Train: 4.989595530522219 | Val: -128.08890598561837
6-th component log probs | Train: 5.037700969494103 | Val: -142.55043578098653
7-th component log probs | Train: 5.112316330500648 | Val: -113.36127624957463
8-th component log probs | Train: 5.0255093659316294 | Val: -188.84426498305265
9-th component log probs | Train: 5.041847402495061 | Val: -166.58432126622768
KEYWORD NR_SAMPLES:1000 DIM:300 AVG_DIFF:17435.4602
Fitting PCA...
0-th component log probs | Train: 5.020313376143862 | Val: -87.98940415836948
1-th component log probs | Train: 4.699478463313984 | Val: -49.27843368061711
2-th component log probs | Train: 4.976558081405082 | Val: -60.867762063920566
3-th component log probs | Train: 4.972465254171065 | Val: -125.97863993377518
4-th component log probs | Train: 5.028034744169863 | Val: -109.61280355763569
5-th component log probs | Train: 5.120551091721494 | Val: -117.02223271481785
6-th component log probs | Train: 5.163667622174797 | Val: -130.62701508537126
7-th component log probs | Train: 5.2286435272357075 | Val: -102.8299335228873
8-th component log probs | Train: 5.1548157487831 | Val: -171.68203230971935
9-th component log probs | Train: 5.169327540972647 | Val: -151.52931357956652
KEYWORD NR_SAMPLES:1000 DIM:350 AVG_DIFF:14815.8389
Fitting PCA...
0-th component log probs | Train: 5.131118782302389 | Val: -82.18631549756306
1-th component log probs | Train: 4.844959608058619 | Val: -47.25904400151656
2-th component log probs | Train: 5.092859736654963 | Val: -56.93849498031945
3-th component log probs | Train: 5.091635445632499 | Val: -115.73377473137047
4-th component log probs | Train: 5.139543191699916 | Val: -101.43523470461457
5-th component log probs | Train: 5.22125547325805 | Val: -107.79531803843787
6-th component log probs | Train: 5.260665328423226 | Val: -119.78502700305106
7-th component log probs | Train: 5.318393747593896 | Val: -93.81746675539581
8-th component log probs | Train: 5.254153264836303 | Val: -156.203166655694
9-th component log probs | Train: 5.266932461017464 | Val: -138.36448900053264
KEYWORD NR_SAMPLES:1000 DIM:400 AVG_DIFF:12609.9073
Fitting PCA...
0-th component log probs | Train: 5.219904533085319 | Val: -76.74676707883424
1-th component log probs | Train: 4.962314847864805 | Val: -45.029184905434
2-th component log probs | Train: 5.186239418306905 | Val: -52.86258084099369
3-th component log probs | Train: 5.186730327244196 | Val: -106.60065295051325
4-th component log probs | Train: 5.228726934705754 | Val: -93.81371224299686
5-th component log probs | Train: 5.302001298655129 | Val: -99.304433724464
6-th component log probs | Train: 5.337919939850803 | Val: -110.13206283146643
7-th component log probs | Train: 5.389337858836201 | Val: -86.14561973997775
8-th component log probs | Train: 5.332889246305722 | Val: -143.12979749960277
9-th component log probs | Train: 5.344372666822539 | Val: -127.01290774841294
KEYWORD NR_SAMPLES:1000 DIM:450 AVG_DIFF:10804.8043
Fitting PCA...
0-th component log probs | Train: 5.293286883463372 | Val: -71.3418760866619
1-th component log probs | Train: 5.059712750171623 | Val: -42.770681855964085
2-th component log probs | Train: 5.263187354085758 | Val: -49.24883254624273
3-th component log probs | Train: 5.264717147717704 | Val: -98.45489600833378
4-th component log probs | Train: 5.301890778878778 | Val: -86.85564809785268
5-th component log probs | Train: 5.368250639180217 | Val: -91.73755332987271
6-th component log probs | Train: 5.40123181024302 | Val: -101.71602740163232
7-th component log probs | Train: 5.4473225551555124 | Val: -79.46635239086869
8-th component log probs | Train: 5.397035027307029 | Val: -131.5306005213719
9-th component log probs | Train: 5.407390726879661 | Val: -117.1018877160315
KEYWORD NR_SAMPLES:1000 DIM:500 AVG_DIFF:9312.4927
0-th component log probs | Train: 5.309082459204188 | Val: -70.16329602896502
1-th component log probs | Train: 5.080750496887613 | Val: -42.17671749077015
2-th component log probs | Train: 5.279718636747289 | Val: -48.41789525126181
3-th component log probs | Train: 5.2813815853974875 | Val: -96.64429457560543
4-th component log probs | Train: 5.317518408334539 | Val: -85.3415636681667
5-th component log probs | Train: 5.382444474906461 | Val: -90.08079205035011
6-th component log probs | Train: 5.414761157724269 | Val: -99.76220633958566
7-th component log probs | Train: 5.459747680147028 | Val: -77.98743970901677
8-th component log probs | Train: 5.4107201571172245 | Val: -129.0077423844346
9-th component log probs | Train: 5.420826213656131 | Val: -114.88318174066052
KEYWORD NR_SAMPLES:1000 DIM:512 AVG_DIFF:8995.5394
best average differences at 50 dimensions: 285.0013088109053
2022-01-08 03:43.11 [info     ] Training complete              train_loss=0.4056575894355774
2022-01-08 03:43.11 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:43.15 [info     ] Testing complete               test_loss=1.2566949129104614
{'dataset_size': 1000,
 'end_test_accuracy': 0.6249743700027466,
 'end_test_loss': 1.2566949129104614,
 'end_train_accuracy': 0.9935547113418579,
 'end_train_loss': 0.4056575894355774,
 'end_val_accuracy': 0.6986367702484131,
 'end_val_loss': 1.3407251834869385}
2022-01-08 03:43.15 [info     ] Start Predict                  dataset=57606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:43.42 [info     ] Starting training              dataset=2000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
2000
Fitting PCA...
0-th component log probs | Train: 2.4932458992762943 | Val: -2.009409893307405
1-th component log probs | Train: 2.3339641418611086 | Val: -0.4118444637586406
2-th component log probs | Train: 2.231124464636027 | Val: -0.07019451738162771
3-th component log probs | Train: 2.345524108630607 | Val: -2.4413682117695386
4-th component log probs | Train: 2.389584204862628 | Val: -1.7577861902160183
5-th component log probs | Train: 2.4007358680421205 | Val: -1.7669945949483266
6-th component log probs | Train: 2.5023248568271628 | Val: -6.675879737072885
7-th component log probs | Train: 2.4869166815237835 | Val: -3.6420605220785873
8-th component log probs | Train: 2.3842727326384097 | Val: -4.71698133055603
9-th component log probs | Train: 2.447745013245676 | Val: -2.879390401211955
KEYWORD NR_SAMPLES:2000 DIM:50 AVG_DIFF:31.7576
Fitting PCA...
0-th component log probs | Train: 3.159805290320451 | Val: -9.922578411948056
1-th component log probs | Train: 2.914784470712556 | Val: -2.0024815863528014
2-th component log probs | Train: 2.813694865112127 | Val: -1.6082958215614647
3-th component log probs | Train: 2.9636728304532314 | Val: -9.341380719767695
4-th component log probs | Train: 2.992958917563806 | Val: -5.979099571122273
5-th component log probs | Train: 3.0212168642288124 | Val: -7.025504299678356
6-th component log probs | Train: 3.147200539557405 | Val: -20.92313166823235
7-th component log probs | Train: 3.1365936733632984 | Val: -11.073118286934227
8-th component log probs | Train: 3.0605139714790948 | Val: -20.31773565784047
9-th component log probs | Train: 3.103774216113527 | Val: -11.38175249434922
KEYWORD NR_SAMPLES:2000 DIM:100 AVG_DIFF:218.4976
Fitting PCA...
0-th component log probs | Train: 3.643640866756269 | Val: -23.551971208447032
1-th component log probs | Train: 3.2708878122845824 | Val: -3.781035739377228
2-th component log probs | Train: 3.1465461602712206 | Val: -2.9095626915680546
3-th component log probs | Train: 3.383291525204284 | Val: -17.08998739069786
4-th component log probs | Train: 3.4046951282388256 | Val: -11.49950334512329
5-th component log probs | Train: 3.434927490290619 | Val: -13.818271918521619
6-th component log probs | Train: 3.597282350041093 | Val: -36.29341990254018
7-th component log probs | Train: 3.5730531122961846 | Val: -22.315995297018365
8-th component log probs | Train: 3.5897778851129236 | Val: -57.32616715470045
9-th component log probs | Train: 3.5419547491391006 | Val: -23.10076665274909
KEYWORD NR_SAMPLES:2000 DIM:150 AVG_DIFF:865.8755
Fitting PCA...
0-th component log probs | Train: 4.044934861858158 | Val: -35.1027282000044
1-th component log probs | Train: 3.5620346678853942 | Val: -6.322874082953613
2-th component log probs | Train: 3.4148345419561594 | Val: -4.112338268933232
3-th component log probs | Train: 3.7572443350993288 | Val: -31.350023572994417
4-th component log probs | Train: 3.74668481978246 | Val: -17.999071023128508
5-th component log probs | Train: 3.7989547344713723 | Val: -24.048100721389023
6-th component log probs | Train: 3.9868757263978867 | Val: -52.97687367382075
7-th component log probs | Train: 3.94584684799174 | Val: -35.57614465074543
8-th component log probs | Train: 4.042130874037514 | Val: -84.64140622046168
9-th component log probs | Train: 3.9185091202330473 | Val: -37.55016436671373
KEYWORD NR_SAMPLES:2000 DIM:200 AVG_DIFF:1888.8723
Fitting PCA...
0-th component log probs | Train: 4.350237639876924 | Val: -41.58420396539978
1-th component log probs | Train: 3.8192625415817347 | Val: -9.606071432076236
2-th component log probs | Train: 3.642784246804442 | Val: -6.187529064603475
3-th component log probs | Train: 4.082349449577541 | Val: -41.47813812214344
4-th component log probs | Train: 4.03674743708817 | Val: -24.116415681119648
5-th component log probs | Train: 4.100433996415452 | Val: -31.625969459301107
6-th component log probs | Train: 4.28945987730988 | Val: -61.20731752649112
7-th component log probs | Train: 4.246280134211904 | Val: -41.77229213954787
8-th component log probs | Train: 4.364324934904636 | Val: -90.8038045796575
9-th component log probs | Train: 4.225186717328869 | Val: -43.49622913240124
KEYWORD NR_SAMPLES:2000 DIM:250 AVG_DIFF:2466.5303
Fitting PCA...
0-th component log probs | Train: 4.575862038111185 | Val: -43.1204268839108
1-th component log probs | Train: 4.048935203126971 | Val: -12.969815473617416
2-th component log probs | Train: 3.8489051570771657 | Val: -8.487170494355926
3-th component log probs | Train: 4.33503966408354 | Val: -47.568606404675194
4-th component log probs | Train: 4.275677316880382 | Val: -27.72437057423848
5-th component log probs | Train: 4.343037883772504 | Val: -35.58619677940994
6-th component log probs | Train: 4.518779259306139 | Val: -63.05807790900449
7-th component log probs | Train: 4.4760277425338675 | Val: -44.361878515456524
8-th component log probs | Train: 4.597040399248864 | Val: -89.60269555571287
9-th component log probs | Train: 4.46133163719707 | Val: -46.08104609478345
KEYWORD NR_SAMPLES:2000 DIM:300 AVG_DIFF:2682.7543
Fitting PCA...
0-th component log probs | Train: 4.750040977101544 | Val: -42.77077720256447
1-th component log probs | Train: 4.247173649745656 | Val: -14.726570505404945
2-th component log probs | Train: 4.0373392172482365 | Val: -11.011312217315938
3-th component log probs | Train: 4.533333083024707 | Val: -48.92517811794544
4-th component log probs | Train: 4.468203972036902 | Val: -28.975670661973073
5-th component log probs | Train: 4.534331530081315 | Val: -36.48921719050258
6-th component log probs | Train: 4.696463977749342 | Val: -62.96821095125586
7-th component log probs | Train: 4.656553078779198 | Val: -43.892159342947004
8-th component log probs | Train: 4.773179516170115 | Val: -85.35509798038406
9-th component log probs | Train: 4.643345058895871 | Val: -45.52891599476134
KEYWORD NR_SAMPLES:2000 DIM:350 AVG_DIFF:2650.0421
Fitting PCA...
0-th component log probs | Train: 4.8876533650738265 | Val: -41.15609266722715
1-th component log probs | Train: 4.41478369658855 | Val: -15.668727365861956
2-th component log probs | Train: 4.202851916518386 | Val: -12.497739811637318
3-th component log probs | Train: 4.690412506072776 | Val: -48.62996678576855
4-th component log probs | Train: 4.625502875936078 | Val: -28.95689588604369
5-th component log probs | Train: 4.688930449178384 | Val: -35.85932119141017
6-th component log probs | Train: 4.8359426170817725 | Val: -61.19952890952282
7-th component log probs | Train: 4.800372526206247 | Val: -42.700733772306926
8-th component log probs | Train: 4.910621285510045 | Val: -80.44701399955
9-th component log probs | Train: 4.788116629518682 | Val: -44.112581730755
KEYWORD NR_SAMPLES:2000 DIM:400 AVG_DIFF:2512.2756
Fitting PCA...
0-th component log probs | Train: 4.99749463041833 | Val: -39.39975280447367
1-th component log probs | Train: 4.557223836300584 | Val: -15.994092290302184
2-th component log probs | Train: 4.350339436771452 | Val: -13.507961620096683
3-th component log probs | Train: 4.819068916056788 | Val: -46.92390356358716
4-th component log probs | Train: 4.755360941089655 | Val: -28.19582249789268
5-th component log probs | Train: 4.815367751429392 | Val: -34.58168246323313
6-th component log probs | Train: 4.949583322069765 | Val: -58.80889698533657
7-th component log probs | Train: 4.91668434917922 | Val: -40.53496301102385
8-th component log probs | Train: 5.020764984645008 | Val: -75.46263618919231
9-th component log probs | Train: 4.906279920122176 | Val: -42.0537690739582
KEYWORD NR_SAMPLES:2000 DIM:450 AVG_DIFF:2323.6918
Fitting PCA...
0-th component log probs | Train: 5.08914884336968 | Val: -37.38610787675303
1-th component log probs | Train: 4.679845631417288 | Val: -16.0163542758717
2-th component log probs | Train: 4.480911249037632 | Val: -13.751764729248178
3-th component log probs | Train: 4.926228681152343 | Val: -44.86065592933607
4-th component log probs | Train: 4.864751578722313 | Val: -27.252740123862765
5-th component log probs | Train: 4.920731072587902 | Val: -33.15303613770693
6-th component log probs | Train: 5.044070686564511 | Val: -55.4495891822554
7-th component log probs | Train: 5.014189271185936 | Val: -38.38635190185336
8-th component log probs | Train: 5.111531399523144 | Val: -70.56553793914053
9-th component log probs | Train: 5.005003738191685 | Val: -39.925239215581925
KEYWORD NR_SAMPLES:2000 DIM:500 AVG_DIFF:2119.0372
0-th component log probs | Train: 5.1086992042218045 | Val: -36.90639957538734
1-th component log probs | Train: 4.706896173733719 | Val: -15.942852245171299
2-th component log probs | Train: 4.510092717690967 | Val: -13.766885201191048
3-th component log probs | Train: 4.949436179410213 | Val: -44.35825649827618
4-th component log probs | Train: 4.8884791820742 | Val: -26.939741442560504
5-th component log probs | Train: 4.943730219261461 | Val: -32.73545998874933
6-th component log probs | Train: 5.064598889075748 | Val: -54.67679166090393
7-th component log probs | Train: 5.03529531162116 | Val: -37.8368397128082
8-th component log probs | Train: 5.131144077996141 | Val: -69.42516722356362
9-th component log probs | Train: 5.026280647471018 | Val: -39.34445740348578
KEYWORD NR_SAMPLES:2000 DIM:512 AVG_DIFF:2069.6127
best average differences at 50 dimensions: 31.75763316214677
2022-01-08 03:48.46 [info     ] Training complete              train_loss=0.28929832577705383
2022-01-08 03:48.46 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:48.50 [info     ] Testing complete               test_loss=0.9020577073097229
{'dataset_size': 2000,
 'end_test_accuracy': 0.78841632604599,
 'end_test_loss': 0.9020577073097229,
 'end_train_accuracy': 1.0,
 'end_train_loss': 0.28929832577705383,
 'end_val_accuracy': 0.8053229451179504,
 'end_val_loss': 0.841428279876709}
2022-01-08 03:48.50 [info     ] Start Predict                  dataset=56606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:49.20 [info     ] Starting training              dataset=4000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
4000
Fitting PCA...
0-th component log probs | Train: 2.2587901193337836 | Val: 0.8640546379632272
1-th component log probs | Train: 1.9641597984985073 | Val: 1.4344505330578539
2-th component log probs | Train: 2.301425285494578 | Val: 1.014607211252335
3-th component log probs | Train: 1.9344111050843993 | Val: 0.9890408100243947
4-th component log probs | Train: 2.2395657556346253 | Val: 0.7826602803651127
5-th component log probs | Train: 2.2090034425139984 | Val: 0.9201089260509566
6-th component log probs | Train: 2.154822125985255 | Val: 0.5619644092525083
7-th component log probs | Train: 2.3615786795364384 | Val: 0.533510997662776
8-th component log probs | Train: 2.1204149178048604 | Val: 0.7851402954130117
9-th component log probs | Train: 2.1677677456243045 | Val: 0.4751994916817983
KEYWORD NR_SAMPLES:4000 DIM:50 AVG_DIFF:1.0725
Fitting PCA...
0-th component log probs | Train: 2.820894911130938 | Val: 0.1225332117182959
1-th component log probs | Train: 2.4797967654100836 | Val: 1.6863038894683484
2-th component log probs | Train: 2.8427213528180872 | Val: 0.687612246676833
3-th component log probs | Train: 2.4580205400870567 | Val: 1.0189768284953815
4-th component log probs | Train: 2.7758397047517436 | Val: 0.4113276885392026
5-th component log probs | Train: 2.761933980334175 | Val: 0.7838184066452812
6-th component log probs | Train: 2.6826013267012803 | Val: 0.33546422737161646
7-th component log probs | Train: 2.9427027927217724 | Val: -0.4412679373705166
8-th component log probs | Train: 2.6512746181458504 | Val: 0.33556288571681764
9-th component log probs | Train: 2.714683199797007 | Val: -0.04867825758702435
KEYWORD NR_SAMPLES:4000 DIM:100 AVG_DIFF:4.9197
Fitting PCA...
0-th component log probs | Train: 3.171611017607528 | Val: -0.6485322481177215
1-th component log probs | Train: 2.783584237425488 | Val: 1.8955684671677613
2-th component log probs | Train: 3.1558225590053124 | Val: 0.4335570204380785
3-th component log probs | Train: 2.7758714590468174 | Val: 0.9355320296099141
4-th component log probs | Train: 3.1038692847779323 | Val: -0.06876053987205977
5-th component log probs | Train: 3.083663666976892 | Val: 0.49551933375620216
6-th component log probs | Train: 2.999727682579623 | Val: -0.031549350735165155
7-th component log probs | Train: 3.3013702581414384 | Val: -2.15122016217007
8-th component log probs | Train: 2.974783882500603 | Val: -0.15163979821319268
9-th component log probs | Train: 3.05812057134314 | Val: -0.6104924844889962
KEYWORD NR_SAMPLES:4000 DIM:150 AVG_DIFF:10.4998
Fitting PCA...
0-th component log probs | Train: 3.448758302377122 | Val: -1.9108152911789644
1-th component log probs | Train: 3.021300243428421 | Val: 1.9505466822645916
2-th component log probs | Train: 3.3996952738010835 | Val: 0.17835353458528094
3-th component log probs | Train: 3.0235626061909535 | Val: 0.7472860367147363
4-th component log probs | Train: 3.3556914302396033 | Val: -0.5779658753332266
5-th component log probs | Train: 3.3445456136221683 | Val: -0.004351054754147885
6-th component log probs | Train: 3.2577465968301915 | Val: -0.7068129604457735
7-th component log probs | Train: 3.593472844180138 | Val: -4.239088198369439
8-th component log probs | Train: 3.229394529418338 | Val: -0.7535506761961572
9-th component log probs | Train: 3.332110584127385 | Val: -1.7908634782724415
KEYWORD NR_SAMPLES:4000 DIM:200 AVG_DIFF:19.8402
Fitting PCA...
0-th component log probs | Train: 3.695341962436172 | Val: -4.041000015602008
1-th component log probs | Train: 3.2114526703371147 | Val: 1.9508818454363455
2-th component log probs | Train: 3.607156802084233 | Val: -0.3165643835565621
3-th component log probs | Train: 3.2321234527047666 | Val: 0.38508264298528305
4-th component log probs | Train: 3.5649142352834184 | Val: -1.3907697654358686
5-th component log probs | Train: 3.563348716380146 | Val: -0.7117798470210976
6-th component log probs | Train: 3.4747361944033486 | Val: -1.6125884571861262
7-th component log probs | Train: 3.847031393245433 | Val: -6.736232312658722
8-th component log probs | Train: 3.4505750459059925 | Val: -2.014341493910455
9-th component log probs | Train: 3.565740682184604 | Val: -3.388263268383325
KEYWORD NR_SAMPLES:4000 DIM:250 AVG_DIFF:36.1762
Fitting PCA...
0-th component log probs | Train: 3.914087141117326 | Val: -6.187687437335062
1-th component log probs | Train: 3.375750945034682 | Val: 1.8146406343960728
2-th component log probs | Train: 3.7835522494870513 | Val: -0.9311440143939415
3-th component log probs | Train: 3.4148526522944054 | Val: -0.3361874332868944
4-th component log probs | Train: 3.75194458718317 | Val: -2.416416392280061
5-th component log probs | Train: 3.7610446426450235 | Val: -1.7412051627438718
6-th component log probs | Train: 3.667249642148336 | Val: -2.906164742677971
7-th component log probs | Train: 4.068348304766251 | Val: -8.678255841074952
8-th component log probs | Train: 3.6458696284747245 | Val: -3.5335840915045535
9-th component log probs | Train: 3.778254490581371 | Val: -5.50130576518302
KEYWORD NR_SAMPLES:4000 DIM:300 AVG_DIFF:58.2863
Fitting PCA...
0-th component log probs | Train: 4.106657001575428 | Val: -7.950708456488394
1-th component log probs | Train: 3.521488164449725 | Val: 1.6195921200036012
2-th component log probs | Train: 3.9379417267759482 | Val: -1.59680935591502
3-th component log probs | Train: 3.5814044815045625 | Val: -1.26499608944991
4-th component log probs | Train: 3.9170128313997443 | Val: -3.357766527087645
5-th component log probs | Train: 3.9391329346024326 | Val: -2.9715114738401684
6-th component log probs | Train: 3.8417198875448206 | Val: -4.0195254541467715
7-th component log probs | Train: 4.257064596727013 | Val: -10.500142034804888
8-th component log probs | Train: 3.8301036493421305 | Val: -5.4096293618666484
9-th component log probs | Train: 3.9726342783033712 | Val: -7.622498280704401
KEYWORD NR_SAMPLES:4000 DIM:350 AVG_DIFF:84.6266
Fitting PCA...
0-th component log probs | Train: 4.275601154045923 | Val: -9.041831671839896
1-th component log probs | Train: 3.6618991856553453 | Val: 1.259369564009744
2-th component log probs | Train: 4.076687461615894 | Val: -2.1368189245708704
3-th component log probs | Train: 3.7408673865112703 | Val: -2.5181844358256393
4-th component log probs | Train: 4.066026334038707 | Val: -4.134483794863374
5-th component log probs | Train: 4.1013725738810765 | Val: -3.9738716436851695
6-th component log probs | Train: 4.001834744692967 | Val: -5.192016428868071
7-th component log probs | Train: 4.416219189494522 | Val: -11.334342393851665
8-th component log probs | Train: 4.002799840381561 | Val: -6.900322794775431
9-th component log probs | Train: 4.146153980088194 | Val: -9.357249288163489
KEYWORD NR_SAMPLES:4000 DIM:400 AVG_DIFF:108.0524
Fitting PCA...
0-th component log probs | Train: 4.4200565658639 | Val: -9.727085522385472
1-th component log probs | Train: 3.7924332988806078 | Val: 0.8969390997212217
2-th component log probs | Train: 4.203612667893756 | Val: -2.63173210419143
3-th component log probs | Train: 3.891435834383837 | Val: -3.753341469012076
4-th component log probs | Train: 4.202118555365179 | Val: -4.745964688708538
5-th component log probs | Train: 4.246011653399047 | Val: -4.663815457050577
6-th component log probs | Train: 4.145714753951329 | Val: -6.108852874842373
7-th component log probs | Train: 4.551839730151001 | Val: -11.710580029376397
8-th component log probs | Train: 4.157932669219809 | Val: -8.283272627460518
9-th component log probs | Train: 4.297387374874537 | Val: -10.640072023296023
KEYWORD NR_SAMPLES:4000 DIM:450 AVG_DIFF:128.2045
Fitting PCA...
0-th component log probs | Train: 4.546342432844384 | Val: -10.055709366788209
1-th component log probs | Train: 3.9208077889612905 | Val: 0.5500813014295697
2-th component log probs | Train: 4.318769715858043 | Val: -2.9696810957109365
3-th component log probs | Train: 4.036140062418112 | Val: -4.802701069027286
4-th component log probs | Train: 4.325365263833659 | Val: -5.176708689512874
5-th component log probs | Train: 4.375571117841054 | Val: -5.118066044950833
6-th component log probs | Train: 4.277900918420935 | Val: -6.652093528196064
7-th component log probs | Train: 4.66820804423733 | Val: -11.70668120371505
8-th component log probs | Train: 4.295529760457035 | Val: -9.244940994029147
9-th component log probs | Train: 4.430369723781004 | Val: -11.191458068312206
KEYWORD NR_SAMPLES:4000 DIM:500 AVG_DIFF:141.7602
0-th component log probs | Train: 4.574264050237112 | Val: -10.044673404856681
1-th component log probs | Train: 3.9515398831757698 | Val: 0.4513474645228456
2-th component log probs | Train: 4.344755445045273 | Val: -3.018923624464402
3-th component log probs | Train: 4.070181874112691 | Val: -4.986254786466586
4-th component log probs | Train: 4.353898206432866 | Val: -5.215650769932225
5-th component log probs | Train: 4.40502863549106 | Val: -5.193093662599977
6-th component log probs | Train: 4.309098854201177 | Val: -6.682933186628144
7-th component log probs | Train: 4.6942015457817 | Val: -11.671609839938558
8-th component log probs | Train: 4.3271170009287 | Val: -9.36354895662968
9-th component log probs | Train: 4.45997200623863 | Val: -11.29077597223988
KEYWORD NR_SAMPLES:4000 DIM:512 AVG_DIFF:143.7109
best average differences at 50 dimensions: 1.072536253230448
2022-01-08 03:53.21 [info     ] Training complete              train_loss=0.43159210681915283
2022-01-08 03:53.21 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:53.25 [info     ] Testing complete               test_loss=0.6625258326530457
{'dataset_size': 4000,
 'end_test_accuracy': 0.79608154296875,
 'end_test_loss': 0.6625258326530457,
 'end_train_accuracy': 0.96254962682724,
 'end_train_loss': 0.43159210681915283,
 'end_val_accuracy': 0.8392062187194824,
 'end_val_loss': 0.7061260342597961}
2022-01-08 03:53.25 [info     ] Start Predict                  dataset=54606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:53.56 [info     ] Starting training              dataset=6000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
6000
Fitting PCA...
0-th component log probs | Train: 2.117205093693946 | Val: 1.4854283922728702
1-th component log probs | Train: 1.8620729563787273 | Val: 1.607679478799402
2-th component log probs | Train: 1.8743250705876828 | Val: 1.6746762271688727
3-th component log probs | Train: 1.9403817994068595 | Val: 1.2660981684777566
4-th component log probs | Train: 2.0303357145371796 | Val: 1.590533683551257
5-th component log probs | Train: 2.1270691203358782 | Val: 1.0114033982505999
6-th component log probs | Train: 1.9244441086771982 | Val: 1.190691045041212
7-th component log probs | Train: 2.0706766969723067 | Val: 1.4297131118515787
8-th component log probs | Train: 1.9708608950063085 | Val: 1.1415103955233645
9-th component log probs | Train: 2.0418802835995504 | Val: 1.1303372088104477
KEYWORD NR_SAMPLES:6000 DIM:50 AVG_DIFF:-0.8664
Fitting PCA...
0-th component log probs | Train: 2.6708702779266256 | Val: 1.6915071196477813
1-th component log probs | Train: 2.373706614133654 | Val: 2.01988082390069
2-th component log probs | Train: 2.403420180169824 | Val: 2.107464230585026
3-th component log probs | Train: 2.4834073985148755 | Val: 1.4071697764961726
4-th component log probs | Train: 2.5808971074635814 | Val: 1.875899871767365
5-th component log probs | Train: 2.6710181529273496 | Val: 1.0694769692779618
6-th component log probs | Train: 2.456217720050964 | Val: 1.3610100504597547
7-th component log probs | Train: 2.6144404928597114 | Val: 1.5874026133766912
8-th component log probs | Train: 2.518611251042137 | Val: 1.1945812280986832
9-th component log probs | Train: 2.5958503329979026 | Val: 1.1196842335517987
KEYWORD NR_SAMPLES:6000 DIM:100 AVG_DIFF:-0.3855
Fitting PCA...
0-th component log probs | Train: 2.981833563634076 | Val: 1.7683522317570848
1-th component log probs | Train: 2.6783136284964413 | Val: 2.2684826161984466
2-th component log probs | Train: 2.704206006934747 | Val: 2.3694121384788054
3-th component log probs | Train: 2.789710339968253 | Val: 1.562090824103044
4-th component log probs | Train: 2.909797108731898 | Val: 2.011708623762117
5-th component log probs | Train: 2.999596192094094 | Val: 0.826290916589252
6-th component log probs | Train: 2.774638345756129 | Val: 1.4011546571683748
7-th component log probs | Train: 2.9332082504084 | Val: 1.6643074800979043
8-th component log probs | Train: 2.84547169785768 | Val: 1.1115755351555938
9-th component log probs | Train: 2.928383411560072 | Val: 0.9883428974280045
KEYWORD NR_SAMPLES:6000 DIM:150 AVG_DIFF:0.3084
Fitting PCA...
0-th component log probs | Train: 3.219862685914671 | Val: 1.7675748420689343
1-th component log probs | Train: 2.9103556948923894 | Val: 2.4421138769816566
2-th component log probs | Train: 2.9351812465625637 | Val: 2.5468336146476465
3-th component log probs | Train: 3.0257734542527537 | Val: 1.6329341052409516
4-th component log probs | Train: 3.1537421241548027 | Val: 2.078979893814553
5-th component log probs | Train: 3.251956032272581 | Val: 0.5551866550866246
6-th component log probs | Train: 3.0174303473730397 | Val: 1.3985190361484998
7-th component log probs | Train: 3.178401063544154 | Val: 1.6612597928342414
8-th component log probs | Train: 3.0989922237973007 | Val: 1.0020972468770895
9-th component log probs | Train: 3.1826257716455713 | Val: 0.7674241080170112
KEYWORD NR_SAMPLES:6000 DIM:200 AVG_DIFF:1.2147
Fitting PCA...
0-th component log probs | Train: 3.4159607679152946 | Val: 1.6956528667935322
1-th component log probs | Train: 3.0956640209736426 | Val: 2.5568027894314804
2-th component log probs | Train: 3.1189336952175184 | Val: 2.6712659724437664
3-th component log probs | Train: 3.220741189618455 | Val: 1.5751357190249624
4-th component log probs | Train: 3.350688480375151 | Val: 2.0602761524872735
5-th component log probs | Train: 3.467017674178011 | Val: -0.0317629692140487
6-th component log probs | Train: 3.222685114212643 | Val: 1.2004580579436612
7-th component log probs | Train: 3.379436780597953 | Val: 1.5046847814375548
8-th component log probs | Train: 3.3118852061750323 | Val: 0.7209212115932017
9-th component log probs | Train: 3.395730351920286 | Val: 0.3767951989550988
KEYWORD NR_SAMPLES:6000 DIM:250 AVG_DIFF:2.9166
Fitting PCA...
0-th component log probs | Train: 3.581134386299521 | Val: 1.5429080717410917
1-th component log probs | Train: 3.249454194393244 | Val: 2.628130981098275
2-th component log probs | Train: 3.2721071799275623 | Val: 2.7561816734162443
3-th component log probs | Train: 3.3855271841696624 | Val: 1.4291710655796173
4-th component log probs | Train: 3.5193424751850615 | Val: 1.9645129738696663
5-th component log probs | Train: 3.650899306508386 | Val: -0.7047467370679422
6-th component log probs | Train: 3.398357071144359 | Val: 0.850390865606166
7-th component log probs | Train: 3.5530269617316304 | Val: 1.2134152217537924
8-th component log probs | Train: 3.4956221033725776 | Val: 0.15229045638092154
9-th component log probs | Train: 3.580255278043502 | Val: -0.24360078288978343
KEYWORD NR_SAMPLES:6000 DIM:300 AVG_DIFF:5.6200
Fitting PCA...
0-th component log probs | Train: 3.728142597346301 | Val: 1.31844339001453
1-th component log probs | Train: 3.383027701652115 | Val: 2.660953253388966
2-th component log probs | Train: 3.4018536765009344 | Val: 2.8116215852593074
3-th component log probs | Train: 3.534161030982843 | Val: 1.1410348618820718
4-th component log probs | Train: 3.665968447349253 | Val: 1.817947981762144
5-th component log probs | Train: 3.8171024468244257 | Val: -1.5106738239631161
6-th component log probs | Train: 3.556233378192526 | Val: 0.42613473276381064
7-th component log probs | Train: 3.7051843789762056 | Val: 0.9222296438111823
8-th component log probs | Train: 3.6633851526225043 | Val: -0.5542683920414262
9-th component log probs | Train: 3.7458614805074553 | Val: -0.975843068665654
KEYWORD NR_SAMPLES:6000 DIM:350 AVG_DIFF:9.3772
Fitting PCA...
0-th component log probs | Train: 3.858998007201415 | Val: 1.0589633065036015
1-th component log probs | Train: 3.501362376967486 | Val: 2.6633656808348487
2-th component log probs | Train: 3.5178427949545332 | Val: 2.830143948548582
3-th component log probs | Train: 3.66993062279001 | Val: 0.7497161259858054
4-th component log probs | Train: 3.8001720325164405 | Val: 1.5992005298313374
5-th component log probs | Train: 3.9703696877368264 | Val: -2.3242349374695683
6-th component log probs | Train: 3.706367523929739 | Val: -0.3092908918244348
7-th component log probs | Train: 3.8450096583957474 | Val: 0.5384955638428789
8-th component log probs | Train: 3.819295683983978 | Val: -1.4473843965865265
9-th component log probs | Train: 3.8992321450722516 | Val: -1.7547254255727693
KEYWORD NR_SAMPLES:6000 DIM:400 AVG_DIFF:14.5169
Fitting PCA...
0-th component log probs | Train: 3.980199142847544 | Val: 0.7993769961563475
1-th component log probs | Train: 3.6091450630253084 | Val: 2.63379595207695
2-th component log probs | Train: 3.6246678230030422 | Val: 2.8337231264067686
3-th component log probs | Train: 3.7958959952016382 | Val: 0.3331553824279931
4-th component log probs | Train: 3.922837881734118 | Val: 1.3645978511960644
5-th component log probs | Train: 4.109752503056109 | Val: -3.0363102568455913
6-th component log probs | Train: 3.849052691522214 | Val: -0.9854576907550328
7-th component log probs | Train: 3.9747684869494466 | Val: 0.09299826118714596
8-th component log probs | Train: 3.9644046216361053 | Val: -2.280213561107266
9-th component log probs | Train: 4.039647204450316 | Val: -2.4258065649316527
KEYWORD NR_SAMPLES:6000 DIM:450 AVG_DIFF:20.1204
Fitting PCA...
0-th component log probs | Train: 4.092639942970178 | Val: 0.5604127019429536
1-th component log probs | Train: 3.7136240540768184 | Val: 2.5864556432421724
2-th component log probs | Train: 3.7277347904441362 | Val: 2.824054500976224
3-th component log probs | Train: 3.9177384946881704 | Val: -0.0915179121580314
4-th component log probs | Train: 4.040284360638161 | Val: 1.1618824633344373
5-th component log probs | Train: 4.239606272048799 | Val: -3.49083594565331
6-th component log probs | Train: 3.984979282940592 | Val: -1.5652732258804753
7-th component log probs | Train: 4.09767686897866 | Val: -0.30909335021031137
8-th component log probs | Train: 4.101230845044612 | Val: -2.952969721886783
9-th component log probs | Train: 4.1724402335449176 | Val: -3.001731592913302
KEYWORD NR_SAMPLES:6000 DIM:500 AVG_DIFF:25.4417
0-th component log probs | Train: 4.118616637125552 | Val: 0.5223529184713694
1-th component log probs | Train: 3.7385185594425856 | Val: 2.57733564895267
2-th component log probs | Train: 3.7523837680211263 | Val: 2.8253495900977112
3-th component log probs | Train: 3.94728492131622 | Val: -0.19374713824354742
4-th component log probs | Train: 4.068437513749802 | Val: 1.1330258804645306
5-th component log probs | Train: 4.269313200156695 | Val: -3.538295174135308
6-th component log probs | Train: 4.017013940178015 | Val: -1.6987176265055053
7-th component log probs | Train: 4.126845395947458 | Val: -0.38276058272159497
8-th component log probs | Train: 4.1321370077504245 | Val: -3.0798353290346108
9-th component log probs | Train: 4.202442555761545 | Val: -3.1370483884558604
KEYWORD NR_SAMPLES:6000 DIM:512 AVG_DIFF:26.5724
best average differences at 50 dimensions: -0.866359845830656
2022-01-08 03:59.11 [info     ] Training complete              train_loss=0.3869197964668274
2022-01-08 03:59.11 [info     ] Starting evaluating            dataset=26032
2022-01-08 03:59.15 [info     ] Testing complete               test_loss=0.6253882646560669
{'dataset_size': 6000,
 'end_test_accuracy': 0.8048218488693237,
 'end_test_loss': 0.6253882646560669,
 'end_train_accuracy': 0.9694148898124695,
 'end_train_loss': 0.3869197964668274,
 'end_val_accuracy': 0.8406899571418762,
 'end_val_loss': 0.7501882314682007}
2022-01-08 03:59.15 [info     ] Start Predict                  dataset=52606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 03:59.41 [info     ] Starting training              dataset=8000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
8000
Fitting PCA...
0-th component log probs | Train: 2.0570262185354604 | Val: 1.4684012571323548
1-th component log probs | Train: 2.1118650977285456 | Val: 1.7517981253331092
2-th component log probs | Train: 1.9298167742314876 | Val: 1.609742969568397
3-th component log probs | Train: 1.9596254914674969 | Val: 1.140091775870084
4-th component log probs | Train: 2.0815707347980834 | Val: 1.4971047161645805
5-th component log probs | Train: 2.2112040513962037 | Val: 1.2017722609277848
6-th component log probs | Train: 2.088310351418466 | Val: 1.076662573288958
7-th component log probs | Train: 2.1500545326779457 | Val: 1.3151247611794763
8-th component log probs | Train: 1.963216507057642 | Val: 1.2552323625961783
9-th component log probs | Train: 2.0520205281675423 | Val: 1.0294212458597491
KEYWORD NR_SAMPLES:8000 DIM:50 AVG_DIFF:-0.7467
Fitting PCA...
0-th component log probs | Train: 2.582515711308884 | Val: 1.7634322708391235
1-th component log probs | Train: 2.6262124829594082 | Val: 2.0697753656130513
2-th component log probs | Train: 2.4628568648088582 | Val: 2.027235729091336
3-th component log probs | Train: 2.479993526456327 | Val: 1.5004344945450387
4-th component log probs | Train: 2.6151058841832397 | Val: 1.7507846732467318
5-th component log probs | Train: 2.7517936369378564 | Val: 1.2766580400908463
6-th component log probs | Train: 2.6197898722401365 | Val: 1.134505479480676
7-th component log probs | Train: 2.6742718785881205 | Val: 1.5703518694569607
8-th component log probs | Train: 2.502498245430939 | Val: 1.3568043623651904
9-th component log probs | Train: 2.5840255260976632 | Val: 1.1211471870739784
KEYWORD NR_SAMPLES:8000 DIM:100 AVG_DIFF:-0.3641
Fitting PCA...
0-th component log probs | Train: 2.8819482039630033 | Val: 1.9384786233792566
1-th component log probs | Train: 2.935870529789687 | Val: 2.279216324625319
2-th component log probs | Train: 2.772658730251471 | Val: 2.2759851816813623
3-th component log probs | Train: 2.779379404578633 | Val: 1.7586495035562906
4-th component log probs | Train: 2.925196245637496 | Val: 1.9831781709457377
5-th component log probs | Train: 3.0579293201424687 | Val: 1.3500349685144675
6-th component log probs | Train: 2.924012471580829 | Val: 1.216350656421474
7-th component log probs | Train: 2.97955176932466 | Val: 1.6928039266346442
8-th component log probs | Train: 2.8225337050351227 | Val: 1.4983409176050189
9-th component log probs | Train: 2.900349706954672 | Val: 1.2616490380106709
KEYWORD NR_SAMPLES:8000 DIM:150 AVG_DIFF:-0.1830
Fitting PCA...
0-th component log probs | Train: 3.114426435200454 | Val: 2.0613993535383783
1-th component log probs | Train: 3.175990557156185 | Val: 2.421917520352312
2-th component log probs | Train: 3.0036922510325232 | Val: 2.466798060786272
3-th component log probs | Train: 3.009119760675977 | Val: 1.925620620863612
4-th component log probs | Train: 3.155998598744302 | Val: 2.134284216321199
5-th component log probs | Train: 3.2930469419442234 | Val: 1.3850869968923984
6-th component log probs | Train: 3.160196064628238 | Val: 1.2663970806502576
7-th component log probs | Train: 3.222061425542281 | Val: 1.7065445344771863
8-th component log probs | Train: 3.0674240339396155 | Val: 1.5678650390999633
9-th component log probs | Train: 3.1442106839843773 | Val: 1.275740513983982
KEYWORD NR_SAMPLES:8000 DIM:200 AVG_DIFF:0.1235
Fitting PCA...
0-th component log probs | Train: 3.3009107300178204 | Val: 2.1102998055660054
1-th component log probs | Train: 3.3688678927566675 | Val: 2.5208737558675525
2-th component log probs | Train: 3.1864689202155354 | Val: 2.5916139862969594
3-th component log probs | Train: 3.1938394300876856 | Val: 2.0212359789930865
4-th component log probs | Train: 3.339423215055998 | Val: 2.2241837027151203
5-th component log probs | Train: 3.4798116951239577 | Val: 1.3553973370783745
6-th component log probs | Train: 3.3507334471064034 | Val: 1.2002976240860321
7-th component log probs | Train: 3.416936120105524 | Val: 1.6508742752937926
8-th component log probs | Train: 3.2659185250575873 | Val: 1.5406132800469656
9-th component log probs | Train: 3.3420323059018897 | Val: 1.1786301562089752
KEYWORD NR_SAMPLES:8000 DIM:250 AVG_DIFF:0.6629
Fitting PCA...
0-th component log probs | Train: 3.458549233514138 | Val: 2.068787467179871
1-th component log probs | Train: 3.524227081609926 | Val: 2.5593147022037144
2-th component log probs | Train: 3.3347239611467083 | Val: 2.669985797781887
3-th component log probs | Train: 3.345053583341337 | Val: 2.0569503356127705
4-th component log probs | Train: 3.4924575302362673 | Val: 2.262211191264328
5-th component log probs | Train: 3.6352424710276146 | Val: 1.270386486926379
6-th component log probs | Train: 3.508796839667265 | Val: 1.0040321289019871
7-th component log probs | Train: 3.5811605697735374 | Val: 1.5293317031940328
8-th component log probs | Train: 3.4314820966880104 | Val: 1.3949636871918343
9-th component log probs | Train: 3.5061559564516687 | Val: 0.9738663253700104
KEYWORD NR_SAMPLES:8000 DIM:300 AVG_DIFF:1.5324
Fitting PCA...
0-th component log probs | Train: 3.5930407101865143 | Val: 2.0026210540445923
1-th component log probs | Train: 3.6555770309254623 | Val: 2.5736341239272287
2-th component log probs | Train: 3.4610781580833803 | Val: 2.7159547620163482
3-th component log probs | Train: 3.474304765820835 | Val: 2.0368255378740616
4-th component log probs | Train: 3.6221759248242558 | Val: 2.2559555360823214
5-th component log probs | Train: 3.7720493063345013 | Val: 1.1148704057650969
6-th component log probs | Train: 3.6481334891852235 | Val: 0.8212905634504807
7-th component log probs | Train: 3.7250757174884708 | Val: 1.3654815567721077
8-th component log probs | Train: 3.5751289724639923 | Val: 1.2060731305025696
9-th component log probs | Train: 3.648448458382588 | Val: 0.6784557425728616
KEYWORD NR_SAMPLES:8000 DIM:350 AVG_DIFF:2.6470
Fitting PCA...
0-th component log probs | Train: 3.7179340353624397 | Val: 1.8896735936396274
1-th component log probs | Train: 3.7730337109113368 | Val: 2.5558423666958396
2-th component log probs | Train: 3.5739704402585284 | Val: 2.7437714809334106
3-th component log probs | Train: 3.589538040696243 | Val: 1.976907418913121
4-th component log probs | Train: 3.737689646773895 | Val: 2.202653076693384
5-th component log probs | Train: 3.8930306340776077 | Val: 0.9609319533782603
6-th component log probs | Train: 3.7734651665787533 | Val: 0.6051044831238798
7-th component log probs | Train: 3.855042680949884 | Val: 1.12396310894062
8-th component log probs | Train: 3.7055492105609233 | Val: 0.9251311887086767
9-th component log probs | Train: 3.779437962810962 | Val: 0.380326986030627
KEYWORD NR_SAMPLES:8000 DIM:400 AVG_DIFF:4.0485
Fitting PCA...
0-th component log probs | Train: 3.831033314741825 | Val: 1.754708699516024
1-th component log probs | Train: 3.8793139795397376 | Val: 2.5075692344462976
2-th component log probs | Train: 3.6757699039198313 | Val: 2.7422472501814275
3-th component log probs | Train: 3.693909111055984 | Val: 1.9096471469203284
4-th component log probs | Train: 3.84244201321054 | Val: 2.1433906781549172
5-th component log probs | Train: 4.003311150727474 | Val: 0.8755777860246896
6-th component log probs | Train: 3.888067563835881 | Val: 0.3131663914755121
7-th component log probs | Train: 3.9745087229216396 | Val: 0.870652293915056
8-th component log probs | Train: 3.826557564330772 | Val: 0.5367651604084936
9-th component log probs | Train: 3.8991915517747238 | Val: 0.027944065135110684
KEYWORD NR_SAMPLES:8000 DIM:450 AVG_DIFF:5.7459
Fitting PCA...
0-th component log probs | Train: 3.941275858913455 | Val: 1.613741177226271
1-th component log probs | Train: 3.98205091071517 | Val: 2.4559258998446443
2-th component log probs | Train: 3.7737008956561446 | Val: 2.7325059170984933
3-th component log probs | Train: 3.7949927836271207 | Val: 1.8261682015496208
4-th component log probs | Train: 3.9426592718291404 | Val: 2.0836360758470662
5-th component log probs | Train: 4.108401207090164 | Val: 0.7950676474584822
6-th component log probs | Train: 3.9975738184806815 | Val: 0.09557467709787225
7-th component log probs | Train: 4.089559751130809 | Val: 0.6875646443484124
8-th component log probs | Train: 3.9432618350871054 | Val: 0.19365978561426028
9-th component log probs | Train: 4.014296523858782 | Val: -0.26920447493406985
KEYWORD NR_SAMPLES:8000 DIM:500 AVG_DIFF:7.4133
0-th component log probs | Train: 3.967056803364024 | Val: 1.5880190523503492
1-th component log probs | Train: 4.006628978739156 | Val: 2.453438548103694
2-th component log probs | Train: 3.7968697213103346 | Val: 2.735745485391233
3-th component log probs | Train: 3.819181739616674 | Val: 1.8162893989361693
4-th component log probs | Train: 3.9664993756247524 | Val: 2.079961678508686
5-th component log probs | Train: 4.132790358646496 | Val: 0.7925861486094979
6-th component log probs | Train: 4.023760234590851 | Val: 0.05827585767068632
7-th component log probs | Train: 4.116855161556453 | Val: 0.6483026033541063
8-th component log probs | Train: 3.971094611958004 | Val: 0.10198589897826561
9-th component log probs | Train: 4.04155421041714 | Val: -0.33182470504307526
KEYWORD NR_SAMPLES:8000 DIM:512 AVG_DIFF:7.7835
best average differences at 50 dimensions: -0.7467098868831763
2022-01-08 04:05.57 [info     ] Training complete              train_loss=0.4029015302658081
2022-01-08 04:05.57 [info     ] Starting evaluating            dataset=26032
2022-01-08 04:06.01 [info     ] Testing complete               test_loss=0.4542480707168579
{'dataset_size': 8000,
 'end_test_accuracy': 0.8600276708602905,
 'end_test_loss': 0.4542480707168579,
 'end_train_accuracy': 0.9632499814033508,
 'end_train_loss': 0.4029015302658081,
 'end_val_accuracy': 0.8760685920715332,
 'end_val_loss': 0.5583471059799194}
2022-01-08 04:06.01 [info     ] Start Predict                  dataset=50606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 04:06.27 [info     ] Starting training              dataset=10000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
10000
Fitting PCA...
0-th component log probs | Train: 2.2743345791967724 | Val: 1.345337508843859
1-th component log probs | Train: 2.016225504770357 | Val: 1.4880437264374986
2-th component log probs | Train: 1.9895586562705467 | Val: 1.4740201906817822
3-th component log probs | Train: 2.1044665907365494 | Val: 0.5802324738457693
4-th component log probs | Train: 2.0974465118661705 | Val: 1.1964657379316708
5-th component log probs | Train: 2.1229438918873322 | Val: 1.131843886226551
6-th component log probs | Train: 2.0614759446116047 | Val: 0.6747300010750202
7-th component log probs | Train: 2.0426333891749895 | Val: 1.3501043672693425
8-th component log probs | Train: 2.1011490354418862 | Val: 0.7221111489200839
9-th component log probs | Train: 2.1309972601175433 | Val: 0.6267887254556217
KEYWORD NR_SAMPLES:10000 DIM:50 AVG_DIFF:0.1502
Fitting PCA...
0-th component log probs | Train: 2.8200698477018626 | Val: 1.1788987187450275
1-th component log probs | Train: 2.5344686897296276 | Val: 1.7865941755390355
2-th component log probs | Train: 2.534091670505118 | Val: 1.7271376059907493
3-th component log probs | Train: 2.64141930461224 | Val: 0.7137499151208068
4-th component log probs | Train: 2.634049003199689 | Val: 1.2403008889260563
5-th component log probs | Train: 2.6491444369922714 | Val: 1.1428669943036078
6-th component log probs | Train: 2.5911739482140033 | Val: 0.6511548215784796
7-th component log probs | Train: 2.564772450351018 | Val: 1.5348361413511158
8-th component log probs | Train: 2.6149097829104817 | Val: 0.5881815771866582
9-th component log probs | Train: 2.656069609589275 | Val: 0.49333224010599136
KEYWORD NR_SAMPLES:10000 DIM:100 AVG_DIFF:1.4384
Fitting PCA...
0-th component log probs | Train: 3.113235386119902 | Val: 1.2218970075799491
1-th component log probs | Train: 2.8181608626267103 | Val: 2.041910319985608
2-th component log probs | Train: 2.8195340808621334 | Val: 1.9485972174676391
3-th component log probs | Train: 2.926830822974684 | Val: 0.9660942236578062
4-th component log probs | Train: 2.922659032976077 | Val: 1.442931514685942
5-th component log probs | Train: 2.9441132870451234 | Val: 1.2919313534202999
6-th component log probs | Train: 2.8786098402778553 | Val: 0.840506562959876
7-th component log probs | Train: 2.850865460140375 | Val: 1.6279195245765727
8-th component log probs | Train: 2.9115138486583323 | Val: 0.560741413940144
9-th component log probs | Train: 2.9435002470095575 | Val: 0.571744355674619
KEYWORD NR_SAMPLES:10000 DIM:150 AVG_DIFF:1.7989
Fitting PCA...
0-th component log probs | Train: 3.3300299411108902 | Val: 1.1314037643042436
1-th component log probs | Train: 3.030102850066843 | Val: 2.2286396071230223
2-th component log probs | Train: 3.0317378941171493 | Val: 2.108256914750678
3-th component log probs | Train: 3.1365567575614697 | Val: 1.0926282143490376
4-th component log probs | Train: 3.136995847931074 | Val: 1.5993723038188774
5-th component log probs | Train: 3.157254870173213 | Val: 1.442637951422025
6-th component log probs | Train: 3.094989625612588 | Val: 1.0152835891888818
7-th component log probs | Train: 3.070636192832519 | Val: 1.6971524180108177
8-th component log probs | Train: 3.134305891292157 | Val: 0.521053787689701
9-th component log probs | Train: 3.1540583501953834 | Val: 0.601062472722898
KEYWORD NR_SAMPLES:10000 DIM:200 AVG_DIFF:2.1932
Fitting PCA...
0-th component log probs | Train: 3.5084515378734538 | Val: 0.9982430328630911
1-th component log probs | Train: 3.204131217952411 | Val: 2.386278471571303
2-th component log probs | Train: 3.2048818622721846 | Val: 2.24980740968029
3-th component log probs | Train: 3.3096548721025973 | Val: 1.114502664952156
4-th component log probs | Train: 3.3123871247978633 | Val: 1.685689681209916
5-th component log probs | Train: 3.335419750097699 | Val: 1.4709294268999422
6-th component log probs | Train: 3.2723839248156144 | Val: 1.0391435948727366
7-th component log probs | Train: 3.2592128735220656 | Val: 1.687878160765744
8-th component log probs | Train: 3.322098721533368 | Val: 0.38641514638337643
9-th component log probs | Train: 3.329672029330271 | Val: 0.5639788538375234
KEYWORD NR_SAMPLES:10000 DIM:250 AVG_DIFF:2.8964
Fitting PCA...
0-th component log probs | Train: 3.6597897506872195 | Val: 0.9372863399253777
1-th component log probs | Train: 3.34829528988446 | Val: 2.4769872474638377
2-th component log probs | Train: 3.349170997429209 | Val: 2.332710103313763
3-th component log probs | Train: 3.453827666160586 | Val: 1.0756712742236374
4-th component log probs | Train: 3.458109240338426 | Val: 1.7159024404565186
5-th component log probs | Train: 3.4813966292560052 | Val: 1.449688499339818
6-th component log probs | Train: 3.419451199697943 | Val: 0.9942716368279402
7-th component log probs | Train: 3.4170662154699096 | Val: 1.6313608680547707
8-th component log probs | Train: 3.4774961083109983 | Val: 0.24138396750927585
9-th component log probs | Train: 3.480868895546087 | Val: 0.5010376720131946
KEYWORD NR_SAMPLES:10000 DIM:300 AVG_DIFF:3.7089
Fitting PCA...
0-th component log probs | Train: 3.789306588387689 | Val: 0.8346055472894367
1-th component log probs | Train: 3.4710929398736976 | Val: 2.5317335493931896
2-th component log probs | Train: 3.4712447700280253 | Val: 2.381756574342128
3-th component log probs | Train: 3.576385821923769 | Val: 1.042226505450998
4-th component log probs | Train: 3.584152545379341 | Val: 1.6770061455833405
5-th component log probs | Train: 3.6089704731591894 | Val: 1.3364383563234306
6-th component log probs | Train: 3.5485517348218756 | Val: 0.9395869036762682
7-th component log probs | Train: 3.5554646733431454 | Val: 1.4819913141493082
8-th component log probs | Train: 3.614509746045521 | Val: -0.18558752903536516
9-th component log probs | Train: 3.612362074105017 | Val: 0.31987351745102444
KEYWORD NR_SAMPLES:10000 DIM:350 AVG_DIFF:5.0051
Fitting PCA...
0-th component log probs | Train: 3.9079652435219696 | Val: 0.6833366651180436
1-th component log probs | Train: 3.5792051687748705 | Val: 2.5736387170027335
2-th component log probs | Train: 3.580334876281344 | Val: 2.3910434649280337
3-th component log probs | Train: 3.6851178468964814 | Val: 0.9052341435482355
4-th component log probs | Train: 3.698094007648476 | Val: 1.590400515608941
5-th component log probs | Train: 3.7212331504435108 | Val: 1.2496788768401819
6-th component log probs | Train: 3.6644237788346814 | Val: 0.7723095195330993
7-th component log probs | Train: 3.6800586652136147 | Val: 1.3013201256403226
8-th component log probs | Train: 3.736938442036302 | Val: -0.5056290645729559
9-th component log probs | Train: 3.732139631675344 | Val: 0.09171513925018676
KEYWORD NR_SAMPLES:10000 DIM:400 AVG_DIFF:6.5324
Fitting PCA...
0-th component log probs | Train: 4.014355396503356 | Val: 0.546120552584522
1-th component log probs | Train: 3.6797562748933803 | Val: 2.583308770401881
2-th component log probs | Train: 3.68106738821939 | Val: 2.3775975544521724
3-th component log probs | Train: 3.784868554224793 | Val: 0.7960924705229394
4-th component log probs | Train: 3.802147921466181 | Val: 1.459795207352721
5-th component log probs | Train: 3.825456311476355 | Val: 1.0969036906583056
6-th component log probs | Train: 3.7697846467716656 | Val: 0.5766804721280675
7-th component log probs | Train: 3.79475865376762 | Val: 1.057482443970077
8-th component log probs | Train: 3.849144257704681 | Val: -0.8984656171100645
9-th component log probs | Train: 3.8416416091239114 | Val: -0.15770801619353064
KEYWORD NR_SAMPLES:10000 DIM:450 AVG_DIFF:8.3580
Fitting PCA...
0-th component log probs | Train: 4.114024547494954 | Val: 0.43506207989679635
1-th component log probs | Train: 3.7775491746031156 | Val: 2.5991917225208137
2-th component log probs | Train: 3.780359694713912 | Val: 2.3546318447702532
3-th component log probs | Train: 3.8829819650283723 | Val: 0.6114604100496053
4-th component log probs | Train: 3.9019980730365638 | Val: 1.3802234001402462
5-th component log probs | Train: 3.9257061731510983 | Val: 0.9908337192942991
6-th component log probs | Train: 3.8725443416015537 | Val: 0.42451368940736434
7-th component log probs | Train: 3.9049950796829407 | Val: 0.8530387696375424
8-th component log probs | Train: 3.955817865605336 | Val: -1.0851695755695414
9-th component log probs | Train: 3.9451990504686365 | Val: -0.39216223955230584
KEYWORD NR_SAMPLES:10000 DIM:500 AVG_DIFF:9.9888
0-th component log probs | Train: 4.137168038100518 | Val: 0.4353693849754639
1-th component log probs | Train: 3.8008303178737295 | Val: 2.6080912531132414
2-th component log probs | Train: 3.8047247094363663 | Val: 2.3607295377869373
3-th component log probs | Train: 3.90572951555548 | Val: 0.5828642823710395
4-th component log probs | Train: 3.9259775407437902 | Val: 1.37525802771341
5-th component log probs | Train: 3.949051611423993 | Val: 0.9858938643411792
6-th component log probs | Train: 3.8968070577296707 | Val: 0.4027501832812089
7-th component log probs | Train: 3.931581293682499 | Val: 0.8018030081122328
8-th component log probs | Train: 3.981183989745702 | Val: -1.0966191564100942
9-th component log probs | Train: 3.969260458112804 | Val: -0.44013455833279347
KEYWORD NR_SAMPLES:10000 DIM:512 AVG_DIFF:10.2754
best average differences at 50 dimensions: 0.15024984761248528
2022-01-08 04:15.02 [info     ] Training complete              train_loss=0.2593032121658325
2022-01-08 04:15.02 [info     ] Starting evaluating            dataset=26032
2022-01-08 04:15.06 [info     ] Testing complete               test_loss=0.4407788813114166
{'dataset_size': 10000,
 'end_test_accuracy': 0.8774186372756958,
 'end_test_loss': 0.4407788813114166,
 'end_train_accuracy': 0.9959195852279663,
 'end_train_loss': 0.2593032121658325,
 'end_val_accuracy': 0.90205317735672,
 'end_val_loss': 0.4502655565738678}
2022-01-08 04:15.06 [info     ] Start Predict                  dataset=48606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 04:15.39 [info     ] Starting training              dataset=20000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
20000
Fitting PCA...
0-th component log probs | Train: 2.100242976045383 | Val: 1.7246226599361065
1-th component log probs | Train: 2.0302522105480922 | Val: 1.7080525514079141
2-th component log probs | Train: 1.900517107064023 | Val: 1.7363226473945281
3-th component log probs | Train: 1.9795123737061513 | Val: 1.3599045643727017
4-th component log probs | Train: 2.024108453635595 | Val: 1.3396982771345463
5-th component log probs | Train: 1.9734838197252307 | Val: 1.5569433753072344
6-th component log probs | Train: 2.0555459954966615 | Val: 1.128539051543144
7-th component log probs | Train: 2.0173521897221356 | Val: 1.6693593059045733
8-th component log probs | Train: 1.9548080320070216 | Val: 1.3989350147782027
9-th component log probs | Train: 2.0774500333752384 | Val: 1.3667712378720087
KEYWORD NR_SAMPLES:20000 DIM:50 AVG_DIFF:-1.1897
Fitting PCA...
0-th component log probs | Train: 2.642474348708673 | Val: 2.0658663287267798
1-th component log probs | Train: 2.5770471512500412 | Val: 2.2183713397835843
2-th component log probs | Train: 2.4646703590160066 | Val: 2.200140204800203
3-th component log probs | Train: 2.521618677905316 | Val: 1.8731820223485818
4-th component log probs | Train: 2.574445816194404 | Val: 1.8282402581662989
5-th component log probs | Train: 2.5204925008799757 | Val: 2.0052221797407674
6-th component log probs | Train: 2.587762897310494 | Val: 1.4975305255458158
7-th component log probs | Train: 2.558935282333081 | Val: 2.0678476095515492
8-th component log probs | Train: 2.485165778854609 | Val: 1.6891433280925878
9-th component log probs | Train: 2.6186210752952 | Val: 1.654157471997825
KEYWORD NR_SAMPLES:20000 DIM:100 AVG_DIFF:-1.4332
Fitting PCA...
0-th component log probs | Train: 2.9288697564971815 | Val: 2.245468465729296
1-th component log probs | Train: 2.851903385773313 | Val: 2.5021446880159184
2-th component log probs | Train: 2.7562113730429503 | Val: 2.4812402561650004
3-th component log probs | Train: 2.8069285050692496 | Val: 2.1649696113784165
4-th component log probs | Train: 2.8574532274452036 | Val: 2.0843031050864713
5-th component log probs | Train: 2.80460716131849 | Val: 2.290522351763431
6-th component log probs | Train: 2.864407188457328 | Val: 1.7094977511680278
7-th component log probs | Train: 2.8488474970524535 | Val: 2.3056626064863557
8-th component log probs | Train: 2.766380438343779 | Val: 1.979105691406201
9-th component log probs | Train: 2.9086893892634302 | Val: 1.8748293840287973
KEYWORD NR_SAMPLES:20000 DIM:150 AVG_DIFF:-1.6381
Fitting PCA...
0-th component log probs | Train: 3.1374311134458934 | Val: 2.399995597688604
1-th component log probs | Train: 3.058925251828786 | Val: 2.707467072481079
2-th component log probs | Train: 2.9753620298200745 | Val: 2.6774990853171152
3-th component log probs | Train: 3.0183435461843238 | Val: 2.3739950623029182
4-th component log probs | Train: 3.065799816518784 | Val: 2.2910622691206917
5-th component log probs | Train: 3.011841025579948 | Val: 2.4954473001486073
6-th component log probs | Train: 3.07537695694606 | Val: 1.8443615558429862
7-th component log probs | Train: 3.063375238664936 | Val: 2.4525414567986012
8-th component log probs | Train: 2.9758321609503326 | Val: 2.1630315732706875
9-th component log probs | Train: 3.1207581666096407 | Val: 2.0622478959397994
KEYWORD NR_SAMPLES:20000 DIM:200 AVG_DIFF:-1.7760
Fitting PCA...
0-th component log probs | Train: 3.315072316044763 | Val: 2.5133625590534674
1-th component log probs | Train: 3.228889068998152 | Val: 2.8764249795854875
2-th component log probs | Train: 3.1515307139198154 | Val: 2.8371224324289477
3-th component log probs | Train: 3.1924815041463632 | Val: 2.5288168063178293
4-th component log probs | Train: 3.2381747500178344 | Val: 2.4370522272504314
5-th component log probs | Train: 3.184045909863614 | Val: 2.654717398572537
6-th component log probs | Train: 3.2492897794273663 | Val: 1.9037500552156168
7-th component log probs | Train: 3.241603693874118 | Val: 2.5662931596379455
8-th component log probs | Train: 3.151634221391275 | Val: 2.326111328932303
9-th component log probs | Train: 3.296622058006538 | Val: 2.1985211908462263
KEYWORD NR_SAMPLES:20000 DIM:250 AVG_DIFF:-1.8460
Fitting PCA...
0-th component log probs | Train: 3.466492744940379 | Val: 2.593695647037712
1-th component log probs | Train: 3.372561914291012 | Val: 3.010294237647568
2-th component log probs | Train: 3.3008284550766653 | Val: 2.9672342203920077
3-th component log probs | Train: 3.3401018698136653 | Val: 2.6352410350538626
4-th component log probs | Train: 3.38265208790892 | Val: 2.5515248467350364
5-th component log probs | Train: 3.3290800097330133 | Val: 2.776014523100991
6-th component log probs | Train: 3.399989836741106 | Val: 1.9435348300322859
7-th component log probs | Train: 3.393956797289626 | Val: 2.6511055173433697
8-th component log probs | Train: 3.301961110246256 | Val: 2.429632148514366
9-th component log probs | Train: 3.446085939392583 | Val: 2.296875440049381
KEYWORD NR_SAMPLES:20000 DIM:300 AVG_DIFF:-1.8603
Fitting PCA...
0-th component log probs | Train: 3.5996624617313326 | Val: 2.65374823878869
1-th component log probs | Train: 3.49515265407872 | Val: 3.1231216070638936
2-th component log probs | Train: 3.4265557379425995 | Val: 3.0709477262338125
3-th component log probs | Train: 3.465479617453449 | Val: 2.7294709628203555
4-th component log probs | Train: 3.505710554736075 | Val: 2.626970887313608
5-th component log probs | Train: 3.452200297888266 | Val: 2.871992686060571
6-th component log probs | Train: 3.5312899090584273 | Val: 1.9450935349980036
7-th component log probs | Train: 3.5240296978697088 | Val: 2.6957891093360513
8-th component log probs | Train: 3.429281422440569 | Val: 2.4785607969141563
9-th component log probs | Train: 3.5757466646630798 | Val: 2.3620240901910976
KEYWORD NR_SAMPLES:20000 DIM:350 AVG_DIFF:-1.8169
Fitting PCA...
0-th component log probs | Train: 3.7148325477219224 | Val: 2.6736985731413565
1-th component log probs | Train: 3.6027805152064336 | Val: 3.215074372020445
2-th component log probs | Train: 3.536507886560187 | Val: 3.1545924013692863
3-th component log probs | Train: 3.575912301918745 | Val: 2.8050297885215265
4-th component log probs | Train: 3.6140461233066348 | Val: 2.674999438372728
5-th component log probs | Train: 3.5594838199348144 | Val: 2.948112045907294
6-th component log probs | Train: 3.6466423894246125 | Val: 1.9249341060502454
7-th component log probs | Train: 3.638929103699401 | Val: 2.7374134593031614
8-th component log probs | Train: 3.541079254645482 | Val: 2.5155465687603074
9-th component log probs | Train: 3.687218604114547 | Val: 2.400428445687588
KEYWORD NR_SAMPLES:20000 DIM:400 AVG_DIFF:-1.7335
Fitting PCA...
0-th component log probs | Train: 3.820039209705873 | Val: 2.6891627942775718
1-th component log probs | Train: 3.6991578735868345 | Val: 3.293494186611308
2-th component log probs | Train: 3.63459709630281 | Val: 3.2195209475729554
3-th component log probs | Train: 3.67500120572372 | Val: 2.856426330614657
4-th component log probs | Train: 3.7112210509020875 | Val: 2.7203591151085713
5-th component log probs | Train: 3.655064671618116 | Val: 3.0150682097678425
6-th component log probs | Train: 3.7510873558327242 | Val: 1.8750941455476389
7-th component log probs | Train: 3.7393821829897447 | Val: 2.7494168813452946
8-th component log probs | Train: 3.640192472492702 | Val: 2.5126117826395307
9-th component log probs | Train: 3.787837213752267 | Val: 2.402440964525302
KEYWORD NR_SAMPLES:20000 DIM:450 AVG_DIFF:-1.5966
Fitting PCA...
0-th component log probs | Train: 3.9197730954095564 | Val: 2.7157996149592174
1-th component log probs | Train: 3.795281044855355 | Val: 3.3682144954624547
2-th component log probs | Train: 3.7314904164212086 | Val: 3.2866910582461433
3-th component log probs | Train: 3.7738043283605363 | Val: 2.9160752340178338
4-th component log probs | Train: 3.8064306969127144 | Val: 2.774024429577076
5-th component log probs | Train: 3.7519152986338806 | Val: 3.0896329329424086
6-th component log probs | Train: 3.8546966793713358 | Val: 1.885563838225299
7-th component log probs | Train: 3.838907233776173 | Val: 2.769407531804245
8-th component log probs | Train: 3.736249139206542 | Val: 2.5278621050430456
9-th component log probs | Train: 3.883394931413561 | Val: 2.453215850965644
KEYWORD NR_SAMPLES:20000 DIM:500 AVG_DIFF:-1.5190
0-th component log probs | Train: 3.944956154594747 | Val: 2.7416407238176332
1-th component log probs | Train: 3.8201390687923653 | Val: 3.393808070756349
2-th component log probs | Train: 3.757906563826481 | Val: 3.3118574929183993
3-th component log probs | Train: 3.799487096607498 | Val: 2.9477747289282163
4-th component log probs | Train: 3.8306944335725124 | Val: 2.806020866941561
5-th component log probs | Train: 3.776658071191085 | Val: 3.1173490628289673
6-th component log probs | Train: 3.8786309188309 | Val: 1.9201222118904577
7-th component log probs | Train: 3.8666449205529334 | Val: 2.794359095566205
8-th component log probs | Train: 3.7635276194669185 | Val: 2.561623802057539
9-th component log probs | Train: 3.9091750995736914 | Val: 2.487725689448747
KEYWORD NR_SAMPLES:20000 DIM:512 AVG_DIFF:-1.5593
best average differences at 300 dimensions: -1.8602640168978801
2022-01-08 04:29.40 [info     ] Training complete              train_loss=0.3346193730831146
2022-01-08 04:29.40 [info     ] Starting evaluating            dataset=26032
2022-01-08 04:29.44 [info     ] Testing complete               test_loss=0.3113006055355072
{'dataset_size': 20000,
 'end_test_accuracy': 0.9078751802444458,
 'end_test_loss': 0.3113006055355072,
 'end_train_accuracy': 0.9671026468276978,
 'end_train_loss': 0.3346193730831146,
 'end_val_accuracy': 0.9096950888633728,
 'end_val_loss': 0.4247167408466339}
2022-01-08 04:29.44 [info     ] Start Predict                  dataset=38606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 04:30.26 [info     ] Starting training              dataset=30000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
30000
Fitting PCA...
0-th component log probs | Train: 2.1008272541545923 | Val: 1.572700239654758
1-th component log probs | Train: 1.8246573664298005 | Val: 1.6134578269386477
2-th component log probs | Train: 1.9158935925420275 | Val: 1.7368844112965576
3-th component log probs | Train: 2.024510472998369 | Val: 1.4921375715458725
4-th component log probs | Train: 2.067661325672755 | Val: 1.5370756880797476
5-th component log probs | Train: 2.1196438496790435 | Val: 1.5624461790103517
6-th component log probs | Train: 1.9648802245027104 | Val: 1.4548460626776427
7-th component log probs | Train: 2.06921232257452 | Val: 1.4525715550991452
8-th component log probs | Train: 2.041107289960634 | Val: 1.4832390503874735
9-th component log probs | Train: 2.086774778610742 | Val: 1.3047665765565446
KEYWORD NR_SAMPLES:30000 DIM:50 AVG_DIFF:-1.2416
Fitting PCA...
0-th component log probs | Train: 2.667153179912867 | Val: 2.04117528209957
1-th component log probs | Train: 2.3824102837915038 | Val: 2.1590279692122905
2-th component log probs | Train: 2.4678578268470814 | Val: 2.2056076979430435
3-th component log probs | Train: 2.6044850385270992 | Val: 1.9230959234739904
4-th component log probs | Train: 2.631607407219423 | Val: 2.0326617279674304
5-th component log probs | Train: 2.680299693060233 | Val: 1.983554694985281
6-th component log probs | Train: 2.510697901630669 | Val: 1.8682925966159551
7-th component log probs | Train: 2.6267632245590096 | Val: 1.9244411362214024
8-th component log probs | Train: 2.601139682045897 | Val: 1.879054395581418
9-th component log probs | Train: 2.653707039469476 | Val: 1.7739812203902992
KEYWORD NR_SAMPLES:30000 DIM:100 AVG_DIFF:-1.5771
Fitting PCA...
0-th component log probs | Train: 2.9440236732588354 | Val: 2.298822405144239
1-th component log probs | Train: 2.661646423341111 | Val: 2.458487466237547
2-th component log probs | Train: 2.750999460608697 | Val: 2.481602541963686
3-th component log probs | Train: 2.8874003363350162 | Val: 2.191593308690792
4-th component log probs | Train: 2.910270368641825 | Val: 2.3241455107579796
5-th component log probs | Train: 2.9582883922789263 | Val: 2.2730551815990045
6-th component log probs | Train: 2.783585797266203 | Val: 2.14004030440145
7-th component log probs | Train: 2.9007873473652275 | Val: 2.201063642101428
8-th component log probs | Train: 2.8879229178108887 | Val: 2.1455364899842984
9-th component log probs | Train: 2.9233431502806853 | Val: 2.0645289687469712
KEYWORD NR_SAMPLES:30000 DIM:150 AVG_DIFF:-1.8559
Fitting PCA...
0-th component log probs | Train: 3.1456750160974423 | Val: 2.4850014945480137
1-th component log probs | Train: 2.86574913740155 | Val: 2.6725663425907915
2-th component log probs | Train: 2.9534410448150026 | Val: 2.685012383943172
3-th component log probs | Train: 3.091790698299159 | Val: 2.3614172854008677
4-th component log probs | Train: 3.116022342198792 | Val: 2.518199744293889
5-th component log probs | Train: 3.158872479880524 | Val: 2.4523439747724805
6-th component log probs | Train: 2.980862173072142 | Val: 2.327095834135883
7-th component log probs | Train: 3.099832634187805 | Val: 2.3863112950324177
8-th component log probs | Train: 3.095203424605211 | Val: 2.3289531970978845
9-th component log probs | Train: 3.118883359311567 | Val: 2.257990591816593
KEYWORD NR_SAMPLES:30000 DIM:200 AVG_DIFF:-2.0274
Fitting PCA...
0-th component log probs | Train: 3.3105075107219104 | Val: 2.646783807310066
1-th component log probs | Train: 3.03468431348285 | Val: 2.8414349163777928
2-th component log probs | Train: 3.1230227988948043 | Val: 2.8390096328247774
3-th component log probs | Train: 3.2612028843355962 | Val: 2.5064431222526906
4-th component log probs | Train: 3.287832989582239 | Val: 2.676205429640146
5-th component log probs | Train: 3.3273131100263065 | Val: 2.573430317302694
6-th component log probs | Train: 3.1476060165248327 | Val: 2.4699824822706944
7-th component log probs | Train: 3.266637148364921 | Val: 2.5249242436752874
8-th component log probs | Train: 3.270733615536028 | Val: 2.473437196136833
9-th component log probs | Train: 3.2851697412092435 | Val: 2.431689826750969
KEYWORD NR_SAMPLES:30000 DIM:250 AVG_DIFF:-2.1539
Fitting PCA...
0-th component log probs | Train: 3.454448920665052 | Val: 2.770729050352486
1-th component log probs | Train: 3.178627716244011 | Val: 2.988499288007431
2-th component log probs | Train: 3.268419700211642 | Val: 2.95939241692104
3-th component log probs | Train: 3.4076873685615183 | Val: 2.616517061177289
4-th component log probs | Train: 3.4321589347768158 | Val: 2.7824330714446117
5-th component log probs | Train: 3.474446161070418 | Val: 2.661260024196811
6-th component log probs | Train: 3.2924705052329295 | Val: 2.586288630436218
7-th component log probs | Train: 3.4119759091687953 | Val: 2.6257314890461165
8-th component log probs | Train: 3.422763016668302 | Val: 2.579573567256876
9-th component log probs | Train: 3.4288096340012273 | Val: 2.5606826837342767
KEYWORD NR_SAMPLES:30000 DIM:300 AVG_DIFF:-2.2241
Fitting PCA...
0-th component log probs | Train: 3.5795265159928937 | Val: 2.8658581523513047
1-th component log probs | Train: 3.302273670933834 | Val: 3.1102306618307707
2-th component log probs | Train: 3.3938498849343555 | Val: 3.0593399938478885
3-th component log probs | Train: 3.533732746612678 | Val: 2.711165216275686
4-th component log probs | Train: 3.5562864013808384 | Val: 2.8648791679278602
5-th component log probs | Train: 3.601391536221391 | Val: 2.729340774397039
6-th component log probs | Train: 3.416021230123139 | Val: 2.680396003348459
7-th component log probs | Train: 3.5376666556182648 | Val: 2.688372944486002
8-th component log probs | Train: 3.552477490933255 | Val: 2.652826339843569
9-th component log probs | Train: 3.5529365042141556 | Val: 2.66129201434064
KEYWORD NR_SAMPLES:30000 DIM:350 AVG_DIFF:-2.2584
Fitting PCA...
0-th component log probs | Train: 3.691062972157128 | Val: 2.9460908108242174
1-th component log probs | Train: 3.4110866985974337 | Val: 3.2146335593209674
2-th component log probs | Train: 3.507836168644098 | Val: 3.1418989759797236
3-th component log probs | Train: 3.648098216267817 | Val: 2.7875016768590943
4-th component log probs | Train: 3.6672514096966236 | Val: 2.933241220760296
5-th component log probs | Train: 3.715668338819084 | Val: 2.7792000223981197
6-th component log probs | Train: 3.528388078935043 | Val: 2.7606415966415216
7-th component log probs | Train: 3.6511000423942863 | Val: 2.7191421943946725
8-th component log probs | Train: 3.6685095963711047 | Val: 2.721611305258113
9-th component log probs | Train: 3.6630078060449693 | Val: 2.742195109002411
KEYWORD NR_SAMPLES:30000 DIM:400 AVG_DIFF:-2.2660
Fitting PCA...
0-th component log probs | Train: 3.7924546789314277 | Val: 3.0196831573277425
1-th component log probs | Train: 3.510472971931458 | Val: 3.3081038955015916
2-th component log probs | Train: 3.611040500107352 | Val: 3.2066820334827577
3-th component log probs | Train: 3.752979905615446 | Val: 2.844410751825905
4-th component log probs | Train: 3.767038236023763 | Val: 2.9925683249229746
5-th component log probs | Train: 3.8193004462243936 | Val: 2.8356994145306893
6-th component log probs | Train: 3.6312777124637203 | Val: 2.8287211187744736
7-th component log probs | Train: 3.755135930166109 | Val: 2.7725840115733336
8-th component log probs | Train: 3.774900301886569 | Val: 2.76754712450128
9-th component log probs | Train: 3.76278171763475 | Val: 2.8161270747668015
KEYWORD NR_SAMPLES:30000 DIM:450 AVG_DIFF:-2.2677
Fitting PCA...
0-th component log probs | Train: 3.8939504726593954 | Val: 3.1096957230647875
1-th component log probs | Train: 3.6091953795142633 | Val: 3.4054009403774455
2-th component log probs | Train: 3.715206447628148 | Val: 3.2920826776367136
3-th component log probs | Train: 3.861568399016697 | Val: 2.9284774459994254
4-th component log probs | Train: 3.8652424764704216 | Val: 3.0733809059430075
5-th component log probs | Train: 3.9220648783333294 | Val: 2.927940340498069
6-th component log probs | Train: 3.7343953276691044 | Val: 2.9175442435147296
7-th component log probs | Train: 3.8572120960512994 | Val: 2.869092075147379
8-th component log probs | Train: 3.8809325855310672 | Val: 2.8428535481246153
9-th component log probs | Train: 3.8612459340294323 | Val: 2.9195072980711694
KEYWORD NR_SAMPLES:30000 DIM:500 AVG_DIFF:-2.3356
0-th component log probs | Train: 3.923262135199385 | Val: 3.1478831335206983
1-th component log probs | Train: 3.639067305263865 | Val: 3.4370296377316194
2-th component log probs | Train: 3.744783407293695 | Val: 3.324791227512613
3-th component log probs | Train: 3.890159008615411 | Val: 2.968612293963553
4-th component log probs | Train: 3.893459738609609 | Val: 3.1117855137939867
5-th component log probs | Train: 3.9509197488756453 | Val: 2.9696141814489594
6-th component log probs | Train: 3.7648111687159735 | Val: 2.956423644955866
7-th component log probs | Train: 3.885505374990931 | Val: 2.9086018941586578
8-th component log probs | Train: 3.910031142181593 | Val: 2.8804070009487948
9-th component log probs | Train: 3.8900379057395336 | Val: 2.959648203044396
KEYWORD NR_SAMPLES:30000 DIM:512 AVG_DIFF:-2.3890
best average differences at 512 dimensions: -2.388956625644269
2022-01-08 04:49.52 [info     ] Training complete              train_loss=0.30899515748023987
2022-01-08 04:49.52 [info     ] Starting evaluating            dataset=26032
2022-01-08 04:49.56 [info     ] Testing complete               test_loss=0.28626391291618347
{'dataset_size': 30000,
 'end_test_accuracy': 0.9174600839614868,
 'end_test_loss': 0.28626391291618347,
 'end_train_accuracy': 0.9688609838485718,
 'end_train_loss': 0.30899515748023987,
 'end_val_accuracy': 0.9156312346458435,
 'end_val_loss': 0.36389538645744324}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 04:49.56 [info     ] Start Predict                  dataset=28606
2022-01-08 04:50.40 [info     ] Starting training              dataset=40000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
40000
Fitting PCA...
0-th component log probs | Train: 2.158404418678925 | Val: 0.8467260060672877
1-th component log probs | Train: 2.0477941214475397 | Val: 1.2116125932901083
2-th component log probs | Train: 1.9956870570070013 | Val: 1.282687234872013
3-th component log probs | Train: 2.1172009233793845 | Val: 0.530979472834932
4-th component log probs | Train: 2.0586766644104153 | Val: 0.9572844711949038
5-th component log probs | Train: 2.0860232454893723 | Val: 0.9565885286407807
6-th component log probs | Train: 2.1636060303072164 | Val: -0.43557718667174977
7-th component log probs | Train: 2.045325799651482 | Val: 0.6851787499308264
8-th component log probs | Train: 2.0841076518102426 | Val: 0.5369222377502658
9-th component log probs | Train: 2.121596129275216 | Val: 0.5805457834797814
KEYWORD NR_SAMPLES:40000 DIM:50 AVG_DIFF:1.4154
Fitting PCA...
0-th component log probs | Train: 2.7875039010117644 | Val: 1.2320664951928733
1-th component log probs | Train: 2.694035675298373 | Val: 1.6857971985255529
2-th component log probs | Train: 2.623460258803875 | Val: 1.691956848899317
3-th component log probs | Train: 2.7605463093161497 | Val: 0.5614247442801825
4-th component log probs | Train: 2.680759198866329 | Val: 1.4171126513390147
5-th component log probs | Train: 2.7049864085223225 | Val: 1.3434544548784502
6-th component log probs | Train: 2.793439578096883 | Val: -0.45840125144036103
7-th component log probs | Train: 2.6641189627309165 | Val: 1.2125770436986523
8-th component log probs | Train: 2.7171819752641033 | Val: 0.3387032462787566
9-th component log probs | Train: 2.7583833494835037 | Val: 0.46681543798351594
KEYWORD NR_SAMPLES:40000 DIM:100 AVG_DIFF:2.6689
Fitting PCA...
0-th component log probs | Train: 3.052149503277512 | Val: 1.5144386326038548
1-th component log probs | Train: 2.9698700940879137 | Val: 2.0180801433079294
2-th component log probs | Train: 2.9010749390542636 | Val: 1.9938372463908773
3-th component log probs | Train: 3.034189451479139 | Val: 0.8751023881468031
4-th component log probs | Train: 2.9508029257104975 | Val: 1.6616799395601138
5-th component log probs | Train: 2.9669596702926406 | Val: 1.6335295549723212
6-th component log probs | Train: 3.0547835716388922 | Val: -0.2465542035072659
7-th component log probs | Train: 2.9308121035926598 | Val: 1.5543776739129262
8-th component log probs | Train: 2.9893589160637126 | Val: 0.5970926274534828
9-th component log probs | Train: 3.02832134544387 | Val: 0.6117905471646801
KEYWORD NR_SAMPLES:40000 DIM:150 AVG_DIFF:2.4338
Fitting PCA...
0-th component log probs | Train: 3.2388096111512326 | Val: 1.6863698473372224
1-th component log probs | Train: 3.162284481452267 | Val: 2.2575013475406984
2-th component log probs | Train: 3.093315273648821 | Val: 2.190777783139722
3-th component log probs | Train: 3.2264009856613205 | Val: 0.9937636665247075
4-th component log probs | Train: 3.1378471924274676 | Val: 1.8751039658784103
5-th component log probs | Train: 3.15368378871888 | Val: 1.8383679860276612
6-th component log probs | Train: 3.2358995235417516 | Val: -0.04018855798689097
7-th component log probs | Train: 3.1166789462853917 | Val: 1.7133885391848893
8-th component log probs | Train: 3.1816355251281547 | Val: 0.8286631665112307
9-th component log probs | Train: 3.215687767671429 | Val: 0.8020303124414132
KEYWORD NR_SAMPLES:40000 DIM:200 AVG_DIFF:2.2271
Fitting PCA...
0-th component log probs | Train: 3.396685781063691 | Val: 1.825135018128886
1-th component log probs | Train: 3.323612058609698 | Val: 2.446762073683384
2-th component log probs | Train: 3.252376849428892 | Val: 2.34863686342552
3-th component log probs | Train: 3.38754048306408 | Val: 1.1336079251766273
4-th component log probs | Train: 3.2962739549227726 | Val: 2.0269441712677385
5-th component log probs | Train: 3.3134307486728085 | Val: 2.007840812217089
6-th component log probs | Train: 3.396030295005884 | Val: 0.1080978496347957
7-th component log probs | Train: 3.2737951786660884 | Val: 1.9118742771384998
8-th component log probs | Train: 3.3476379647610774 | Val: 0.9916431803709959
9-th component log probs | Train: 3.3767025126474404 | Val: 0.8766456421338661
KEYWORD NR_SAMPLES:40000 DIM:250 AVG_DIFF:2.1240
Fitting PCA...
0-th component log probs | Train: 3.5379141865434054 | Val: 1.9054455130818404
1-th component log probs | Train: 3.46227554779071 | Val: 2.59568955195983
2-th component log probs | Train: 3.391391582800547 | Val: 2.474075642419204
3-th component log probs | Train: 3.5308374993026113 | Val: 1.162435630652072
4-th component log probs | Train: 3.4347420114167817 | Val: 2.1747964951208343
5-th component log probs | Train: 3.4539435748490845 | Val: 2.1088950013393433
6-th component log probs | Train: 3.5371416894294856 | Val: 0.06777831567840109
7-th component log probs | Train: 3.4143409392899815 | Val: 2.048861918432036
8-th component log probs | Train: 3.4918262512913216 | Val: 1.0817575526515428
9-th component log probs | Train: 3.5203564974319654 | Val: 0.9934253991668
KEYWORD NR_SAMPLES:40000 DIM:300 AVG_DIFF:2.2745
Fitting PCA...
0-th component log probs | Train: 3.66490197401865 | Val: 1.956256622784703
1-th component log probs | Train: 3.5852960626691504 | Val: 2.7123675195459667
2-th component log probs | Train: 3.514888187002769 | Val: 2.558657173929281
3-th component log probs | Train: 3.6571521194592522 | Val: 1.204312038192614
4-th component log probs | Train: 3.5583996155546616 | Val: 2.2916384000086216
5-th component log probs | Train: 3.578602562946083 | Val: 2.20598947804132
6-th component log probs | Train: 3.663044686734716 | Val: 0.01788851895511708
7-th component log probs | Train: 3.53759598431254 | Val: 2.1099990873452183
8-th component log probs | Train: 3.6209072876261987 | Val: 1.1466939806953111
9-th component log probs | Train: 3.648081438614839 | Val: 1.0932220862582995
KEYWORD NR_SAMPLES:40000 DIM:350 AVG_DIFF:2.4778
Fitting PCA...
0-th component log probs | Train: 3.781947405748903 | Val: 2.006653067398769
1-th component log probs | Train: 3.6970503518321802 | Val: 2.7973315905265324
2-th component log probs | Train: 3.6279745948280353 | Val: 2.623193215705055
3-th component log probs | Train: 3.7719903178184575 | Val: 1.2154782337301255
4-th component log probs | Train: 3.6728034651826187 | Val: 2.3628598388428212
5-th component log probs | Train: 3.6936267833341443 | Val: 2.2846938946504713
6-th component log probs | Train: 3.7801250250955416 | Val: -0.08210551936150838
7-th component log probs | Train: 3.6518749465775175 | Val: 2.1862276458439047
8-th component log probs | Train: 3.738158983322187 | Val: 1.1160700713243723
9-th component log probs | Train: 3.764099811838582 | Val: 1.111403133484163
KEYWORD NR_SAMPLES:40000 DIM:400 AVG_DIFF:2.8563
Fitting PCA...
0-th component log probs | Train: 3.891779159231378 | Val: 2.10512832366439
1-th component log probs | Train: 3.800625193913493 | Val: 2.8830890818398274
2-th component log probs | Train: 3.7353629486623636 | Val: 2.678991359672151
3-th component log probs | Train: 3.878253260885745 | Val: 1.2582692627556122
4-th component log probs | Train: 3.7798155304113394 | Val: 2.4593807699538437
5-th component log probs | Train: 3.8026945270565564 | Val: 2.3611891687435396
6-th component log probs | Train: 3.887406688116049 | Val: -0.03589513906174473
7-th component log probs | Train: 3.7572722614953236 | Val: 2.224108050884338
8-th component log probs | Train: 3.844755824851513 | Val: 1.1240167942655968
9-th component log probs | Train: 3.8724385110837156 | Val: 1.152275095522672
KEYWORD NR_SAMPLES:40000 DIM:450 AVG_DIFF:3.0170
Fitting PCA...
0-th component log probs | Train: 4.002038703648814 | Val: 2.2794344503707347
1-th component log probs | Train: 3.9069218543378708 | Val: 3.0269875240940896
2-th component log probs | Train: 3.8450296553470977 | Val: 2.807091511165092
3-th component log probs | Train: 3.9857908975523904 | Val: 1.4303561653883259
4-th component log probs | Train: 3.889978226288593 | Val: 2.6246719702338
5-th component log probs | Train: 3.9142972823216255 | Val: 2.514577636868095
6-th component log probs | Train: 3.9935079585301887 | Val: 0.2314218738861308
7-th component log probs | Train: 3.8662791041019196 | Val: 2.3871023884340614
8-th component log probs | Train: 3.95345921014098 | Val: 1.3129614560837197
9-th component log probs | Train: 3.9797557558062495 | Val: 1.3511322552820417
KEYWORD NR_SAMPLES:40000 DIM:500 AVG_DIFF:2.5167
0-th component log probs | Train: 4.034870015588441 | Val: 2.344657963165036
1-th component log probs | Train: 3.9401010856840855 | Val: 3.0770169396181304
2-th component log probs | Train: 3.8800316465688747 | Val: 2.8611930653839956
3-th component log probs | Train: 4.018824672473968 | Val: 1.514701706407478
4-th component log probs | Train: 3.9233207997553956 | Val: 2.682297604272481
5-th component log probs | Train: 3.9485802148023086 | Val: 2.575257105914955
6-th component log probs | Train: 4.026005046928819 | Val: 0.3397298317713233
7-th component log probs | Train: 3.9014943643060773 | Val: 2.450566626630266
8-th component log probs | Train: 3.9864455690182425 | Val: 1.3971365774869355
9-th component log probs | Train: 4.0130234458855885 | Val: 1.4373258954446733
KEYWORD NR_SAMPLES:40000 DIM:512 AVG_DIFF:2.2689
best average differences at 50 dimensions: 1.4154278960229836
2022-01-08 05:20.12 [info     ] Training complete              train_loss=0.17766878008842468
2022-01-08 05:20.12 [info     ] Starting evaluating            dataset=26032
2022-01-08 05:20.16 [info     ] Testing complete               test_loss=0.2866934537887573
{'dataset_size': 40000,
 'end_test_accuracy': 0.9223100543022156,
 'end_test_loss': 0.2866934537887573,
 'end_train_accuracy': 0.9974750280380249,
 'end_train_loss': 0.17766878008842468,
 'end_val_accuracy': 0.9333147406578064,
 'end_val_loss': 0.3293134570121765}
2022-01-08 05:20.16 [info     ] Start Predict                  dataset=18606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-08 05:20.51 [info     ] Starting training              dataset=50000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
50000
Fitting PCA...
0-th component log probs | Train: 2.1528190861999157 | Val: 1.0494142148233208
1-th component log probs | Train: 1.9393974195115216 | Val: 1.471428647502112
2-th component log probs | Train: 1.9558985127048938 | Val: 1.3051039886468152
3-th component log probs | Train: 1.969754299104059 | Val: 1.062516261559674
4-th component log probs | Train: 2.0295329456560247 | Val: 1.1175188781578207
5-th component log probs | Train: 2.0709870463151114 | Val: 0.7724186228981504
6-th component log probs | Train: 2.0667011373262265 | Val: 0.402099608412858
7-th component log probs | Train: 2.027923536028518 | Val: 0.9947298182811893
8-th component log probs | Train: 2.070708793762461 | Val: 0.3808552158021491
9-th component log probs | Train: 2.0886921557605906 | Val: 1.1107775490373164
KEYWORD NR_SAMPLES:50000 DIM:50 AVG_DIFF:0.3185
Fitting PCA...
0-th component log probs | Train: 2.8174118924430487 | Val: 1.11720951895077
1-th component log probs | Train: 2.5784646477080355 | Val: 2.065835870028356
2-th component log probs | Train: 2.6130040960298286 | Val: 1.8573780470644154
3-th component log probs | Train: 2.622765954287122 | Val: 1.4404873284148336
4-th component log probs | Train: 2.6647528548927077 | Val: 1.522392792365188
5-th component log probs | Train: 2.707004966392886 | Val: 1.2447466521143513
6-th component log probs | Train: 2.7086235374032746 | Val: 0.6017615806223747
7-th component log probs | Train: 2.676428560413012 | Val: 1.5395279834499545
8-th component log probs | Train: 2.7120654330477065 | Val: 0.5493588841627671
9-th component log probs | Train: 2.7342350341684 | Val: 1.4522764684175575
KEYWORD NR_SAMPLES:50000 DIM:100 AVG_DIFF:0.7227
Fitting PCA...
0-th component log probs | Train: 3.079998042577328 | Val: 1.4291633421531138
1-th component log probs | Train: 2.8598314621258036 | Val: 2.3859339469889007
2-th component log probs | Train: 2.886150774587108 | Val: 2.17790541325108
3-th component log probs | Train: 2.9016649474634213 | Val: 1.8367350442706412
4-th component log probs | Train: 2.9344043055072464 | Val: 1.883950662358549
5-th component log probs | Train: 2.9674163558735263 | Val: 1.6464047723901367
6-th component log probs | Train: 2.976662309121853 | Val: 0.946068147539097
7-th component log probs | Train: 2.944693977568516 | Val: 1.8826407260446143
8-th component log probs | Train: 2.9783069769883443 | Val: 0.9763744189294632
9-th component log probs | Train: 3.002696302307624 | Val: 1.7477686046834855
KEYWORD NR_SAMPLES:50000 DIM:150 AVG_DIFF:0.1355
Fitting PCA...
0-th component log probs | Train: 3.2743434961336355 | Val: 1.6253677215061217
1-th component log probs | Train: 3.0654349938082954 | Val: 2.6182773746428416
2-th component log probs | Train: 3.080977469852076 | Val: 2.407308682847634
3-th component log probs | Train: 3.1045082640582384 | Val: 2.0894982202213783
4-th component log probs | Train: 3.1330025590301442 | Val: 2.1211602113319037
5-th component log probs | Train: 3.163512790033992 | Val: 1.8347909622293954
6-th component log probs | Train: 3.1729346066161646 | Val: 1.1405112653129645
7-th component log probs | Train: 3.1425785346125648 | Val: 2.094103118887272
8-th component log probs | Train: 3.17546060312523 | Val: 1.261838280553585
9-th component log probs | Train: 3.2005212296401755 | Val: 1.901013293190779
KEYWORD NR_SAMPLES:50000 DIM:200 AVG_DIFF:-0.1321
Fitting PCA...
0-th component log probs | Train: 3.4406327358720667 | Val: 1.760442112952264
1-th component log probs | Train: 3.2364494484611637 | Val: 2.798279798309282
2-th component log probs | Train: 3.246175088474185 | Val: 2.5705916895453873
3-th component log probs | Train: 3.273122162763108 | Val: 2.2707790047194263
4-th component log probs | Train: 3.2981179543143355 | Val: 2.313412351383554
5-th component log probs | Train: 3.3307584690178857 | Val: 1.9943901637283707
6-th component log probs | Train: 3.3407178067010457 | Val: 1.2830992837458395
7-th component log probs | Train: 3.3076472339244645 | Val: 2.249880907931709
8-th component log probs | Train: 3.342638656948123 | Val: 1.4209469217268649
9-th component log probs | Train: 3.3680143664146804 | Val: 1.985712452504708
KEYWORD NR_SAMPLES:50000 DIM:250 AVG_DIFF:-0.2460
Fitting PCA...
0-th component log probs | Train: 3.5878763597333636 | Val: 1.8808506737125803
1-th component log probs | Train: 3.38601427698108 | Val: 2.949575753252325
2-th component log probs | Train: 3.390906903715273 | Val: 2.7004120860751435
3-th component log probs | Train: 3.4224001651132965 | Val: 2.390716109885677
4-th component log probs | Train: 3.4453764620464784 | Val: 2.478306870802397
5-th component log probs | Train: 3.4783492771144657 | Val: 2.144612177548233
6-th component log probs | Train: 3.489779138786067 | Val: 1.3919597612306334
7-th component log probs | Train: 3.451286451916029 | Val: 2.396704557908732
8-th component log probs | Train: 3.4901456067154717 | Val: 1.5383309629369553
9-th component log probs | Train: 3.5171240073897296 | Val: 2.051478551476001
KEYWORD NR_SAMPLES:50000 DIM:300 AVG_DIFF:-0.3093
Fitting PCA...
0-th component log probs | Train: 3.7206204001210748 | Val: 2.009586230773768
1-th component log probs | Train: 3.5199639267795515 | Val: 3.0810532314060763
2-th component log probs | Train: 3.5203682755251977 | Val: 2.8211288520818307
3-th component log probs | Train: 3.5551514284309635 | Val: 2.504819771858672
4-th component log probs | Train: 3.5776858975188075 | Val: 2.6057638357637765
5-th component log probs | Train: 3.6127732780359185 | Val: 2.2366411703183706
6-th component log probs | Train: 3.6243123783316396 | Val: 1.465610712285259
7-th component log probs | Train: 3.581297852280255 | Val: 2.53255094024362
8-th component log probs | Train: 3.6252129303629124 | Val: 1.5919326096656785
9-th component log probs | Train: 3.651345930805943 | Val: 2.133299478045163
KEYWORD NR_SAMPLES:50000 DIM:350 AVG_DIFF:-0.3233
Fitting PCA...
0-th component log probs | Train: 3.8384638447190773 | Val: 2.136430314842925
1-th component log probs | Train: 3.639396039421406 | Val: 3.2024526453467295
2-th component log probs | Train: 3.6371752727029407 | Val: 2.9272837469716575
3-th component log probs | Train: 3.67498320777174 | Val: 2.5976120798785387
4-th component log probs | Train: 3.696839624857089 | Val: 2.7166826493662497
5-th component log probs | Train: 3.7333428152592014 | Val: 2.366566414464952
6-th component log probs | Train: 3.7447478412127344 | Val: 1.6022978093454188
7-th component log probs | Train: 3.697401515737965 | Val: 2.66080883274612
8-th component log probs | Train: 3.7459834108606924 | Val: 1.6795306899566849
9-th component log probs | Train: 3.771420504712521 | Val: 2.237738918232281
KEYWORD NR_SAMPLES:50000 DIM:400 AVG_DIFF:-0.4259
Fitting PCA...
0-th component log probs | Train: 3.9471548311535845 | Val: 2.2751637662880677
1-th component log probs | Train: 3.750546151824392 | Val: 3.3122708734929636
2-th component log probs | Train: 3.748585637935831 | Val: 3.0242362198878707
3-th component log probs | Train: 3.78537082718585 | Val: 2.6896427469631634
4-th component log probs | Train: 3.8094744783220427 | Val: 2.8290713700943777
5-th component log probs | Train: 3.843897375568254 | Val: 2.477607164973571
6-th component log probs | Train: 3.85841148725904 | Val: 1.7540459227996374
7-th component log probs | Train: 3.8069097352601005 | Val: 2.7938781588502564
8-th component log probs | Train: 3.858204483413499 | Val: 1.786657131619124
9-th component log probs | Train: 3.8846530006137723 | Val: 2.363498393607671
KEYWORD NR_SAMPLES:50000 DIM:450 AVG_DIFF:-0.5705
Fitting PCA...
0-th component log probs | Train: 4.063322789696156 | Val: 2.4985938714315514
1-th component log probs | Train: 3.8753610456495937 | Val: 3.4591473092850498
2-th component log probs | Train: 3.8733855819011445 | Val: 3.193680286277225
3-th component log probs | Train: 3.9081425947029054 | Val: 2.876807980571146
4-th component log probs | Train: 3.9320177092230315 | Val: 3.0090135108879466
5-th component log probs | Train: 3.966568889343376 | Val: 2.694235979390333
6-th component log probs | Train: 3.9791455865861556 | Val: 2.01742074067216
7-th component log probs | Train: 3.9296716114172385 | Val: 2.97623116179587
8-th component log probs | Train: 3.9779558549595295 | Val: 2.0418094401948803
9-th component log probs | Train: 4.008755725693921 | Val: 2.5789577929563388
KEYWORD NR_SAMPLES:50000 DIM:500 AVG_DIFF:-1.0177
0-th component log probs | Train: 4.101354729246299 | Val: 2.5695425299863643
1-th component log probs | Train: 3.915828778480731 | Val: 3.508127675804819
2-th component log probs | Train: 3.91437523022562 | Val: 3.2488967599385847
3-th component log probs | Train: 3.949747275202526 | Val: 2.9395022222856726
4-th component log probs | Train: 3.9718764859486835 | Val: 3.0683694741061776
5-th component log probs | Train: 4.006049093196065 | Val: 2.7609245065357513
6-th component log probs | Train: 4.018856765543708 | Val: 2.0991157808373795
7-th component log probs | Train: 3.9707151101718234 | Val: 3.0367739751752616
8-th component log probs | Train: 4.016966463692442 | Val: 2.1219109870930035
9-th component log probs | Train: 4.04711373559815 | Val: 2.6473155170371743
KEYWORD NR_SAMPLES:50000 DIM:512 AVG_DIFF:-1.1549
best average differences at 512 dimensions: -1.1549372003686442
2022-01-08 05:55.10 [info     ] Training complete              train_loss=0.18702292442321777
2022-01-08 05:55.10 [info     ] Starting evaluating            dataset=26032
2022-01-08 05:55.14 [info     ] Testing complete               test_loss=0.2712220847606659
{'dataset_size': 50000,
 'end_test_accuracy': 0.9242551922798157,
 'end_test_loss': 0.2712220847606659,
 'end_train_accuracy': 0.9935861825942993,
 'end_train_loss': 0.18702292442321777,
 'end_val_accuracy': 0.9343440532684326,
 'end_val_loss': 0.29675740003585815}
2022-01-08 05:55.14 [info     ] Start Predict                  dataset=8606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

wandb: Waiting for W&B process to finish, PID 15258... (success).
wandb: - 0.54MB of 0.54MB uploaded (0.00MB deduped)wandb: \ 0.54MB of 0.54MB uploaded (0.00MB deduped)wandb: | 0.54MB of 0.54MB uploaded (0.00MB deduped)wandb: / 0.54MB of 0.54MB uploaded (0.00MB deduped)wandb: - 0.54MB of 0.94MB uploaded (0.00MB deduped)wandb: \ 0.54MB of 0.94MB uploaded (0.00MB deduped)wandb: | 0.54MB of 0.94MB uploaded (0.00MB deduped)wandb: / 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: - 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: \ 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: | 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: / 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: - 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: \ 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:           accuracy_0 
wandb:           accuracy_1 
wandb:          accuracy_10 
wandb:          accuracy_11 
wandb:          accuracy_12 
wandb:          accuracy_13 
wandb:          accuracy_14 
wandb:           accuracy_2 
wandb:           accuracy_3 
wandb:           accuracy_4 
wandb:           accuracy_5 
wandb:           accuracy_6 
wandb:           accuracy_7 
wandb:           accuracy_8 
wandb:           accuracy_9 
wandb:              class_0 
wandb:              class_1 
wandb:              class_2 
wandb:              class_3 
wandb:              class_4 
wandb:              class_5 
wandb:              class_6 
wandb:              class_7 
wandb:              class_8 
wandb:              class_9 
wandb:         dataset_size 
wandb:    end_test_accuracy 
wandb:        end_test_loss 
wandb:   end_train_accuracy 
wandb:       end_train_loss 
wandb:     end_val_accuracy 
wandb:         end_val_loss 
wandb:                epoch 
wandb:               loss_0 
wandb:               loss_1 
wandb:              loss_10 
wandb:              loss_11 
wandb:              loss_12 
wandb:              loss_13 
wandb:              loss_14 
wandb:               loss_2 
wandb:               loss_3 
wandb:               loss_4 
wandb:               loss_5 
wandb:               loss_6 
wandb:               loss_7 
wandb:               loss_8 
wandb:               loss_9 
wandb:                 lr_0 
wandb:                 lr_1 
wandb:                lr_10 
wandb:                lr_11 
wandb:                lr_12 
wandb:                lr_13 
wandb:                lr_14 
wandb:                 lr_2 
wandb:                 lr_3 
wandb:                 lr_4 
wandb:                 lr_5 
wandb:                 lr_6 
wandb:                 lr_7 
wandb:                 lr_8 
wandb:                 lr_9 
wandb:       val_accuracy_0 
wandb:       val_accuracy_1 
wandb:      val_accuracy_10 
wandb:      val_accuracy_11 
wandb:      val_accuracy_12 
wandb:      val_accuracy_13 
wandb:      val_accuracy_14 
wandb:       val_accuracy_2 
wandb:       val_accuracy_3 
wandb:       val_accuracy_4 
wandb:       val_accuracy_5 
wandb:       val_accuracy_6 
wandb:       val_accuracy_7 
wandb:       val_accuracy_8 
wandb:       val_accuracy_9 
wandb:           val_loss_0 
wandb:           val_loss_1 
wandb:          val_loss_10 
wandb:          val_loss_11 
wandb:          val_loss_12 
wandb:          val_loss_13 
wandb:          val_loss_14 
wandb:           val_loss_2 
wandb:           val_loss_3 
wandb:           val_loss_4 
wandb:           val_loss_5 
wandb:           val_loss_6 
wandb:           val_loss_7 
wandb:           val_loss_8 
wandb:           val_loss_9 
wandb: 
wandb: Run summary:
wandb:           accuracy_0 0.95052
wandb:           accuracy_1 0.75
wandb:          accuracy_10 0.99592
wandb:          accuracy_11 0.9671
wandb:          accuracy_12 0.96886
wandb:          accuracy_13 0.99748
wandb:          accuracy_14 0.99359
wandb:           accuracy_2 0.95536
wandb:           accuracy_3 0.99271
wandb:           accuracy_4 0.98197
wandb:           accuracy_5 0.99355
wandb:           accuracy_6 1.0
wandb:           accuracy_7 0.96255
wandb:           accuracy_8 0.96941
wandb:           accuracy_9 0.96325
wandb:              class_0 0.0754
wandb:              class_1 0.15592
wandb:              class_2 0.13974
wandb:              class_3 0.09852
wandb:              class_4 0.10916
wandb:              class_5 0.10162
wandb:              class_6 0.08224
wandb:              class_7 0.08582
wandb:              class_8 0.07834
wandb:              class_9 0.07324
wandb:         dataset_size 50000
wandb:    end_test_accuracy 0.92426
wandb:        end_test_loss 0.27122
wandb:   end_train_accuracy 0.99359
wandb:       end_train_loss 0.18702
wandb:     end_val_accuracy 0.93434
wandb:         end_val_loss 0.29676
wandb:                epoch 32
wandb:               loss_0 0.56886
wandb:               loss_1 1.21235
wandb:              loss_10 0.2593
wandb:              loss_11 0.33462
wandb:              loss_12 0.309
wandb:              loss_13 0.17767
wandb:              loss_14 0.18702
wandb:               loss_2 0.6834
wandb:               loss_3 0.37161
wandb:               loss_4 0.49808
wandb:               loss_5 0.40566
wandb:               loss_6 0.2893
wandb:               loss_7 0.43159
wandb:               loss_8 0.38692
wandb:               loss_9 0.4029
wandb:                 lr_0 0.001
wandb:                 lr_1 0.001
wandb:                lr_10 0.0001
wandb:                lr_11 0.0001
wandb:                lr_12 0.001
wandb:                lr_13 0.0001
wandb:                lr_14 0.0001
wandb:                 lr_2 0.001
wandb:                 lr_3 1e-05
wandb:                 lr_4 0.0001
wandb:                 lr_5 0.0001
wandb:                 lr_6 0.0001
wandb:                 lr_7 0.001
wandb:                 lr_8 0.001
wandb:                 lr_9 0.001
wandb:       val_accuracy_0 0.17111
wandb:       val_accuracy_1 0.19214
wandb:      val_accuracy_10 0.90205
wandb:      val_accuracy_11 0.9097
wandb:      val_accuracy_12 0.91563
wandb:      val_accuracy_13 0.93331
wandb:      val_accuracy_14 0.93434
wandb:       val_accuracy_2 0.44387
wandb:       val_accuracy_3 0.61185
wandb:       val_accuracy_4 0.62985
wandb:       val_accuracy_5 0.69864
wandb:       val_accuracy_6 0.80532
wandb:       val_accuracy_7 0.83921
wandb:       val_accuracy_8 0.84069
wandb:       val_accuracy_9 0.87607
wandb:           val_loss_0 5.37452
wandb:           val_loss_1 4.39266
wandb:          val_loss_10 0.45027
wandb:          val_loss_11 0.42472
wandb:          val_loss_12 0.3639
wandb:          val_loss_13 0.32931
wandb:          val_loss_14 0.29676
wandb:           val_loss_2 2.59301
wandb:           val_loss_3 1.70807
wandb:           val_loss_4 1.77656
wandb:           val_loss_5 1.34073
wandb:           val_loss_6 0.84143
wandb:           val_loss_7 0.70613
wandb:           val_loss_8 0.75019
wandb:           val_loss_9 0.55835
wandb: 
wandb: Synced 6 W&B file(s), 30 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced svhn_hu_greedy_run3: https://wandb.ai/fanconic/hidden_uncertainty/runs/1eli4w7y
wandb: Find logs at: ./wandb/run-20220108_032723-1eli4w7y/logs/debug.log
wandb: 
