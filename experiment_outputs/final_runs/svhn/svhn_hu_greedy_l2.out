svhn_hu_greedy_l2
wandb: Currently logged in as: eth_dlad_team32 (use `wandb login --relogin` to force relogin)
wandb: wandb version 0.12.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.7
wandb: Syncing run svhn_hu_greedy_l2_run1
wandb:  View project at https://wandb.ai/fanconic/hidden_uncertainty
wandb:  View run at https://wandb.ai/fanconic/hidden_uncertainty/runs/kkeg4h1g
wandb: Run data is saved locally in /scratch_net/airfox/fanconic/semproj2/hidden_uncertainty_active_learning/wandb/run-20220109_200018-kkeg4h1g
wandb: Run `wandb offline` to turn off syncing.

Cuda is available:  True
Downloading http://ufldl.stanford.edu/housenumbers/train_32x32.mat to /tmp/train_32x32.mat
  0% 0/182040794 [00:00<?, ?it/s]  0% 14336/182040794 [00:00<32:12, 94205.73it/s]  0% 30720/182040794 [00:00<29:54, 101436.48it/s]  0% 51200/182040794 [00:00<26:09, 115926.54it/s]  0% 78848/182040794 [00:00<21:29, 141131.34it/s]  0% 113664/182040794 [00:00<17:39, 171734.47it/s]  0% 156672/182040794 [00:00<14:32, 208414.85it/s]  0% 205824/182040794 [00:01<12:23, 244671.44it/s]  0% 272384/182040794 [00:01<09:57, 304139.89it/s]  0% 353280/182040794 [00:01<08:06, 373363.43it/s]  0% 449536/182040794 [00:01<06:42, 451060.55it/s]  0% 562176/182040794 [00:01<05:37, 537050.12it/s]  0% 690176/182040794 [00:01<04:50, 623794.97it/s]  0% 840704/182040794 [00:02<04:08, 730479.90it/s]  1% 1013760/182040794 [00:02<03:33, 849220.38it/s]  1% 1219584/182040794 [00:02<03:01, 996207.55it/s]  1% 1460224/182040794 [00:02<02:34, 1166881.13it/s]  1% 1726464/182040794 [00:02<02:15, 1335437.40it/s]  1% 2030592/182040794 [00:02<01:57, 1526488.99it/s]  1% 2375680/182040794 [00:02<01:43, 1741190.20it/s]  2% 2762752/182040794 [00:03<01:30, 1970694.49it/s]  2% 3197952/182040794 [00:03<01:20, 2226408.39it/s]  2% 3681280/182040794 [00:03<01:11, 2499678.31it/s]  2% 4219904/182040794 [00:03<01:03, 2798261.33it/s]  3% 4816896/182040794 [00:03<00:56, 3118220.97it/s]  3% 5465088/182040794 [00:03<00:51, 3446113.12it/s]  3% 6203392/182040794 [00:04<00:45, 3847980.57it/s]  4% 7046144/182040794 [00:04<00:38, 4559138.33it/s]  4% 7975936/182040794 [00:04<00:31, 5472753.22it/s]  5% 8782848/182040794 [00:04<00:29, 5950910.81it/s]  5% 9404416/182040794 [00:04<00:30, 5737963.95it/s]  6% 10248192/182040794 [00:04<00:28, 6114579.68it/s]  6% 11556864/182040794 [00:04<00:22, 7654765.99it/s]  7% 12707840/182040794 [00:04<00:20, 8444121.86it/s]  7% 13572096/182040794 [00:04<00:20, 8071446.90it/s]  8% 14734336/182040794 [00:05<00:19, 8561657.57it/s]  9% 16508928/182040794 [00:05<00:15, 10644900.34it/s] 10% 18064384/182040794 [00:05<00:14, 11622588.66it/s] 11% 19240960/182040794 [00:05<00:14, 10954004.93it/s] 11% 20848640/182040794 [00:05<00:13, 11842737.66it/s] 13% 23323648/182040794 [00:05<00:10, 14830063.41it/s] 14% 25428992/182040794 [00:05<00:09, 16512066.39it/s] 15% 27110400/182040794 [00:05<00:10, 15088885.14it/s] 16% 29260800/182040794 [00:05<00:09, 16191796.59it/s] 18% 32252928/182040794 [00:06<00:07, 19248844.15it/s] 19% 34208768/182040794 [00:06<00:08, 18284421.49it/s] 20% 36062208/182040794 [00:06<00:08, 16907997.57it/s] 21% 38601728/182040794 [00:06<00:08, 16817755.00it/s] 23% 41448448/182040794 [00:06<00:08, 17285046.89it/s] 24% 44392448/182040794 [00:06<00:07, 17696334.44it/s] 26% 47173632/182040794 [00:06<00:07, 17737313.59it/s] 27% 50000896/182040794 [00:07<00:07, 17872388.65it/s] 29% 52835328/182040794 [00:07<00:07, 17951676.63it/s] 31% 55746560/182040794 [00:07<00:06, 18148739.93it/s] 32% 58658816/182040794 [00:07<00:06, 18274437.27it/s] 34% 61546496/182040794 [00:07<00:06, 18280214.03it/s] 35% 64332800/182040794 [00:07<00:06, 18191990.73it/s] 37% 67186688/182040794 [00:08<00:06, 18231716.40it/s] 39% 70090752/182040794 [00:08<00:06, 18330563.25it/s] 40% 72938496/182040794 [00:08<00:05, 18298472.48it/s] 42% 75763712/182040794 [00:08<00:05, 18253874.78it/s] 43% 78631936/182040794 [00:08<00:05, 18296356.21it/s] 45% 81575936/182040794 [00:08<00:05, 18447661.37it/s] 46% 84585472/182040794 [00:09<00:05, 18609357.27it/s] 48% 87384064/182040794 [00:09<00:05, 18432003.83it/s] 50% 90240000/182040794 [00:09<00:05, 18348791.65it/s] 51% 93134848/182040794 [00:09<00:04, 18390904.01it/s] 53% 96088064/182040794 [00:09<00:04, 18472669.84it/s] 54% 98955264/182040794 [00:09<00:04, 18446945.27it/s] 56% 101872640/182040794 [00:09<00:04, 18496489.42it/s] 58% 104755200/182040794 [00:10<00:04, 18472894.36it/s] 59% 107607040/182040794 [00:10<00:04, 18427432.20it/s] 61% 110510080/182040794 [00:10<00:03, 18444146.05it/s] 62% 113475584/182040794 [00:10<00:03, 18575579.15it/s] 64% 116347904/182040794 [00:10<00:03, 18541309.57it/s] 65% 119173120/182040794 [00:10<00:03, 18417688.80it/s] 67% 122110976/182040794 [00:11<00:03, 18522377.50it/s] 69% 125149184/182040794 [00:11<00:03, 18703892.93it/s] 70% 127965184/182040794 [00:11<00:02, 18531146.13it/s] 72% 130864128/182040794 [00:11<00:02, 18516030.81it/s] 73% 133776384/182040794 [00:11<00:02, 18546498.89it/s] 75% 136594432/182040794 [00:11<00:02, 18424543.89it/s] 77% 139441152/182040794 [00:11<00:02, 18390146.33it/s] 78% 142283776/182040794 [00:12<00:02, 18357669.36it/s] 80% 145165312/182040794 [00:12<00:02, 18399425.35it/s] 81% 147947520/182040794 [00:12<00:01, 18259404.77it/s] 83% 150823936/182040794 [00:12<00:01, 18314070.24it/s] 84% 153666560/182040794 [00:12<00:01, 18281998.19it/s] 86% 156607488/182040794 [00:12<00:01, 18427606.38it/s] 88% 159400960/182040794 [00:13<00:01, 18304475.76it/s] 89% 162238464/182040794 [00:13<00:01, 18288131.16it/s] 91% 165009408/182040794 [00:13<00:00, 18149195.52it/s] 92% 167826432/182040794 [00:13<00:00, 18135374.55it/s] 94% 170705920/182040794 [00:13<00:00, 18231435.62it/s] 95% 173523968/182040794 [00:13<00:00, 18197863.54it/s] 97% 176357376/182040794 [00:14<00:00, 18149146.02it/s] 98% 179230720/182040794 [00:14<00:00, 18232277.53it/s]100% 182040576/182040794 [00:14<00:00, 17594049.88it/s]182041600it [00:14, 12700270.28it/s]                   
Downloading http://ufldl.stanford.edu/housenumbers/test_32x32.mat to /tmp/test_32x32.mat
  0% 0/64275384 [00:00<?, ?it/s]  0% 14336/64275384 [00:00<12:31, 85486.32it/s]  0% 33792/64275384 [00:00<10:28, 102165.23it/s]  0% 55296/64275384 [00:00<09:22, 114165.98it/s]  0% 83968/64275384 [00:00<07:52, 135868.62it/s]  0% 124928/64275384 [00:00<06:07, 174470.59it/s]  0% 180224/64275384 [00:01<04:42, 226531.42it/s]  0% 246784/64275384 [00:01<03:46, 282343.56it/s]  1% 327680/64275384 [00:01<03:05, 344267.80it/s]  1% 422912/64275384 [00:01<02:34, 413751.35it/s]  1% 533504/64275384 [00:01<02:10, 489471.06it/s]  1% 654336/64275384 [00:01<01:53, 559765.93it/s]  1% 790528/64275384 [00:02<01:40, 633779.14it/s]  1% 939008/64275384 [00:02<01:29, 707284.32it/s]  2% 1100800/64275384 [00:02<01:20, 783771.65it/s]  2% 1274880/64275384 [00:02<01:13, 858526.20it/s]  2% 1465344/64275384 [00:02<01:06, 940222.32it/s]  3% 1671168/64275384 [00:02<01:00, 1037238.42it/s]  3% 1899520/64275384 [00:03<00:54, 1138722.45it/s]  3% 2154496/64275384 [00:03<00:49, 1253506.94it/s]  4% 2441216/64275384 [00:03<00:44, 1390213.48it/s]  4% 2775040/64275384 [00:03<00:39, 1571367.34it/s]  5% 3153920/64275384 [00:03<00:34, 1781264.81it/s]  6% 3588096/64275384 [00:03<00:30, 2014648.68it/s]  6% 4077568/64275384 [00:04<00:26, 2281904.10it/s]  7% 4636672/64275384 [00:04<00:22, 2596468.62it/s]  8% 5253120/64275384 [00:04<00:20, 2907398.26it/s]  9% 5948416/64275384 [00:04<00:17, 3259245.53it/s] 10% 6710272/64275384 [00:04<00:15, 3634936.66it/s] 12% 7553024/64275384 [00:04<00:14, 4043327.75it/s] 13% 8266752/64275384 [00:05<00:13, 4001730.27it/s] 15% 9392128/64275384 [00:05<00:11, 4886327.87it/s] 16% 10089472/64275384 [00:05<00:11, 4660939.42it/s] 17% 10806272/64275384 [00:05<00:11, 4548392.80it/s] 18% 11542528/64275384 [00:05<00:11, 4487138.35it/s] 19% 12295168/64275384 [00:05<00:11, 4479990.91it/s] 20% 13064192/64275384 [00:06<00:11, 4507835.78it/s] 22% 13850624/64275384 [00:06<00:11, 4551266.12it/s] 23% 14649344/64275384 [00:06<00:10, 4610065.67it/s] 24% 15462400/64275384 [00:06<00:10, 4669355.19it/s] 25% 16287744/64275384 [00:06<00:09, 4840096.55it/s] 27% 17125376/64275384 [00:06<00:09, 4963947.53it/s] 28% 17973248/64275384 [00:07<00:09, 4985745.98it/s] 29% 18833408/64275384 [00:07<00:09, 5033110.41it/s] 31% 19701760/64275384 [00:07<00:08, 5075263.29it/s] 32% 20583424/64275384 [00:07<00:08, 5131706.65it/s] 33% 21474304/64275384 [00:07<00:08, 5181762.20it/s] 35% 22373376/64275384 [00:07<00:08, 5227415.65it/s] 36% 23281664/64275384 [00:08<00:07, 5258982.78it/s] 38% 24198144/64275384 [00:08<00:07, 5302531.97it/s] 39% 25118720/64275384 [00:08<00:07, 5338529.93it/s] 41% 26048512/64275384 [00:08<00:07, 5393828.17it/s] 42% 26986496/64275384 [00:08<00:06, 5447751.98it/s] 43% 27929600/64275384 [00:08<00:06, 5510070.59it/s] 45% 28875776/64275384 [00:09<00:06, 5525856.17it/s] 46% 29827072/64275384 [00:09<00:06, 5547434.55it/s] 48% 30783488/64275384 [00:09<00:06, 5559506.15it/s] 49% 31742976/64275384 [00:09<00:05, 5575651.70it/s] 51% 32707584/64275384 [00:09<00:05, 5604849.40it/s] 52% 33676288/64275384 [00:09<00:05, 5638941.21it/s] 54% 34649088/64275384 [00:10<00:05, 5649767.18it/s] 55% 35627008/64275384 [00:10<00:05, 5678829.67it/s] 57% 36603904/64275384 [00:10<00:04, 6256312.19it/s] 58% 37581824/64275384 [00:10<00:04, 6605602.95it/s] 60% 38259712/64275384 [00:10<00:03, 6535122.05it/s] 61% 38924288/64275384 [00:10<00:04, 5662654.83it/s] 62% 39550976/64275384 [00:10<00:04, 5674876.59it/s] 63% 40537088/64275384 [00:11<00:04, 5740697.56it/s] 65% 41523200/64275384 [00:11<00:03, 5774375.58it/s] 66% 42509312/64275384 [00:11<00:03, 5798673.15it/s] 68% 43499520/64275384 [00:11<00:03, 5909100.07it/s] 69% 44489728/64275384 [00:11<00:03, 6031632.77it/s] 71% 45480960/64275384 [00:11<00:02, 6645138.22it/s] 72% 46162944/64275384 [00:11<00:02, 6551922.78it/s] 73% 46828544/64275384 [00:12<00:02, 5908914.37it/s] 74% 47467520/64275384 [00:12<00:03, 5464380.24it/s] 75% 48457728/64275384 [00:12<00:02, 5738538.47it/s] 77% 49447936/64275384 [00:12<00:02, 6495858.99it/s] 78% 50433024/64275384 [00:12<00:01, 7071698.33it/s] 80% 51161088/64275384 [00:12<00:01, 6936851.97it/s] 81% 51867648/64275384 [00:12<00:02, 6194614.01it/s] 82% 52505600/64275384 [00:13<00:02, 5665331.29it/s] 83% 53409792/64275384 [00:13<00:01, 6335749.86it/s] 85% 54393856/64275384 [00:13<00:01, 6961430.21it/s] 86% 55109632/64275384 [00:13<00:01, 6830787.43it/s] 87% 55805952/64275384 [00:13<00:01, 6083516.08it/s] 88% 56433664/64275384 [00:13<00:01, 5537660.69it/s] 89% 57371648/64275384 [00:13<00:01, 6348771.30it/s] 91% 58355712/64275384 [00:13<00:00, 6975907.65it/s] 92% 59075584/64275384 [00:13<00:00, 6823494.24it/s] 93% 59771904/64275384 [00:14<00:00, 6080539.13it/s] 94% 60400640/64275384 [00:14<00:00, 5543812.49it/s] 95% 61333504/64275384 [00:14<00:00, 6354899.30it/s] 97% 62317568/64275384 [00:14<00:00, 6967536.87it/s] 98% 63036416/64275384 [00:14<00:00, 6819470.86it/s] 99% 63732736/64275384 [00:14<00:00, 6089534.94it/s]64275456it [00:14, 4350896.30it/s]                  
2022-01-09 20:01.03 [info     ] Starting training              dataset=100 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
100
Fitting PCA...
0-th component log probs | Train: 5.117102852449792 | Val: -4746.077135120747
1-th component log probs | Train: 5.039081320403154 | Val: -4079.899918879421
2-th component log probs | Train: 5.037466097770323 | Val: -3905.0219555522967
3-th component log probs | Train: 5.033151932961994 | Val: -4536.050556016511
4-th component log probs | Train: 5.106648181734636 | Val: -5067.000598059857
5-th component log probs | Train: 5.04270915220759 | Val: -5619.716165989193
6-th component log probs | Train: 4.99965712022402 | Val: -5076.033750976304
7-th component log probs | Train: 5.056888859047939 | Val: -3641.4017529153166
8-th component log probs | Train: 5.047673191160213 | Val: -6199.258602899914
9-th component log probs | Train: 5.025783066658507 | Val: -4195.727540543953
KEYWORD NR_SAMPLES:100 DIM:50 AVG_DIFF:22778806.9540
0-th component log probs | Train: 30.201176735519432 | Val: -3149.573310422453
1-th component log probs | Train: 30.17453115388082 | Val: -2591.7781488637984
2-th component log probs | Train: 30.173685831910554 | Val: -2611.3605064858625
3-th component log probs | Train: 30.171186704427168 | Val: -2877.9045636897445
4-th component log probs | Train: 30.19792940663276 | Val: -3173.603601594499
5-th component log probs | Train: 30.172202981092532 | Val: -3396.557258751949
6-th component log probs | Train: 30.15992355342457 | Val: -3085.6455763119725
7-th component log probs | Train: 30.17862872054939 | Val: -2443.225969359838
8-th component log probs | Train: 30.177352752891075 | Val: -3916.7199084330914
9-th component log probs | Train: 30.170502793229154 | Val: -2687.246192581199
KEYWORD NR_SAMPLES:100 DIM:100 AVG_DIFF:9321535.3864
best average differences at 100 dimensions: 9321535.386405533
2022-01-09 20:02.08 [info     ] Training complete              train_loss=0.5016754865646362
2022-01-09 20:02.08 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:02.11 [info     ] Testing complete               test_loss=2.3206605911254883
{'dataset_size': 100,
 'end_test_accuracy': 0.11108977347612381,
 'end_test_loss': 2.3206605911254883,
 'end_train_accuracy': 0.9722222089767456,
 'end_train_loss': 0.5016754865646362,
 'end_val_accuracy': 0.1833101361989975,
 'end_val_loss': 4.7640557289123535}
2022-01-09 20:02.12 [info     ] Start Predict                  dataset=58506
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:02.43 [info     ] Starting training              dataset=200 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
200
Fitting PCA...
0-th component log probs | Train: 4.404421260882644 | Val: -1981.1951863878999
1-th component log probs | Train: 3.8935252928807387 | Val: -712.819062448877
2-th component log probs | Train: 4.323234842823807 | Val: -1074.3487405373003
3-th component log probs | Train: 3.8218714787524757 | Val: -641.1718020831419
4-th component log probs | Train: 4.442207449614918 | Val: -2187.197973721697
5-th component log probs | Train: 3.8901677738289147 | Val: -1535.8098408039227
6-th component log probs | Train: 4.637400771118995 | Val: -1329.0067339548455
7-th component log probs | Train: 4.802172548988969 | Val: -1387.6849323566373
8-th component log probs | Train: 4.115513003433155 | Val: -1060.832454192633
9-th component log probs | Train: 4.316296147758281 | Val: -1230.3380406552287
KEYWORD NR_SAMPLES:200 DIM:50 AVG_DIFF:1958590.8125
Fitting PCA...
0-th component log probs | Train: 5.162713335357044 | Val: -1272.5297699473058
1-th component log probs | Train: 4.882058840101536 | Val: -559.5574597384191
2-th component log probs | Train: 5.127389906381043 | Val: -718.7406946889101
3-th component log probs | Train: 4.854002494245556 | Val: -500.57315009575916
4-th component log probs | Train: 5.179112193047531 | Val: -1370.325375185821
5-th component log probs | Train: 4.873216626935351 | Val: -1056.0437586972578
6-th component log probs | Train: 5.3014460935481456 | Val: -812.0825724504015
7-th component log probs | Train: 5.385135406121637 | Val: -867.9841543337307
8-th component log probs | Train: 5.019775327015917 | Val: -718.5867458377408
9-th component log probs | Train: 5.124159891274923 | Val: -805.1295288772517
KEYWORD NR_SAMPLES:200 DIM:100 AVG_DIFF:835909.7073
Fitting PCA...
0-th component log probs | Train: 5.428803613465273 | Val: -917.3248231344194
1-th component log probs | Train: 5.236851563930572 | Val: -425.820858610729
2-th component log probs | Train: 5.406692647747252 | Val: -535.7632055210129
3-th component log probs | Train: 5.2221507075440865 | Val: -370.7655389366612
4-th component log probs | Train: 5.437396107973384 | Val: -990.4116264040631
5-th component log probs | Train: 5.230700577071179 | Val: -772.641003649222
6-th component log probs | Train: 5.528105289126024 | Val: -576.8620878430561
7-th component log probs | Train: 5.585042238015089 | Val: -615.6548736920566
8-th component log probs | Train: 5.33646890312968 | Val: -525.3508204629292
9-th component log probs | Train: 5.4059330276679205 | Val: -583.7450703986607
KEYWORD NR_SAMPLES:200 DIM:150 AVG_DIFF:442216.1545
0-th component log probs | Train: 14.907842009201898 | Val: -752.5602214160157
1-th component log probs | Train: 14.761236657325801 | Val: -383.8959395927378
2-th component log probs | Train: 14.892683500740532 | Val: -468.87352760239605
3-th component log probs | Train: 14.754952971569914 | Val: -333.75058589929057
4-th component log probs | Train: 14.914039320088412 | Val: -824.8866499529154
5-th component log probs | Train: 14.759949640522793 | Val: -641.4324057341346
6-th component log probs | Train: 14.9853095910434 | Val: -491.28865638753655
7-th component log probs | Train: 15.028427041396355 | Val: -523.851863415543
8-th component log probs | Train: 14.840345558810817 | Val: -455.65162567243533
9-th component log probs | Train: 14.892370689852756 | Val: -499.66021660275345
KEYWORD NR_SAMPLES:200 DIM:200 AVG_DIFF:327210.6591
best average differences at 200 dimensions: 327210.65912908484
2022-01-09 20:03.53 [info     ] Training complete              train_loss=1.3964872360229492
2022-01-09 20:03.53 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:03.56 [info     ] Testing complete               test_loss=2.407365322113037
{'dataset_size': 200,
 'end_test_accuracy': 0.13320280611515045,
 'end_test_loss': 2.407365322113037,
 'end_train_accuracy': 0.79296875,
 'end_train_loss': 1.3964872360229492,
 'end_val_accuracy': 0.19687199592590332,
 'end_val_loss': 3.1081290245056152}
2022-01-09 20:03.56 [info     ] Start Predict                  dataset=58406
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:04.28 [info     ] Starting training              dataset=400 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
400
Fitting PCA...
0-th component log probs | Train: 4.316829844409845 | Val: -2035.220774064332
1-th component log probs | Train: 2.8997309095860766 | Val: -64.76955932134466
2-th component log probs | Train: 2.8045717976160334 | Val: -89.9137804155676
3-th component log probs | Train: 2.6487987043845194 | Val: -34.65230837913699
4-th component log probs | Train: 3.405925130735117 | Val: -375.3658958896325
5-th component log probs | Train: 3.422003172566466 | Val: -458.96585407604334
6-th component log probs | Train: 3.6278975830480893 | Val: -969.8080491556642
7-th component log probs | Train: 3.7163356739921 | Val: -1005.4556111860613
8-th component log probs | Train: 3.4316897402152184 | Val: -990.2731344311184
9-th component log probs | Train: 4.229458869139379 | Val: -1295.2614462615031
KEYWORD NR_SAMPLES:400 DIM:50 AVG_DIFF:917368.2910
Fitting PCA...
0-th component log probs | Train: 5.0980961972285135 | Val: -1400.9141552126687
1-th component log probs | Train: 4.0415611554985515 | Val: -336.0614545852738
2-th component log probs | Train: 4.067756178100411 | Val: -416.7884701389336
3-th component log probs | Train: 3.8385181224369713 | Val: -295.42768500088863
4-th component log probs | Train: 4.543513037944632 | Val: -493.4417494470635
5-th component log probs | Train: 4.526103416993897 | Val: -586.4859783740633
6-th component log probs | Train: 4.706708556107079 | Val: -918.3578811328423
7-th component log probs | Train: 4.764465120554936 | Val: -901.7874286983267
8-th component log probs | Train: 4.604871869826103 | Val: -1008.5958170500026
9-th component log probs | Train: 5.06151898071597 | Val: -1134.8710886943657
KEYWORD NR_SAMPLES:400 DIM:100 AVG_DIFF:695641.1897
Fitting PCA...
0-th component log probs | Train: 5.381056150409608 | Val: -1047.3192578986775
1-th component log probs | Train: 4.603015275070407 | Val: -358.67975911296264
2-th component log probs | Train: 4.641225904692437 | Val: -391.18762257097956
3-th component log probs | Train: 4.461652660973082 | Val: -309.5767020322455
4-th component log probs | Train: 4.988166323892294 | Val: -404.7084655583863
5-th component log probs | Train: 4.9678047981268945 | Val: -503.1304844647618
6-th component log probs | Train: 5.104952430210038 | Val: -735.4275815185194
7-th component log probs | Train: 5.148153242021641 | Val: -714.0610142956808
8-th component log probs | Train: 5.040842193046909 | Val: -810.3934624210286
9-th component log probs | Train: 5.356886975943016 | Val: -858.9457897702817
KEYWORD NR_SAMPLES:400 DIM:150 AVG_DIFF:439907.0575
Fitting PCA...
0-th component log probs | Train: 5.525921529840743 | Val: -851.5660603386638
1-th component log probs | Train: 4.914634165616364 | Val: -321.67193798808717
2-th component log probs | Train: 4.950232951215425 | Val: -344.2371002708177
3-th component log probs | Train: 4.808236451357412 | Val: -282.04773524659595
4-th component log probs | Train: 5.222365008288656 | Val: -344.57736289986696
5-th component log probs | Train: 5.203179967952964 | Val: -430.3672819920058
6-th component log probs | Train: 5.313640533858612 | Val: -615.8687348100794
7-th component log probs | Train: 5.347395695033145 | Val: -587.5555864582992
8-th component log probs | Train: 5.268715739523164 | Val: -659.9559754212257
9-th component log probs | Train: 5.509057149308779 | Val: -703.5151350725698
KEYWORD NR_SAMPLES:400 DIM:200 AVG_DIFF:304020.5758
Fitting PCA...
0-th component log probs | Train: 5.614913896742778 | Val: -710.9296938527516
1-th component log probs | Train: 5.112136541194973 | Val: -285.6952958368559
2-th component log probs | Train: 5.144554272246585 | Val: -299.4828005821628
3-th component log probs | Train: 5.027973801582885 | Val: -247.04613371298475
4-th component log probs | Train: 5.367522078435848 | Val: -296.05137454782647
5-th component log probs | Train: 5.34921148893107 | Val: -368.8190109139531
6-th component log probs | Train: 5.442395483033041 | Val: -520.0677420359918
7-th component log probs | Train: 5.4718696565800515 | Val: -494.4188037900104
8-th component log probs | Train: 5.409101846706896 | Val: -551.1231233562568
9-th component log probs | Train: 5.602374752073622 | Val: -593.6426332883103
KEYWORD NR_SAMPLES:400 DIM:250 AVG_DIFF:218007.3816
Fitting PCA...
0-th component log probs | Train: 5.675359464473342 | Val: -608.1065308350396
1-th component log probs | Train: 5.249635434748016 | Val: -253.08164229354762
2-th component log probs | Train: 5.278892594115058 | Val: -262.9095653645284
3-th component log probs | Train: 5.180492888923915 | Val: -217.87695054940596
4-th component log probs | Train: 5.467132668289458 | Val: -257.686122551353
5-th component log probs | Train: 5.4502427274759855 | Val: -320.00333770557097
6-th component log probs | Train: 5.530628781408351 | Val: -447.49658251274724
7-th component log probs | Train: 5.556363532252283 | Val: -424.5763192517178
8-th component log probs | Train: 5.50431626202609 | Val: -471.39561132584396
9-th component log probs | Train: 5.665470102907799 | Val: -511.32449233533544
KEYWORD NR_SAMPLES:400 DIM:300 AVG_DIFF:162527.2540
Fitting PCA...
0-th component log probs | Train: 5.719329597531118 | Val: -531.7123492056509
1-th component log probs | Train: 5.351673881487699 | Val: -224.65302631439152
2-th component log probs | Train: 5.377630300855633 | Val: -232.9156338376551
3-th component log probs | Train: 5.292728378677195 | Val: -193.60328894612604
4-th component log probs | Train: 5.539951630154934 | Val: -228.15702638825078
5-th component log probs | Train: 5.5244842483785925 | Val: -282.2537246051175
6-th component log probs | Train: 5.594930192724645 | Val: -391.8438587768724
7-th component log probs | Train: 5.617526356387023 | Val: -371.99411442472626
8-th component log probs | Train: 5.573089491540267 | Val: -411.4795089563145
9-th component log probs | Train: 5.711054199556001 | Val: -446.87006472939646
KEYWORD NR_SAMPLES:400 DIM:350 AVG_DIFF:125481.9533
0-th component log probs | Train: 7.429691199837645 | Val: -481.25954560440186
1-th component log probs | Train: 7.106962302511572 | Val: -209.736153982462
2-th component log probs | Train: 7.130233437953075 | Val: -218.7433889909953
3-th component log probs | Train: 7.055599773089074 | Val: -182.89033633629498
4-th component log probs | Train: 7.272320739670202 | Val: -212.45266915950867
5-th component log probs | Train: 7.258499537289064 | Val: -259.46087164240816
6-th component log probs | Train: 7.320715327500667 | Val: -357.3947673150667
7-th component log probs | Train: 7.340671232218155 | Val: -340.47030003337954
8-th component log probs | Train: 7.301832030829564 | Val: -375.5374923688416
9-th component log probs | Train: 7.422511465455556 | Val: -406.26635255066645
KEYWORD NR_SAMPLES:400 DIM:400 AVG_DIFF:106404.9033
best average differences at 400 dimensions: 106404.90328804866
2022-01-09 20:06.06 [info     ] Training complete              train_loss=0.630437433719635
2022-01-09 20:06.06 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:06.10 [info     ] Testing complete               test_loss=2.5043535232543945
{'dataset_size': 400,
 'end_test_accuracy': 0.2048397958278656,
 'end_test_loss': 2.5043535232543945,
 'end_train_accuracy': 0.9308035969734192,
 'end_train_loss': 0.630437433719635,
 'end_val_accuracy': 0.439168781042099,
 'end_val_loss': 2.474438190460205}
2022-01-09 20:06.10 [info     ] Start Predict                  dataset=58206
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:06.41 [info     ] Starting training              dataset=600 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
600
Fitting PCA...
0-th component log probs | Train: 2.860769629723889 | Val: -251.57714356840336
1-th component log probs | Train: 2.624958297175279 | Val: -14.490729864731584
2-th component log probs | Train: 2.870062726314921 | Val: -47.35335312892517
3-th component log probs | Train: 2.507623984339689 | Val: -9.995804318488196
4-th component log probs | Train: 2.817556345357799 | Val: -44.862771394099134
5-th component log probs | Train: 3.1885755854237225 | Val: -164.34820669746458
6-th component log probs | Train: 2.9566042284956406 | Val: -188.82796213481592
7-th component log probs | Train: 3.0776707949521067 | Val: -145.4272297519295
8-th component log probs | Train: 3.086536683920989 | Val: -338.56540473594515
9-th component log probs | Train: 3.1936611369556474 | Val: -413.7724360083572
KEYWORD NR_SAMPLES:600 DIM:50 AVG_DIFF:44747.4113
Fitting PCA...
0-th component log probs | Train: 4.223629502005083 | Val: -543.6617752384105
1-th component log probs | Train: 3.3983848834282844 | Val: -60.07707675035794
2-th component log probs | Train: 3.9655773337006957 | Val: -200.65857148188147
3-th component log probs | Train: 3.52060503555253 | Val: -106.42007815543488
4-th component log probs | Train: 3.9755483650383696 | Val: -217.36705338191715
5-th component log probs | Train: 4.269538956024604 | Val: -409.09998927154004
6-th component log probs | Train: 4.172958067509658 | Val: -501.4325345785979
7-th component log probs | Train: 4.3311191646722635 | Val: -302.5909239079583
8-th component log probs | Train: 4.33026943691844 | Val: -651.3982628658049
9-th component log probs | Train: 4.473564115282678 | Val: -582.8292887227973
KEYWORD NR_SAMPLES:600 DIM:100 AVG_DIFF:170277.5065
Fitting PCA...
0-th component log probs | Train: 4.766412563403413 | Val: -482.45731704948247
1-th component log probs | Train: 4.005187837046772 | Val: -128.35148922092316
2-th component log probs | Train: 4.548015273991763 | Val: -221.17269446212285
3-th component log probs | Train: 4.197607245324249 | Val: -148.56769828517622
4-th component log probs | Train: 4.566140893508997 | Val: -237.34797277899963
5-th component log probs | Train: 4.769990512903796 | Val: -386.38608268167036
6-th component log probs | Train: 4.71494121129927 | Val: -455.5381856596887
7-th component log probs | Train: 4.833009988351194 | Val: -271.2660568350731
8-th component log probs | Train: 4.829660887606089 | Val: -560.6733974265895
9-th component log probs | Train: 4.949559413892992 | Val: -487.3711182499635
KEYWORD NR_SAMPLES:600 DIM:150 AVG_DIFF:139095.4836
Fitting PCA...
0-th component log probs | Train: 5.052992069785666 | Val: -409.8734152104662
1-th component log probs | Train: 4.408224057374587 | Val: -137.01075090005818
2-th component log probs | Train: 4.868558972478532 | Val: -204.94508596396204
3-th component log probs | Train: 4.589378371132404 | Val: -152.9461796479383
4-th component log probs | Train: 4.885246763996474 | Val: -222.31677778938527
5-th component log probs | Train: 5.0435564704569975 | Val: -331.93824890659016
6-th component log probs | Train: 5.006978395174057 | Val: -395.70798567537474
7-th component log probs | Train: 5.098897287611109 | Val: -237.72719791927767
8-th component log probs | Train: 5.097641742013842 | Val: -479.80622134000606
9-th component log probs | Train: 5.1976128331407745 | Val: -406.4855444214934
KEYWORD NR_SAMPLES:600 DIM:200 AVG_DIFF:105033.1738
Fitting PCA...
0-th component log probs | Train: 5.2315332452838454 | Val: -350.6655875309569
1-th component log probs | Train: 4.681069032257269 | Val: -128.8574152098472
2-th component log probs | Train: 5.074402420058632 | Val: -184.9231302235104
3-th component log probs | Train: 4.842419196701471 | Val: -141.9718233038663
4-th component log probs | Train: 5.088400326654411 | Val: -198.99833581680195
5-th component log probs | Train: 5.215162679731981 | Val: -288.762211243847
6-th component log probs | Train: 5.188760835441166 | Val: -343.9675484920803
7-th component log probs | Train: 5.265614092457187 | Val: -205.50724622249604
8-th component log probs | Train: 5.264821560884735 | Val: -412.64815130399853
9-th component log probs | Train: 5.350598942633468 | Val: -346.202457662142
KEYWORD NR_SAMPLES:600 DIM:250 AVG_DIFF:79479.8995
Fitting PCA...
0-th component log probs | Train: 5.353601707665791 | Val: -304.37579767362655
1-th component log probs | Train: 4.874404720223201 | Val: -120.22294240392335
2-th component log probs | Train: 5.2160390169152935 | Val: -166.11391215806958
3-th component log probs | Train: 5.018920706590264 | Val: -131.404826221037
4-th component log probs | Train: 5.228140833737309 | Val: -177.0548405583142
5-th component log probs | Train: 5.3345358161723215 | Val: -256.7548429205783
6-th component log probs | Train: 5.314056360676795 | Val: -303.0218406868242
7-th component log probs | Train: 5.379987560618927 | Val: -181.1556742232215
8-th component log probs | Train: 5.3803289765608175 | Val: -360.4891336668281
9-th component log probs | Train: 5.454376987080699 | Val: -302.06299924163704
KEYWORD NR_SAMPLES:600 DIM:300 AVG_DIFF:61975.8945
Fitting PCA...
0-th component log probs | Train: 5.442320044268523 | Val: -267.95646068239756
1-th component log probs | Train: 5.020334147611863 | Val: -111.02420869030304
2-th component log probs | Train: 5.320571859210468 | Val: -149.38776826651545
3-th component log probs | Train: 5.150039019327962 | Val: -119.94056836463727
4-th component log probs | Train: 5.331083631507707 | Val: -159.47501860147628
5-th component log probs | Train: 5.421908297621302 | Val: -228.97418785317697
6-th component log probs | Train: 5.406120210860352 | Val: -269.46957706961996
7-th component log probs | Train: 5.463512738780655 | Val: -161.31586740517722
8-th component log probs | Train: 5.464324106125895 | Val: -319.5860876819202
9-th component log probs | Train: 5.529532414195928 | Val: -266.6400074257309
KEYWORD NR_SAMPLES:600 DIM:350 AVG_DIFF:49300.4180
Fitting PCA...
0-th component log probs | Train: 5.509684130870349 | Val: -239.73580059930367
1-th component log probs | Train: 5.133662338164051 | Val: -102.06325396844717
2-th component log probs | Train: 5.401132491462306 | Val: -135.54970182680717
3-th component log probs | Train: 5.251180170622564 | Val: -109.4080834468418
4-th component log probs | Train: 5.41031300700328 | Val: -144.81135864141743
5-th component log probs | Train: 5.489179615463632 | Val: -206.3286661983509
6-th component log probs | Train: 5.476673543748649 | Val: -242.03211849150702
7-th component log probs | Train: 5.527421742823713 | Val: -145.17709138667482
8-th component log probs | Train: 5.52854513578506 | Val: -285.68181619704194
9-th component log probs | Train: 5.586422216604044 | Val: -238.71252793829817
KEYWORD NR_SAMPLES:600 DIM:400 AVG_DIFF:40054.1666
Fitting PCA...
0-th component log probs | Train: 5.562592593992267 | Val: -216.83360615658634
1-th component log probs | Train: 5.2247336143537 | Val: -94.01590420313833
2-th component log probs | Train: 5.464975579537399 | Val: -123.68014450231435
3-th component log probs | Train: 5.331475285969187 | Val: -100.60687344301746
4-th component log probs | Train: 5.4731587704077995 | Val: -131.93043811979624
5-th component log probs | Train: 5.542888095464359 | Val: -186.98879471552584
6-th component log probs | Train: 5.532443020967861 | Val: -219.30587156880554
7-th component log probs | Train: 5.577955242374942 | Val: -131.91128141670956
8-th component log probs | Train: 5.579072157841319 | Val: -258.2915529300213
9-th component log probs | Train: 5.630909214852787 | Val: -215.9874217084007
KEYWORD NR_SAMPLES:600 DIM:450 AVG_DIFF:33135.6316
Fitting PCA...
0-th component log probs | Train: 5.605133649031864 | Val: -198.1059257334795
1-th component log probs | Train: 5.29968204205106 | Val: -86.78439763664355
2-th component log probs | Train: 5.516953997453674 | Val: -113.67727075061862
3-th component log probs | Train: 5.396641558787369 | Val: -93.06690546048101
4-th component log probs | Train: 5.524223941986923 | Val: -121.1178191704283
5-th component log probs | Train: 5.586843648767661 | Val: -170.6283874363196
6-th component log probs | Train: 5.5777216194819665 | Val: -200.12171183556669
7-th component log probs | Train: 5.6187850257223175 | Val: -120.98147428297167
8-th component log probs | Train: 5.619888728059549 | Val: -235.43387678346778
9-th component log probs | Train: 5.666646035477303 | Val: -197.26473061256962
KEYWORD NR_SAMPLES:600 DIM:500 AVG_DIFF:27859.7966
0-th component log probs | Train: 5.614121192756143 | Val: -194.09759648386455
1-th component log probs | Train: 5.315734907403221 | Val: -85.18954860790615
2-th component log probs | Train: 5.527993970982919 | Val: -111.51172276599343
3-th component log probs | Train: 5.4104871345195535 | Val: -91.4071127590734
4-th component log probs | Train: 5.53507906783721 | Val: -118.77243295355953
5-th component log probs | Train: 5.596217734080097 | Val: -167.0586485916672
6-th component log probs | Train: 5.587333438111962 | Val: -196.00999039998328
7-th component log probs | Train: 5.6274440438946804 | Val: -118.62272547836868
8-th component log probs | Train: 5.628524296962562 | Val: -230.5682183339527
9-th component log probs | Train: 5.674193373638051 | Val: -193.25880063099038
KEYWORD NR_SAMPLES:600 DIM:512 AVG_DIFF:26785.2803
best average differences at 512 dimensions: 26785.2802813565
2022-01-09 20:08.51 [info     ] Training complete              train_loss=0.6672658324241638
2022-01-09 20:08.51 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:08.55 [info     ] Testing complete               test_loss=1.9498424530029297
{'dataset_size': 600,
 'end_test_accuracy': 0.46612662076950073,
 'end_test_loss': 1.9498424530029297,
 'end_train_accuracy': 0.9739583730697632,
 'end_train_loss': 0.6672658324241638,
 'end_val_accuracy': 0.5826027989387512,
 'end_val_loss': 1.9849534034729004}
2022-01-09 20:08.55 [info     ] Start Predict                  dataset=58006
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:09.28 [info     ] Starting training              dataset=800 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
800
Fitting PCA...
0-th component log probs | Train: 2.8270953003798205 | Val: -73.46377595040829
1-th component log probs | Train: 2.4759862887189703 | Val: -13.209889064267019
2-th component log probs | Train: 2.6503785918542504 | Val: -12.739237844687299
3-th component log probs | Train: 2.5702424173689282 | Val: -12.611172952798658
4-th component log probs | Train: 2.726238794525979 | Val: -25.727251448385168
5-th component log probs | Train: 2.8298094193699708 | Val: -34.18499872466088
6-th component log probs | Train: 2.743077854745583 | Val: -57.56416215701361
7-th component log probs | Train: 2.999890674951248 | Val: -126.26626663070734
8-th component log probs | Train: 2.635506946470409 | Val: -20.334988407924644
9-th component log probs | Train: 2.8027621995192984 | Val: -47.33324405696272
KEYWORD NR_SAMPLES:800 DIM:50 AVG_DIFF:3210.1322
Fitting PCA...
0-th component log probs | Train: 4.091744974989973 | Val: -445.6239505265122
1-th component log probs | Train: 3.23291754233782 | Val: -68.48570319965236
2-th component log probs | Train: 3.5709367449150538 | Val: -97.63130822017666
3-th component log probs | Train: 3.3251770235526847 | Val: -59.94486387207864
4-th component log probs | Train: 3.7623183834277865 | Val: -161.01175498284826
5-th component log probs | Train: 3.7534934278245915 | Val: -160.95046974245358
6-th component log probs | Train: 3.770479162841632 | Val: -299.6124431248584
7-th component log probs | Train: 4.219305961717987 | Val: -332.7084305599395
8-th component log probs | Train: 3.6194100915260674 | Val: -209.08141160822055
9-th component log probs | Train: 3.842468085294499 | Val: -267.52742081372537
KEYWORD NR_SAMPLES:800 DIM:100 AVG_DIFF:60035.5404
Fitting PCA...
0-th component log probs | Train: 4.660156442682562 | Val: -429.06383393429974
1-th component log probs | Train: 3.8581474176079458 | Val: -136.9201424591974
2-th component log probs | Train: 4.221099281658989 | Val: -144.42319133936823
3-th component log probs | Train: 3.933222450434242 | Val: -130.26086346962387
4-th component log probs | Train: 4.383269050116628 | Val: -201.71978195425888
5-th component log probs | Train: 4.342357160829753 | Val: -208.73227044412147
6-th component log probs | Train: 4.393537869767481 | Val: -316.2697882157615
7-th component log probs | Train: 4.74780255524556 | Val: -314.2451158278164
8-th component log probs | Train: 4.271623134460778 | Val: -279.04198760928927
9-th component log probs | Train: 4.445983150829448 | Val: -280.67705384864024
KEYWORD NR_SAMPLES:800 DIM:150 AVG_DIFF:70206.0668
Fitting PCA...
0-th component log probs | Train: 4.965609631348275 | Val: -368.34979324039114
1-th component log probs | Train: 4.295788283697173 | Val: -154.73932315064164
2-th component log probs | Train: 4.604654422695634 | Val: -146.05738390812272
3-th component log probs | Train: 4.356045178503464 | Val: -146.12268368964297
4-th component log probs | Train: 4.7384100375577445 | Val: -185.69744511640022
5-th component log probs | Train: 4.693885362049384 | Val: -205.06064635668585
6-th component log probs | Train: 4.745285531617978 | Val: -289.6689048740957
7-th component log probs | Train: 5.032286515117452 | Val: -273.7631143489291
8-th component log probs | Train: 4.649328812059166 | Val: -264.62666742150964
9-th component log probs | Train: 4.787941720847351 | Val: -263.34349253276395
KEYWORD NR_SAMPLES:800 DIM:200 AVG_DIFF:59907.2852
Fitting PCA...
0-th component log probs | Train: 5.157043871929718 | Val: -318.31487953457116
1-th component log probs | Train: 4.590843935087309 | Val: -154.17362071676433
2-th component log probs | Train: 4.852087806537873 | Val: -136.69302722126542
3-th component log probs | Train: 4.636294298439904 | Val: -143.58625661466755
4-th component log probs | Train: 4.964347499779135 | Val: -169.58516579597332
5-th component log probs | Train: 4.922062129893467 | Val: -196.85487143325398
6-th component log probs | Train: 4.970330691311801 | Val: -263.9461181678313
7-th component log probs | Train: 5.210999168472147 | Val: -239.3204979498225
8-th component log probs | Train: 4.890093257690921 | Val: -244.1633561384556
9-th component log probs | Train: 5.005078324518964 | Val: -236.84179857853798
KEYWORD NR_SAMPLES:800 DIM:250 AVG_DIFF:49565.5890
Fitting PCA...
0-th component log probs | Train: 5.288247198780837 | Val: -280.2278362583411
1-th component log probs | Train: 4.800090286824899 | Val: -144.31349220820306
2-th component log probs | Train: 5.025586445501282 | Val: -124.48318353753477
3-th component log probs | Train: 4.8356121024089695 | Val: -134.40110967926134
4-th component log probs | Train: 5.121774399350937 | Val: -153.03363505782949
5-th component log probs | Train: 5.081692890835091 | Val: -181.83042807199115
6-th component log probs | Train: 5.126656124786172 | Val: -238.21193878332198
7-th component log probs | Train: 5.333627812498697 | Val: -212.16512412605985
8-th component log probs | Train: 5.058016375912385 | Val: -221.78323529708044
9-th component log probs | Train: 5.155851159653014 | Val: -212.20128918962058
KEYWORD NR_SAMPLES:800 DIM:300 AVG_DIFF:40508.3414
Fitting PCA...
0-th component log probs | Train: 5.384133991170801 | Val: -249.25262535782704
1-th component log probs | Train: 4.956290276565279 | Val: -133.51860043753652
2-th component log probs | Train: 5.153580527344168 | Val: -113.09961834959769
3-th component log probs | Train: 4.985877745990599 | Val: -123.60607622323757
4-th component log probs | Train: 5.237752970454324 | Val: -139.1041348102382
5-th component log probs | Train: 5.201042713016319 | Val: -165.97220634843094
6-th component log probs | Train: 5.241402118072117 | Val: -214.64384256770583
7-th component log probs | Train: 5.423209160188072 | Val: -188.91951599933358
8-th component log probs | Train: 5.182590416777936 | Val: -201.03483435447944
9-th component log probs | Train: 5.266827272509537 | Val: -190.84782481525244
KEYWORD NR_SAMPLES:800 DIM:350 AVG_DIFF:33177.4945
Fitting PCA...
0-th component log probs | Train: 5.45751990323387 | Val: -224.01253536246566
1-th component log probs | Train: 5.077572635284255 | Val: -122.92376136026064
2-th component log probs | Train: 5.252466909674244 | Val: -103.93410131995745
3-th component log probs | Train: 5.10255403783355 | Val: -114.26028947436187
4-th component log probs | Train: 5.327097695645702 | Val: -126.66139363965783
5-th component log probs | Train: 5.293000338994302 | Val: -152.03770487950803
6-th component log probs | Train: 5.329947367868345 | Val: -195.1855499087698
7-th component log probs | Train: 5.491586307122622 | Val: -170.33749170099935
8-th component log probs | Train: 5.27847870399723 | Val: -183.30603317554161
9-th component log probs | Train: 5.35227910113376 | Val: -172.66564729154902
KEYWORD NR_SAMPLES:800 DIM:400 AVG_DIFF:27576.0785
Fitting PCA...
0-th component log probs | Train: 5.515351617816121 | Val: -202.9506679796999
1-th component log probs | Train: 5.1745797550870645 | Val: -113.40114690172437
2-th component log probs | Train: 5.3313266946648685 | Val: -95.5304839217956
3-th component log probs | Train: 5.196225055008117 | Val: -105.51764421694375
4-th component log probs | Train: 5.3979747581985835 | Val: -116.15701548597102
5-th component log probs | Train: 5.366570544451538 | Val: -139.2407356765631
6-th component log probs | Train: 5.4006747027289155 | Val: -177.76590256676636
7-th component log probs | Train: 5.545568124451482 | Val: -154.98479949172088
8-th component log probs | Train: 5.354834299014524 | Val: -167.46410406839115
9-th component log probs | Train: 5.420125271017157 | Val: -157.62834041268988
KEYWORD NR_SAMPLES:800 DIM:450 AVG_DIFF:23140.7020
Fitting PCA...
0-th component log probs | Train: 5.562226429776212 | Val: -185.58660330568156
1-th component log probs | Train: 5.254120624877241 | Val: -105.07773099999531
2-th component log probs | Train: 5.395762739658425 | Val: -88.33371236970576
3-th component log probs | Train: 5.273068262122998 | Val: -97.78977497867625
4-th component log probs | Train: 5.455921493342174 | Val: -106.96550250658156
5-th component log probs | Train: 5.426979880177633 | Val: -127.84532186089622
6-th component log probs | Train: 5.4582500589139515 | Val: -163.11026567351757
7-th component log probs | Train: 5.589284007208547 | Val: -142.03449043977403
8-th component log probs | Train: 5.417031379159161 | Val: -154.02090054080847
9-th component log probs | Train: 5.475683481295318 | Val: -144.55474816726257
KEYWORD NR_SAMPLES:800 DIM:500 AVG_DIFF:19665.5948
0-th component log probs | Train: 5.572172113566235 | Val: -181.82529033864074
1-th component log probs | Train: 5.271094759863932 | Val: -103.17209531306405
2-th component log probs | Train: 5.409504027962574 | Val: -86.74443828210156
3-th component log probs | Train: 5.289576501506644 | Val: -96.04085260196894
4-th component log probs | Train: 5.468283579373187 | Val: -104.95203246484914
5-th component log probs | Train: 5.4399454883292035 | Val: -125.33520684806501
6-th component log probs | Train: 5.4705360387421536 | Val: -159.9203485579976
7-th component log probs | Train: 5.598582938313391 | Val: -139.2216858801888
8-th component log probs | Train: 5.430301812893887 | Val: -151.05063998816644
9-th component log probs | Train: 5.487537876730956 | Val: -141.75399722422858
KEYWORD NR_SAMPLES:800 DIM:512 AVG_DIFF:18942.6136
best average differences at 50 dimensions: 3210.1321920025503
2022-01-09 20:13.19 [info     ] Training complete              train_loss=0.33913707733154297
2022-01-09 20:13.19 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:13.23 [info     ] Testing complete               test_loss=1.6977866888046265
{'dataset_size': 800,
 'end_test_accuracy': 0.6236563324928284,
 'end_test_loss': 1.6977866888046265,
 'end_train_accuracy': 1.0,
 'end_train_loss': 0.33913707733154297,
 'end_val_accuracy': 0.6327136158943176,
 'end_val_loss': 1.6548045873641968}
2022-01-09 20:13.23 [info     ] Start Predict                  dataset=57806
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:13.45 [info     ] Starting training              dataset=1000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
1000
Fitting PCA...
0-th component log probs | Train: 2.6030696398239566 | Val: -17.516000331048662
1-th component log probs | Train: 2.423610557520453 | Val: -7.078637093402794
2-th component log probs | Train: 2.597672528388458 | Val: -5.781783366308364
3-th component log probs | Train: 2.429202179308767 | Val: -7.414402156810023
4-th component log probs | Train: 2.659971751041042 | Val: -15.319753135976082
5-th component log probs | Train: 2.6350466763381215 | Val: -15.943438325209499
6-th component log probs | Train: 2.604242593017092 | Val: -25.791747959703027
7-th component log probs | Train: 2.63327574245709 | Val: -18.330938626619762
8-th component log probs | Train: 2.650520750646402 | Val: -23.32882985444998
9-th component log probs | Train: 2.601670986983356 | Val: -23.116842232314482
KEYWORD NR_SAMPLES:1000 DIM:50 AVG_DIFF:391.2811
Fitting PCA...
0-th component log probs | Train: 3.6011595313299396 | Val: -205.3451494939647
1-th component log probs | Train: 3.1030804235514307 | Val: -22.346303076011313
2-th component log probs | Train: 3.3857718988440957 | Val: -37.327444981916805
3-th component log probs | Train: 3.110025998494275 | Val: -33.20915813100207
4-th component log probs | Train: 3.605879041373722 | Val: -113.49469026926788
5-th component log probs | Train: 3.4365433556266436 | Val: -88.50767442109269
6-th component log probs | Train: 3.4927677448558208 | Val: -145.13796961884444
7-th component log probs | Train: 3.6701594098209935 | Val: -136.56921922935052
8-th component log probs | Train: 3.4733907345869555 | Val: -116.82209347088092
9-th component log probs | Train: 3.4581185511664803 | Val: -151.26340788591858
KEYWORD NR_SAMPLES:1000 DIM:100 AVG_DIFF:14961.7097
Fitting PCA...
0-th component log probs | Train: 4.26914723781608 | Val: -237.60296300177725
1-th component log probs | Train: 3.642965499953648 | Val: -61.36273406840112
2-th component log probs | Train: 3.999384085097096 | Val: -79.76739088896811
3-th component log probs | Train: 3.6576162131319916 | Val: -76.39361958705948
4-th component log probs | Train: 4.247276952876619 | Val: -158.7606679496222
5-th component log probs | Train: 4.049452957906059 | Val: -171.42858421865333
6-th component log probs | Train: 4.1413888504360505 | Val: -209.12257603005503
7-th component log probs | Train: 4.324696088438353 | Val: -173.34803624550196
8-th component log probs | Train: 4.10292042809836 | Val: -208.69379155883973
9-th component log probs | Train: 4.116877845676323 | Val: -228.7722035818092
KEYWORD NR_SAMPLES:1000 DIM:150 AVG_DIFF:31008.5947
Fitting PCA...
0-th component log probs | Train: 4.647155664751182 | Val: -230.30041522266018
1-th component log probs | Train: 4.085296135842054 | Val: -85.73930182087221
2-th component log probs | Train: 4.412495538952664 | Val: -86.38053069114414
3-th component log probs | Train: 4.102533270409532 | Val: -99.63031959561762
4-th component log probs | Train: 4.623260530838673 | Val: -155.97132345469777
5-th component log probs | Train: 4.453231280846771 | Val: -178.36675074969307
6-th component log probs | Train: 4.533364420866374 | Val: -209.78024722355605
7-th component log probs | Train: 4.6940999658752105 | Val: -163.54622905409929
8-th component log probs | Train: 4.4994290200832205 | Val: -217.81056679419203
9-th component log probs | Train: 4.5155670901195135 | Val: -221.02287444948416
KEYWORD NR_SAMPLES:1000 DIM:200 AVG_DIFF:31601.0919
Fitting PCA...
0-th component log probs | Train: 4.889221840806245 | Val: -207.01008179840431
1-th component log probs | Train: 4.3990863299642395 | Val: -87.64231087036616
2-th component log probs | Train: 4.684552018558795 | Val: -84.9689188551261
3-th component log probs | Train: 4.41615311743069 | Val: -103.85358822454506
4-th component log probs | Train: 4.865856770042591 | Val: -144.0476973831516
5-th component log probs | Train: 4.719199392229612 | Val: -169.97145690721726
6-th component log probs | Train: 4.788979223494117 | Val: -196.30511722465434
7-th component log probs | Train: 4.930944333637261 | Val: -145.84572826525158
8-th component log probs | Train: 4.759201530258668 | Val: -207.04535904139667
9-th component log probs | Train: 4.774996949055185 | Val: -204.1580332006495
KEYWORD NR_SAMPLES:1000 DIM:250 AVG_DIFF:27751.1711
Fitting PCA...
0-th component log probs | Train: 5.057294916083503 | Val: -188.10417282507146
1-th component log probs | Train: 4.629228340791925 | Val: -85.16822454194948
2-th component log probs | Train: 4.879031317883159 | Val: -79.27305647794168
3-th component log probs | Train: 4.6450813451877115 | Val: -101.7373378163765
4-th component log probs | Train: 5.036422200220788 | Val: -130.90256905674065
5-th component log probs | Train: 4.906735516101421 | Val: -161.21170590302975
6-th component log probs | Train: 4.96909033511158 | Val: -180.09129829352324
7-th component log probs | Train: 5.0942566340034965 | Val: -132.63302976939042
8-th component log probs | Train: 4.942165846566649 | Val: -191.54190783468906
9-th component log probs | Train: 4.957282476473041 | Val: -186.817056572225
KEYWORD NR_SAMPLES:1000 DIM:300 AVG_DIFF:23844.8015
Fitting PCA...
0-th component log probs | Train: 5.18159796950531 | Val: -170.60772044764786
1-th component log probs | Train: 4.802943177610053 | Val: -81.48670985381277
2-th component log probs | Train: 5.023994234951153 | Val: -73.6811038706609
3-th component log probs | Train: 4.8176172277766325 | Val: -96.58563753386692
4-th component log probs | Train: 5.162449438270859 | Val: -120.0082135870993
5-th component log probs | Train: 5.047379015851237 | Val: -147.94322877381705
6-th component log probs | Train: 5.102441950695945 | Val: -163.9010850704742
7-th component log probs | Train: 5.213969808160432 | Val: -120.35717672946188
8-th component log probs | Train: 5.078205497157325 | Val: -176.7784318988259
9-th component log probs | Train: 5.0928804699767705 | Val: -170.6309754501235
KEYWORD NR_SAMPLES:1000 DIM:350 AVG_DIFF:20217.9737
Fitting PCA...
0-th component log probs | Train: 5.27773013924781 | Val: -154.70834530735846
1-th component log probs | Train: 4.9388369183213 | Val: -76.54144349820143
2-th component log probs | Train: 5.136202219924487 | Val: -68.91029656498976
3-th component log probs | Train: 4.952362190706491 | Val: -91.11956801855605
4-th component log probs | Train: 5.259485917634134 | Val: -110.0463599499369
5-th component log probs | Train: 5.156650356229247 | Val: -135.96145392068752
6-th component log probs | Train: 5.205545806504048 | Val: -149.88158839168472
7-th component log probs | Train: 5.3061153790665845 | Val: -109.73071322305117
8-th component log probs | Train: 5.183864667644405 | Val: -162.39742746247083
9-th component log probs | Train: 5.197391123979021 | Val: -155.34157849668063
KEYWORD NR_SAMPLES:1000 DIM:400 AVG_DIFF:17129.8779
Fitting PCA...
0-th component log probs | Train: 5.353743933721352 | Val: -142.10821370117813
1-th component log probs | Train: 5.0480698508144535 | Val: -71.53245539093602
2-th component log probs | Train: 5.22552160963012 | Val: -63.97557423522475
3-th component log probs | Train: 5.060523379240194 | Val: -85.35627621384971
4-th component log probs | Train: 5.336644796995916 | Val: -101.50612715456616
5-th component log probs | Train: 5.243759577884655 | Val: -124.78236148843925
6-th component log probs | Train: 5.288057538677258 | Val: -137.4606858680924
7-th component log probs | Train: 5.3790878467092185 | Val: -100.77822928155648
8-th component log probs | Train: 5.268568118359905 | Val: -149.161681280564
9-th component log probs | Train: 5.280986398422295 | Val: -142.32345203337564
KEYWORD NR_SAMPLES:1000 DIM:450 AVG_DIFF:14617.8117
Fitting PCA...
0-th component log probs | Train: 5.415702749443485 | Val: -130.8466758634115
1-th component log probs | Train: 5.138119472864691 | Val: -66.84299440311143
2-th component log probs | Train: 5.299220263832954 | Val: -59.50213307941998
3-th component log probs | Train: 5.1495166702158715 | Val: -79.6712133974906
4-th component log probs | Train: 5.399936614622586 | Val: -93.84266544311608
5-th component log probs | Train: 5.315597524818645 | Val: -114.98575486991247
6-th component log probs | Train: 5.355608558953618 | Val: -126.85934340742061
7-th component log probs | Train: 5.438692655924331 | Val: -92.92585975737964
8-th component log probs | Train: 5.338020378610807 | Val: -137.49772862938678
9-th component log probs | Train: 5.349327419568004 | Val: -131.05693316790996
KEYWORD NR_SAMPLES:1000 DIM:500 AVG_DIFF:12562.9095
0-th component log probs | Train: 5.428930173210363 | Val: -128.33065743219126
1-th component log probs | Train: 5.157562539207583 | Val: -65.72590473528584
2-th component log probs | Train: 5.315011096912654 | Val: -58.492309420901634
3-th component log probs | Train: 5.168704492871362 | Val: -78.33756856492047
4-th component log probs | Train: 5.413466715336909 | Val: -92.19219391855337
5-th component log probs | Train: 5.33097383289677 | Val: -112.78530582615771
6-th component log probs | Train: 5.37007658736494 | Val: -124.47455065394551
7-th component log probs | Train: 5.451376902001437 | Val: -91.23173924055972
8-th component log probs | Train: 5.352896437338684 | Val: -134.82216700743248
9-th component log probs | Train: 5.36394008278663 | Val: -128.54491181955706
KEYWORD NR_SAMPLES:1000 DIM:512 AVG_DIFF:12122.6967
best average differences at 50 dimensions: 391.28112699516225
2022-01-09 20:20.02 [info     ] Training complete              train_loss=0.2888510823249817
2022-01-09 20:20.02 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:20.05 [info     ] Testing complete               test_loss=1.3651833534240723
{'dataset_size': 1000,
 'end_test_accuracy': 0.6932713389396667,
 'end_test_loss': 1.3651833534240723,
 'end_train_accuracy': 0.9984375238418579,
 'end_train_loss': 0.2888510823249817,
 'end_val_accuracy': 0.694094181060791,
 'end_val_loss': 1.390792965888977}
2022-01-09 20:20.05 [info     ] Start Predict                  dataset=57606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:20.28 [info     ] Starting training              dataset=2000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
2000
Fitting PCA...
0-th component log probs | Train: 2.5244210956709696 | Val: -3.5552698168518497
1-th component log probs | Train: 2.2609754960792685 | Val: 0.28688284260921015
2-th component log probs | Train: 2.4301266395638503 | Val: -0.9804165350735843
3-th component log probs | Train: 2.3142463700792053 | Val: -1.2386462222087573
4-th component log probs | Train: 2.45491054168474 | Val: -1.183077891000341
5-th component log probs | Train: 2.628848960943283 | Val: -4.715754753183406
6-th component log probs | Train: 2.392395388060609 | Val: -3.4858507926691624
7-th component log probs | Train: 2.5599307023420437 | Val: -2.471051821371572
8-th component log probs | Train: 2.427558176199581 | Val: -2.819379808924791
9-th component log probs | Train: 2.498417291583723 | Val: -3.4662825444876257
KEYWORD NR_SAMPLES:2000 DIM:50 AVG_DIFF:25.5265
Fitting PCA...
0-th component log probs | Train: 3.154067384653634 | Val: -12.760159675279832
1-th component log probs | Train: 2.8204223372799757 | Val: -0.41453030127254137
2-th component log probs | Train: 3.036546327841649 | Val: -4.391854809465991
3-th component log probs | Train: 2.9191505522727006 | Val: -4.302362645290982
4-th component log probs | Train: 3.0883096400550234 | Val: -5.672072284644782
5-th component log probs | Train: 3.26623825448771 | Val: -14.029477933208856
6-th component log probs | Train: 3.0323211271591965 | Val: -11.229685740394105
7-th component log probs | Train: 3.254351104104463 | Val: -12.028923234876961
8-th component log probs | Train: 3.0479102306004084 | Val: -10.046337995273063
9-th component log probs | Train: 3.0945179602953594 | Val: -9.314124743667552
KEYWORD NR_SAMPLES:2000 DIM:100 AVG_DIFF:150.9362
Fitting PCA...
0-th component log probs | Train: 3.585352313796271 | Val: -24.82669205794649
1-th component log probs | Train: 3.177401879948873 | Val: -1.1726049278401502
2-th component log probs | Train: 3.4446835403243767 | Val: -7.607478688644092
3-th component log probs | Train: 3.2981064454460736 | Val: -7.671911062353217
4-th component log probs | Train: 3.49297127776721 | Val: -10.88385591029828
5-th component log probs | Train: 3.7080318443105744 | Val: -28.056139194227008
6-th component log probs | Train: 3.4746863131554475 | Val: -25.061313960983355
7-th component log probs | Train: 3.7862828485433604 | Val: -28.404225922232552
8-th component log probs | Train: 3.468497597395883 | Val: -21.515716795800962
9-th component log probs | Train: 3.495325457015074 | Val: -15.885609116723412
KEYWORD NR_SAMPLES:2000 DIM:150 AVG_DIFF:513.4678
Fitting PCA...
0-th component log probs | Train: 3.9527798669320715 | Val: -36.24508418832444
1-th component log probs | Train: 3.4523884961217433 | Val: -2.6169382488632524
2-th component log probs | Train: 3.778989618863524 | Val: -12.836870521479863
3-th component log probs | Train: 3.616573573833659 | Val: -12.748425770296109
4-th component log probs | Train: 3.831813132677506 | Val: -17.231956556590784
5-th component log probs | Train: 4.061692503856183 | Val: -42.49897535520913
6-th component log probs | Train: 3.8556356228373425 | Val: -40.60728381148403
7-th component log probs | Train: 4.195214536719423 | Val: -38.75580725675782
8-th component log probs | Train: 3.844786687085873 | Val: -35.985632310893436
9-th component log probs | Train: 3.848389802029738 | Val: -23.79390341997357
KEYWORD NR_SAMPLES:2000 DIM:200 AVG_DIFF:1098.0483
Fitting PCA...
0-th component log probs | Train: 4.251125348395252 | Val: -43.6392353071737
1-th component log probs | Train: 3.6928267097669387 | Val: -4.571652690930182
2-th component log probs | Train: 4.064377931722927 | Val: -17.900966580442457
3-th component log probs | Train: 3.9006786428367866 | Val: -19.174861895282138
4-th component log probs | Train: 4.1165871210654 | Val: -22.367495803323024
5-th component log probs | Train: 4.337378812087214 | Val: -47.707224756193675
6-th component log probs | Train: 4.167389562336471 | Val: -49.95491219475465
7-th component log probs | Train: 4.488256056793981 | Val: -42.00558593486154
8-th component log probs | Train: 4.153368765204956 | Val: -48.092483525183084
9-th component log probs | Train: 4.137966169135856 | Val: -30.684864282599435
KEYWORD NR_SAMPLES:2000 DIM:250 AVG_DIFF:1581.9952
Fitting PCA...
0-th component log probs | Train: 4.479364530133683 | Val: -45.899297550732726
1-th component log probs | Train: 3.909772731437737 | Val: -6.667577433731617
2-th component log probs | Train: 4.298627841722874 | Val: -20.855152374686956
3-th component log probs | Train: 4.147880488180429 | Val: -23.6145949402111
4-th component log probs | Train: 4.348460487121188 | Val: -24.976653164043736
5-th component log probs | Train: 4.549987533179267 | Val: -49.949500583555164
6-th component log probs | Train: 4.409191032467967 | Val: -53.756624869445005
7-th component log probs | Train: 4.701042577142565 | Val: -41.83843497122646
8-th component log probs | Train: 4.392255610889665 | Val: -51.548103182132195
9-th component log probs | Train: 4.369522861514043 | Val: -35.1449629719855
KEYWORD NR_SAMPLES:2000 DIM:300 AVG_DIFF:1812.3418
Fitting PCA...
0-th component log probs | Train: 4.657983448463345 | Val: -46.36090686913626
1-th component log probs | Train: 4.1055667852812 | Val: -8.405615311505038
2-th component log probs | Train: 4.48916194261338 | Val: -21.81284620330023
3-th component log probs | Train: 4.350418719253292 | Val: -26.191536820638497
4-th component log probs | Train: 4.5346689680297825 | Val: -25.67608692990578
5-th component log probs | Train: 4.717886445911147 | Val: -48.43371182184743
6-th component log probs | Train: 4.597738580756491 | Val: -53.2276770046735
7-th component log probs | Train: 4.8616915040310404 | Val: -40.479972502543625
8-th component log probs | Train: 4.581493712257019 | Val: -52.27257976720098
9-th component log probs | Train: 4.5548204334633855 | Val: -35.80709707019139
KEYWORD NR_SAMPLES:2000 DIM:350 AVG_DIFF:1838.2961
Fitting PCA...
0-th component log probs | Train: 4.800204614567589 | Val: -45.09220786959803
1-th component log probs | Train: 4.27643150231929 | Val: -9.540980862640783
2-th component log probs | Train: 4.643053557375258 | Val: -21.963297230631465
3-th component log probs | Train: 4.516543756992433 | Val: -27.07095502381602
4-th component log probs | Train: 4.685120717642475 | Val: -25.71570979917464
5-th component log probs | Train: 4.852542764024094 | Val: -46.58759900898706
6-th component log probs | Train: 4.748739180138903 | Val: -51.850098306344584
7-th component log probs | Train: 4.987506850834249 | Val: -38.49734315998613
8-th component log probs | Train: 4.733182856821217 | Val: -51.3290860499456
9-th component log probs | Train: 4.7032285011956745 | Val: -35.397310066196134
KEYWORD NR_SAMPLES:2000 DIM:400 AVG_DIFF:1780.1532
Fitting PCA...
0-th component log probs | Train: 4.916289403985924 | Val: -43.203934793181325
1-th component log probs | Train: 4.423930688771161 | Val: -10.124430936148954
2-th component log probs | Train: 4.770448075934595 | Val: -21.815657994919007
3-th component log probs | Train: 4.656289731145649 | Val: -27.036070886736887
4-th component log probs | Train: 4.808788771612526 | Val: -25.11188945970673
5-th component log probs | Train: 4.962226367216372 | Val: -44.32154001364727
6-th component log probs | Train: 4.871290340095512 | Val: -49.779123080481966
7-th component log probs | Train: 5.088099483978507 | Val: -36.393927271117384
8-th component log probs | Train: 4.85638829116032 | Val: -49.236961803522824
9-th component log probs | Train: 4.826304924072464 | Val: -34.55189861400897
KEYWORD NR_SAMPLES:2000 DIM:450 AVG_DIFF:1674.6734
Fitting PCA...
0-th component log probs | Train: 5.013234947031889 | Val: -41.058955110093684
1-th component log probs | Train: 4.553529539586046 | Val: -10.279227892703192
2-th component log probs | Train: 4.878578508444033 | Val: -21.06988369550979
3-th component log probs | Train: 4.7745068128598565 | Val: -26.47883465975882
4-th component log probs | Train: 4.914135573678391 | Val: -24.188473670098993
5-th component log probs | Train: 5.0543038841714685 | Val: -41.84545281589204
6-th component log probs | Train: 4.973780065202883 | Val: -47.17135655728946
7-th component log probs | Train: 5.1714275457515555 | Val: -34.36954701445832
8-th component log probs | Train: 4.959186374673549 | Val: -46.95527742711515
9-th component log probs | Train: 4.92950820778075 | Val: -33.06016164536895
KEYWORD NR_SAMPLES:2000 DIM:500 AVG_DIFF:1546.0231
0-th component log probs | Train: 5.034241389255255 | Val: -40.492371737310364
1-th component log probs | Train: 4.582105706661909 | Val: -10.276028928732098
2-th component log probs | Train: 4.901996704803004 | Val: -20.855711649880636
3-th component log probs | Train: 4.800295531653086 | Val: -26.23479836016963
4-th component log probs | Train: 4.936980399080736 | Val: -23.939338871315933
5-th component log probs | Train: 5.0743002414561245 | Val: -41.24109173234795
6-th component log probs | Train: 4.99592612086618 | Val: -46.57098915777686
7-th component log probs | Train: 5.189420761992757 | Val: -33.883284938771965
8-th component log probs | Train: 4.981490353808322 | Val: -46.37827765958367
9-th component log probs | Train: 4.952097897778596 | Val: -32.637756904834625
KEYWORD NR_SAMPLES:2000 DIM:512 AVG_DIFF:1513.5677
best average differences at 50 dimensions: 25.52652631379582
2022-01-09 20:24.51 [info     ] Training complete              train_loss=0.3121822476387024
2022-01-09 20:24.51 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:24.54 [info     ] Testing complete               test_loss=0.9409878253936768
{'dataset_size': 2000,
 'end_test_accuracy': 0.7451371550559998,
 'end_test_loss': 0.9409878253936768,
 'end_train_accuracy': 0.99853515625,
 'end_train_loss': 0.3121822476387024,
 'end_val_accuracy': 0.7951229810714722,
 'end_val_loss': 0.8972664475440979}
2022-01-09 20:24.55 [info     ] Start Predict                  dataset=56606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:25.19 [info     ] Starting training              dataset=4000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
4000
Fitting PCA...
0-th component log probs | Train: 2.229805470584544 | Val: 0.34352749967440555
1-th component log probs | Train: 2.1190078455028285 | Val: 1.123333548075624
2-th component log probs | Train: 2.3478310525688517 | Val: 1.0057136378052165
3-th component log probs | Train: 2.1741171872202383 | Val: 0.36828242222525165
4-th component log probs | Train: 2.2073450353839283 | Val: 0.7796762164369904
5-th component log probs | Train: 2.2261519775555825 | Val: 0.4235906893699879
6-th component log probs | Train: 2.1975984330312617 | Val: -0.5118912319597297
7-th component log probs | Train: 2.266890754143753 | Val: 0.9559097066444189
8-th component log probs | Train: 2.1792001857267027 | Val: -0.39521491891690846
9-th component log probs | Train: 2.1185650444934465 | Val: 0.3257323263548159
KEYWORD NR_SAMPLES:4000 DIM:50 AVG_DIFF:3.3801
Fitting PCA...
0-th component log probs | Train: 2.772499299553601 | Val: -0.403791006831184
1-th component log probs | Train: 2.6526105678155516 | Val: 1.3097499033531308
2-th component log probs | Train: 2.8983917718586967 | Val: 0.15100142852547693
3-th component log probs | Train: 2.7069636814419553 | Val: -0.18419207715542688
4-th component log probs | Train: 2.7624699863089233 | Val: 0.44659308136009535
5-th component log probs | Train: 2.772467469801845 | Val: -0.5312255510591057
6-th component log probs | Train: 2.759709925204309 | Val: -2.1425813292654103
7-th component log probs | Train: 2.8494778600520343 | Val: 0.19122352092891798
8-th component log probs | Train: 2.7392240464655395 | Val: -1.7107278078848158
9-th component log probs | Train: 2.6601104129043778 | Val: -0.13106848223484668
KEYWORD NR_SAMPLES:4000 DIM:100 AVG_DIFF:10.2768
Fitting PCA...
0-th component log probs | Train: 3.093484275630285 | Val: -1.3514219527254698
1-th component log probs | Train: 2.954778342070629 | Val: 1.402417735950062
2-th component log probs | Train: 3.230589805923399 | Val: -0.8549138106808111
3-th component log probs | Train: 3.014835039839148 | Val: -0.33055684943632285
4-th component log probs | Train: 3.0807205175254335 | Val: 0.36464143754909145
5-th component log probs | Train: 3.1098922811647647 | Val: -1.5330394586929519
6-th component log probs | Train: 3.106403890471314 | Val: -3.6339287272339047
7-th component log probs | Train: 3.2164881121660365 | Val: -1.1229168622275052
8-th component log probs | Train: 3.07818629196985 | Val: -2.6393576839485107
9-th component log probs | Train: 2.9802461166599374 | Val: -0.4048696747843851
KEYWORD NR_SAMPLES:4000 DIM:150 AVG_DIFF:18.7396
Fitting PCA...
0-th component log probs | Train: 3.347824586901449 | Val: -2.2008329715086945
1-th component log probs | Train: 3.182476752436795 | Val: 1.4051416707684021
2-th component log probs | Train: 3.494380507263101 | Val: -1.5673321195900003
3-th component log probs | Train: 3.243682954542823 | Val: -0.4612644168147987
4-th component log probs | Train: 3.3277404026817434 | Val: 0.054377089202954754
5-th component log probs | Train: 3.374184820579766 | Val: -2.635537849851641
6-th component log probs | Train: 3.378684615318611 | Val: -5.501887738057991
7-th component log probs | Train: 3.5183464930787305 | Val: -3.2101419201639816
8-th component log probs | Train: 3.3303296432734366 | Val: -3.638943935499408
9-th component log probs | Train: 3.2248812143407406 | Val: -0.8500716783685626
KEYWORD NR_SAMPLES:4000 DIM:200 AVG_DIFF:30.9439
Fitting PCA...
0-th component log probs | Train: 3.5714304602315665 | Val: -3.7499815536971273
1-th component log probs | Train: 3.3695459971735193 | Val: 1.3417522030483657
2-th component log probs | Train: 3.7122417964187946 | Val: -2.610274739417218
3-th component log probs | Train: 3.4359063268057652 | Val: -0.8082822848945926
4-th component log probs | Train: 3.529002143239048 | Val: -0.4145826007584255
5-th component log probs | Train: 3.6008663376143564 | Val: -4.402149005180336
6-th component log probs | Train: 3.6164571953803604 | Val: -8.27841794536758
7-th component log probs | Train: 3.7851694393574045 | Val: -5.896707874525183
8-th component log probs | Train: 3.5482436053729938 | Val: -5.471099763698995
9-th component log probs | Train: 3.4347566631806306 | Val: -1.789004134556812
KEYWORD NR_SAMPLES:4000 DIM:250 AVG_DIFF:53.9166
Fitting PCA...
0-th component log probs | Train: 3.769526423220199 | Val: -5.464357490796098
1-th component log probs | Train: 3.5304362611158764 | Val: 1.1220967927223593
2-th component log probs | Train: 3.9017724068041617 | Val: -3.5286582238826023
3-th component log probs | Train: 3.598261020324313 | Val: -1.2698302869336835
4-th component log probs | Train: 3.702840067254249 | Val: -1.0230065806761208
5-th component log probs | Train: 3.806369145853389 | Val: -6.367543277432102
6-th component log probs | Train: 3.8338248240702084 | Val: -11.767863038074823
7-th component log probs | Train: 4.022877974836261 | Val: -8.494146946085424
8-th component log probs | Train: 3.7493336595864077 | Val: -7.883902577867964
9-th component log probs | Train: 3.6220223989428377 | Val: -3.0925684702625573
KEYWORD NR_SAMPLES:4000 DIM:300 AVG_DIFF:87.6323
Fitting PCA...
0-th component log probs | Train: 3.949908001177246 | Val: -7.008758983585298
1-th component log probs | Train: 3.6716373903849244 | Val: 0.8165827717420636
2-th component log probs | Train: 4.069122120038694 | Val: -4.5560475327351435
3-th component log probs | Train: 3.745376193993778 | Val: -1.9500097117788935
4-th component log probs | Train: 3.8617061883207606 | Val: -1.7530809557473024
5-th component log probs | Train: 3.9915023822946694 | Val: -8.417902794095317
6-th component log probs | Train: 4.029254930003658 | Val: -14.826703597246109
7-th component log probs | Train: 4.227583178301327 | Val: -10.268704645052953
8-th component log probs | Train: 3.9307077146799334 | Val: -10.152929167522027
9-th component log probs | Train: 3.796210501831151 | Val: -4.387600955952718
KEYWORD NR_SAMPLES:4000 DIM:350 AVG_DIFF:125.1607
Fitting PCA...
0-th component log probs | Train: 4.11442557074 | Val: -8.497613395560236
1-th component log probs | Train: 3.8037214681760254 | Val: 0.4913199375500097
2-th component log probs | Train: 4.216064072373952 | Val: -5.141509295132437
3-th component log probs | Train: 3.880830336990641 | Val: -2.673320047533898
4-th component log probs | Train: 4.007205941646925 | Val: -2.5104156162973723
5-th component log probs | Train: 4.158646534854527 | Val: -10.045757582725738
6-th component log probs | Train: 4.204440841069094 | Val: -17.348186383096643
7-th component log probs | Train: 4.39866667472776 | Val: -11.278453653625785
8-th component log probs | Train: 4.098854178969891 | Val: -12.414179918732168
9-th component log probs | Train: 3.9567650452583574 | Val: -5.966157782119472
KEYWORD NR_SAMPLES:4000 DIM:400 AVG_DIFF:162.6234
Fitting PCA...
0-th component log probs | Train: 4.261193723639129 | Val: -9.601679036350298
1-th component log probs | Train: 3.92808627000155 | Val: 0.1168922052260015
2-th component log probs | Train: 4.347243207428827 | Val: -5.613484254610969
3-th component log probs | Train: 4.006341336049951 | Val: -3.419215815723915
4-th component log probs | Train: 4.1417442137640785 | Val: -3.337802087794131
5-th component log probs | Train: 4.306861155684496 | Val: -10.984457967775077
6-th component log probs | Train: 4.355754036686397 | Val: -18.634881495892298
7-th component log probs | Train: 4.543570631556936 | Val: -11.846680579168746
8-th component log probs | Train: 4.247803635160289 | Val: -13.997622000275292
9-th component log probs | Train: 4.104085416626245 | Val: -7.101130201358949
KEYWORD NR_SAMPLES:4000 DIM:450 AVG_DIFF:190.6490
Fitting PCA...
0-th component log probs | Train: 4.3937321793203745 | Val: -10.089532906128724
1-th component log probs | Train: 4.04679813307725 | Val: -0.17982570889340407
2-th component log probs | Train: 4.465362849517852 | Val: -5.853973770351524
3-th component log probs | Train: 4.126692047262743 | Val: -3.928980482648375
4-th component log probs | Train: 4.2654879920407955 | Val: -3.8655523990899234
5-th component log probs | Train: 4.438273109872916 | Val: -11.545876313224744
6-th component log probs | Train: 4.488276515629487 | Val: -19.034841737023857
7-th component log probs | Train: 4.665926403569211 | Val: -11.920352719859045
8-th component log probs | Train: 4.381770199540658 | Val: -14.852014264714555
9-th component log probs | Train: 4.2405214434437895 | Val: -7.966586975999596
KEYWORD NR_SAMPLES:4000 DIM:500 AVG_DIFF:206.8012
0-th component log probs | Train: 4.423889983130295 | Val: -10.150380844946577
1-th component log probs | Train: 4.075199415101935 | Val: -0.22416039186999667
2-th component log probs | Train: 4.492311461573809 | Val: -5.836312875860565
3-th component log probs | Train: 4.155309339438436 | Val: -4.02415935323617
4-th component log probs | Train: 4.294804602440237 | Val: -3.9464976888571273
5-th component log probs | Train: 4.467931635937972 | Val: -11.616063864697985
6-th component log probs | Train: 4.51734856177737 | Val: -19.047927034485024
7-th component log probs | Train: 4.692556649310055 | Val: -11.900002521134981
8-th component log probs | Train: 4.411532973215153 | Val: -14.986844768075594
9-th component log probs | Train: 4.271583579919086 | Val: -8.082177067017605
KEYWORD NR_SAMPLES:4000 DIM:512 AVG_DIFF:209.0640
best average differences at 50 dimensions: 3.3801063535673976
2022-01-09 20:32.00 [info     ] Training complete              train_loss=0.27256274223327637
2022-01-09 20:32.00 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:32.04 [info     ] Testing complete               test_loss=0.675909161567688
{'dataset_size': 4000,
 'end_test_accuracy': 0.8119369149208069,
 'end_test_loss': 0.675909161567688,
 'end_train_accuracy': 0.99379962682724,
 'end_train_loss': 0.27256274223327637,
 'end_val_accuracy': 0.853950023651123,
 'end_val_loss': 0.6865193843841553}
2022-01-09 20:32.04 [info     ] Start Predict                  dataset=54606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:32.29 [info     ] Starting training              dataset=6000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
6000
Fitting PCA...
0-th component log probs | Train: 2.298720930194427 | Val: 0.2560943005763173
1-th component log probs | Train: 2.12326927772621 | Val: 1.3957559753198163
2-th component log probs | Train: 2.160448619727818 | Val: 1.1947089562357018
3-th component log probs | Train: 2.1198474533174254 | Val: 0.36060738796946695
4-th component log probs | Train: 2.135773756475954 | Val: 1.0360521849815876
5-th component log probs | Train: 2.236303172434152 | Val: 0.42843045217592457
6-th component log probs | Train: 2.211024292310644 | Val: -0.08174534048320294
7-th component log probs | Train: 2.206258805656082 | Val: 0.8543755466782814
8-th component log probs | Train: 2.1102221731686277 | Val: 0.15617091888406687
9-th component log probs | Train: 2.1560824120393174 | Val: 0.13882886160857824
KEYWORD NR_SAMPLES:6000 DIM:50 AVG_DIFF:2.8179
Fitting PCA...
0-th component log probs | Train: 2.8216318731840153 | Val: -0.28231590501424947
1-th component log probs | Train: 2.6452558066753005 | Val: 1.6230171641617088
2-th component log probs | Train: 2.6900204531427265 | Val: 1.04019961623071
3-th component log probs | Train: 2.6369156175763924 | Val: 0.204306865099172
4-th component log probs | Train: 2.6555167303482854 | Val: 0.993265194259462
5-th component log probs | Train: 2.764344988371913 | Val: 0.05509734936424473
6-th component log probs | Train: 2.731741084342638 | Val: -0.5694433365361716
7-th component log probs | Train: 2.7562581791857492 | Val: 0.22666611418117144
8-th component log probs | Train: 2.6498933792163406 | Val: -1.077389658645437
9-th component log probs | Train: 2.656160292389786 | Val: 0.009723047548520611
KEYWORD NR_SAMPLES:6000 DIM:100 AVG_DIFF:6.7615
Fitting PCA...
0-th component log probs | Train: 3.125587672667869 | Val: -0.36980174136048444
1-th component log probs | Train: 2.9325377919034015 | Val: 1.8449647660386188
2-th component log probs | Train: 2.9884140475359224 | Val: 1.2230890927305877
3-th component log probs | Train: 2.92451688661606 | Val: 0.3751053570235095
4-th component log probs | Train: 2.957730277911468 | Val: 1.1291678433768413
5-th component log probs | Train: 3.072581222883369 | Val: -0.16788097028227442
6-th component log probs | Train: 3.040236486854884 | Val: -0.8447371121882234
7-th component log probs | Train: 3.086312271119136 | Val: -0.36379641441596455
8-th component log probs | Train: 2.9629183446039837 | Val: -1.4525700509062587
9-th component log probs | Train: 2.963843657465725 | Val: -0.04819170257500735
KEYWORD NR_SAMPLES:6000 DIM:150 AVG_DIFF:9.2426
Fitting PCA...
0-th component log probs | Train: 3.3568272376360357 | Val: -0.6590892185595386
1-th component log probs | Train: 3.1537696704716702 | Val: 1.9998965628271566
2-th component log probs | Train: 3.2104971368409836 | Val: 1.2641694983810299
3-th component log probs | Train: 3.144520388741103 | Val: 0.4257527555609001
4-th component log probs | Train: 3.189839887055872 | Val: 1.1407372815494305
5-th component log probs | Train: 3.3069242729728523 | Val: -0.5734400985987412
6-th component log probs | Train: 3.278818035064617 | Val: -1.225115646476017
7-th component log probs | Train: 3.3485568246561885 | Val: -0.913469728281755
8-th component log probs | Train: 3.195334749888302 | Val: -1.7748195454756148
9-th component log probs | Train: 3.19915974812409 | Val: -0.2027453706906939
KEYWORD NR_SAMPLES:6000 DIM:200 AVG_DIFF:12.2621
Fitting PCA...
0-th component log probs | Train: 3.5538958092527193 | Val: -1.0553648169807777
1-th component log probs | Train: 3.333116534907533 | Val: 2.096769764505277
2-th component log probs | Train: 3.3913617639599143 | Val: 1.2496357692582802
3-th component log probs | Train: 3.3235520060733537 | Val: 0.34825072003333524
4-th component log probs | Train: 3.373453974251509 | Val: 1.088094412489873
5-th component log probs | Train: 3.5011876897042518 | Val: -1.0774020282180712
6-th component log probs | Train: 3.479114690352489 | Val: -1.9302680495695823
7-th component log probs | Train: 3.574088551400273 | Val: -1.9800237627655703
8-th component log probs | Train: 3.3910155623984046 | Val: -2.275517800549378
9-th component log probs | Train: 3.3909392415145314 | Val: -0.43762362022338386
KEYWORD NR_SAMPLES:6000 DIM:250 AVG_DIFF:16.9277
Fitting PCA...
0-th component log probs | Train: 3.721163697316248 | Val: -1.6047329800036272
1-th component log probs | Train: 3.4791919158377267 | Val: 2.147501648151825
2-th component log probs | Train: 3.545565215698698 | Val: 1.1292076485490745
3-th component log probs | Train: 3.473808894752946 | Val: 0.22343433677475427
4-th component log probs | Train: 3.533797507179377 | Val: 0.9010740949457385
5-th component log probs | Train: 3.6671962854261686 | Val: -1.6786880869238663
6-th component log probs | Train: 3.653842491710894 | Val: -2.950202689375173
7-th component log probs | Train: 3.772760319586369 | Val: -3.62076399831277
8-th component log probs | Train: 3.555579146170783 | Val: -3.033026451513851
9-th component log probs | Train: 3.5543010348271618 | Val: -0.8764617837936797
KEYWORD NR_SAMPLES:6000 DIM:300 AVG_DIFF:24.3371
Fitting PCA...
0-th component log probs | Train: 3.8712467467884544 | Val: -2.297293542954816
1-th component log probs | Train: 3.6072124594324566 | Val: 2.104730249990388
2-th component log probs | Train: 3.6810700096323097 | Val: 0.9502260039120851
3-th component log probs | Train: 3.6065411101222966 | Val: 0.02873632884189891
4-th component log probs | Train: 3.671151360358183 | Val: 0.6735737372912962
5-th component log probs | Train: 3.817845229894579 | Val: -2.274652342941998
6-th component log probs | Train: 3.8139506707024347 | Val: -4.143144995924332
7-th component log probs | Train: 3.9509370840691433 | Val: -4.942447414053257
8-th component log probs | Train: 3.7074078187927313 | Val: -3.9672821611019717
9-th component log probs | Train: 3.703226024581461 | Val: -1.5466016455222744
KEYWORD NR_SAMPLES:6000 DIM:350 AVG_DIFF:33.5540
Fitting PCA...
0-th component log probs | Train: 4.007897105718198 | Val: -2.9065453015168843
1-th component log probs | Train: 3.721934917330997 | Val: 2.0429225192257277
2-th component log probs | Train: 3.8065356965178156 | Val: 0.6573053289230608
3-th component log probs | Train: 3.726239995766831 | Val: -0.3271312618692729
4-th component log probs | Train: 3.7968836578055924 | Val: 0.3551561486905326
5-th component log probs | Train: 3.9550941209418773 | Val: -2.879325465781324
6-th component log probs | Train: 3.9615525648363223 | Val: -5.267598006212652
7-th component log probs | Train: 4.114550220097897 | Val: -5.985333784313022
8-th component log probs | Train: 3.8449380711642873 | Val: -5.04155846295651
9-th component log probs | Train: 3.838784567774686 | Val: -2.1443521821605906
KEYWORD NR_SAMPLES:6000 DIM:400 AVG_DIFF:43.7483
Fitting PCA...
0-th component log probs | Train: 4.131167533217603 | Val: -3.425759228888578
1-th component log probs | Train: 3.826752277036559 | Val: 1.9682322935334444
2-th component log probs | Train: 3.922288271751914 | Val: 0.45927035398072
3-th component log probs | Train: 3.8369360062465803 | Val: -0.6540797049225635
4-th component log probs | Train: 3.915832070568639 | Val: 0.038232847384857174
5-th component log probs | Train: 4.0821370948619835 | Val: -3.517452433631817
6-th component log probs | Train: 4.096175217312446 | Val: -6.129607146998851
7-th component log probs | Train: 4.258890223261431 | Val: -6.821535445572543
8-th component log probs | Train: 3.975154248298543 | Val: -6.098688864461047
9-th component log probs | Train: 3.966104714783877 | Val: -2.7994686729819276
KEYWORD NR_SAMPLES:6000 DIM:450 AVG_DIFF:54.0110
Fitting PCA...
0-th component log probs | Train: 4.246210801343897 | Val: -3.6616896251120887
1-th component log probs | Train: 3.931305557015479 | Val: 1.8736245554596154
2-th component log probs | Train: 4.035672047024522 | Val: 0.27164669016756404
3-th component log probs | Train: 3.944447259238474 | Val: -0.8964333029594559
4-th component log probs | Train: 4.029149162882432 | Val: -0.2339485521880266
5-th component log probs | Train: 4.201342180193589 | Val: -3.9434861077558363
6-th component log probs | Train: 4.223836313799977 | Val: -6.8038414920741195
7-th component log probs | Train: 4.388972255702702 | Val: -7.326471130349081
8-th component log probs | Train: 4.100915476711021 | Val: -6.917919436538199
9-th component log probs | Train: 4.089254082194267 | Val: -3.370422420679578
KEYWORD NR_SAMPLES:6000 DIM:500 AVG_DIFF:62.4806
0-th component log probs | Train: 4.273172875428733 | Val: -3.724141675570331
1-th component log probs | Train: 3.9575333247722053 | Val: 1.8523392893431707
2-th component log probs | Train: 4.06263425528431 | Val: 0.2499289828353358
3-th component log probs | Train: 3.9717864573932835 | Val: -0.965592724938725
4-th component log probs | Train: 4.056119567416037 | Val: -0.2859867212704998
5-th component log probs | Train: 4.2295481639976655 | Val: -4.017080484550873
6-th component log probs | Train: 4.253780202117513 | Val: -6.916521087332317
7-th component log probs | Train: 4.4174725138835855 | Val: -7.36195593729766
8-th component log probs | Train: 4.131249941401763 | Val: -7.045933964046103
9-th component log probs | Train: 4.117902734486233 | Val: -3.493508070450407
KEYWORD NR_SAMPLES:6000 DIM:512 AVG_DIFF:64.0558
best average differences at 50 dimensions: 2.8178978291897137
2022-01-09 20:41.54 [info     ] Training complete              train_loss=0.25705283880233765
2022-01-09 20:41.54 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:41.58 [info     ] Testing complete               test_loss=0.5393983125686646
{'dataset_size': 6000,
 'end_test_accuracy': 0.8431357741355896,
 'end_test_loss': 0.5393983125686646,
 'end_train_accuracy': 0.9971742033958435,
 'end_train_loss': 0.25705283880233765,
 'end_val_accuracy': 0.8755735754966736,
 'end_val_loss': 0.5566366314888}
2022-01-09 20:41.58 [info     ] Start Predict                  dataset=52606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:42.24 [info     ] Starting training              dataset=8000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
8000
Fitting PCA...
0-th component log probs | Train: 2.1137653181693525 | Val: 1.4878080126807796
1-th component log probs | Train: 1.8217934615971694 | Val: 1.7061320553700465
2-th component log probs | Train: 1.9513581330502268 | Val: 1.5017844546111903
3-th component log probs | Train: 1.9040509309784397 | Val: 1.292856817340367
4-th component log probs | Train: 1.9739687927255611 | Val: 1.4274237673075816
5-th component log probs | Train: 2.014071990204742 | Val: 1.4800220080220516
6-th component log probs | Train: 1.9941867224434504 | Val: 1.1849402181104791
7-th component log probs | Train: 2.010565406788508 | Val: 1.5049295316374773
8-th component log probs | Train: 2.0052618028143216 | Val: 1.0066803907772028
9-th component log probs | Train: 2.153978304897227 | Val: 1.1907449924380764
KEYWORD NR_SAMPLES:8000 DIM:50 AVG_DIFF:0.4400
Fitting PCA...
0-th component log probs | Train: 2.6537232417045034 | Val: 1.7064656116557861
1-th component log probs | Train: 2.33469733463776 | Val: 2.14585983270915
2-th component log probs | Train: 2.4850703853421194 | Val: 1.8101344786289257
3-th component log probs | Train: 2.410819010367365 | Val: 1.6442938044473798
4-th component log probs | Train: 2.4913308346250114 | Val: 1.7763702822375127
5-th component log probs | Train: 2.53117847905154 | Val: 1.6963722039513733
6-th component log probs | Train: 2.5063054423084408 | Val: 1.3359583299035453
7-th component log probs | Train: 2.540444631230912 | Val: 1.8166672261695993
8-th component log probs | Train: 2.5228802997782314 | Val: 1.0840387783973484
9-th component log probs | Train: 2.703266984457058 | Val: 1.343002046887366
KEYWORD NR_SAMPLES:8000 DIM:100 AVG_DIFF:0.8998
Fitting PCA...
0-th component log probs | Train: 2.96039870824095 | Val: 1.8563957131058177
1-th component log probs | Train: 2.6228248805614998 | Val: 2.4214845611821207
2-th component log probs | Train: 2.778378519304217 | Val: 2.059988152372427
3-th component log probs | Train: 2.7093611015162224 | Val: 1.8663989024901977
4-th component log probs | Train: 2.791665001937823 | Val: 2.0180981984365602
5-th component log probs | Train: 2.832099524117 | Val: 1.8541142382651756
6-th component log probs | Train: 2.817176414200245 | Val: 1.3982207434053118
7-th component log probs | Train: 2.850868415066432 | Val: 1.9427987085839988
8-th component log probs | Train: 2.832326746814634 | Val: 1.1063881326369063
9-th component log probs | Train: 3.016587793720552 | Val: 1.3460419907540964
KEYWORD NR_SAMPLES:8000 DIM:150 AVG_DIFF:1.2649
Fitting PCA...
0-th component log probs | Train: 3.1925136463640045 | Val: 1.9118900416919646
1-th component log probs | Train: 2.8441647915281196 | Val: 2.6188693934828
2-th component log probs | Train: 2.997209687236045 | Val: 2.226396505080044
3-th component log probs | Train: 2.933054081782309 | Val: 2.034522300437902
4-th component log probs | Train: 3.019330950127173 | Val: 2.137574039580468
5-th component log probs | Train: 3.0602707191323395 | Val: 1.959192010556484
6-th component log probs | Train: 3.060418098437153 | Val: 1.3124709416503635
7-th component log probs | Train: 3.08732850923482 | Val: 2.0164016621387346
8-th component log probs | Train: 3.066651073575981 | Val: 1.1438086145385502
9-th component log probs | Train: 3.2521263133736644 | Val: 1.3870654920313368
KEYWORD NR_SAMPLES:8000 DIM:200 AVG_DIFF:1.6460
Fitting PCA...
0-th component log probs | Train: 3.3785237736348663 | Val: 1.9364854157729614
1-th component log probs | Train: 3.0246907802311296 | Val: 2.7693599986118898
2-th component log probs | Train: 3.182414325525772 | Val: 2.3119885981529222
3-th component log probs | Train: 3.1134153771023962 | Val: 2.1622902233227785
4-th component log probs | Train: 3.2058297235435322 | Val: 2.191743298008663
5-th component log probs | Train: 3.250454244885566 | Val: 2.001727899773387
6-th component log probs | Train: 3.2615051474949674 | Val: 1.1635495478455415
7-th component log probs | Train: 3.280429049398388 | Val: 2.0286343760599546
8-th component log probs | Train: 3.260218110729828 | Val: 1.091384921585511
9-th component log probs | Train: 3.447845243380729 | Val: 1.261489672036446
KEYWORD NR_SAMPLES:8000 DIM:250 AVG_DIFF:2.1847
Fitting PCA...
0-th component log probs | Train: 3.537342874452275 | Val: 1.8789733465526344
1-th component log probs | Train: 3.1743338160483474 | Val: 2.876967277283604
2-th component log probs | Train: 3.3339706505132165 | Val: 2.35471541712913
3-th component log probs | Train: 3.262627220828573 | Val: 2.218614854339456
4-th component log probs | Train: 3.357739325637695 | Val: 2.1498126757156606
5-th component log probs | Train: 3.410883549992864 | Val: 1.959669168775144
6-th component log probs | Train: 3.4292693929741325 | Val: 0.9567113510671751
7-th component log probs | Train: 3.443688167848772 | Val: 1.9805725808154047
8-th component log probs | Train: 3.422313971198128 | Val: 0.9320357039208496
9-th component log probs | Train: 3.6128161975461013 | Val: 1.0454076808742077
KEYWORD NR_SAMPLES:8000 DIM:300 AVG_DIFF:2.9500
Fitting PCA...
0-th component log probs | Train: 3.6737804056885017 | Val: 1.7651373370961085
1-th component log probs | Train: 3.299231867930597 | Val: 2.9576780569150185
2-th component log probs | Train: 3.4637994768759306 | Val: 2.368197780047964
3-th component log probs | Train: 3.3899531813912045 | Val: 2.235636315917195
4-th component log probs | Train: 3.492589093482393 | Val: 2.067707115478971
5-th component log probs | Train: 3.5523624798253595 | Val: 1.8400837308146618
6-th component log probs | Train: 3.5817760442517335 | Val: 0.5902101280566597
7-th component log probs | Train: 3.585887489431764 | Val: 1.861756227231481
8-th component log probs | Train: 3.5655518812582243 | Val: 0.6653815138280078
9-th component log probs | Train: 3.7584454666793086 | Val: 0.8428674974117208
KEYWORD NR_SAMPLES:8000 DIM:350 AVG_DIFF:4.0088
Fitting PCA...
0-th component log probs | Train: 3.796847920909207 | Val: 1.6228784539338532
1-th component log probs | Train: 3.4090530607244505 | Val: 3.0170579573770575
2-th component log probs | Train: 3.5795874147856486 | Val: 2.3299243507055896
3-th component log probs | Train: 3.502494171392647 | Val: 2.2093879092956374
4-th component log probs | Train: 3.6121204982433834 | Val: 1.9740634153934782
5-th component log probs | Train: 3.6797757817655925 | Val: 1.6594239622561733
6-th component log probs | Train: 3.720739160043505 | Val: 0.16898404911178777
7-th component log probs | Train: 3.7149665770572606 | Val: 1.7012615752312508
8-th component log probs | Train: 3.6965425202452096 | Val: 0.34667226193480233
9-th component log probs | Train: 3.8874062763229245 | Val: 0.5619836357101259
KEYWORD NR_SAMPLES:8000 DIM:400 AVG_DIFF:5.3829
Fitting PCA...
0-th component log probs | Train: 3.9078344193464143 | Val: 1.4641865479161074
1-th component log probs | Train: 3.5079369806190552 | Val: 3.0575250278750796
2-th component log probs | Train: 3.6858529540620415 | Val: 2.265640082489378
3-th component log probs | Train: 3.604113455686289 | Val: 2.156403472559979
4-th component log probs | Train: 3.7220093913210395 | Val: 1.8589376466649599
5-th component log probs | Train: 3.797908521369308 | Val: 1.438726227634101
6-th component log probs | Train: 3.849849037964809 | Val: -0.3268962174499996
7-th component log probs | Train: 3.831142232260426 | Val: 1.4879774636473821
8-th component log probs | Train: 3.81556306023868 | Val: -0.047163537442410815
9-th component log probs | Train: 4.002446894707268 | Val: 0.3206393017469313
KEYWORD NR_SAMPLES:8000 DIM:450 AVG_DIFF:7.0736
Fitting PCA...
0-th component log probs | Train: 4.015380131986009 | Val: 1.319061903226151
1-th component log probs | Train: 3.6044411752804715 | Val: 3.0849358073380135
2-th component log probs | Train: 3.7872264201521633 | Val: 2.192827114687272
3-th component log probs | Train: 3.701627712675336 | Val: 2.0890421030369914
4-th component log probs | Train: 3.8265682736151536 | Val: 1.7719635524673585
5-th component log probs | Train: 3.9126672581067266 | Val: 1.212125886435504
6-th component log probs | Train: 3.972822732170453 | Val: -0.7977956377937291
7-th component log probs | Train: 3.9449480393395184 | Val: 1.2772764631682463
8-th component log probs | Train: 3.930868087677222 | Val: -0.42147086624265845
9-th component log probs | Train: 4.11065368843756 | Val: 0.12192137368597844
KEYWORD NR_SAMPLES:8000 DIM:500 AVG_DIFF:8.8925
0-th component log probs | Train: 4.040668343603007 | Val: 1.2866823013527626
1-th component log probs | Train: 3.628652211955935 | Val: 3.0924345770576425
2-th component log probs | Train: 3.811478074334337 | Val: 2.179676811200873
3-th component log probs | Train: 3.7260808035426987 | Val: 2.0802375011473684
4-th component log probs | Train: 3.8515659460378786 | Val: 1.753713705636432
5-th component log probs | Train: 3.9394813444864116 | Val: 1.164923454776942
6-th component log probs | Train: 4.001633190961817 | Val: -0.8786532672169627
7-th component log probs | Train: 3.972442564808196 | Val: 1.2442930931177683
8-th component log probs | Train: 3.9581978123566315 | Val: -0.48949400543749855
9-th component log probs | Train: 4.135616341348339 | Val: 0.1005299995363185
KEYWORD NR_SAMPLES:8000 DIM:512 AVG_DIFF:9.2667
best average differences at 50 dimensions: 0.4400326488066414
2022-01-09 20:53.21 [info     ] Training complete              train_loss=0.3561801612377167
2022-01-09 20:53.21 [info     ] Starting evaluating            dataset=26032
2022-01-09 20:53.25 [info     ] Testing complete               test_loss=0.459456205368042
{'dataset_size': 8000,
 'end_test_accuracy': 0.8626382350921631,
 'end_test_loss': 0.459456205368042,
 'end_train_accuracy': 0.9676250219345093,
 'end_train_loss': 0.3561801612377167,
 'end_val_accuracy': 0.8645883202552795,
 'end_val_loss': 0.6419003009796143}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 20:53.25 [info     ] Start Predict                  dataset=50606
2022-01-09 20:53.51 [info     ] Starting training              dataset=10000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
10000
Fitting PCA...
0-th component log probs | Train: 2.1102986307594 | Val: 1.5723542894584055
1-th component log probs | Train: 2.0446143747385914 | Val: 1.675341174613192
2-th component log probs | Train: 2.047190236516553 | Val: 1.5096344385767644
3-th component log probs | Train: 1.9374875025541316 | Val: 1.4366767883184182
4-th component log probs | Train: 1.978020870059622 | Val: 1.6025399593592855
5-th component log probs | Train: 2.001035575052336 | Val: 1.4225614140160878
6-th component log probs | Train: 2.095183376544558 | Val: 0.8911267172454161
7-th component log probs | Train: 2.001663060968832 | Val: 1.5692384850022494
8-th component log probs | Train: 2.0343289881108033 | Val: 0.9210863763067887
9-th component log probs | Train: 2.0825141602520696 | Val: 1.1410413219590505
KEYWORD NR_SAMPLES:10000 DIM:50 AVG_DIFF:0.5204
Fitting PCA...
0-th component log probs | Train: 2.6094108058832934 | Val: 1.885758705021071
1-th component log probs | Train: 2.5358709426620525 | Val: 2.1116352933914797
2-th component log probs | Train: 2.543784002630072 | Val: 1.8788736947273195
3-th component log probs | Train: 2.4353254598392122 | Val: 1.7539059389987133
4-th component log probs | Train: 2.4853032857575617 | Val: 1.978764359484318
5-th component log probs | Train: 2.508032945568915 | Val: 1.7134177145894447
6-th component log probs | Train: 2.585968616355998 | Val: 0.9749410931754604
7-th component log probs | Train: 2.498638182299828 | Val: 1.9012724681906168
8-th component log probs | Train: 2.525495189188649 | Val: 0.9426757102998659
9-th component log probs | Train: 2.5878806422867227 | Val: 1.3434803335866732
KEYWORD NR_SAMPLES:10000 DIM:100 AVG_DIFF:0.9504
Fitting PCA...
0-th component log probs | Train: 2.9013251202651134 | Val: 2.09764232815753
1-th component log probs | Train: 2.818366228514634 | Val: 2.371703588855361
2-th component log probs | Train: 2.833689927878307 | Val: 2.1049788152840745
3-th component log probs | Train: 2.730174450651725 | Val: 2.0087865202451107
4-th component log probs | Train: 2.782854466601527 | Val: 2.2006601510010073
5-th component log probs | Train: 2.814191966370901 | Val: 1.881433885133728
6-th component log probs | Train: 2.8903873023807267 | Val: 1.0911210097401052
7-th component log probs | Train: 2.7916332846173906 | Val: 2.088405694714252
8-th component log probs | Train: 2.8183576406113655 | Val: 1.025653849308432
9-th component log probs | Train: 2.8805246445222243 | Val: 1.5310928066790574
KEYWORD NR_SAMPLES:10000 DIM:150 AVG_DIFF:1.1872
Fitting PCA...
0-th component log probs | Train: 3.1249004120409136 | Val: 2.1938039460032592
1-th component log probs | Train: 3.033723419445604 | Val: 2.5484741605936407
2-th component log probs | Train: 3.05319773840887 | Val: 2.258246680365079
3-th component log probs | Train: 2.9540616569944684 | Val: 2.193464330806818
4-th component log probs | Train: 3.0055607141266987 | Val: 2.3623423084612014
5-th component log probs | Train: 3.040518599855993 | Val: 1.9954155048153466
6-th component log probs | Train: 3.1248853134803647 | Val: 1.0267161510688088
7-th component log probs | Train: 3.0201031623711807 | Val: 2.230245258526603
8-th component log probs | Train: 3.048516588436243 | Val: 1.1068936168194377
9-th component log probs | Train: 3.1062949585366004 | Val: 1.5798634586070943
KEYWORD NR_SAMPLES:10000 DIM:200 AVG_DIFF:1.4945
Fitting PCA...
0-th component log probs | Train: 3.311640752939034 | Val: 2.2448032514787606
1-th component log probs | Train: 3.208142251092241 | Val: 2.6857659181639892
2-th component log probs | Train: 3.232352313569482 | Val: 2.3737999301370447
3-th component log probs | Train: 3.1345778385854723 | Val: 2.3398024909608974
4-th component log probs | Train: 3.188960141223715 | Val: 2.463988042613345
5-th component log probs | Train: 3.2264473166284575 | Val: 2.0411086329634363
6-th component log probs | Train: 3.317005515347665 | Val: 0.8671549184718169
7-th component log probs | Train: 3.2069262827081286 | Val: 2.3157762454135926
8-th component log probs | Train: 3.234557447799424 | Val: 1.0792499876215509
9-th component log probs | Train: 3.290936653441161 | Val: 1.6008981899815165
KEYWORD NR_SAMPLES:10000 DIM:250 AVG_DIFF:1.9008
Fitting PCA...
0-th component log probs | Train: 3.4637958351141105 | Val: 2.2587066608487327
1-th component log probs | Train: 3.3521442359784475 | Val: 2.7886076423775603
2-th component log probs | Train: 3.3811856490501744 | Val: 2.437346843090172
3-th component log probs | Train: 3.2814652543699143 | Val: 2.4507297740650946
4-th component log probs | Train: 3.340306167036623 | Val: 2.5097210577932154
5-th component log probs | Train: 3.381091013056431 | Val: 2.0582434616931584
6-th component log probs | Train: 3.4799107731294265 | Val: 0.5939651029637336
7-th component log probs | Train: 3.360584126456339 | Val: 2.344703078128356
8-th component log probs | Train: 3.387665727056455 | Val: 1.0345078204083529
9-th component log probs | Train: 3.4447977865648176 | Val: 1.5268548478892923
KEYWORD NR_SAMPLES:10000 DIM:300 AVG_DIFF:2.4367
Fitting PCA...
0-th component log probs | Train: 3.597955367594273 | Val: 2.2177690641512777
1-th component log probs | Train: 3.475211568084135 | Val: 2.8527127720676138
2-th component log probs | Train: 3.508563443588533 | Val: 2.442622574168754
3-th component log probs | Train: 3.404437986909058 | Val: 2.508169117036554
4-th component log probs | Train: 3.4679761461330583 | Val: 2.5335901338428584
5-th component log probs | Train: 3.5132449931540277 | Val: 2.0210537965433932
6-th component log probs | Train: 3.6200186887736776 | Val: 0.34063714864647215
7-th component log probs | Train: 3.4915835682742142 | Val: 2.3411715132372337
8-th component log probs | Train: 3.5221347459454244 | Val: 0.8299083303840078
9-th component log probs | Train: 3.5779658055250034 | Val: 1.4266571258353618
KEYWORD NR_SAMPLES:10000 DIM:350 AVG_DIFF:3.1286
Fitting PCA...
0-th component log probs | Train: 3.718163033949025 | Val: 2.1582986103128263
1-th component log probs | Train: 3.583794239937275 | Val: 2.8937682327516496
2-th component log probs | Train: 3.6205927410688603 | Val: 2.4266477268611335
3-th component log probs | Train: 3.5118102249151106 | Val: 2.551202915236777
4-th component log probs | Train: 3.5817869808118594 | Val: 2.5232029984910853
5-th component log probs | Train: 3.633459025454863 | Val: 1.950783190259436
6-th component log probs | Train: 3.75049785620905 | Val: -0.039458202563971694
7-th component log probs | Train: 3.609382156487754 | Val: 2.2882861120351987
8-th component log probs | Train: 3.6415541991103795 | Val: 0.5943311797276944
9-th component log probs | Train: 3.696482817504156 | Val: 1.2719659284272593
KEYWORD NR_SAMPLES:10000 DIM:400 AVG_DIFF:4.0482
Fitting PCA...
0-th component log probs | Train: 3.8283672341794324 | Val: 2.0249711846376823
1-th component log probs | Train: 3.6813045788158796 | Val: 2.926003790054104
2-th component log probs | Train: 3.7224873345773264 | Val: 2.3831546215211574
3-th component log probs | Train: 3.608348303337783 | Val: 2.5573526701870417
4-th component log probs | Train: 3.6847509966054046 | Val: 2.491142573387954
5-th component log probs | Train: 3.744408743267218 | Val: 1.830256236726086
6-th component log probs | Train: 3.8697736548008974 | Val: -0.3589741437749302
7-th component log probs | Train: 3.7181312134702003 | Val: 2.219969589714705
8-th component log probs | Train: 3.7515279553588896 | Val: 0.25446443125957197
9-th component log probs | Train: 3.8036899196891953 | Val: 1.089440673647311
KEYWORD NR_SAMPLES:10000 DIM:450 AVG_DIFF:5.1533
Fitting PCA...
0-th component log probs | Train: 3.935614768618804 | Val: 1.9308209076556089
1-th component log probs | Train: 3.7778191799355842 | Val: 2.9441657658909457
2-th component log probs | Train: 3.8218070043142593 | Val: 2.3131342552757563
3-th component log probs | Train: 3.7012747475448817 | Val: 2.5741153603691664
4-th component log probs | Train: 3.784143639610547 | Val: 2.465020449789654
5-th component log probs | Train: 3.85194038572564 | Val: 1.7221871626472198
6-th component log probs | Train: 3.9871399571489214 | Val: -0.6792213776973804
7-th component log probs | Train: 3.82448013004132 | Val: 2.1434892235664913
8-th component log probs | Train: 3.860024588172556 | Val: -0.1299632357129237
9-th component log probs | Train: 3.9090112314085252 | Val: 0.9428258837504832
KEYWORD NR_SAMPLES:10000 DIM:500 AVG_DIFF:6.3856
0-th component log probs | Train: 3.9631278323383534 | Val: 1.9304152197183837
1-th component log probs | Train: 3.8026937776002403 | Val: 2.9508596494503387
2-th component log probs | Train: 3.8476858487055443 | Val: 2.305044065646117
3-th component log probs | Train: 3.724061922166869 | Val: 2.5818451087360192
4-th component log probs | Train: 3.8092555068611924 | Val: 2.459538617406718
5-th component log probs | Train: 3.8808629482387897 | Val: 1.7076350973828451
6-th component log probs | Train: 4.014336661579137 | Val: -0.7397022265687455
7-th component log probs | Train: 3.8503689588645065 | Val: 2.122118100804358
8-th component log probs | Train: 3.8868252128438625 | Val: -0.21162874215924998
9-th component log probs | Train: 3.936306290217759 | Val: 0.9293362428147159
KEYWORD NR_SAMPLES:10000 DIM:512 AVG_DIFF:6.6514
best average differences at 50 dimensions: 0.5203566358029754
2022-01-09 21:06.17 [info     ] Training complete              train_loss=0.3932446539402008
2022-01-09 21:06.17 [info     ] Starting evaluating            dataset=26032
2022-01-09 21:06.21 [info     ] Testing complete               test_loss=0.4338774085044861
{'dataset_size': 10000,
 'end_test_accuracy': 0.8668739199638367,
 'end_test_loss': 0.4338774085044861,
 'end_train_accuracy': 0.9582006335258484,
 'end_train_loss': 0.3932446539402008,
 'end_val_accuracy': 0.8911130428314209,
 'end_val_loss': 0.48945820331573486}
2022-01-09 21:06.21 [info     ] Start Predict                  dataset=48606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 21:06.53 [info     ] Starting training              dataset=20000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
20000
Fitting PCA...
0-th component log probs | Train: 2.0338910309749823 | Val: 1.5841924572370427
1-th component log probs | Train: 1.9541596198626408 | Val: 1.7537651361173325
2-th component log probs | Train: 2.0578630273541663 | Val: 1.6213296896208111
3-th component log probs | Train: 1.838118964402883 | Val: 1.45320282487481
4-th component log probs | Train: 1.9627268614961462 | Val: 1.6315118723936564
5-th component log probs | Train: 2.0992184108070924 | Val: 1.467854152051766
6-th component log probs | Train: 2.0406784456677163 | Val: 1.4088054278932087
7-th component log probs | Train: 2.010498082723572 | Val: 1.5017444671949343
8-th component log probs | Train: 1.9998901113513208 | Val: 1.113619171904557
9-th component log probs | Train: 2.0554237886478233 | Val: 1.3040265708662349
KEYWORD NR_SAMPLES:20000 DIM:50 AVG_DIFF:0.3098
Fitting PCA...
0-th component log probs | Train: 2.569207092780966 | Val: 2.019372992608357
1-th component log probs | Train: 2.499633235160284 | Val: 2.261475737853907
2-th component log probs | Train: 2.6129248233513227 | Val: 2.0405065508174713
3-th component log probs | Train: 2.3778800781987717 | Val: 1.927279103458715
4-th component log probs | Train: 2.4998394477480472 | Val: 2.0712931234643337
5-th component log probs | Train: 2.6510857646965973 | Val: 1.7808788252985317
6-th component log probs | Train: 2.5809385656186024 | Val: 1.785795800115694
7-th component log probs | Train: 2.5474355795304393 | Val: 1.9888537304470908
8-th component log probs | Train: 2.5503308829110494 | Val: 1.3579392391351213
9-th component log probs | Train: 2.6032772011857297 | Val: 1.5549802662606913
KEYWORD NR_SAMPLES:20000 DIM:100 AVG_DIFF:0.5296
Fitting PCA...
0-th component log probs | Train: 2.839721189644447 | Val: 2.264453937447201
1-th component log probs | Train: 2.77483222872538 | Val: 2.536756288903056
2-th component log probs | Train: 2.8995017628441224 | Val: 2.328713850897735
3-th component log probs | Train: 2.657771842055179 | Val: 2.2099553015535776
4-th component log probs | Train: 2.773466152904972 | Val: 2.3439522290079817
5-th component log probs | Train: 2.9282023409845066 | Val: 2.014790346293145
6-th component log probs | Train: 2.851398270982478 | Val: 2.0341641014269514
7-th component log probs | Train: 2.824451983063241 | Val: 2.257148579825245
8-th component log probs | Train: 2.830523003547124 | Val: 1.6252621515665742
9-th component log probs | Train: 2.8797497576974624 | Val: 1.8121002008157319
KEYWORD NR_SAMPLES:20000 DIM:150 AVG_DIFF:0.5515
Fitting PCA...
0-th component log probs | Train: 3.054396271334252 | Val: 2.4601692972314364
1-th component log probs | Train: 2.9866700545759235 | Val: 2.7327667329411494
2-th component log probs | Train: 3.1154588318442547 | Val: 2.5318467383319665
3-th component log probs | Train: 2.8717446788415906 | Val: 2.424863094390985
4-th component log probs | Train: 2.9867361290881758 | Val: 2.54636741200253
5-th component log probs | Train: 3.1423983973655636 | Val: 2.151328562023152
6-th component log probs | Train: 3.0670623395236163 | Val: 2.212206619800728
7-th component log probs | Train: 3.04074754353695 | Val: 2.427287929066522
8-th component log probs | Train: 3.0477890665068035 | Val: 1.8045597360189913
9-th component log probs | Train: 3.094316517504705 | Val: 1.983167695395354
KEYWORD NR_SAMPLES:20000 DIM:200 AVG_DIFF:0.6021
Fitting PCA...
0-th component log probs | Train: 3.229196206270938 | Val: 2.6011364377846213
1-th component log probs | Train: 3.163272234363976 | Val: 2.895456785430018
2-th component log probs | Train: 3.2895822760678857 | Val: 2.675406348486524
3-th component log probs | Train: 3.0498742644495147 | Val: 2.587958535033912
4-th component log probs | Train: 3.162524672508166 | Val: 2.700457556876091
5-th component log probs | Train: 3.3203405984452052 | Val: 2.2554386930154084
6-th component log probs | Train: 3.2459040526804146 | Val: 2.3369292218026962
7-th component log probs | Train: 3.2197346238683964 | Val: 2.5653781106199203
8-th component log probs | Train: 3.228118568686913 | Val: 1.9447606123177867
9-th component log probs | Train: 3.2743442558347713 | Val: 2.0673365781431863
KEYWORD NR_SAMPLES:20000 DIM:250 AVG_DIFF:0.6763
Fitting PCA...
0-th component log probs | Train: 3.376992202817187 | Val: 2.705376648422803
1-th component log probs | Train: 3.309943700684665 | Val: 3.0319266116365595
2-th component log probs | Train: 3.43677679235343 | Val: 2.790822095959354
3-th component log probs | Train: 3.197376290185897 | Val: 2.7191750821742415
4-th component log probs | Train: 3.3102573628991916 | Val: 2.821191386797261
5-th component log probs | Train: 3.470914701359157 | Val: 2.3289326919914872
6-th component log probs | Train: 3.3955324133381435 | Val: 2.436178054491103
7-th component log probs | Train: 3.369850849705498 | Val: 2.679383640390965
8-th component log probs | Train: 3.3769616120424977 | Val: 2.0352585386825663
9-th component log probs | Train: 3.4273387648767826 | Val: 2.126272958446819
KEYWORD NR_SAMPLES:20000 DIM:300 AVG_DIFF:0.7608
Fitting PCA...
0-th component log probs | Train: 3.5012042056315296 | Val: 2.7778514286436655
1-th component log probs | Train: 3.433815405540682 | Val: 3.1401868886554687
2-th component log probs | Train: 3.560809609613281 | Val: 2.888071769308222
3-th component log probs | Train: 3.3224395121310466 | Val: 2.8250991738995137
4-th component log probs | Train: 3.4363886379538595 | Val: 2.9091563614256475
5-th component log probs | Train: 3.6005928256713795 | Val: 2.339117911016208
6-th component log probs | Train: 3.5244931006882116 | Val: 2.488465674825756
7-th component log probs | Train: 3.4970483241460686 | Val: 2.7509224406859416
8-th component log probs | Train: 3.505536233658042 | Val: 2.0845563288205233
9-th component log probs | Train: 3.556679701892823 | Val: 2.1176987550630963
KEYWORD NR_SAMPLES:20000 DIM:350 AVG_DIFF:0.8899
Fitting PCA...
0-th component log probs | Train: 3.6117789798958535 | Val: 2.837765524752518
1-th component log probs | Train: 3.5425676048972243 | Val: 3.230286471874781
2-th component log probs | Train: 3.6700463326336905 | Val: 2.9575795394880577
3-th component log probs | Train: 3.4313953949360685 | Val: 2.9158615714139784
4-th component log probs | Train: 3.5462271221052277 | Val: 2.9841453400312634
5-th component log probs | Train: 3.717193504413537 | Val: 2.3237320319215176
6-th component log probs | Train: 3.6391818967114093 | Val: 2.5131781055488895
7-th component log probs | Train: 3.6088234921444995 | Val: 2.811429130878295
8-th component log probs | Train: 3.617750260128627 | Val: 2.1034026754931165
9-th component log probs | Train: 3.6719761131509197 | Val: 2.091649499622086
KEYWORD NR_SAMPLES:20000 DIM:400 AVG_DIFF:1.0422
Fitting PCA...
0-th component log probs | Train: 3.7093596912801834 | Val: 2.8883382685106125
1-th component log probs | Train: 3.639755965239825 | Val: 3.310460425586991
2-th component log probs | Train: 3.769092053775094 | Val: 3.011454015965622
3-th component log probs | Train: 3.529374701734699 | Val: 2.9836485578121814
4-th component log probs | Train: 3.6454658620346567 | Val: 3.034015038852164
5-th component log probs | Train: 3.8248752975774063 | Val: 2.292078864362131
6-th component log probs | Train: 3.7423511424359805 | Val: 2.5338389282351166
7-th component log probs | Train: 3.7094793206726537 | Val: 2.842250487164035
8-th component log probs | Train: 3.7206195372496 | Val: 2.1093845887375364
9-th component log probs | Train: 3.7743931151992394 | Val: 2.0692965893117785
KEYWORD NR_SAMPLES:20000 DIM:450 AVG_DIFF:1.2094
Fitting PCA...
0-th component log probs | Train: 3.8034314744227844 | Val: 2.9466778730997025
1-th component log probs | Train: 3.7338730911482547 | Val: 3.3880676041164954
2-th component log probs | Train: 3.863443522609681 | Val: 3.076298164476802
3-th component log probs | Train: 3.624847752791408 | Val: 3.040976070556157
4-th component log probs | Train: 3.7455056695440048 | Val: 3.0533695409916355
5-th component log probs | Train: 3.9314634916280347 | Val: 2.288309592458734
6-th component log probs | Train: 3.8464323553209616 | Val: 2.555727996044496
7-th component log probs | Train: 3.80772265675865 | Val: 2.876330786633113
8-th component log probs | Train: 3.8183798871545136 | Val: 2.1316956247806744
9-th component log probs | Train: 3.873208762946213 | Val: 2.0895621016960515
KEYWORD NR_SAMPLES:20000 DIM:500 AVG_DIFF:1.3553
0-th component log probs | Train: 3.827759068634768 | Val: 2.9712290632304446
1-th component log probs | Train: 3.756150502076587 | Val: 3.4100940521494647
2-th component log probs | Train: 3.890221527779431 | Val: 3.101920111635263
3-th component log probs | Train: 3.653168604630818 | Val: 3.0651405420156905
4-th component log probs | Train: 3.773845230576602 | Val: 3.0774368216361223
5-th component log probs | Train: 3.9618198069057495 | Val: 2.3166495858808993
6-th component log probs | Train: 3.873443044464017 | Val: 2.5752862038655575
7-th component log probs | Train: 3.8339700753102837 | Val: 2.8983364036927264
8-th component log probs | Train: 3.84327620941189 | Val: 2.1575921338519968
9-th component log probs | Train: 3.9013932766288986 | Val: 2.1152218087412717
KEYWORD NR_SAMPLES:20000 DIM:512 AVG_DIFF:1.3605
best average differences at 50 dimensions: 0.3097600450901815
2022-01-09 21:31.04 [info     ] Training complete              train_loss=0.3472304046154022
2022-01-09 21:31.04 [info     ] Starting evaluating            dataset=26032
2022-01-09 21:31.07 [info     ] Testing complete               test_loss=0.32748889923095703
{'dataset_size': 20000,
 'end_test_accuracy': 0.9035754203796387,
 'end_test_loss': 0.32748889923095703,
 'end_train_accuracy': 0.9619608521461487,
 'end_train_loss': 0.3472304046154022,
 'end_val_accuracy': 0.9132431149482727,
 'end_val_loss': 0.391599178314209}
2022-01-09 21:31.07 [info     ] Start Predict                  dataset=38606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 21:31.39 [info     ] Starting training              dataset=30000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
30000
Fitting PCA...
0-th component log probs | Train: 2.175464560426226 | Val: 1.4004971516174562
1-th component log probs | Train: 2.030093886993131 | Val: 1.5813274620582434
2-th component log probs | Train: 2.0267522347086824 | Val: 1.4063488051399116
3-th component log probs | Train: 2.0541552574292217 | Val: 1.1454468820553665
4-th component log probs | Train: 2.1078067100139393 | Val: 1.5471049165723636
5-th component log probs | Train: 2.136140726284815 | Val: 1.1881321888199483
6-th component log probs | Train: 2.0281821833837634 | Val: 1.116866175888658
7-th component log probs | Train: 2.0816338725642307 | Val: 1.3076777995721416
8-th component log probs | Train: 2.1049910599115518 | Val: 0.8072100390071868
9-th component log probs | Train: 2.1603345763994417 | Val: 1.370060066397541
KEYWORD NR_SAMPLES:30000 DIM:50 AVG_DIFF:0.6964
Fitting PCA...
0-th component log probs | Train: 2.7626693319128424 | Val: 1.7046317413389065
1-th component log probs | Train: 2.592558595431167 | Val: 2.1476851680982043
2-th component log probs | Train: 2.6149362932697784 | Val: 1.8445949854878256
3-th component log probs | Train: 2.628649781782275 | Val: 1.5987226813789535
4-th component log probs | Train: 2.6644044911898237 | Val: 1.981133325992677
5-th component log probs | Train: 2.704648475515664 | Val: 1.5666311950034248
6-th component log probs | Train: 2.6050807608194737 | Val: 1.460531674465482
7-th component log probs | Train: 2.6641159634796097 | Val: 1.6947315849365971
8-th component log probs | Train: 2.6660386819078608 | Val: 0.9270562343317832
9-th component log probs | Train: 2.7417433536022915 | Val: 1.3970181671468787
KEYWORD NR_SAMPLES:30000 DIM:100 AVG_DIFF:1.1816
Fitting PCA...
0-th component log probs | Train: 3.0183319864159763 | Val: 1.969928393818971
1-th component log probs | Train: 2.8505690037372076 | Val: 2.440986811183894
2-th component log probs | Train: 2.8818769141151295 | Val: 2.1357151297191184
3-th component log probs | Train: 2.8931981182040567 | Val: 1.9174487277240329
4-th component log probs | Train: 2.9307757065469837 | Val: 2.2659871326030654
5-th component log probs | Train: 2.961918023293126 | Val: 1.8673165858261722
6-th component log probs | Train: 2.871896200118264 | Val: 1.7620600300188238
7-th component log probs | Train: 2.9228110603407447 | Val: 1.9571588365466477
8-th component log probs | Train: 2.932068137110211 | Val: 1.214268174010928
9-th component log probs | Train: 3.0051749971298496 | Val: 1.6106392398371814
KEYWORD NR_SAMPLES:30000 DIM:150 AVG_DIFF:1.1476
Fitting PCA...
0-th component log probs | Train: 3.216070402152742 | Val: 2.154427853877357
1-th component log probs | Train: 3.048915158397419 | Val: 2.669086333819436
2-th component log probs | Train: 3.0776570032053145 | Val: 2.345894290356007
3-th component log probs | Train: 3.0894988408921673 | Val: 2.1382444404575507
4-th component log probs | Train: 3.1355008945443172 | Val: 2.470233396370263
5-th component log probs | Train: 3.1554416872603985 | Val: 2.06845280375058
6-th component log probs | Train: 3.067358369087011 | Val: 1.9628825433337649
7-th component log probs | Train: 3.1211698200281055 | Val: 2.088524617643714
8-th component log probs | Train: 3.1325639978483015 | Val: 1.4342601100190335
9-th component log probs | Train: 3.2033818204884907 | Val: 1.7456649847569556
KEYWORD NR_SAMPLES:30000 DIM:200 AVG_DIFF:1.1631
Fitting PCA...
0-th component log probs | Train: 3.3851634993352033 | Val: 2.286866313991827
1-th component log probs | Train: 3.2187876976072136 | Val: 2.848985092171337
2-th component log probs | Train: 3.2460383731123286 | Val: 2.4981661765484207
3-th component log probs | Train: 3.2604619517217985 | Val: 2.3025253144478492
4-th component log probs | Train: 3.3091004599658858 | Val: 2.632439693062173
5-th component log probs | Train: 3.324807029757122 | Val: 2.2121914060876677
6-th component log probs | Train: 3.236053247237307 | Val: 2.123451454028669
7-th component log probs | Train: 3.2929269170528017 | Val: 2.224649889549608
8-th component log probs | Train: 3.305291962090613 | Val: 1.5308810778719084
9-th component log probs | Train: 3.3754298243525382 | Val: 1.8953691499724081
KEYWORD NR_SAMPLES:30000 DIM:250 AVG_DIFF:1.2234
Fitting PCA...
0-th component log probs | Train: 3.533071636030109 | Val: 2.3761210369081427
1-th component log probs | Train: 3.3653952124108115 | Val: 2.9978455537366817
2-th component log probs | Train: 3.3880901651129873 | Val: 2.6240219630431465
3-th component log probs | Train: 3.407605679057524 | Val: 2.395499755106315
4-th component log probs | Train: 3.456414753704133 | Val: 2.746753628001928
5-th component log probs | Train: 3.4705869391702278 | Val: 2.317452124009431
6-th component log probs | Train: 3.3820394754076335 | Val: 2.2212954816683608
7-th component log probs | Train: 3.441823809738872 | Val: 2.2987361068609493
8-th component log probs | Train: 3.4536573456252637 | Val: 1.5997102914204102
9-th component log probs | Train: 3.5271103665041856 | Val: 1.953201420726744
KEYWORD NR_SAMPLES:30000 DIM:300 AVG_DIFF:1.3483
Fitting PCA...
0-th component log probs | Train: 3.6610490358176784 | Val: 2.4236013623071058
1-th component log probs | Train: 3.491317586080755 | Val: 3.114636523397538
2-th component log probs | Train: 3.513355244161642 | Val: 2.704792628079085
3-th component log probs | Train: 3.5339417132180886 | Val: 2.47570826774669
4-th component log probs | Train: 3.5848223370983265 | Val: 2.848744362231712
5-th component log probs | Train: 3.5991092600210335 | Val: 2.3922863067188067
6-th component log probs | Train: 3.5090319939804644 | Val: 2.3026550543015403
7-th component log probs | Train: 3.5713711031026865 | Val: 2.3423630522100223
8-th component log probs | Train: 3.584168380505906 | Val: 1.6060006382097491
9-th component log probs | Train: 3.6613214989894334 | Val: 2.0017571785180746
KEYWORD NR_SAMPLES:30000 DIM:350 AVG_DIFF:1.5078
Fitting PCA...
0-th component log probs | Train: 3.7773363944782843 | Val: 2.4411678317419585
1-th component log probs | Train: 3.605248862303317 | Val: 3.211526233469083
2-th component log probs | Train: 3.627051383138072 | Val: 2.7896389905421013
3-th component log probs | Train: 3.649338865907896 | Val: 2.5490877425326444
4-th component log probs | Train: 3.699603992358278 | Val: 2.918887837792104
5-th component log probs | Train: 3.714726983422237 | Val: 2.4598582326156864
6-th component log probs | Train: 3.6226425554446458 | Val: 2.352631277883683
7-th component log probs | Train: 3.68986007064865 | Val: 2.3662418024508463
8-th component log probs | Train: 3.7033214203320752 | Val: 1.6205972449453137
9-th component log probs | Train: 3.7813228955811415 | Val: 1.952595445510261
KEYWORD NR_SAMPLES:30000 DIM:400 AVG_DIFF:1.7083
Fitting PCA...
0-th component log probs | Train: 3.883961660855504 | Val: 2.466703039810794
1-th component log probs | Train: 3.7108262132539704 | Val: 3.2975518325708637
2-th component log probs | Train: 3.730193332330779 | Val: 2.8453262386285862
3-th component log probs | Train: 3.7559483946616368 | Val: 2.5907863705895497
4-th component log probs | Train: 3.8030825304297387 | Val: 2.9567011976538278
5-th component log probs | Train: 3.8221385763954316 | Val: 2.523518856559047
6-th component log probs | Train: 3.7268993856651558 | Val: 2.382117830236505
7-th component log probs | Train: 3.7983520174506347 | Val: 2.403504013382184
8-th component log probs | Train: 3.812354755828045 | Val: 1.6216706429093315
9-th component log probs | Train: 3.8893997983632906 | Val: 1.9591404944639759
KEYWORD NR_SAMPLES:30000 DIM:450 AVG_DIFF:1.9002
Fitting PCA...
0-th component log probs | Train: 3.987050983599486 | Val: 2.561364956224204
1-th component log probs | Train: 3.8128125272146702 | Val: 3.3898499100523805
2-th component log probs | Train: 3.832536328516688 | Val: 2.944816865409478
3-th component log probs | Train: 3.8652366616812586 | Val: 2.660911949637186
4-th component log probs | Train: 3.9057560423730937 | Val: 3.0146663519090406
5-th component log probs | Train: 3.92764754048742 | Val: 2.608895232368902
6-th component log probs | Train: 3.8276181730880605 | Val: 2.4503669854371672
7-th component log probs | Train: 3.904390382839521 | Val: 2.49228537905359
8-th component log probs | Train: 3.9186018385804497 | Val: 1.6810171349447987
9-th component log probs | Train: 3.990786288745556 | Val: 2.0236051584382793
KEYWORD NR_SAMPLES:30000 DIM:500 AVG_DIFF:1.9751
0-th component log probs | Train: 4.0110417856977065 | Val: 2.602102101884903
1-th component log probs | Train: 3.837969531356918 | Val: 3.419955725950539
2-th component log probs | Train: 3.857283366143256 | Val: 2.9817417702898945
3-th component log probs | Train: 3.890296943940264 | Val: 2.701336529681322
4-th component log probs | Train: 3.930377299262062 | Val: 3.047451591077544
5-th component log probs | Train: 3.9522907648273655 | Val: 2.6497310054093055
6-th component log probs | Train: 3.8541014165978007 | Val: 2.4941190814874634
7-th component log probs | Train: 3.929573686877267 | Val: 2.536200156266687
8-th component log probs | Train: 3.9442939520074947 | Val: 1.7314469704089477
9-th component log probs | Train: 4.015308005017835 | Val: 2.0713011385283635
KEYWORD NR_SAMPLES:30000 DIM:512 AVG_DIFF:1.9283
best average differences at 50 dimensions: 0.6963998051851258
2022-01-09 22:09.32 [info     ] Training complete              train_loss=0.2386246919631958
2022-01-09 22:09.32 [info     ] Starting evaluating            dataset=26032
2022-01-09 22:09.36 [info     ] Testing complete               test_loss=0.2887871563434601
{'dataset_size': 30000,
 'end_test_accuracy': 0.9173449277877808,
 'end_test_loss': 0.2887871563434601,
 'end_train_accuracy': 0.9871512651443481,
 'end_train_loss': 0.2386246919631958,
 'end_val_accuracy': 0.9283338785171509,
 'end_val_loss': 0.3112897276878357}
2022-01-09 22:09.36 [info     ] Start Predict                  dataset=28606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 22:10.10 [info     ] Starting training              dataset=40000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
40000
Fitting PCA...
0-th component log probs | Train: 2.1148958454096576 | Val: 1.4978615941742395
1-th component log probs | Train: 1.8817482256279299 | Val: 1.7360161931412035
2-th component log probs | Train: 1.9839881576142937 | Val: 1.5170741520296582
3-th component log probs | Train: 1.9472809083520657 | Val: 1.4522251527750538
4-th component log probs | Train: 1.9277173671525352 | Val: 1.6447062867106161
5-th component log probs | Train: 2.0385210153253874 | Val: 1.4465833383038909
6-th component log probs | Train: 1.9862725693450218 | Val: 1.359454108065164
7-th component log probs | Train: 2.0416951162792727 | Val: 1.5074223011170844
8-th component log probs | Train: 2.0719621084282385 | Val: 1.135486908482047
9-th component log probs | Train: 2.152399956520993 | Val: 1.156074794340297
KEYWORD NR_SAMPLES:40000 DIM:50 AVG_DIFF:0.3844
Fitting PCA...
0-th component log probs | Train: 2.7318011910508813 | Val: 1.946875782215704
1-th component log probs | Train: 2.488271169171722 | Val: 2.3191083155535765
2-th component log probs | Train: 2.596264672903136 | Val: 2.0754624860460176
3-th component log probs | Train: 2.545854772162791 | Val: 1.973810159626404
4-th component log probs | Train: 2.5165806257459997 | Val: 2.1821546101524385
5-th component log probs | Train: 2.6297968121716853 | Val: 1.9928633991031621
6-th component log probs | Train: 2.5820205783557353 | Val: 1.8382409234074626
7-th component log probs | Train: 2.667944959107736 | Val: 2.0360391454499274
8-th component log probs | Train: 2.6768177937276927 | Val: 1.5835470057096301
9-th component log probs | Train: 2.7545224864997415 | Val: 1.5187843870545832
KEYWORD NR_SAMPLES:40000 DIM:100 AVG_DIFF:0.5436
Fitting PCA...
0-th component log probs | Train: 3.003696387237166 | Val: 2.216142981113934
1-th component log probs | Train: 2.7672617691523507 | Val: 2.610467266531375
2-th component log probs | Train: 2.8629690332201467 | Val: 2.3870747986442544
3-th component log probs | Train: 2.82043946079301 | Val: 2.2876763898054535
4-th component log probs | Train: 2.802259882351102 | Val: 2.4757746925835193
5-th component log probs | Train: 2.897235097852103 | Val: 2.275504217938183
6-th component log probs | Train: 2.8545101531981465 | Val: 2.134987427553876
7-th component log probs | Train: 2.9433569186729738 | Val: 2.3019792709501417
8-th component log probs | Train: 2.9546575835791806 | Val: 1.8778864404844124
9-th component log probs | Train: 3.022497951681549 | Val: 1.7998793556547612
KEYWORD NR_SAMPLES:40000 DIM:150 AVG_DIFF:0.5232
Fitting PCA...
0-th component log probs | Train: 3.201970604439376 | Val: 2.398966079429805
1-th component log probs | Train: 2.972366368642407 | Val: 2.8217795728538886
2-th component log probs | Train: 3.0576176908282275 | Val: 2.5956053722256094
3-th component log probs | Train: 3.019663885761837 | Val: 2.502911460135195
4-th component log probs | Train: 3.0119630590225714 | Val: 2.6733849754290078
5-th component log probs | Train: 3.091521926318819 | Val: 2.469745918197938
6-th component log probs | Train: 3.053368974557189 | Val: 2.330483860803552
7-th component log probs | Train: 3.1439633002205967 | Val: 2.4997663096473883
8-th component log probs | Train: 3.157380609703852 | Val: 2.0770139793250544
9-th component log probs | Train: 3.221900861087839 | Val: 2.001271904195368
KEYWORD NR_SAMPLES:40000 DIM:200 AVG_DIFF:0.5244
Fitting PCA...
0-th component log probs | Train: 3.3713227079140378 | Val: 2.5394662904113465
1-th component log probs | Train: 3.143344210373113 | Val: 2.986283296205375
2-th component log probs | Train: 3.223126286678682 | Val: 2.7666238981222278
3-th component log probs | Train: 3.1869260424260903 | Val: 2.680935713220233
4-th component log probs | Train: 3.18717810591796 | Val: 2.8163776445816144
5-th component log probs | Train: 3.2603040617486543 | Val: 2.6243775837386654
6-th component log probs | Train: 3.2223666396197572 | Val: 2.4809597092835927
7-th component log probs | Train: 3.312823173100155 | Val: 2.642051491414447
8-th component log probs | Train: 3.3312575546168883 | Val: 2.2036168486547676
9-th component log probs | Train: 3.3926463583241024 | Val: 2.117489333091363
KEYWORD NR_SAMPLES:40000 DIM:250 AVG_DIFF:0.5620
Fitting PCA...
0-th component log probs | Train: 3.5214310878132156 | Val: 2.6433860682208876
1-th component log probs | Train: 3.2902891206373446 | Val: 3.1292502118990404
2-th component log probs | Train: 3.369169740147017 | Val: 2.9061257180772024
3-th component log probs | Train: 3.3345778819617977 | Val: 2.8281011815038712
4-th component log probs | Train: 3.341771288996534 | Val: 2.9350564419423617
5-th component log probs | Train: 3.4114511605003597 | Val: 2.749508946920723
6-th component log probs | Train: 3.3713432341198084 | Val: 2.594785870446679
7-th component log probs | Train: 3.460524067175574 | Val: 2.758015657871926
8-th component log probs | Train: 3.484201036282638 | Val: 2.3027108763022124
9-th component log probs | Train: 3.543331809572037 | Val: 2.2086661723416854
KEYWORD NR_SAMPLES:40000 DIM:300 AVG_DIFF:0.6145
Fitting PCA...
0-th component log probs | Train: 3.6547466119970777 | Val: 2.7264663860571643
1-th component log probs | Train: 3.419089667282914 | Val: 3.249612586683541
2-th component log probs | Train: 3.4983054244202387 | Val: 3.031926620399758
3-th component log probs | Train: 3.4650900848095167 | Val: 2.953358379469575
4-th component log probs | Train: 3.4760547826502495 | Val: 3.0312317849017045
5-th component log probs | Train: 3.5437513127595697 | Val: 2.846694516805701
6-th component log probs | Train: 3.5044543749883146 | Val: 2.6976192687009273
7-th component log probs | Train: 3.5933833947704614 | Val: 2.834362015573331
8-th component log probs | Train: 3.6201051522429677 | Val: 2.370973652630903
9-th component log probs | Train: 3.67621144374486 | Val: 2.2870218086446306
KEYWORD NR_SAMPLES:40000 DIM:350 AVG_DIFF:0.6771
Fitting PCA...
0-th component log probs | Train: 3.7742915966059507 | Val: 2.7868534401767686
1-th component log probs | Train: 3.533407703439408 | Val: 3.3566371673122886
2-th component log probs | Train: 3.615170085737167 | Val: 3.139562580699393
3-th component log probs | Train: 3.5814747364925847 | Val: 3.0605140949117002
4-th component log probs | Train: 3.5977878671355654 | Val: 3.1182521526840032
5-th component log probs | Train: 3.6623822099158128 | Val: 2.92795825924391
6-th component log probs | Train: 3.6263924467841853 | Val: 2.7812015817442552
7-th component log probs | Train: 3.711427772418036 | Val: 2.893901652789465
8-th component log probs | Train: 3.742762250625193 | Val: 2.409496219687312
9-th component log probs | Train: 3.7967047272327155 | Val: 2.3459205396506273
KEYWORD NR_SAMPLES:40000 DIM:400 AVG_DIFF:0.7538
Fitting PCA...
0-th component log probs | Train: 3.8859942737901156 | Val: 2.8573291602660413
1-th component log probs | Train: 3.6383257373383615 | Val: 3.4583754134751894
2-th component log probs | Train: 3.7248373935629733 | Val: 3.2344800730785654
3-th component log probs | Train: 3.6892674741874876 | Val: 3.1610684327990954
4-th component log probs | Train: 3.7114709978374076 | Val: 3.1927939497556332
5-th component log probs | Train: 3.7727896723326952 | Val: 3.00647550922095
6-th component log probs | Train: 3.738961427351105 | Val: 2.8501953248949605
7-th component log probs | Train: 3.819207974254077 | Val: 2.97330844573848
8-th component log probs | Train: 3.8532259124933805 | Val: 2.4342632231836734
9-th component log probs | Train: 3.908397645455609 | Val: 2.404814006956653
KEYWORD NR_SAMPLES:40000 DIM:450 AVG_DIFF:0.8246
Fitting PCA...
0-th component log probs | Train: 3.9983525993841558 | Val: 2.981125125837084
1-th component log probs | Train: 3.7479518299905696 | Val: 3.569428319143226
2-th component log probs | Train: 3.836459750264785 | Val: 3.3537319803334835
3-th component log probs | Train: 3.7984290947138026 | Val: 3.2798726120925696
4-th component log probs | Train: 3.8315757215631083 | Val: 3.2951862510181678
5-th component log probs | Train: 3.88449004450497 | Val: 3.116016966859725
6-th component log probs | Train: 3.853982940139216 | Val: 2.9663910637478224
7-th component log probs | Train: 3.931745292367932 | Val: 3.0954082450440303
8-th component log probs | Train: 3.967391889735509 | Val: 2.5658461668517156
9-th component log probs | Train: 4.020069613913262 | Val: 2.5158814292324023
KEYWORD NR_SAMPLES:40000 DIM:500 AVG_DIFF:0.8161
0-th component log probs | Train: 4.028344719747655 | Val: 3.027976925204605
1-th component log probs | Train: 3.7825092424941316 | Val: 3.6063100399637884
2-th component log probs | Train: 3.8695097768241515 | Val: 3.3950534694287287
3-th component log probs | Train: 3.8320802720599296 | Val: 3.3210183172487833
4-th component log probs | Train: 3.863996470718948 | Val: 3.3352157244424485
5-th component log probs | Train: 3.9168155219434975 | Val: 3.1606546900723584
6-th component log probs | Train: 3.8873758361598894 | Val: 3.0131822288740886
7-th component log probs | Train: 3.9638579477732083 | Val: 3.140220035205969
8-th component log probs | Train: 3.999420900776678 | Val: 2.6200713040341355
9-th component log probs | Train: 4.050703613037448 | Val: 2.5714496167103924
KEYWORD NR_SAMPLES:40000 DIM:512 AVG_DIFF:0.7903
best average differences at 50 dimensions: 0.3843541920693118
2022-01-09 22:58.32 [info     ] Training complete              train_loss=0.2909761369228363
2022-01-09 22:58.32 [info     ] Starting evaluating            dataset=26032
2022-01-09 22:58.36 [info     ] Testing complete               test_loss=0.27119144797325134
{'dataset_size': 40000,
 'end_test_accuracy': 0.9216830730438232,
 'end_test_loss': 0.27119144797325134,
 'end_train_accuracy': 0.9714999794960022,
 'end_train_loss': 0.2909761369228363,
 'end_val_accuracy': 0.9251269698143005,
 'end_val_loss': 0.3195829391479492}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 22:58.37 [info     ] Start Predict                  dataset=18606
2022-01-09 22:59.09 [info     ] Starting training              dataset=50000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
50000
Fitting PCA...
0-th component log probs | Train: 2.148434801008753 | Val: 0.7297345410986404
1-th component log probs | Train: 1.928944898901219 | Val: 1.3522018527570743
2-th component log probs | Train: 2.011582060037674 | Val: 1.0731264632996704
3-th component log probs | Train: 2.0789960596557586 | Val: 0.6172973206639927
4-th component log probs | Train: 2.1228630761675604 | Val: 1.0359181569158287
5-th component log probs | Train: 2.14669275396556 | Val: 0.6440823695591849
6-th component log probs | Train: 2.13720222126599 | Val: 0.3907221616336058
7-th component log probs | Train: 2.13631605010868 | Val: 0.69386307412724
8-th component log probs | Train: 2.118226454472363 | Val: -0.07566415437863934
9-th component log probs | Train: 2.154528812873386 | Val: 0.7918016307862689
KEYWORD NR_SAMPLES:50000 DIM:50 AVG_DIFF:2.0603
Fitting PCA...
0-th component log probs | Train: 2.7771018169705255 | Val: 1.0435179147204312
1-th component log probs | Train: 2.530935577153679 | Val: 1.969193895355061
2-th component log probs | Train: 2.644538166735207 | Val: 1.4916609364075522
3-th component log probs | Train: 2.7060347443594437 | Val: 0.9659242724298269
4-th component log probs | Train: 2.7443103337640813 | Val: 1.367644352457243
5-th component log probs | Train: 2.7607116850540945 | Val: 0.9516849506797124
6-th component log probs | Train: 2.7572488574367218 | Val: 0.630077539383222
7-th component log probs | Train: 2.7699165973028705 | Val: 1.2308115321353277
8-th component log probs | Train: 2.7379011205572303 | Val: -0.05995185114928149
9-th component log probs | Train: 2.766178030654528 | Val: 1.0249954248477688
KEYWORD NR_SAMPLES:50000 DIM:100 AVG_DIFF:3.0599
Fitting PCA...
0-th component log probs | Train: 3.0543648005507382 | Val: 1.412646866711955
1-th component log probs | Train: 2.8131430539615367 | Val: 2.308570813381096
2-th component log probs | Train: 2.924411349113669 | Val: 1.840705011688058
3-th component log probs | Train: 2.9883940526779598 | Val: 1.3676017053386222
4-th component log probs | Train: 3.02199026511103 | Val: 1.6673034814256695
5-th component log probs | Train: 3.0377256854166665 | Val: 1.2506461134635367
6-th component log probs | Train: 3.03633769656789 | Val: 1.0676534291472604
7-th component log probs | Train: 3.0508681895799445 | Val: 1.5226117622279607
8-th component log probs | Train: 3.02653426741908 | Val: 0.14861347471462033
9-th component log probs | Train: 3.0500607374455453 | Val: 1.3787237189320487
KEYWORD NR_SAMPLES:50000 DIM:150 AVG_DIFF:2.9067
Fitting PCA...
0-th component log probs | Train: 3.251766560973548 | Val: 1.6646632976891786
1-th component log probs | Train: 3.014130208982302 | Val: 2.5493605347480957
2-th component log probs | Train: 3.122580064165485 | Val: 2.059285998884825
3-th component log probs | Train: 3.190208675508068 | Val: 1.642953996094493
4-th component log probs | Train: 3.221173995625431 | Val: 1.8414619772977898
5-th component log probs | Train: 3.2354433814258723 | Val: 1.480843064146158
6-th component log probs | Train: 3.235832535231204 | Val: 1.3324626559451538
7-th component log probs | Train: 3.2516877007286915 | Val: 1.6774381997273984
8-th component log probs | Train: 3.2299876707446877 | Val: 0.42990203623061585
9-th component log probs | Train: 3.251578066032866 | Val: 1.571977051377862
KEYWORD NR_SAMPLES:50000 DIM:200 AVG_DIFF:2.8004
Fitting PCA...
0-th component log probs | Train: 3.423403318248105 | Val: 1.8162696459132552
1-th component log probs | Train: 3.1857261828122727 | Val: 2.7410787074136227
2-th component log probs | Train: 3.2938472438863102 | Val: 2.254153066079172
3-th component log probs | Train: 3.362637918060205 | Val: 1.8301510733991524
4-th component log probs | Train: 3.395070431649821 | Val: 2.02517933619952
5-th component log probs | Train: 3.404663712054659 | Val: 1.6056845888456603
6-th component log probs | Train: 3.409030408452065 | Val: 1.5225439125844689
7-th component log probs | Train: 3.422377505196631 | Val: 1.8152237668276052
8-th component log probs | Train: 3.4043904242374006 | Val: 0.5367794982682712
9-th component log probs | Train: 3.424493279944554 | Val: 1.697896752135564
KEYWORD NR_SAMPLES:50000 DIM:250 AVG_DIFF:2.8669
Fitting PCA...
0-th component log probs | Train: 3.5717364447858104 | Val: 1.9398734404513798
1-th component log probs | Train: 3.332935067287455 | Val: 2.8959406867485056
2-th component log probs | Train: 3.4424717522114174 | Val: 2.4033543769808077
3-th component log probs | Train: 3.512440489641412 | Val: 1.9676326123095356
4-th component log probs | Train: 3.5467735750294924 | Val: 2.12147723672179
5-th component log probs | Train: 3.5541567051610707 | Val: 1.67223428903269
6-th component log probs | Train: 3.560491287156501 | Val: 1.6750177822365249
7-th component log probs | Train: 3.5706313546557915 | Val: 1.9124162946632235
8-th component log probs | Train: 3.558555749417625 | Val: 0.48596812036172
9-th component log probs | Train: 3.5740562639476265 | Val: 1.797947979576154
KEYWORD NR_SAMPLES:50000 DIM:300 AVG_DIFF:3.0793
Fitting PCA...
0-th component log probs | Train: 3.702051182034481 | Val: 2.048183945911184
1-th component log probs | Train: 3.4628756403295355 | Val: 3.0328936922686194
2-th component log probs | Train: 3.5732188579334214 | Val: 2.5015262582228055
3-th component log probs | Train: 3.644575956945583 | Val: 2.0915240316392527
4-th component log probs | Train: 3.68047507367605 | Val: 2.2145083353187136
5-th component log probs | Train: 3.685766014524808 | Val: 1.762410947583302
6-th component log probs | Train: 3.6953690813567914 | Val: 1.818165143860267
7-th component log probs | Train: 3.7026234833566205 | Val: 1.9962148772051336
8-th component log probs | Train: 3.6941556021612203 | Val: 0.5081528559090255
9-th component log probs | Train: 3.7058303014771563 | Val: 1.8707574111588607
KEYWORD NR_SAMPLES:50000 DIM:350 AVG_DIFF:3.2283
Fitting PCA...
0-th component log probs | Train: 3.8186982053557186 | Val: 2.1392871891399565
1-th component log probs | Train: 3.579027299872973 | Val: 3.1512919551781304
2-th component log probs | Train: 3.6899664999206565 | Val: 2.609136758417445
3-th component log probs | Train: 3.764562639513244 | Val: 2.1765038190511987
4-th component log probs | Train: 3.7995806232539637 | Val: 2.3295759910872613
5-th component log probs | Train: 3.8051198704453126 | Val: 1.8257571591176105
6-th component log probs | Train: 3.816706778287692 | Val: 1.9053169982239664
7-th component log probs | Train: 3.8217217616442367 | Val: 2.0746463980328826
8-th component log probs | Train: 3.8162472061752424 | Val: 0.5901002495589236
9-th component log probs | Train: 3.823460398462643 | Val: 1.9512858118192182
KEYWORD NR_SAMPLES:50000 DIM:400 AVG_DIFF:3.3391
Fitting PCA...
0-th component log probs | Train: 3.92592024614098 | Val: 2.2161352761806574
1-th component log probs | Train: 3.6896996747006083 | Val: 3.27122417425893
2-th component log probs | Train: 3.800580192309976 | Val: 2.7310336607506347
3-th component log probs | Train: 3.878866081716646 | Val: 2.296864129432361
4-th component log probs | Train: 3.910437804317233 | Val: 2.4279269511602335
5-th component log probs | Train: 3.916245226493009 | Val: 1.9553888263899941
6-th component log probs | Train: 3.9314168847422652 | Val: 2.009328453256495
7-th component log probs | Train: 3.932010853692799 | Val: 2.1709446926525646
8-th component log probs | Train: 3.9294497528660615 | Val: 0.7442973784926247
9-th component log probs | Train: 3.931763019336629 | Val: 2.064276325766217
KEYWORD NR_SAMPLES:50000 DIM:450 AVG_DIFF:3.3216
Fitting PCA...
0-th component log probs | Train: 4.043552445954377 | Val: 2.4253668907026835
1-th component log probs | Train: 3.8153700148650658 | Val: 3.4207261052317173
2-th component log probs | Train: 3.922238869155425 | Val: 2.9140096236943767
3-th component log probs | Train: 3.998386321751667 | Val: 2.526434206926264
4-th component log probs | Train: 4.025942621086951 | Val: 2.6346012410579482
5-th component log probs | Train: 4.033689951623066 | Val: 2.192149490971707
6-th component log probs | Train: 4.049349418705729 | Val: 2.2462517842751084
7-th component log probs | Train: 4.046857160346553 | Val: 2.4033913880795263
8-th component log probs | Train: 4.046202973704807 | Val: 1.07111401397656
9-th component log probs | Train: 4.05140695272743 | Val: 2.2947266853245814
KEYWORD NR_SAMPLES:50000 DIM:500 AVG_DIFF:2.9174
0-th component log probs | Train: 4.082870612924946 | Val: 2.4992339460931916
1-th component log probs | Train: 3.8581440745819138 | Val: 3.4715963872099347
2-th component log probs | Train: 3.9633487638702722 | Val: 2.9767958901196927
3-th component log probs | Train: 4.038271967035282 | Val: 2.598330909918608
4-th component log probs | Train: 4.064474173685522 | Val: 2.7030825150659985
5-th component log probs | Train: 4.072982809974476 | Val: 2.271669449969826
6-th component log probs | Train: 4.0884885389643095 | Val: 2.324079001150683
7-th component log probs | Train: 4.085630670170888 | Val: 2.4778700167906957
8-th component log probs | Train: 4.084958256899908 | Val: 1.174975829753294
9-th component log probs | Train: 4.090738857855371 | Val: 2.3711625912236673
KEYWORD NR_SAMPLES:50000 DIM:512 AVG_DIFF:2.7925
best average differences at 50 dimensions: 2.060293686719164
2022-01-10 00:07.02 [info     ] Training complete              train_loss=0.17865696549415588
2022-01-10 00:07.03 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:07.06 [info     ] Testing complete               test_loss=0.2869532108306885
{'dataset_size': 50000,
 'end_test_accuracy': 0.9203009605407715,
 'end_test_loss': 0.2869532108306885,
 'end_train_accuracy': 0.9963635206222534,
 'end_train_loss': 0.17865696549415588,
 'end_val_accuracy': 0.9342873096466064,
 'end_val_loss': 0.32212895154953003}
2022-01-10 00:07.06 [info     ] Start Predict                  dataset=8606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

wandb: Waiting for W&B process to finish, PID 21194... (success).
wandb: - 0.61MB of 0.61MB uploaded (0.00MB deduped)wandb: \ 0.61MB of 0.61MB uploaded (0.00MB deduped)wandb: | 0.61MB of 0.61MB uploaded (0.00MB deduped)wandb: / 0.61MB of 1.01MB uploaded (0.00MB deduped)wandb: - 0.61MB of 1.01MB uploaded (0.00MB deduped)wandb: \ 0.87MB of 1.01MB uploaded (0.00MB deduped)wandb: | 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: / 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: - 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: \ 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: | 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: / 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb: - 1.01MB of 1.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:           accuracy_0 ▁▁▃▄▄▅▆▆▆▇▇▇██▇████▇█
wandb:           accuracy_1 ▁▁▂▃▂▃▃▄▃▄▅▅▅▆▆▆▆▆▇▆█
wandb:          accuracy_10 ▁▃▄▅▅▆▆▆▇▇▇▇▇▇▇█████████████
wandb:          accuracy_11 ▁▄▅▆▆▆▇▇▇▇▇▇▇████████████████
wandb:          accuracy_12 ▁▅▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇████████████
wandb:          accuracy_13 ▁▅▅▆▆▆▇▇▇▇▇▇▇▇████████████████
wandb:          accuracy_14 ▁▄▅▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇████
wandb:           accuracy_2 ▁▂▃▃▅▅▅▆▆▇▇▇▇▇▇▇▇████████
wandb:           accuracy_3 ▁▂▃▄▅▆▆▇▇▇▇▇▇▇███████████████
wandb:           accuracy_4 ▁▂▂▃▄▆▆▇▇▇▇▇▇▇▇█████████████████████████
wandb:           accuracy_5 ▁▂▃▅▆▇▇▇▇███████████████████████████████
wandb:           accuracy_6 ▁▁▂▂▃▄▅▅▆▆▆▇▇▇▇▇▇▇███▇▇███████████
wandb:           accuracy_7 ▁▁▂▄▄▅▆▆▆▇▇▇▇▇▇▇▇███████████████
wandb:           accuracy_8 ▁▂▃▄▄▅▅▆▆▆▇▇▇▇▇▇▇▇▇▇█████████████
wandb:           accuracy_9 ▁▃▄▅▅▆▆▆▆▇▇▇▇▇▇▇██████████████
wandb:              class_0 █▇▁▄▃▅▆▆▆▆▅█▆▅▃
wandb:              class_1 ▁▃▅▇▄▄▅▄▆▅▄▆▅▅█
wandb:              class_2 ▂▁▅▂▂▂▂▂▃▃▂▃▇█▇
wandb:              class_3 ▁▄█▅▅▅▃▅▄▅▆▄▂▄▃
wandb:              class_4 ▆▅▆▇▅▃▆█▇▇▆▅▃▂▁
wandb:              class_5 ▄█▅▄▅▅▃▃▃▂▃▁▄▃▂
wandb:              class_6 █▁▄▆▇▇▅▃▂▁▁▃█▅▅
wandb:              class_7 █▁▄▄▂▄▂▂▁▆▆▄▆▄▅
wandb:              class_8 ▇█▄▂▇▇▅▅▄▃▃▅▂▁▃
wandb:              class_9 █▇▁▂▇▇██▆▅▆▄▂▅▃
wandb:         dataset_size ▁▁▁▁▁▁▁▂▂▂▂▄▅▇█
wandb:    end_test_accuracy ▁▁▂▄▅▆▆▇▇▇█████
wandb:        end_test_loss ▇██▆▅▄▃▂▂▂▂▁▁▁▁
wandb:   end_train_accuracy ▇▁▆▇█████▇▇▇█▇█
wandb:       end_train_loss ▃█▄▄▂▂▂▂▁▂▂▂▁▂▁
wandb:     end_val_accuracy ▁▁▃▅▅▆▇▇▇▇█████
wandb:         end_val_loss █▅▄▄▃▃▂▂▁▂▁▁▁▁▁
wandb:                epoch ▁▂▂▃▂▃▂▃▂▃▄▅▂▃▄▆▇█▂▃▁▃▄▂▃▁▃▄▂▃▂▃▁▃▄▂▃▁▃▄
wandb:               loss_0 █▆▅▅▄▃▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb:               loss_1 █▆▆▅▆▅▄▃▄▃▃▃▂▂▂▂▂▂▁▂▁
wandb:              loss_10 █▇▅▅▄▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              loss_11 █▅▄▄▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              loss_12 █▅▄▄▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:              loss_13 █▅▄▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              loss_14 █▅▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁
wandb:               loss_2 █▇▆▅▄▄▃▃▃▂▂▂▂▂▁▂▂▁▁▁▁▁▁▁▁
wandb:               loss_3 █▆▅▅▄▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_4 █▇▆▅▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_5 █▇▅▄▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_6 █▇▇▆▆▅▄▄▃▃▃▃▂▂▂▂▂▂▂▂▁▂▂▁▂▁▁▁▁▁▁▁▁▁
wandb:               loss_7 █▇▆▅▅▄▄▃▃▃▂▂▂▂▂▂▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁
wandb:               loss_8 █▇▆▅▅▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▁▂▁▁▁▁▁▁▁▁▁▁
wandb:               loss_9 █▆▅▄▄▄▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_0 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_1 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                lr_10 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                lr_11 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                lr_12 █████████████████████████████▁▁
wandb:                lr_13 █████████████████████████████▁
wandb:                lr_14 █████████████████████████████▁▁▁▁▁
wandb:                 lr_2 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_3 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_4 █████████████████████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_5 ████████████████▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb:                 lr_6 █████████████████████████████▁▁▁▁▁
wandb:                 lr_7 █████████████████████████████▁▁▁
wandb:                 lr_8 █████████████████████████████▁▁▁▁
wandb:                 lr_9 █████████████████████████████▁
wandb:       val_accuracy_0 ▁▅▁▁▁▃▃▄▆▆▆▆▆▅▆▆▆▇▆▇█
wandb:       val_accuracy_1 ▄▃▂▁▂▂▂▄▆▇▆▅▅▅▄▅▇▇▆██
wandb:      val_accuracy_10 ▁▅▆▇▇███████████████████████
wandb:      val_accuracy_11 ▁▅▆▇▇▇▇██████████████████████
wandb:      val_accuracy_12 ▁▄▅▆▆▆▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇█▇▇▇▇▇▇█
wandb:      val_accuracy_13 ▁▄▅▆▆▇▇▇▇█▇▇▇█▇████▇▇▇████████
wandb:      val_accuracy_14 ▁▃▄▅▅▅▆▇▆▆▇▆▇▇▇▆▇▇▇▆▆▇▇▇▇▇▇▇▇▇████
wandb:       val_accuracy_2 ▁▂▁▂▃▃▂▄▅▆▆▆▇▇▇▇▇▆▇▇▇▇███
wandb:       val_accuracy_3 ▂▁▃▄▄▅▅▆▆▆▆▇▇▇▆▇▇▇▇▇▇▇▇▇▇████
wandb:       val_accuracy_4 ▁▂▂▃▄▅▆▇▆▆▇▇▇█▇▇▇▇▇▇▇▇██████████████████
wandb:       val_accuracy_5 ▁▂▄▆▇▆▇▇▇█▇█████████████████████████████
wandb:       val_accuracy_6 ▁▁▂▃▅▅▆▇▇▇▇▇▇████▇████▇███████████
wandb:       val_accuracy_7 ▁▂▅▆▇▇▇▇▇█▇████▇██▇█████████████
wandb:       val_accuracy_8 ▁▃▄▆▆▇▇▇█▇███████████████████████
wandb:       val_accuracy_9 ▁▅▆▇▇█▇▇██▇███████████████████
wandb:           val_loss_0 ▁▁▁▁▂▂▂▂▂▂▂▃▃▄▅▆▇▇▇██
wandb:           val_loss_1 ▁▃█▇▄▅▃▃▂▁▂▂▃▃▄▃▃▄▄▃▃
wandb:          val_loss_10 █▄▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▁
wandb:          val_loss_11 █▄▃▂▂▁▁▁▁▁▁▁▁▁▁▂▁▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_loss_12 █▅▄▃▃▂▂▂▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▃▃▂▂▂▃▂
wandb:          val_loss_13 █▅▄▃▃▂▁▂▂▁▂▂▂▁▂▂▂▂▂▂▃▃▂▂▂▂▃▃▃▂
wandb:          val_loss_14 █▅▄▃▃▃▂▁▁▂▁▂▁▁▂▂▂▂▂▂▃▂▂▂▃▃▃▂▂▂▁▂▂▃
wandb:           val_loss_2 ▂█▅▂▁▂▆▃▁▁▂▂▁▂▂▂▂▃▁▁▂▃▂▂▁
wandb:           val_loss_3 ▄█▄▃▃▁▃▁▁▆▅▁▁▂▃▂▂▂▁▃▃▂▂▃▃▂▃▃▂
wandb:           val_loss_4 ██▅▃▃▂▂▂▂▃▂▃▄▁▂▂▃▂▂▂▃▂▂▁▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_loss_5 █▆▄▂▁▂▂▁▂▁▂▁▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_loss_6 █▅▄▄▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▁▁▁▁
wandb:           val_loss_7 █▇▄▃▂▂▁▂▁▁▂▁▁▁▂▂▁▂▂▂▁▂▂▁▂▂▂▂▂▂▁▁
wandb:           val_loss_8 █▆▅▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▂▁▁▁▁▁
wandb:           val_loss_9 █▄▃▂▁▁▂▁▁▁▂▁▁▁▁▁▁▁▁▂▂▂▂▂▂▁▁▂▂▂
wandb: 
wandb: Run summary:
wandb:           accuracy_0 0.97222
wandb:           accuracy_1 0.79297
wandb:          accuracy_10 0.9582
wandb:          accuracy_11 0.96196
wandb:          accuracy_12 0.98715
wandb:          accuracy_13 0.9715
wandb:          accuracy_14 0.99636
wandb:           accuracy_2 0.9308
wandb:           accuracy_3 0.97396
wandb:           accuracy_4 1.0
wandb:           accuracy_5 0.99844
wandb:           accuracy_6 0.99854
wandb:           accuracy_7 0.9938
wandb:           accuracy_8 0.99717
wandb:           accuracy_9 0.96763
wandb:              class_0 0.0689
wandb:              class_1 0.1938
wandb:              class_2 0.15182
wandb:              class_3 0.11796
wandb:              class_4 0.07028
wandb:              class_5 0.0817
wandb:              class_6 0.08504
wandb:              class_7 0.0829
wandb:              class_8 0.07774
wandb:              class_9 0.06986
wandb:         dataset_size 50000
wandb:    end_test_accuracy 0.9203
wandb:        end_test_loss 0.28695
wandb:   end_train_accuracy 0.99636
wandb:       end_train_loss 0.17866
wandb:     end_val_accuracy 0.93429
wandb:         end_val_loss 0.32213
wandb:                epoch 34
wandb:               loss_0 0.50168
wandb:               loss_1 1.39649
wandb:              loss_10 0.39324
wandb:              loss_11 0.34723
wandb:              loss_12 0.23862
wandb:              loss_13 0.29098
wandb:              loss_14 0.17866
wandb:               loss_2 0.63044
wandb:               loss_3 0.66727
wandb:               loss_4 0.33914
wandb:               loss_5 0.28885
wandb:               loss_6 0.31218
wandb:               loss_7 0.27256
wandb:               loss_8 0.25705
wandb:               loss_9 0.35618
wandb:                 lr_0 0.001
wandb:                 lr_1 0.001
wandb:                lr_10 0.001
wandb:                lr_11 0.001
wandb:                lr_12 0.0001
wandb:                lr_13 0.0001
wandb:                lr_14 0.0001
wandb:                 lr_2 0.001
wandb:                 lr_3 0.001
wandb:                 lr_4 0.0001
wandb:                 lr_5 1e-05
wandb:                 lr_6 0.0001
wandb:                 lr_7 0.0001
wandb:                 lr_8 0.0001
wandb:                 lr_9 0.0001
wandb:       val_accuracy_0 0.18331
wandb:       val_accuracy_1 0.19687
wandb:      val_accuracy_10 0.89111
wandb:      val_accuracy_11 0.91324
wandb:      val_accuracy_12 0.92833
wandb:      val_accuracy_13 0.92513
wandb:      val_accuracy_14 0.93429
wandb:       val_accuracy_2 0.43917
wandb:       val_accuracy_3 0.5826
wandb:       val_accuracy_4 0.63271
wandb:       val_accuracy_5 0.69409
wandb:       val_accuracy_6 0.79512
wandb:       val_accuracy_7 0.85395
wandb:       val_accuracy_8 0.87557
wandb:       val_accuracy_9 0.86459
wandb:           val_loss_0 4.76406
wandb:           val_loss_1 3.10813
wandb:          val_loss_10 0.48946
wandb:          val_loss_11 0.3916
wandb:          val_loss_12 0.31129
wandb:          val_loss_13 0.31958
wandb:          val_loss_14 0.32213
wandb:           val_loss_2 2.47444
wandb:           val_loss_3 1.98495
wandb:           val_loss_4 1.6548
wandb:           val_loss_5 1.39079
wandb:           val_loss_6 0.89727
wandb:           val_loss_7 0.68652
wandb:           val_loss_8 0.55664
wandb:           val_loss_9 0.6419
wandb: 
wandb: Synced 6 W&B file(s), 30 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced svhn_hu_greedy_l2_run1: https://wandb.ai/fanconic/hidden_uncertainty/runs/kkeg4h1g
wandb: Find logs at: ./wandb/run-20220109_200018-kkeg4h1g/logs/debug.log
wandb: 
wandb: Tracking run with wandb version 0.12.7
wandb: Syncing run svhn_hu_greedy_l2_run2
wandb:  View project at https://wandb.ai/fanconic/hidden_uncertainty
wandb:  View run at https://wandb.ai/fanconic/hidden_uncertainty/runs/3se444sd
wandb: Run data is saved locally in /scratch_net/airfox/fanconic/semproj2/hidden_uncertainty_active_learning/wandb/run-20220110_000710-3se444sd
wandb: Run `wandb offline` to turn off syncing.

Cuda is available:  True
Using downloaded and verified file: /tmp/train_32x32.mat
Using downloaded and verified file: /tmp/test_32x32.mat
2022-01-10 00:07.40 [info     ] Starting training              dataset=100 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
100
Fitting PCA...
0-th component log probs | Train: 5.080399159919873 | Val: -5437.378764075531
1-th component log probs | Train: 5.0850210299420615 | Val: -4626.261181142428
2-th component log probs | Train: 5.0515809310314115 | Val: -5736.852327275766
3-th component log probs | Train: 5.067805479091813 | Val: -4749.61394799121
4-th component log probs | Train: 5.058860991082279 | Val: -4047.8918666964587
5-th component log probs | Train: 5.036270430898222 | Val: -4920.840659205361
6-th component log probs | Train: 5.042762623418194 | Val: -4489.082035584274
7-th component log probs | Train: 5.016632457198831 | Val: -4547.932351886217
8-th component log probs | Train: 5.021937038115515 | Val: -5163.571412238778
9-th component log probs | Train: 5.106999726935729 | Val: -5587.607912063966
KEYWORD NR_SAMPLES:100 DIM:50 AVG_DIFF:24625618.1033
0-th component log probs | Train: 30.18774505326521 | Val: -3465.662883433207
1-th component log probs | Train: 30.19128057529278 | Val: -2990.292615370215
2-th component log probs | Train: 30.17795969595291 | Val: -3570.0557980648546
3-th component log probs | Train: 30.180434680618692 | Val: -3195.1497223510582
4-th component log probs | Train: 30.180580865549036 | Val: -2789.1561374467824
5-th component log probs | Train: 30.172398530150854 | Val: -3211.8343604018587
6-th component log probs | Train: 30.174497246330883 | Val: -2930.465832468593
7-th component log probs | Train: 30.165455474014816 | Val: -2914.0633489203265
8-th component log probs | Train: 30.167308467412465 | Val: -3201.731657239549
9-th component log probs | Train: 30.194212235793117 | Val: -3664.9690707271975
KEYWORD NR_SAMPLES:100 DIM:100 AVG_DIFF:10470127.6698
best average differences at 100 dimensions: 10470127.669777427
2022-01-10 00:08.49 [info     ] Training complete              train_loss=0.6536874175071716
2022-01-10 00:08.49 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:08.53 [info     ] Testing complete               test_loss=2.405123472213745
{'dataset_size': 100,
 'end_test_accuracy': 0.08314137160778046,
 'end_test_loss': 2.405123472213745,
 'end_train_accuracy': 0.9505208730697632,
 'end_train_loss': 0.6536874175071716,
 'end_val_accuracy': 0.16860105097293854,
 'end_val_loss': 4.849072456359863}
2022-01-10 00:08.53 [info     ] Start Predict                  dataset=58506
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:09.27 [info     ] Starting training              dataset=200 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
200
Fitting PCA...
0-th component log probs | Train: 4.151276141113725 | Val: -1482.9903626062408
1-th component log probs | Train: 3.5750004861227844 | Val: -735.5811223983138
2-th component log probs | Train: 3.6451288708624716 | Val: -1065.5818596231322
3-th component log probs | Train: 4.46852221672242 | Val: -1944.272483962307
4-th component log probs | Train: 4.329124792869572 | Val: -2161.6173249705084
5-th component log probs | Train: 4.0631090148548505 | Val: -1347.7564946651855
6-th component log probs | Train: 4.359868344802527 | Val: -2147.602408926197
7-th component log probs | Train: 4.476449259681583 | Val: -1822.1392270663016
8-th component log probs | Train: 4.348335775806669 | Val: -1606.88724848822
9-th component log probs | Train: 4.681758517752426 | Val: -3069.2223482171976
KEYWORD NR_SAMPLES:200 DIM:50 AVG_DIFF:3422995.3191
Fitting PCA...
0-th component log probs | Train: 5.0248214474486685 | Val: -1048.3175153267507
1-th component log probs | Train: 4.722286970300007 | Val: -593.576503136286
2-th component log probs | Train: 4.749237798366137 | Val: -939.8660425931351
3-th component log probs | Train: 5.208154369963382 | Val: -1221.4099751760184
4-th component log probs | Train: 5.130812913676733 | Val: -1410.87854438768
5-th component log probs | Train: 4.9957025757643985 | Val: -923.6245581039208
6-th component log probs | Train: 5.1396536751868735 | Val: -1423.956204940587
7-th component log probs | Train: 5.2108209863159995 | Val: -1220.878094077207
8-th component log probs | Train: 5.149570929437673 | Val: -1023.0588722135736
9-th component log probs | Train: 5.3143779433630325 | Val: -1917.3255868111598
KEYWORD NR_SAMPLES:200 DIM:100 AVG_DIFF:1503116.5710
Fitting PCA...
0-th component log probs | Train: 5.334875863908582 | Val: -792.7763561469959
1-th component log probs | Train: 5.130130597880675 | Val: -457.44376703143695
2-th component log probs | Train: 5.145423899512878 | Val: -706.4153319842732
3-th component log probs | Train: 5.461428359318391 | Val: -888.8830878839775
4-th component log probs | Train: 5.410754304341042 | Val: -1019.7057914975666
5-th component log probs | Train: 5.318739426026497 | Val: -689.5024028369413
6-th component log probs | Train: 5.411938172685185 | Val: -1070.1534301319052
7-th component log probs | Train: 5.46538247468799 | Val: -883.2055904618584
8-th component log probs | Train: 5.425840320591549 | Val: -741.7508080891699
9-th component log probs | Train: 5.530409667749106 | Val: -1409.3201293502732
KEYWORD NR_SAMPLES:200 DIM:150 AVG_DIFF:819741.9276
0-th component log probs | Train: 14.83864282117766 | Val: -699.5475123068575
1-th component log probs | Train: 14.682181836413497 | Val: -447.2441759645692
2-th component log probs | Train: 14.692712250642208 | Val: -639.034877757161
3-th component log probs | Train: 14.931766738284338 | Val: -776.2910589139815
4-th component log probs | Train: 14.896485386068312 | Val: -873.5281849721428
5-th component log probs | Train: 14.826696366643196 | Val: -619.1623330667958
6-th component log probs | Train: 14.893639573463544 | Val: -931.0528340711385
7-th component log probs | Train: 14.937573183143215 | Val: -770.6467258301233
8-th component log probs | Train: 14.908193797903621 | Val: -656.7497281005691
9-th component log probs | Train: 14.984203003219585 | Val: -1182.6435325017026
KEYWORD NR_SAMPLES:200 DIM:200 AVG_DIFF:636575.1324
best average differences at 200 dimensions: 636575.1323539959
2022-01-10 00:10.40 [info     ] Training complete              train_loss=1.363572359085083
2022-01-10 00:10.40 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:10.44 [info     ] Testing complete               test_loss=2.4030816555023193
{'dataset_size': 200,
 'end_test_accuracy': 0.12457770109176636,
 'end_test_loss': 2.4030816555023193,
 'end_train_accuracy': 0.67578125,
 'end_train_loss': 1.363572359085083,
 'end_val_accuracy': 0.2060878723859787,
 'end_val_loss': 3.506157875061035}
2022-01-10 00:10.44 [info     ] Start Predict                  dataset=58406
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:11.20 [info     ] Starting training              dataset=400 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
400
Fitting PCA...
0-th component log probs | Train: 3.237451272710879 | Val: -460.8158113775743
1-th component log probs | Train: 2.512360579294803 | Val: -31.94156697332578
2-th component log probs | Train: 2.926233613322121 | Val: -209.82157662212978
3-th component log probs | Train: 3.5603669313832644 | Val: -827.5796334087717
4-th component log probs | Train: 3.3373079724698305 | Val: -632.1055365382913
5-th component log probs | Train: 3.1197504806744965 | Val: -438.1533182909982
6-th component log probs | Train: 2.7985042257727475 | Val: -222.01874621569692
7-th component log probs | Train: 3.875933060004186 | Val: -735.7741459850204
8-th component log probs | Train: 3.4168389246954396 | Val: -926.3412995582166
9-th component log probs | Train: 3.2465127347616614 | Val: -782.5977862642965
KEYWORD NR_SAMPLES:400 DIM:50 AVG_DIFF:363072.3858
Fitting PCA...
0-th component log probs | Train: 4.476641204429497 | Val: -666.020571405611
1-th component log probs | Train: 3.8176911457296296 | Val: -273.14411500184644
2-th component log probs | Train: 4.195250892782997 | Val: -480.21989762678925
3-th component log probs | Train: 4.708180996633262 | Val: -763.348955722612
4-th component log probs | Train: 4.541855725354032 | Val: -699.2305320105827
5-th component log probs | Train: 4.418848818593324 | Val: -594.3633210948598
6-th component log probs | Train: 4.1731261263179755 | Val: -573.6575416364537
7-th component log probs | Train: 4.858856734412229 | Val: -681.895771812565
8-th component log probs | Train: 4.627143172507154 | Val: -824.7996080724537
9-th component log probs | Train: 4.497814600568858 | Val: -880.161411049718
KEYWORD NR_SAMPLES:400 DIM:100 AVG_DIFF:448077.0698
Fitting PCA...
0-th component log probs | Train: 4.9442200202887125 | Val: -558.0531823470274
1-th component log probs | Train: 4.465174357074602 | Val: -282.8637271338537
2-th component log probs | Train: 4.736471274159779 | Val: -419.205630113363
3-th component log probs | Train: 5.11469375532202 | Val: -634.9858228188775
4-th component log probs | Train: 4.991558799978708 | Val: -571.4613486229238
5-th component log probs | Train: 4.907982695636514 | Val: -506.88253253924813
6-th component log probs | Train: 4.728200962663604 | Val: -514.068363782079
7-th component log probs | Train: 5.213471854625859 | Val: -543.7691629746143
8-th component log probs | Train: 5.0621560048143905 | Val: -642.7688809582406
9-th component log probs | Train: 4.963183520661275 | Val: -737.6191171563974
KEYWORD NR_SAMPLES:400 DIM:150 AVG_DIFF:312485.2370
Fitting PCA...
0-th component log probs | Train: 5.189479342254674 | Val: -467.8462922101681
1-th component log probs | Train: 4.814869077651901 | Val: -260.71041249839857
2-th component log probs | Train: 5.025393957419292 | Val: -360.6452254863047
3-th component log probs | Train: 5.325168918036853 | Val: -528.5952395241205
4-th component log probs | Train: 5.228401916682881 | Val: -474.18617850496975
5-th component log probs | Train: 5.162681710343363 | Val: -428.0738800464695
6-th component log probs | Train: 5.022927723846564 | Val: -442.3579853319407
7-th component log probs | Train: 5.397905129332168 | Val: -453.04237508615364
8-th component log probs | Train: 5.285309145363388 | Val: -525.2219153971104
9-th component log probs | Train: 5.207810158313721 | Val: -602.6890911774988
KEYWORD NR_SAMPLES:400 DIM:200 AVG_DIFF:219187.8509
Fitting PCA...
0-th component log probs | Train: 5.341447161046589 | Val: -401.0440993060627
1-th component log probs | Train: 5.035103257086612 | Val: -232.3384005034329
2-th component log probs | Train: 5.206396719524184 | Val: -312.37201745209705
3-th component log probs | Train: 5.453503291361545 | Val: -455.35689653690775
4-th component log probs | Train: 5.3738921000915605 | Val: -402.5150381774769
5-th component log probs | Train: 5.3215320566416064 | Val: -363.61005773976245
6-th component log probs | Train: 5.206369031514501 | Val: -380.74093515532377
7-th component log probs | Train: 5.51137694044076 | Val: -384.11171736527666
8-th component log probs | Train: 5.422116403882721 | Val: -442.8955795501529
9-th component log probs | Train: 5.35925654260502 | Val: -511.22874196370157
KEYWORD NR_SAMPLES:400 DIM:250 AVG_DIFF:160579.4958
Fitting PCA...
0-th component log probs | Train: 5.445993560031535 | Val: -348.03830945724667
1-th component log probs | Train: 5.186971321465802 | Val: -208.7875471804837
2-th component log probs | Train: 5.331053351974876 | Val: -273.06274575600304
3-th component log probs | Train: 5.540297061525153 | Val: -398.3387343375612
4-th component log probs | Train: 5.473460547994589 | Val: -348.36583911237113
5-th component log probs | Train: 5.429974028118375 | Val: -316.1032519732598
6-th component log probs | Train: 5.331930109789534 | Val: -331.79384201775656
7-th component log probs | Train: 5.588623614279081 | Val: -334.17776978870245
8-th component log probs | Train: 5.5144507785002945 | Val: -383.4617126047506
9-th component log probs | Train: 5.461939398016887 | Val: -442.67964492041904
KEYWORD NR_SAMPLES:400 DIM:300 AVG_DIFF:122117.1815
Fitting PCA...
0-th component log probs | Train: 5.521832943495779 | Val: -306.524952727818
1-th component log probs | Train: 5.298138198199131 | Val: -188.30695978663704
2-th component log probs | Train: 5.421918697272833 | Val: -242.39408654660468
3-th component log probs | Train: 5.60320152881184 | Val: -352.0567588435619
4-th component log probs | Train: 5.545963168407659 | Val: -306.54376110158853
5-th component log probs | Train: 5.508897644865171 | Val: -278.54870176240036
6-th component log probs | Train: 5.423458896078187 | Val: -293.34850505297254
7-th component log probs | Train: 5.644803801353246 | Val: -294.05573407917797
8-th component log probs | Train: 5.581479182913826 | Val: -337.06037247119934
9-th component log probs | Train: 5.5365150565333145 | Val: -388.2146552062075
KEYWORD NR_SAMPLES:400 DIM:350 AVG_DIFF:95380.6787
0-th component log probs | Train: 7.2566387188481345 | Val: -284.8961749306667
1-th component log probs | Train: 7.060315287419365 | Val: -181.61946755351613
2-th component log probs | Train: 7.168812512737446 | Val: -226.20542663338549
3-th component log probs | Train: 7.327902400019979 | Val: -324.63362384089476
4-th component log probs | Train: 7.277812531365888 | Val: -284.91132812934177
5-th component log probs | Train: 7.245543204401942 | Val: -259.342538583641
6-th component log probs | Train: 7.170264536152389 | Val: -273.8110819959197
7-th component log probs | Train: 7.364378525502952 | Val: -271.49737581991354
8-th component log probs | Train: 7.308937598462295 | Val: -311.9016231228642
9-th component log probs | Train: 7.269779385539437 | Val: -356.71531321254315
KEYWORD NR_SAMPLES:400 DIM:400 AVG_DIFF:83315.3941
best average differences at 400 dimensions: 83315.39414941691
2022-01-10 00:12.45 [info     ] Training complete              train_loss=0.7601667046546936
2022-01-10 00:12.45 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:12.49 [info     ] Testing complete               test_loss=2.3953487873077393
{'dataset_size': 400,
 'end_test_accuracy': 0.11503122746944427,
 'end_test_loss': 2.3953487873077393,
 'end_train_accuracy': 0.9151785969734192,
 'end_train_loss': 0.7601667046546936,
 'end_val_accuracy': 0.40249961614608765,
 'end_val_loss': 2.730506181716919}
2022-01-10 00:12.49 [info     ] Start Predict                  dataset=58206
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:13.22 [info     ] Starting training              dataset=600 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
600
Fitting PCA...
0-th component log probs | Train: 3.0752715513356623 | Val: -124.34476675280645
1-th component log probs | Train: 2.369593805274623 | Val: -8.673852243201937
2-th component log probs | Train: 2.5882712517987643 | Val: -30.440635827968272
3-th component log probs | Train: 2.7802139436462467 | Val: -104.65470495846128
4-th component log probs | Train: 2.7745865120041824 | Val: -42.78311462817489
5-th component log probs | Train: 2.714267007215396 | Val: -45.02771745996583
6-th component log probs | Train: 2.99367329657465 | Val: -158.21715316114492
7-th component log probs | Train: 3.501197672598956 | Val: -413.84410473284197
8-th component log probs | Train: 2.6965777158338766 | Val: -60.72551806108732
9-th component log probs | Train: 3.0179064367533663 | Val: -267.7637193428555
KEYWORD NR_SAMPLES:600 DIM:50 AVG_DIFF:31085.6879
Fitting PCA...
0-th component log probs | Train: 4.261213511356959 | Val: -443.0938417845329
1-th component log probs | Train: 3.1083352847640326 | Val: -34.175900523308904
2-th component log probs | Train: 3.722986981321183 | Val: -295.4163989038918
3-th component log probs | Train: 4.104178694897564 | Val: -654.690804424159
4-th component log probs | Train: 3.922094210000866 | Val: -285.0463473576071
5-th component log probs | Train: 3.9461962762958587 | Val: -272.6328146828607
6-th component log probs | Train: 4.207513589097423 | Val: -550.9394640760387
7-th component log probs | Train: 4.6205365982235405 | Val: -541.8552385117459
8-th component log probs | Train: 4.047986425445592 | Val: -440.0234335064167
9-th component log probs | Train: 4.320681193231342 | Val: -689.0988972617444
KEYWORD NR_SAMPLES:600 DIM:100 AVG_DIFF:216986.4649
Fitting PCA...
0-th component log probs | Train: 4.777437044436601 | Val: -421.1467294848817
1-th component log probs | Train: 3.7614514648047424 | Val: -100.65871305529758
2-th component log probs | Train: 4.378517164013168 | Val: -324.8968801208958
3-th component log probs | Train: 4.669224657139521 | Val: -577.2971931292005
4-th component log probs | Train: 4.528309780884336 | Val: -294.8593517857857
5-th component log probs | Train: 4.554596835579135 | Val: -276.9648967178448
6-th component log probs | Train: 4.737093450476719 | Val: -507.9504018039748
7-th component log probs | Train: 5.040991390540879 | Val: -479.7475355332061
8-th component log probs | Train: 4.635457662475219 | Val: -418.2986399477591
9-th component log probs | Train: 4.8301213660723015 | Val: -614.1267102614496
KEYWORD NR_SAMPLES:600 DIM:150 AVG_DIFF:186815.7556
Fitting PCA...
0-th component log probs | Train: 5.053097321794798 | Val: -375.32224970840304
1-th component log probs | Train: 4.2141173863618775 | Val: -121.33066919173794
2-th component log probs | Train: 4.741756203714561 | Val: -284.0312842827919
3-th component log probs | Train: 4.975060754095435 | Val: -494.0932845204034
4-th component log probs | Train: 4.858946643535763 | Val: -271.34921290866595
5-th component log probs | Train: 4.8825592553785615 | Val: -248.73189980021817
6-th component log probs | Train: 5.021842491865653 | Val: -444.41377621034053
7-th component log probs | Train: 5.261386384855 | Val: -407.89105353714274
8-th component log probs | Train: 4.950532039846102 | Val: -363.6036903363539
9-th component log probs | Train: 5.100839424973387 | Val: -526.0854996975419
KEYWORD NR_SAMPLES:600 DIM:200 AVG_DIFF:142419.5677
Fitting PCA...
0-th component log probs | Train: 5.227329675072252 | Val: -331.45887445254994
1-th component log probs | Train: 4.525314196048909 | Val: -119.18689024981322
2-th component log probs | Train: 4.971102962075468 | Val: -253.76136533347616
3-th component log probs | Train: 5.165451210520381 | Val: -429.6052932121628
4-th component log probs | Train: 5.066330536943823 | Val: -245.39533261041342
5-th component log probs | Train: 5.088103602286075 | Val: -219.57156329972756
6-th component log probs | Train: 5.2014202237287765 | Val: -387.83863045602897
7-th component log probs | Train: 5.398484043487719 | Val: -351.52108659427864
8-th component log probs | Train: 5.14574306497911 | Val: -318.4785310611011
9-th component log probs | Train: 5.268956855265535 | Val: -454.79209818223967
KEYWORD NR_SAMPLES:600 DIM:250 AVG_DIFF:109609.4317
Fitting PCA...
0-th component log probs | Train: 5.3467711585152005 | Val: -290.9146635801776
1-th component log probs | Train: 4.744954659936487 | Val: -112.11066187889459
2-th component log probs | Train: 5.129921159934263 | Val: -225.90295974362581
3-th component log probs | Train: 5.297082799988813 | Val: -374.54565066847476
4-th component log probs | Train: 5.209662043864278 | Val: -219.50963512931173
5-th component log probs | Train: 5.2296761139344 | Val: -195.25140545977285
6-th component log probs | Train: 5.3242218346578 | Val: -340.950399176041
7-th component log probs | Train: 5.491937394005195 | Val: -308.1556239427636
8-th component log probs | Train: 5.2798436810645795 | Val: -281.6339086775135
9-th component log probs | Train: 5.383998774955459 | Val: -396.995125250662
KEYWORD NR_SAMPLES:600 DIM:300 AVG_DIFF:85228.3560
Fitting PCA...
0-th component log probs | Train: 5.43440067242873 | Val: -259.2091707479537
1-th component log probs | Train: 4.909142229992613 | Val: -104.09022943351493
2-th component log probs | Train: 5.2463979991330225 | Val: -202.42320041138132
3-th component log probs | Train: 5.3924229262062955 | Val: -331.63374013958554
4-th component log probs | Train: 5.315178261438466 | Val: -197.66638769493156
5-th component log probs | Train: 5.333601014835809 | Val: -175.32662081071808
6-th component log probs | Train: 5.414559959348802 | Val: -302.5171940235036
7-th component log probs | Train: 5.560253305230188 | Val: -274.8836264893753
8-th component log probs | Train: 5.377737418846049 | Val: -252.03526226342842
9-th component log probs | Train: 5.46802984298473 | Val: -352.16905640868015
KEYWORD NR_SAMPLES:600 DIM:350 AVG_DIFF:68010.6484
Fitting PCA...
0-th component log probs | Train: 5.501510858910642 | Val: -233.28375056630733
1-th component log probs | Train: 5.037046510224268 | Val: -96.2761417784716
2-th component log probs | Train: 5.336223489974268 | Val: -183.0238836662034
3-th component log probs | Train: 5.465050753794621 | Val: -296.7053267078776
4-th component log probs | Train: 5.396476299944656 | Val: -178.7840348282181
5-th component log probs | Train: 5.4131674928023665 | Val: -158.2281960697175
6-th component log probs | Train: 5.48402614400106 | Val: -271.1644838566061
7-th component log probs | Train: 5.612471270519481 | Val: -246.9800322511486
8-th component log probs | Train: 5.452490363253123 | Val: -227.12230153363504
9-th component log probs | Train: 5.531864977884197 | Val: -314.8660879714018
KEYWORD NR_SAMPLES:600 DIM:400 AVG_DIFF:55185.3440
Fitting PCA...
0-th component log probs | Train: 5.55466719261085 | Val: -211.24090563944935
1-th component log probs | Train: 5.139276038009913 | Val: -88.94009787821948
2-th component log probs | Train: 5.4073208876397585 | Val: -166.47608875815007
3-th component log probs | Train: 5.522393068426745 | Val: -268.4665697809701
4-th component log probs | Train: 5.460862330832484 | Val: -162.76940581437157
5-th component log probs | Train: 5.4761081374313125 | Val: -144.15814009839377
6-th component log probs | Train: 5.538929115862882 | Val: -245.61081860195245
7-th component log probs | Train: 5.653777432596478 | Val: -223.1366181938469
8-th component log probs | Train: 5.511383534788916 | Val: -206.34173062655657
9-th component log probs | Train: 5.582135665438055 | Val: -284.39427964288313
KEYWORD NR_SAMPLES:600 DIM:450 AVG_DIFF:45554.6243
Fitting PCA...
0-th component log probs | Train: 5.597740383721096 | Val: -193.2638363241815
1-th component log probs | Train: 5.223125339950355 | Val: -82.61892258319588
2-th component log probs | Train: 5.46502188436331 | Val: -152.6485963354412
3-th component log probs | Train: 5.568793956316749 | Val: -244.83586215387697
4-th component log probs | Train: 5.513170353342787 | Val: -149.24990212713018
5-th component log probs | Train: 5.527062701465155 | Val: -132.43718609526533
6-th component log probs | Train: 5.58351772746499 | Val: -224.1919501414021
7-th component log probs | Train: 5.6871139129000845 | Val: -203.65901909414904
8-th component log probs | Train: 5.5589033845486995 | Val: -189.12029420238753
9-th component log probs | Train: 5.622670369811732 | Val: -259.1786715324533
KEYWORD NR_SAMPLES:600 DIM:500 AVG_DIFF:38259.2612
0-th component log probs | Train: 5.6068822753071315 | Val: -189.33427347446914
1-th component log probs | Train: 5.24099703026368 | Val: -81.19801171969239
2-th component log probs | Train: 5.477271444596389 | Val: -149.6699160380701
3-th component log probs | Train: 5.578624891031113 | Val: -239.78730812584035
4-th component log probs | Train: 5.524281606966773 | Val: -146.36308957515482
5-th component log probs | Train: 5.5378661404700305 | Val: -129.91921056291275
6-th component log probs | Train: 5.592992388816417 | Val: -219.6226014823237
7-th component log probs | Train: 5.694175076450735 | Val: -199.49564448328448
8-th component log probs | Train: 5.568967582785945 | Val: -185.42476216953432
9-th component log probs | Train: 5.631244065427409 | Val: -253.765017364677
KEYWORD NR_SAMPLES:600 DIM:512 AVG_DIFF:36775.7191
best average differences at 50 dimensions: 31085.68786781383
2022-01-10 00:16.16 [info     ] Training complete              train_loss=0.32259637117385864
2022-01-10 00:16.16 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:16.20 [info     ] Testing complete               test_loss=2.25274920463562
{'dataset_size': 600,
 'end_test_accuracy': 0.4870111346244812,
 'end_test_loss': 2.25274920463562,
 'end_train_accuracy': 0.9984375238418579,
 'end_train_loss': 0.32259637117385864,
 'end_val_accuracy': 0.522303581237793,
 'end_val_loss': 2.1865952014923096}
2022-01-10 00:16.20 [info     ] Start Predict                  dataset=58006
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:16.46 [info     ] Starting training              dataset=800 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
800
Fitting PCA...
0-th component log probs | Train: 2.804958448873308 | Val: -32.9576450681941
1-th component log probs | Train: 2.382738267756053 | Val: -3.9354491091961217
2-th component log probs | Train: 2.6716298418817472 | Val: -21.33168164891168
3-th component log probs | Train: 2.7130712536454373 | Val: -48.08111671007857
4-th component log probs | Train: 2.697544820091126 | Val: -26.16135490521756
5-th component log probs | Train: 2.6048994638354017 | Val: -11.626579922809025
6-th component log probs | Train: 2.644365713109079 | Val: -19.01671307689481
7-th component log probs | Train: 3.2246017497363963 | Val: -118.55201538297364
8-th component log probs | Train: 2.5070399323631234 | Val: -17.208265724044853
9-th component log probs | Train: 3.0143189119600424 | Val: -98.12990260064083
KEYWORD NR_SAMPLES:800 DIM:50 AVG_DIFF:3142.8057
Fitting PCA...
0-th component log probs | Train: 3.8319523836457945 | Val: -234.3101865879131
1-th component log probs | Train: 3.1355887658008803 | Val: -22.32571060371797
2-th component log probs | Train: 3.6568735501671754 | Val: -159.80667970916306
3-th component log probs | Train: 3.6791433431352716 | Val: -254.36466489941625
4-th component log probs | Train: 3.73208549913378 | Val: -186.0146982512917
5-th component log probs | Train: 3.611432355123857 | Val: -125.04298521421539
6-th component log probs | Train: 3.4607125315060214 | Val: -93.06457002130189
7-th component log probs | Train: 4.392799064163282 | Val: -296.13707579071945
8-th component log probs | Train: 3.4729446289399997 | Val: -146.7425939354215
9-th component log probs | Train: 4.114043230186529 | Val: -398.47163821835704
KEYWORD NR_SAMPLES:800 DIM:100 AVG_DIFF:48749.7972
Fitting PCA...
0-th component log probs | Train: 4.429023247426196 | Val: -250.99756310769664
1-th component log probs | Train: 3.740919704177952 | Val: -53.95567993500117
2-th component log probs | Train: 4.306987748783968 | Val: -200.2384523392054
3-th component log probs | Train: 4.3053315905580325 | Val: -320.8156652561378
4-th component log probs | Train: 4.366592137129876 | Val: -211.15465427746994
5-th component log probs | Train: 4.273307686577537 | Val: -158.30477355997616
6-th component log probs | Train: 4.087206341054401 | Val: -167.55225265925077
7-th component log probs | Train: 4.874722046139568 | Val: -279.1828772037418
8-th component log probs | Train: 4.162570989741026 | Val: -231.03359738632295
9-th component log probs | Train: 4.659698777856813 | Val: -383.37899753072793
KEYWORD NR_SAMPLES:800 DIM:150 AVG_DIFF:60503.5269
Fitting PCA...
0-th component log probs | Train: 4.7734980163535425 | Val: -229.36003809555297
1-th component log probs | Train: 4.185378419461754 | Val: -72.29966075812888
2-th component log probs | Train: 4.6761447470023825 | Val: -188.72547484422606
3-th component log probs | Train: 4.667214223778142 | Val: -302.4981971807407
4-th component log probs | Train: 4.724381633719495 | Val: -198.08051223463337
5-th component log probs | Train: 4.651189294708843 | Val: -155.53552530306965
6-th component log probs | Train: 4.486087112502171 | Val: -175.5125572168273
7-th component log probs | Train: 5.131430224258572 | Val: -245.7836107846692
8-th component log probs | Train: 4.5652358276738925 | Val: -226.58649721184614
9-th component log probs | Train: 4.958220234348207 | Val: -341.16711527564746
KEYWORD NR_SAMPLES:800 DIM:200 AVG_DIFF:52780.4600
Fitting PCA...
0-th component log probs | Train: 4.991757327508552 | Val: -209.83226441292277
1-th component log probs | Train: 4.493728590322529 | Val: -74.37969991337127
2-th component log probs | Train: 4.912299144011824 | Val: -172.8311248509915
3-th component log probs | Train: 4.902949689330077 | Val: -275.52344002705155
4-th component log probs | Train: 4.954383827009403 | Val: -178.8039613206763
5-th component log probs | Train: 4.89392647295506 | Val: -143.70709384414613
6-th component log probs | Train: 4.74819912190763 | Val: -167.44994324779685
7-th component log probs | Train: 5.290839707755035 | Val: -216.88463238564609
8-th component log probs | Train: 4.8242490704526215 | Val: -210.07895058486133
9-th component log probs | Train: 5.147041129089486 | Val: -297.7565300262281
KEYWORD NR_SAMPLES:800 DIM:250 AVG_DIFF:43539.9555
Fitting PCA...
0-th component log probs | Train: 5.144054206152459 | Val: -187.45337461692185
1-th component log probs | Train: 4.713142088185361 | Val: -71.92708063902245
2-th component log probs | Train: 5.078191756818852 | Val: -156.78997562880596
3-th component log probs | Train: 5.067605669407158 | Val: -245.65357713446753
4-th component log probs | Train: 5.113753553887537 | Val: -161.24330489994657
5-th component log probs | Train: 5.062061831542482 | Val: -131.27802125973201
6-th component log probs | Train: 4.93309544693006 | Val: -154.5042955692463
7-th component log probs | Train: 5.400790668109997 | Val: -192.1397348078655
8-th component log probs | Train: 5.003663736289094 | Val: -191.1984814753848
9-th component log probs | Train: 5.276734096478934 | Val: -263.558531516118
KEYWORD NR_SAMPLES:800 DIM:300 AVG_DIFF:35350.3420
Fitting PCA...
0-th component log probs | Train: 5.256504238798091 | Val: -168.55528149349522
1-th component log probs | Train: 4.878639415716727 | Val: -68.12216597062285
2-th component log probs | Train: 5.199847717901306 | Val: -142.71691482413732
3-th component log probs | Train: 5.18953673733917 | Val: -222.73948718469853
4-th component log probs | Train: 5.231795889958261 | Val: -145.4812095677033
5-th component log probs | Train: 5.186477612484104 | Val: -119.32245508972532
6-th component log probs | Train: 5.071126704738101 | Val: -142.27708348611063
7-th component log probs | Train: 5.48128108901299 | Val: -171.65812400509188
8-th component log probs | Train: 5.1365981637473075 | Val: -173.62808381230886
9-th component log probs | Train: 5.37193418359644 | Val: -235.62221110777514
KEYWORD NR_SAMPLES:800 DIM:350 AVG_DIFF:29071.2401
Fitting PCA...
0-th component log probs | Train: 5.343199745975581 | Val: -152.6517975281803
1-th component log probs | Train: 5.0081044718233985 | Val: -63.98079793233114
2-th component log probs | Train: 5.293598912603296 | Val: -130.11209975269927
3-th component log probs | Train: 5.283710259905147 | Val: -201.7013237097699
4-th component log probs | Train: 5.322181158722235 | Val: -132.32033543379038
5-th component log probs | Train: 5.28207087708536 | Val: -108.86129215569375
6-th component log probs | Train: 5.178887926187906 | Val: -130.74815283350858
7-th component log probs | Train: 5.542417446102198 | Val: -154.89840857006737
8-th component log probs | Train: 5.23841012417138 | Val: -158.53956536699906
9-th component log probs | Train: 5.445171604404624 | Val: -212.56382460787228
KEYWORD NR_SAMPLES:800 DIM:400 AVG_DIFF:24144.2132
Fitting PCA...
0-th component log probs | Train: 5.41231513245355 | Val: -139.4834080801403
1-th component log probs | Train: 5.111655761554482 | Val: -59.95882967268326
2-th component log probs | Train: 5.368215055234295 | Val: -119.30860178657478
3-th component log probs | Train: 5.358901519100801 | Val: -183.78158567534157
4-th component log probs | Train: 5.393969137141343 | Val: -121.286638450057
5-th component log probs | Train: 5.358120134396555 | Val: -99.89621936405484
6-th component log probs | Train: 5.26458660018778 | Val: -120.61086619626798
7-th component log probs | Train: 5.590866693853846 | Val: -140.95211009683362
8-th component log probs | Train: 5.3191843522412166 | Val: -145.23750981926938
9-th component log probs | Train: 5.503164172993807 | Val: -193.4182083837823
KEYWORD NR_SAMPLES:800 DIM:450 AVG_DIFF:20323.0328
Fitting PCA...
0-th component log probs | Train: 5.468715215227121 | Val: -128.0369741645088
1-th component log probs | Train: 5.196841459381556 | Val: -56.22549594488087
2-th component log probs | Train: 5.429049863090828 | Val: -109.91004309388877
3-th component log probs | Train: 5.42033421714928 | Val: -168.45608834321965
4-th component log probs | Train: 5.452434040706557 | Val: -111.68028241633077
5-th component log probs | Train: 5.420023843160043 | Val: -92.10912074155303
6-th component log probs | Train: 5.335049380227901 | Val: -111.56385129838945
7-th component log probs | Train: 5.630172144943122 | Val: -129.21067250290866
8-th component log probs | Train: 5.385057449659015 | Val: -133.72439583770173
9-th component log probs | Train: 5.5505173800016046 | Val: -176.9901064120556
KEYWORD NR_SAMPLES:800 DIM:500 AVG_DIFF:17288.4522
0-th component log probs | Train: 5.480736357204505 | Val: -125.51808885214656
1-th component log probs | Train: 5.215108861666699 | Val: -55.34996590572772
2-th component log probs | Train: 5.442025678071129 | Val: -107.86361164429213
3-th component log probs | Train: 5.43346523873725 | Val: -165.14494316483288
4-th component log probs | Train: 5.464890349648747 | Val: -109.58724755508139
5-th component log probs | Train: 5.433224057898016 | Val: -90.43357564344211
6-th component log probs | Train: 5.350121908249494 | Val: -109.50899764906136
7-th component log probs | Train: 5.6385189366378015 | Val: -126.69574934008078
8-th component log probs | Train: 5.399077843967507 | Val: -131.19313069210247
9-th component log probs | Train: 5.560654665778989 | Val: -173.33044470353317
KEYWORD NR_SAMPLES:800 DIM:512 AVG_DIFF:16655.5852
best average differences at 50 dimensions: 3142.805653150439
2022-01-10 00:19.15 [info     ] Training complete              train_loss=0.4116905629634857
2022-01-10 00:19.15 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:19.18 [info     ] Testing complete               test_loss=1.8106521368026733
{'dataset_size': 800,
 'end_test_accuracy': 0.5080620646476746,
 'end_test_loss': 1.8106521368026733,
 'end_train_accuracy': 0.9723557829856873,
 'end_train_loss': 0.4116905629634857,
 'end_val_accuracy': 0.6131542921066284,
 'end_val_loss': 1.7818851470947266}
2022-01-10 00:19.19 [info     ] Start Predict                  dataset=57806
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:19.41 [info     ] Starting training              dataset=1000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
1000
Fitting PCA...
0-th component log probs | Train: 2.532580287975256 | Val: -11.006644012561317
1-th component log probs | Train: 2.4819984316936345 | Val: -3.8008125223374187
2-th component log probs | Train: 2.521730522969192 | Val: -8.410881768693736
3-th component log probs | Train: 2.573304390128171 | Val: -16.01280062161461
4-th component log probs | Train: 2.642314522344924 | Val: -13.849776143272512
5-th component log probs | Train: 2.7217837591384924 | Val: -13.417067078596196
6-th component log probs | Train: 2.6550799224896413 | Val: -22.304138859767654
7-th component log probs | Train: 2.803689906426378 | Val: -19.375379197843134
8-th component log probs | Train: 2.570944137111474 | Val: -21.348092611200126
9-th component log probs | Train: 2.8063485671083965 | Val: -37.39266431744377
KEYWORD NR_SAMPLES:1000 DIM:50 AVG_DIFF:452.3156
Fitting PCA...
0-th component log probs | Train: 3.3814349484095128 | Val: -80.33734623179605
1-th component log probs | Train: 3.138848647766428 | Val: -12.562639359148394
2-th component log probs | Train: 3.2719500933103083 | Val: -40.72091430158819
3-th component log probs | Train: 3.3576426193477955 | Val: -80.31446548331009
4-th component log probs | Train: 3.4985843264425935 | Val: -88.57969750114167
5-th component log probs | Train: 3.602697489437373 | Val: -79.56171402306522
6-th component log probs | Train: 3.3748744530843977 | Val: -70.58091760957267
7-th component log probs | Train: 3.833520600484181 | Val: -124.72383311670498
8-th component log probs | Train: 3.4823941572288857 | Val: -170.92365177958982
9-th component log probs | Train: 3.6787862845192327 | Val: -164.56997504758542
KEYWORD NR_SAMPLES:1000 DIM:100 AVG_DIFF:11230.8061
Fitting PCA...
0-th component log probs | Train: 4.0481104134438715 | Val: -135.10976924784677
1-th component log probs | Train: 3.6511363992652495 | Val: -35.13166138823887
2-th component log probs | Train: 3.9089233867730293 | Val: -92.9140079351843
3-th component log probs | Train: 3.96525185328663 | Val: -145.15002685336435
4-th component log probs | Train: 4.135449265042956 | Val: -146.70888510619943
5-th component log probs | Train: 4.227234362311441 | Val: -116.34105994580663
6-th component log probs | Train: 3.972727648145558 | Val: -147.32563838178737
7-th component log probs | Train: 4.44281945664884 | Val: -155.07591640147797
8-th component log probs | Train: 4.160437176632309 | Val: -243.9608816350487
9-th component log probs | Train: 4.2672654140018995 | Val: -230.58597916884708
KEYWORD NR_SAMPLES:1000 DIM:150 AVG_DIFF:25482.7452
Fitting PCA...
0-th component log probs | Train: 4.463523420807674 | Val: -141.35423890053536
1-th component log probs | Train: 4.072448345613688 | Val: -49.83460124564954
2-th component log probs | Train: 4.342166615253183 | Val: -102.30148170435992
3-th component log probs | Train: 4.376863865580518 | Val: -166.88709337824787
4-th component log probs | Train: 4.530631481753687 | Val: -149.26285134744052
5-th component log probs | Train: 4.603309525205503 | Val: -116.32161634066334
6-th component log probs | Train: 4.379860085153931 | Val: -164.64105734894045
7-th component log probs | Train: 4.78492148852599 | Val: -149.92264388829187
8-th component log probs | Train: 4.5584020618403605 | Val: -247.271629214796
9-th component log probs | Train: 4.6342654892347035 | Val: -220.25220211436962
KEYWORD NR_SAMPLES:1000 DIM:200 AVG_DIFF:26964.3063
Fitting PCA...
0-th component log probs | Train: 4.734154231699308 | Val: -134.01641579303993
1-th component log probs | Train: 4.383071343949316 | Val: -53.42801069299446
2-th component log probs | Train: 4.627491727325482 | Val: -100.02136803275269
3-th component log probs | Train: 4.652327526684022 | Val: -165.60317501845756
4-th component log probs | Train: 4.788110595931985 | Val: -140.11033168724344
5-th component log probs | Train: 4.847138566908745 | Val: -108.92969519116842
6-th component log probs | Train: 4.656157558448279 | Val: -163.64889557595745
7-th component log probs | Train: 5.003485944137611 | Val: -137.41184353186262
8-th component log probs | Train: 4.815838505025142 | Val: -229.65282039568964
9-th component log probs | Train: 4.872005956236569 | Val: -212.77277341439887
KEYWORD NR_SAMPLES:1000 DIM:250 AVG_DIFF:24742.6407
Fitting PCA...
0-th component log probs | Train: 4.923938487850873 | Val: -124.09180777611977
1-th component log probs | Train: 4.609944393249753 | Val: -53.64648915614751
2-th component log probs | Train: 4.830142428244365 | Val: -93.45862747114073
3-th component log probs | Train: 4.849520204505889 | Val: -155.0798239894774
4-th component log probs | Train: 4.968944682942026 | Val: -128.57945517312203
5-th component log probs | Train: 5.0183295449363285 | Val: -100.15822148501339
6-th component log probs | Train: 4.852155662003764 | Val: -154.8237758600901
7-th component log probs | Train: 5.155004701988848 | Val: -125.62294490273041
8-th component log probs | Train: 4.994920988443132 | Val: -209.41597129959402
9-th component log probs | Train: 5.039289990027653 | Val: -194.26427967907753
KEYWORD NR_SAMPLES:1000 DIM:300 AVG_DIFF:21246.7453
Fitting PCA...
0-th component log probs | Train: 5.0650361214885855 | Val: -113.41589599224902
1-th component log probs | Train: 4.783669700792937 | Val: -51.44474693187132
2-th component log probs | Train: 4.98206295322854 | Val: -86.81385818016118
3-th component log probs | Train: 4.996792530979871 | Val: -144.55570637297905
4-th component log probs | Train: 5.102936231723261 | Val: -117.75288739757875
5-th component log probs | Train: 5.145128589389241 | Val: -91.81452989813184
6-th component log probs | Train: 4.999328615367231 | Val: -142.2536378916501
7-th component log probs | Train: 5.266477339699039 | Val: -114.812008698966
8-th component log probs | Train: 5.127343065853221 | Val: -189.02486086565065
9-th component log probs | Train: 5.16286022604708 | Val: -176.1798176595958
KEYWORD NR_SAMPLES:1000 DIM:350 AVG_DIFF:17916.9060
Fitting PCA...
0-th component log probs | Train: 5.173830221865084 | Val: -104.0463272587309
1-th component log probs | Train: 4.919962981107236 | Val: -48.777227467216456
2-th component log probs | Train: 5.099512747976491 | Val: -80.43473859602022
3-th component log probs | Train: 5.110885971643912 | Val: -133.55954647970154
4-th component log probs | Train: 5.206609764913117 | Val: -108.05960967743451
5-th component log probs | Train: 5.243062469315673 | Val: -84.59639660584253
6-th component log probs | Train: 5.113352978037754 | Val: -131.97154393033665
7-th component log probs | Train: 5.352216308762925 | Val: -104.67855195787303
8-th component log probs | Train: 5.229277754567334 | Val: -172.39406896732274
9-th component log probs | Train: 5.258753608279836 | Val: -160.54456817428746
KEYWORD NR_SAMPLES:1000 DIM:400 AVG_DIFF:15219.8227
Fitting PCA...
0-th component log probs | Train: 5.260309283850202 | Val: -95.76471700444206
1-th component log probs | Train: 5.030102700500203 | Val: -46.00756317180436
2-th component log probs | Train: 5.193331064139549 | Val: -74.58221034406789
3-th component log probs | Train: 5.20279350857215 | Val: -123.03623673389956
4-th component log probs | Train: 5.289161233439143 | Val: -99.30337500236651
5-th component log probs | Train: 5.321374394811811 | Val: -77.94893794622722
6-th component log probs | Train: 5.205127549653539 | Val: -121.8453005575107
7-th component log probs | Train: 5.4201337546686545 | Val: -96.2803151976738
8-th component log probs | Train: 5.31014129132889 | Val: -157.83900877180267
9-th component log probs | Train: 5.335344775596037 | Val: -146.86509651105712
KEYWORD NR_SAMPLES:1000 DIM:450 AVG_DIFF:12976.1241
Fitting PCA...
0-th component log probs | Train: 5.331187939805395 | Val: -88.49857098154392
1-th component log probs | Train: 5.121445067506368 | Val: -43.27741708672021
2-th component log probs | Train: 5.270203865631761 | Val: -69.24253282569377
3-th component log probs | Train: 5.278310067321622 | Val: -113.99366307131893
4-th component log probs | Train: 5.356687939633337 | Val: -91.67787501743221
5-th component log probs | Train: 5.38555841670202 | Val: -72.07853343757598
6-th component log probs | Train: 5.280522033519126 | Val: -112.78377241396808
7-th component log probs | Train: 5.475689152369471 | Val: -88.69404172869297
8-th component log probs | Train: 5.376244920942408 | Val: -145.40614526986818
9-th component log probs | Train: 5.398119613776828 | Val: -134.91702640618547
KEYWORD NR_SAMPLES:1000 DIM:500 AVG_DIFF:11157.1602
0-th component log probs | Train: 5.346310019208914 | Val: -86.89678733264539
1-th component log probs | Train: 5.1411080687554165 | Val: -42.619186259424595
2-th component log probs | Train: 5.286667305557567 | Val: -68.07612214284937
3-th component log probs | Train: 5.294551423056268 | Val: -111.8891263674958
4-th component log probs | Train: 5.371211710485898 | Val: -89.96910570155657
5-th component log probs | Train: 5.399334870866554 | Val: -70.75510508076113
6-th component log probs | Train: 5.296684007713787 | Val: -110.74189109416157
7-th component log probs | Train: 5.487529441821907 | Val: -87.02786971507334
8-th component log probs | Train: 5.390372612385483 | Val: -142.581806208702
9-th component log probs | Train: 5.411563286166949 | Val: -132.3237798476531
KEYWORD NR_SAMPLES:1000 DIM:512 AVG_DIFF:10768.4063
best average differences at 50 dimensions: 452.3155844469296
2022-01-10 00:22.13 [info     ] Training complete              train_loss=0.3756354749202728
2022-01-10 00:22.13 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:22.17 [info     ] Testing complete               test_loss=1.4399099349975586
{'dataset_size': 1000,
 'end_test_accuracy': 0.5882217288017273,
 'end_test_loss': 1.4399099349975586,
 'end_train_accuracy': 0.9769531488418579,
 'end_train_loss': 0.3756354749202728,
 'end_val_accuracy': 0.6645892858505249,
 'end_val_loss': 1.5819932222366333}
2022-01-10 00:22.17 [info     ] Start Predict                  dataset=57606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:22.42 [info     ] Starting training              dataset=2000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
2000
Fitting PCA...
0-th component log probs | Train: 2.549082964320918 | Val: -4.266065964871455
1-th component log probs | Train: 2.309888939326985 | Val: 0.030775779051122998
2-th component log probs | Train: 2.5787954248658647 | Val: -3.5719017230434384
3-th component log probs | Train: 2.433773243722818 | Val: -4.325709226356461
4-th component log probs | Train: 2.4280880191803558 | Val: -2.324989237650054
5-th component log probs | Train: 2.5149849327822995 | Val: -3.4055897805595223
6-th component log probs | Train: 2.4539468976423264 | Val: -6.716323113711808
7-th component log probs | Train: 2.5775796639962727 | Val: -6.157319168778217
8-th component log probs | Train: 2.428252258510843 | Val: -4.668726247473681
9-th component log probs | Train: 2.5546410598686933 | Val: -6.7923215272711355
KEYWORD NR_SAMPLES:2000 DIM:50 AVG_DIFF:49.0932
Fitting PCA...
0-th component log probs | Train: 3.1986128443373825 | Val: -22.3506529609394
1-th component log probs | Train: 2.895831019450407 | Val: -2.10583381900677
2-th component log probs | Train: 3.1909991602349885 | Val: -7.646751038467456
3-th component log probs | Train: 3.0339041416106314 | Val: -7.908624391344221
4-th component log probs | Train: 3.07187297024654 | Val: -9.563948727145481
5-th component log probs | Train: 3.144999343156225 | Val: -9.06053778383918
6-th component log probs | Train: 3.045665772676094 | Val: -14.609289703800311
7-th component log probs | Train: 3.332107652875542 | Val: -30.897044960552083
8-th component log probs | Train: 3.0637322402158214 | Val: -14.59953164754936
9-th component log probs | Train: 3.204381336266708 | Val: -18.131820653884485
KEYWORD NR_SAMPLES:2000 DIM:100 AVG_DIFF:347.4173
Fitting PCA...
0-th component log probs | Train: 3.6926827642911246 | Val: -45.51058248592837
1-th component log probs | Train: 3.2669659411714 | Val: -3.7036531384652385
2-th component log probs | Train: 3.5696012502437187 | Val: -11.590280443841753
3-th component log probs | Train: 3.4078797570292028 | Val: -11.70259597095623
4-th component log probs | Train: 3.490967654953097 | Val: -16.358236103557893
5-th component log probs | Train: 3.5492905001432735 | Val: -16.485861896174146
6-th component log probs | Train: 3.4379188071374926 | Val: -25.26390557747061
7-th component log probs | Train: 3.9167103348882955 | Val: -63.78470251548367
8-th component log probs | Train: 3.466601483061192 | Val: -23.84321757563694
9-th component log probs | Train: 3.6670561814647713 | Val: -38.38057752959573
KEYWORD NR_SAMPLES:2000 DIM:150 AVG_DIFF:1164.4203
Fitting PCA...
0-th component log probs | Train: 4.108574562773387 | Val: -60.09416665786503
1-th component log probs | Train: 3.5754731614475337 | Val: -6.796512449747696
2-th component log probs | Train: 3.863019435938291 | Val: -16.337379262094895
3-th component log probs | Train: 3.698796047583159 | Val: -18.03175388863211
4-th component log probs | Train: 3.8549628618604364 | Val: -25.388242919112823
5-th component log probs | Train: 3.8696167058732125 | Val: -22.892096552521167
6-th component log probs | Train: 3.766646942115888 | Val: -36.445310363084516
7-th component log probs | Train: 4.329595469095539 | Val: -77.04079555343829
8-th component log probs | Train: 3.8104929496515467 | Val: -37.31005301777382
9-th component log probs | Train: 4.053377581434534 | Val: -54.82993944263876
KEYWORD NR_SAMPLES:2000 DIM:200 AVG_DIFF:2007.7484
Fitting PCA...
0-th component log probs | Train: 4.4094978974821 | Val: -65.34219822326816
1-th component log probs | Train: 3.8407630192468565 | Val: -10.798522667907458
2-th component log probs | Train: 4.103679456831498 | Val: -20.936485004474576
3-th component log probs | Train: 3.9473982956068747 | Val: -23.35979785410485
4-th component log probs | Train: 4.161872297729391 | Val: -33.87594054061311
5-th component log probs | Train: 4.139696186718376 | Val: -27.608695375468418
6-th component log probs | Train: 4.04897736048356 | Val: -45.34540695230746
7-th component log probs | Train: 4.6111203800814815 | Val: -75.96282625867786
8-th component log probs | Train: 4.107516687178342 | Val: -47.70285574271545
9-th component log probs | Train: 4.349477095504939 | Val: -60.446536758289085
KEYWORD NR_SAMPLES:2000 DIM:250 AVG_DIFF:2472.1940
Fitting PCA...
0-th component log probs | Train: 4.631364461252575 | Val: -64.05809167973032
1-th component log probs | Train: 4.077794868584362 | Val: -14.138611848592731
2-th component log probs | Train: 4.3083737378672184 | Val: -23.237632428842378
3-th component log probs | Train: 4.159947493836669 | Val: -27.910281458989928
4-th component log probs | Train: 4.399959904556719 | Val: -36.24652228315198
5-th component log probs | Train: 4.356968528528767 | Val: -30.95159371044178
6-th component log probs | Train: 4.276361766618652 | Val: -49.473205508636525
7-th component log probs | Train: 4.811185494133158 | Val: -74.02731323073344
8-th component log probs | Train: 4.344851339330371 | Val: -52.945673264560774
9-th component log probs | Train: 4.571476317113735 | Val: -61.38465979253671
KEYWORD NR_SAMPLES:2000 DIM:300 AVG_DIFF:2647.3133
Fitting PCA...
0-th component log probs | Train: 4.800074401209277 | Val: -61.17589486394495
1-th component log probs | Train: 4.282913321184392 | Val: -16.210903841964782
2-th component log probs | Train: 4.47607627361261 | Val: -24.510143217789103
3-th component log probs | Train: 4.342694737645395 | Val: -30.72776106778876
4-th component log probs | Train: 4.587344965723386 | Val: -37.19989388114727
5-th component log probs | Train: 4.534689785015319 | Val: -32.07609922375601
6-th component log probs | Train: 4.466479174850214 | Val: -51.6755245575214
7-th component log probs | Train: 4.962005891260451 | Val: -69.86495158790336
8-th component log probs | Train: 4.534310775011614 | Val: -54.2717372654889
9-th component log probs | Train: 4.743293239394007 | Val: -59.689785725695366
KEYWORD NR_SAMPLES:2000 DIM:350 AVG_DIFF:2629.0257
Fitting PCA...
0-th component log probs | Train: 4.932694824126408 | Val: -57.90911753398696
1-th component log probs | Train: 4.453409364479175 | Val: -17.227068596321853
2-th component log probs | Train: 4.617472802046623 | Val: -24.766303717398763
3-th component log probs | Train: 4.4989239050889935 | Val: -31.80196987975669
4-th component log probs | Train: 4.735933182372594 | Val: -37.098289881504016
5-th component log probs | Train: 4.681137832548619 | Val: -31.62772626174058
6-th component log probs | Train: 4.62100107098221 | Val: -51.30398940023966
7-th component log probs | Train: 5.07919078108068 | Val: -65.31009738970977
8-th component log probs | Train: 4.687599821167096 | Val: -54.34439149052555
9-th component log probs | Train: 4.879100882345814 | Val: -57.15768905510588
KEYWORD NR_SAMPLES:2000 DIM:400 AVG_DIFF:2508.4329
Fitting PCA...
0-th component log probs | Train: 5.03976832524346 | Val: -54.304712800673045
1-th component log probs | Train: 4.5961010874718315 | Val: -17.358313860440255
2-th component log probs | Train: 4.737808605536767 | Val: -24.15631862215453
3-th component log probs | Train: 4.630976405064448 | Val: -32.14353278655199
4-th component log probs | Train: 4.858176294281837 | Val: -35.793030353543585
5-th component log probs | Train: 4.802818975737723 | Val: -30.450074448917647
6-th component log probs | Train: 4.749974460657795 | Val: -49.77503628004602
7-th component log probs | Train: 5.1724580156095925 | Val: -61.27528865050188
8-th component log probs | Train: 4.814018535523511 | Val: -52.660798343551235
9-th component log probs | Train: 4.988903440703109 | Val: -54.238982959327956
KEYWORD NR_SAMPLES:2000 DIM:450 AVG_DIFF:2328.5863
Fitting PCA...
0-th component log probs | Train: 5.12803429974865 | Val: -50.72884240565629
1-th component log probs | Train: 4.718094019987634 | Val: -17.071833557546583
2-th component log probs | Train: 4.841577550242309 | Val: -23.20150090950216
3-th component log probs | Train: 4.744561863538414 | Val: -31.499494149190767
4-th component log probs | Train: 4.960596768541436 | Val: -34.19899954442466
5-th component log probs | Train: 4.906697409890067 | Val: -29.23705609255799
6-th component log probs | Train: 4.859390510081088 | Val: -47.432296909039316
7-th component log probs | Train: 5.2492134303074875 | Val: -57.28365416629705
8-th component log probs | Train: 4.920558089318497 | Val: -50.49814958528385
9-th component log probs | Train: 5.080277840217308 | Val: -51.151254283399034
KEYWORD NR_SAMPLES:2000 DIM:500 AVG_DIFF:2127.2106
0-th component log probs | Train: 5.147059627164969 | Val: -49.84704867672013
1-th component log probs | Train: 4.744964924163471 | Val: -16.946803509846788
2-th component log probs | Train: 4.864350511436297 | Val: -23.0625021725112
3-th component log probs | Train: 4.769736390402638 | Val: -31.26354254754599
4-th component log probs | Train: 4.9826893907949295 | Val: -33.77212787020397
5-th component log probs | Train: 4.929224997145608 | Val: -28.89000452227789
6-th component log probs | Train: 4.88337366103758 | Val: -46.79776210116205
7-th component log probs | Train: 5.265754147649434 | Val: -56.34275015620255
8-th component log probs | Train: 4.94355744954013 | Val: -49.90432918369305
9-th component log probs | Train: 5.100038244477045 | Val: -50.38037967076296
KEYWORD NR_SAMPLES:2000 DIM:512 AVG_DIFF:2077.1782
best average differences at 50 dimensions: 49.09323619584284
2022-01-10 00:30.13 [info     ] Training complete              train_loss=0.23676037788391113
2022-01-10 00:30.13 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:30.17 [info     ] Testing complete               test_loss=0.9306367039680481
{'dataset_size': 2000,
 'end_test_accuracy': 0.7878404259681702,
 'end_test_loss': 0.9306367039680481,
 'end_train_accuracy': 0.99853515625,
 'end_train_loss': 0.23676037788391113,
 'end_val_accuracy': 0.7938658595085144,
 'end_val_loss': 0.92742520570755}
2022-01-10 00:30.17 [info     ] Start Predict                  dataset=56606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:30.40 [info     ] Starting training              dataset=4000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
4000
Fitting PCA...
0-th component log probs | Train: 2.154330784466085 | Val: 1.159735165773831
1-th component log probs | Train: 1.9194862484320108 | Val: 1.5759652782201743
2-th component log probs | Train: 2.029701263170201 | Val: 1.4945586997078926
3-th component log probs | Train: 2.071676607428975 | Val: 0.8775499836309384
4-th component log probs | Train: 1.8310449186485735 | Val: 1.285577279744922
5-th component log probs | Train: 2.2069301972572966 | Val: 0.9987265949961995
6-th component log probs | Train: 2.088503645250497 | Val: 1.0408282665242319
7-th component log probs | Train: 2.137350651255563 | Val: 1.1877949615894554
8-th component log probs | Train: 2.0878928707820337 | Val: 0.3345852463864573
9-th component log probs | Train: 2.170623501117851 | Val: 0.7791843432706095
KEYWORD NR_SAMPLES:4000 DIM:50 AVG_DIFF:1.1586
Fitting PCA...
0-th component log probs | Train: 2.7257233098567815 | Val: 0.9310470212596261
1-th component log probs | Train: 2.467338173251393 | Val: 1.8534816343475848
2-th component log probs | Train: 2.5736364433362633 | Val: 1.7909793128803868
3-th component log probs | Train: 2.6327307273520426 | Val: 0.9057081590956195
4-th component log probs | Train: 2.3605754160117605 | Val: 1.4416504928012588
5-th component log probs | Train: 2.7629921047035864 | Val: 0.7687555813973233
6-th component log probs | Train: 2.632983107301781 | Val: 0.9725023871546057
7-th component log probs | Train: 2.7275333300013056 | Val: 0.8328969889968407
8-th component log probs | Train: 2.6306179178320273 | Val: -0.05567173924906709
9-th component log probs | Train: 2.7384562171852496 | Val: 0.38618091577100794
KEYWORD NR_SAMPLES:4000 DIM:100 AVG_DIFF:3.1110
Fitting PCA...
0-th component log probs | Train: 3.0850620721531454 | Val: 0.5215514000468303
1-th component log probs | Train: 2.796731694630863 | Val: 2.0219915614823045
2-th component log probs | Train: 2.899403781846945 | Val: 1.9391861170772595
3-th component log probs | Train: 2.960482697181193 | Val: 0.9570239779358065
4-th component log probs | Train: 2.703667938535429 | Val: 1.4120381000636895
5-th component log probs | Train: 3.1048788821170596 | Val: 0.5143576493401318
6-th component log probs | Train: 2.972725752027645 | Val: 0.7370710680907707
7-th component log probs | Train: 3.1030148113731704 | Val: 0.24389271554156314
8-th component log probs | Train: 2.9620714046480128 | Val: -0.3108778278451952
9-th component log probs | Train: 3.096547707064418 | Val: -0.24360111133254345
KEYWORD NR_SAMPLES:4000 DIM:150 AVG_DIFF:5.5528
Fitting PCA...
0-th component log probs | Train: 3.3801743649380405 | Val: -0.4508655292067711
1-th component log probs | Train: 3.045763447313221 | Val: 2.079267056578627
2-th component log probs | Train: 3.1454865669841316 | Val: 1.9656803235164129
3-th component log probs | Train: 3.211484750823463 | Val: 0.7985397394794673
4-th component log probs | Train: 2.9831473213465127 | Val: 1.1633451827292014
5-th component log probs | Train: 3.3771614365634783 | Val: -0.06271732835751143
6-th component log probs | Train: 3.2402191838017513 | Val: 0.3632095964062199
7-th component log probs | Train: 3.404552020756179 | Val: -1.1691222242034685
8-th component log probs | Train: 3.220951386006078 | Val: -0.8620074936421692
9-th component log probs | Train: 3.3842285603949764 | Val: -1.3671320536896168
KEYWORD NR_SAMPLES:4000 DIM:200 AVG_DIFF:10.6411
Fitting PCA...
0-th component log probs | Train: 3.6292471105064084 | Val: -1.9221740722185618
1-th component log probs | Train: 3.250101962978965 | Val: 1.9826139290889484
2-th component log probs | Train: 3.340451534166653 | Val: 1.8998978865231293
3-th component log probs | Train: 3.4124832537298286 | Val: 0.4904742502473063
4-th component log probs | Train: 3.213774965710038 | Val: 0.5846539350810618
5-th component log probs | Train: 3.5989714829914132 | Val: -0.8827642784813293
6-th component log probs | Train: 3.4605619875381386 | Val: -0.3647010287784812
7-th component log probs | Train: 3.673229035355334 | Val: -3.2182480019863853
8-th component log probs | Train: 3.4370240264804544 | Val: -1.6985715563637782
9-th component log probs | Train: 3.6292945638763103 | Val: -2.8429096911524443
KEYWORD NR_SAMPLES:4000 DIM:250 AVG_DIFF:20.0425
Fitting PCA...
0-th component log probs | Train: 3.8512847670591897 | Val: -3.839639753054838
1-th component log probs | Train: 3.426218807139566 | Val: 1.7893457389684202
2-th component log probs | Train: 3.507323845716044 | Val: 1.7504576175764037
3-th component log probs | Train: 3.5834600568238275 | Val: 0.1013826961460752
4-th component log probs | Train: 3.4271948385286626 | Val: -0.5777488876844238
5-th component log probs | Train: 3.7987068972342004 | Val: -1.9815643738641295
6-th component log probs | Train: 3.6544537422724863 | Val: -1.2297824940725641
7-th component log probs | Train: 3.9072758540886214 | Val: -5.189213544501014
8-th component log probs | Train: 3.6263333358590235 | Val: -3.010929063267981
9-th component log probs | Train: 3.847859013386094 | Val: -4.623655154895894
KEYWORD NR_SAMPLES:4000 DIM:300 AVG_DIFF:34.8914
Fitting PCA...
0-th component log probs | Train: 4.053867123097064 | Val: -5.581386000650766
1-th component log probs | Train: 3.5829177917920596 | Val: 1.4781395259753156
2-th component log probs | Train: 3.6571173295359505 | Val: 1.511670512038553
3-th component log probs | Train: 3.734578665208496 | Val: -0.4285547866557082
4-th component log probs | Train: 3.6282389576015355 | Val: -2.122132806040322
5-th component log probs | Train: 3.97724533453549 | Val: -3.155403026847551
6-th component log probs | Train: 3.8356224260443335 | Val: -2.470622124153656
7-th component log probs | Train: 4.113839858069543 | Val: -6.806913627347089
8-th component log probs | Train: 3.8006022717609333 | Val: -4.310134775110133
9-th component log probs | Train: 4.0437802141164925 | Val: -6.348576931673242
KEYWORD NR_SAMPLES:4000 DIM:350 AVG_DIFF:53.5961
Fitting PCA...
0-th component log probs | Train: 4.226841096816141 | Val: -6.70351059082179
1-th component log probs | Train: 3.7326016764354772 | Val: 1.0408192808504853
2-th component log probs | Train: 3.7929775364343343 | Val: 1.2598853788208844
3-th component log probs | Train: 3.8721664437001944 | Val: -1.040543075058623
4-th component log probs | Train: 3.8188916618061746 | Val: -3.9545861253436825
5-th component log probs | Train: 4.134289292564601 | Val: -4.107901468443497
6-th component log probs | Train: 4.001553806622643 | Val: -3.778642902869229
7-th component log probs | Train: 4.288928902335637 | Val: -7.799477150144515
8-th component log probs | Train: 3.9620927447507945 | Val: -5.783048226994416
9-th component log probs | Train: 4.213648111031572 | Val: -7.517898571923725
KEYWORD NR_SAMPLES:4000 DIM:400 AVG_DIFF:72.4888
Fitting PCA...
0-th component log probs | Train: 4.378993667310811 | Val: -7.505609587178462
1-th component log probs | Train: 3.8732316587536686 | Val: 0.5966949198493053
2-th component log probs | Train: 3.918586520420604 | Val: 0.9743061114418394
3-th component log probs | Train: 4.001631666467694 | Val: -1.6099138481308295
4-th component log probs | Train: 3.9941617103443106 | Val: -5.397719176413764
5-th component log probs | Train: 4.276000919105034 | Val: -4.893639179218004
6-th component log probs | Train: 4.152033550464309 | Val: -4.712106417508016
7-th component log probs | Train: 4.437911939514405 | Val: -8.477678034033016
8-th component log probs | Train: 4.110554016476127 | Val: -6.986937776101254
9-th component log probs | Train: 4.359697573444445 | Val: -8.241874382456778
KEYWORD NR_SAMPLES:4000 DIM:450 AVG_DIFF:89.1767
Fitting PCA...
0-th component log probs | Train: 4.511006348230701 | Val: -7.905283096506078
1-th component log probs | Train: 4.008469628280961 | Val: 0.14063347301595416
2-th component log probs | Train: 4.040800659430671 | Val: 0.6914774845787268
3-th component log probs | Train: 4.123275886527183 | Val: -2.0693908212332843
4-th component log probs | Train: 4.151989341127747 | Val: -6.453785601362924
5-th component log probs | Train: 4.405980229864061 | Val: -5.304254345383103
6-th component log probs | Train: 4.2894234973653536 | Val: -5.378904514292743
7-th component log probs | Train: 4.565760181523148 | Val: -8.736780464970568
8-th component log probs | Train: 4.246841486800227 | Val: -7.868439815469986
9-th component log probs | Train: 4.489391379571044 | Val: -8.575006310635436
KEYWORD NR_SAMPLES:4000 DIM:500 AVG_DIFF:101.3355
0-th component log probs | Train: 4.540418003505481 | Val: -7.9510377180807295
1-th component log probs | Train: 4.039950046610098 | Val: 0.040215137156606434
2-th component log probs | Train: 4.069747584893985 | Val: 0.6296434504650347
3-th component log probs | Train: 4.151672635233206 | Val: -2.190838938483685
4-th component log probs | Train: 4.187567598778894 | Val: -6.604306594614141
5-th component log probs | Train: 4.4348407170124755 | Val: -5.364714549251064
6-th component log probs | Train: 4.320644449066892 | Val: -5.462010876241724
7-th component log probs | Train: 4.5942981373525775 | Val: -8.733572058133234
8-th component log probs | Train: 4.277256615283224 | Val: -8.03075760888967
9-th component log probs | Train: 4.518048140808405 | Val: -8.561378230530524
KEYWORD NR_SAMPLES:4000 DIM:512 AVG_DIFF:103.2483
best average differences at 50 dimensions: 1.158630421091803
2022-01-10 00:36.34 [info     ] Training complete              train_loss=0.38156867027282715
2022-01-10 00:36.34 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:36.37 [info     ] Testing complete               test_loss=0.700247585773468
{'dataset_size': 4000,
 'end_test_accuracy': 0.7856521606445312,
 'end_test_loss': 0.700247585773468,
 'end_train_accuracy': 0.9672619104385376,
 'end_train_loss': 0.38156867027282715,
 'end_val_accuracy': 0.8174230456352234,
 'end_val_loss': 0.8301421999931335}
2022-01-10 00:36.38 [info     ] Start Predict                  dataset=54606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:37.01 [info     ] Starting training              dataset=6000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
6000
Fitting PCA...
0-th component log probs | Train: 2.313534431950404 | Val: 0.5482126397025181
1-th component log probs | Train: 2.0560634737289125 | Val: 1.5160097789045721
2-th component log probs | Train: 2.0690017072571885 | Val: 1.3634914442089063
3-th component log probs | Train: 2.2752596617113325 | Val: 0.5184111486841009
4-th component log probs | Train: 2.177242777895374 | Val: 0.9263208508935425
5-th component log probs | Train: 2.1652041338120744 | Val: 0.8798487047691745
6-th component log probs | Train: 2.181541611676161 | Val: 0.5116330760303787
7-th component log probs | Train: 2.269770104383056 | Val: 0.9686102670922913
8-th component log probs | Train: 2.167819733887317 | Val: 0.0519608922126795
9-th component log probs | Train: 2.2008373257114697 | Val: 0.5033222179352131
KEYWORD NR_SAMPLES:6000 DIM:50 AVG_DIFF:2.2049
Fitting PCA...
0-th component log probs | Train: 2.844487006546934 | Val: 0.07085631477084445
1-th component log probs | Train: 2.5532078666948284 | Val: 1.7289301390040426
2-th component log probs | Train: 2.5771287999379218 | Val: 1.5925283700637702
3-th component log probs | Train: 2.7912192127969844 | Val: 0.0005605650585977864
4-th component log probs | Train: 2.7070519646529325 | Val: 0.6830324346589565
5-th component log probs | Train: 2.6832526699118833 | Val: 0.9503634761975684
6-th component log probs | Train: 2.7018724671749106 | Val: 0.21284573554493905
7-th component log probs | Train: 2.7942718934314947 | Val: 0.587527851766809
8-th component log probs | Train: 2.7011992469511648 | Val: -0.319421352374813
9-th component log probs | Train: 2.736329575301494 | Val: 0.0068196395402096216
KEYWORD NR_SAMPLES:6000 DIM:100 AVG_DIFF:5.1869
Fitting PCA...
0-th component log probs | Train: 3.161889309773575 | Val: -0.28752964354696303
1-th component log probs | Train: 2.862873124962742 | Val: 1.9347290122272294
2-th component log probs | Train: 2.878872135355577 | Val: 1.7512860423287469
3-th component log probs | Train: 3.09767558780949 | Val: 0.12598597844827117
4-th component log probs | Train: 3.0230988902937934 | Val: 0.5081015668862826
5-th component log probs | Train: 2.989340267523003 | Val: 1.0483485393933971
6-th component log probs | Train: 3.0082770064872517 | Val: 0.1765089408367321
7-th component log probs | Train: 3.1094270327706144 | Val: 0.17160078112799448
8-th component log probs | Train: 3.007224266455674 | Val: -0.5520276142684075
9-th component log probs | Train: 3.038530527012918 | Val: -0.14754164481683701
KEYWORD NR_SAMPLES:6000 DIM:150 AVG_DIFF:7.2424
Fitting PCA...
0-th component log probs | Train: 3.4148848082084884 | Val: -0.7112309529726167
1-th component log probs | Train: 3.104903202183487 | Val: 2.0172841117323626
2-th component log probs | Train: 3.108717925543895 | Val: 1.8771959773732574
3-th component log probs | Train: 3.335684129113888 | Val: 0.0711532006229869
4-th component log probs | Train: 3.275715814658276 | Val: 0.31241869287015356
5-th component log probs | Train: 3.2179376180983508 | Val: 1.0066092040263994
6-th component log probs | Train: 3.2497388196963986 | Val: -0.10737612776465308
7-th component log probs | Train: 3.364360717516007 | Val: -0.24763010099911947
8-th component log probs | Train: 3.241217359655278 | Val: -0.6561811642833288
9-th component log probs | Train: 3.2837039415890175 | Val: -0.5644678799743441
KEYWORD NR_SAMPLES:6000 DIM:200 AVG_DIFF:9.8367
Fitting PCA...
0-th component log probs | Train: 3.6217499439800256 | Val: -1.415593360855637
1-th component log probs | Train: 3.2970921526225663 | Val: 2.0252236867189346
2-th component log probs | Train: 3.2900491720919387 | Val: 1.9351808950588134
3-th component log probs | Train: 3.5224182279164045 | Val: -0.10065604224875713
4-th component log probs | Train: 3.4828778405841 | Val: -0.16255359782095627
5-th component log probs | Train: 3.4039121862658996 | Val: 0.9106813035336955
6-th component log probs | Train: 3.446024072529963 | Val: -0.5028891138692855
7-th component log probs | Train: 3.5796550932756794 | Val: -0.8274666277357424
8-th component log probs | Train: 3.426860203449305 | Val: -0.8697245900026674
9-th component log probs | Train: 3.4797589633132633 | Val: -1.043224852690386
KEYWORD NR_SAMPLES:6000 DIM:250 AVG_DIFF:13.5395
Fitting PCA...
0-th component log probs | Train: 3.7995287385428105 | Val: -2.2181485462521144
1-th component log probs | Train: 3.456990708763406 | Val: 1.9658140530190855
2-th component log probs | Train: 3.442686040146166 | Val: 1.941099526568011
3-th component log probs | Train: 3.6726873653665497 | Val: -0.2675252657691747
4-th component log probs | Train: 3.6606004259900917 | Val: -0.82366298135539
5-th component log probs | Train: 3.5621387506469286 | Val: 0.6917138424429988
6-th component log probs | Train: 3.613324211975186 | Val: -1.0108776544142741
7-th component log probs | Train: 3.7625150967652727 | Val: -1.698948043977709
8-th component log probs | Train: 3.5848841370768745 | Val: -1.3204931370095176
9-th component log probs | Train: 3.65034106750284 | Val: -1.7678447852213681
KEYWORD NR_SAMPLES:6000 DIM:300 AVG_DIFF:18.9194
Fitting PCA...
0-th component log probs | Train: 3.958303043951053 | Val: -3.079129667856569
1-th component log probs | Train: 3.5965284107218207 | Val: 1.8445687862578077
2-th component log probs | Train: 3.5737236844542735 | Val: 1.90600970442275
3-th component log probs | Train: 3.8022381748936747 | Val: -0.5817801254142287
4-th component log probs | Train: 3.820024319875283 | Val: -1.5826976126935388
5-th component log probs | Train: 3.7021710118787885 | Val: 0.41422339081910364
6-th component log probs | Train: 3.765508497206038 | Val: -1.7433240448820972
7-th component log probs | Train: 3.9312370561575727 | Val: -2.5794297593091944
8-th component log probs | Train: 3.724993869520454 | Val: -1.8257172547150748
9-th component log probs | Train: 3.8017442445049983 | Val: -2.514738073773649
KEYWORD NR_SAMPLES:6000 DIM:350 AVG_DIFF:25.8040
Fitting PCA...
0-th component log probs | Train: 4.102465600253753 | Val: -3.9267475512316
1-th component log probs | Train: 3.7221790080407087 | Val: 1.6779583538484129
2-th component log probs | Train: 3.6921519185226837 | Val: 1.7772029760414227
3-th component log probs | Train: 3.916904052961313 | Val: -0.8046962958123384
4-th component log probs | Train: 3.967792863121876 | Val: -2.3141483156405287
5-th component log probs | Train: 3.8300642658858632 | Val: 0.07065966326871122
6-th component log probs | Train: 3.904677949872929 | Val: -2.4259637871622046
7-th component log probs | Train: 4.0795123228961145 | Val: -3.3954002819596676
8-th component log probs | Train: 3.8514678516309098 | Val: -2.289187835468332
9-th component log probs | Train: 3.937653139518059 | Val: -3.275402305496897
KEYWORD NR_SAMPLES:6000 DIM:400 AVG_DIFF:33.3891
Fitting PCA...
0-th component log probs | Train: 4.232306170053927 | Val: -4.50671871299042
1-th component log probs | Train: 3.8397455592617726 | Val: 1.5159777188389996
2-th component log probs | Train: 3.802165268861605 | Val: 1.6254097217586447
3-th component log probs | Train: 4.022339013776003 | Val: -1.055004722741498
4-th component log probs | Train: 4.1010932093269865 | Val: -3.09687348174661
5-th component log probs | Train: 3.9499208294333377 | Val: -0.29281959454544326
6-th component log probs | Train: 4.032934902990586 | Val: -3.082156177369042
7-th component log probs | Train: 4.215792942736122 | Val: -4.131298440871618
8-th component log probs | Train: 3.9699324457701053 | Val: -2.9218788827828472
9-th component log probs | Train: 4.065939100909933 | Val: -3.9571200643488917
KEYWORD NR_SAMPLES:6000 DIM:450 AVG_DIFF:41.4265
Fitting PCA...
0-th component log probs | Train: 4.350873124127016 | Val: -4.86248450007427
1-th component log probs | Train: 3.952498678539891 | Val: 1.357794134458298
2-th component log probs | Train: 3.910609053622869 | Val: 1.4829126474752408
3-th component log probs | Train: 4.122624434266598 | Val: -1.2703592322071573
4-th component log probs | Train: 4.225692974988422 | Val: -3.57168144160398
5-th component log probs | Train: 4.063220800399102 | Val: -0.582290260506334
6-th component log probs | Train: 4.153025121462214 | Val: -3.4955027288956195
7-th component log probs | Train: 4.339311135069778 | Val: -4.72460813995787
8-th component log probs | Train: 4.083608097789905 | Val: -3.4512728253636364
9-th component log probs | Train: 4.186008765256266 | Val: -4.356588146277835
KEYWORD NR_SAMPLES:6000 DIM:500 AVG_DIFF:47.9381
0-th component log probs | Train: 4.379374662536874 | Val: -4.939168868320773
1-th component log probs | Train: 3.9794505105437494 | Val: 1.3143783866560017
2-th component log probs | Train: 3.9382402260628626 | Val: 1.4444466005475165
3-th component log probs | Train: 4.146737964762641 | Val: -1.2995382104166913
4-th component log probs | Train: 4.255749797558183 | Val: -3.6181188131172832
5-th component log probs | Train: 4.089507397849036 | Val: -0.6414258357299961
6-th component log probs | Train: 4.1813978191294465 | Val: -3.5904061629110298
7-th component log probs | Train: 4.367888424261707 | Val: -4.803693954320917
8-th component log probs | Train: 4.111352845093107 | Val: -3.5598322356374803
9-th component log probs | Train: 4.215058196008955 | Val: -4.4303992989734375
KEYWORD NR_SAMPLES:6000 DIM:512 AVG_DIFF:49.2308
best average differences at 50 dimensions: 2.204925231751774
2022-01-10 00:45.57 [info     ] Training complete              train_loss=0.29775339365005493
2022-01-10 00:45.57 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:46.01 [info     ] Testing complete               test_loss=0.5244171619415283
{'dataset_size': 6000,
 'end_test_accuracy': 0.8490606546401978,
 'end_test_loss': 0.5244171619415283,
 'end_train_accuracy': 0.9843195676803589,
 'end_train_loss': 0.29775339365005493,
 'end_val_accuracy': 0.8783086538314819,
 'end_val_loss': 0.5538269281387329}
2022-01-10 00:46.01 [info     ] Start Predict                  dataset=52606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:46.26 [info     ] Starting training              dataset=8000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
8000
Fitting PCA...
0-th component log probs | Train: 2.2290859805358503 | Val: 1.445229846883915
1-th component log probs | Train: 2.2227029108220133 | Val: 1.668996732101526
2-th component log probs | Train: 1.936376568482821 | Val: 1.6160384277496649
3-th component log probs | Train: 1.9893594019743939 | Val: 1.0970146274215067
4-th component log probs | Train: 2.17974935832444 | Val: 1.2925233165179317
5-th component log probs | Train: 2.107223274721958 | Val: 1.2319028552852878
6-th component log probs | Train: 1.9938096935157337 | Val: 1.2348531192494576
7-th component log probs | Train: 2.0626715149730197 | Val: 1.5098593559702143
8-th component log probs | Train: 1.8459119561432544 | Val: 1.113244948737105
9-th component log probs | Train: 2.0997759401233753 | Val: 1.1343503197430087
KEYWORD NR_SAMPLES:8000 DIM:50 AVG_DIFF:0.5724
Fitting PCA...
0-th component log probs | Train: 2.7679652494991838 | Val: 1.4744163497437932
1-th component log probs | Train: 2.7544128192951924 | Val: 1.913373207230914
2-th component log probs | Train: 2.437346372742525 | Val: 1.9423431075076316
3-th component log probs | Train: 2.4948703916128956 | Val: 1.4038216764665261
4-th component log probs | Train: 2.712969141535107 | Val: 1.409917122572313
5-th component log probs | Train: 2.606104782258795 | Val: 1.4638440926396243
6-th component log probs | Train: 2.4939120620592083 | Val: 1.4836225543554855
7-th component log probs | Train: 2.593136614926324 | Val: 1.7118704326890766
8-th component log probs | Train: 2.3492189564542754 | Val: 1.3343819120275437
9-th component log probs | Train: 2.6241892488930056 | Val: 1.2077319077781776
KEYWORD NR_SAMPLES:8000 DIM:100 AVG_DIFF:1.1652
Fitting PCA...
0-th component log probs | Train: 3.0915232301480606 | Val: 1.4309597443311808
1-th component log probs | Train: 3.061658595366457 | Val: 2.120008683225288
2-th component log probs | Train: 2.7335686865766604 | Val: 2.176516936341861
3-th component log probs | Train: 2.7939157277815543 | Val: 1.6599111834740052
4-th component log probs | Train: 3.019594747978357 | Val: 1.4848160610018033
5-th component log probs | Train: 2.9100953831132115 | Val: 1.6526864646195154
6-th component log probs | Train: 2.79540584056881 | Val: 1.6695134981097444
7-th component log probs | Train: 2.904673670580486 | Val: 1.8091062095299122
8-th component log probs | Train: 2.6599261559392615 | Val: 1.5985231168933614
9-th component log probs | Train: 2.936253226886498 | Val: 1.230797973069606
KEYWORD NR_SAMPLES:8000 DIM:150 AVG_DIFF:1.5680
Fitting PCA...
0-th component log probs | Train: 3.3388119001000094 | Val: 1.2351129188485273
1-th component log probs | Train: 3.2891009886939617 | Val: 2.2374843600034873
2-th component log probs | Train: 2.9628235213122824 | Val: 2.346385359546897
3-th component log probs | Train: 3.0198251826998708 | Val: 1.8048347302983239
4-th component log probs | Train: 3.2530185202456647 | Val: 1.5047696613703267
5-th component log probs | Train: 3.139808993090478 | Val: 1.7490952386893974
6-th component log probs | Train: 3.025813266222461 | Val: 1.7472211405945288
7-th component log probs | Train: 3.150685577015814 | Val: 1.8005607700045385
8-th component log probs | Train: 2.8957513574222835 | Val: 1.7519225438904016
9-th component log probs | Train: 3.173701330827681 | Val: 1.2102228069856105
KEYWORD NR_SAMPLES:8000 DIM:200 AVG_DIFF:2.0999
Fitting PCA...
0-th component log probs | Train: 3.5423141765350707 | Val: 1.031243902188363
1-th component log probs | Train: 3.474926511912143 | Val: 2.302523160423675
2-th component log probs | Train: 3.148249850222096 | Val: 2.4549965147258384
3-th component log probs | Train: 3.2015096785187818 | Val: 1.89772949622839
4-th component log probs | Train: 3.4415885711445577 | Val: 1.4433264545533933
5-th component log probs | Train: 3.3225886248391254 | Val: 1.7899479344870681
6-th component log probs | Train: 3.2115613198642676 | Val: 1.7516574196624202
7-th component log probs | Train: 3.348641099651091 | Val: 1.7353628424464478
8-th component log probs | Train: 3.0837956505904653 | Val: 1.857549279557669
9-th component log probs | Train: 3.367955414491823 | Val: 1.1103309530117111
KEYWORD NR_SAMPLES:8000 DIM:250 AVG_DIFF:2.7537
Fitting PCA...
0-th component log probs | Train: 3.7160646891679545 | Val: 0.6570982207223128
1-th component log probs | Train: 3.62874602990844 | Val: 2.3300599353969416
2-th component log probs | Train: 3.302582805283748 | Val: 2.5089845190576705
3-th component log probs | Train: 3.347772078795262 | Val: 1.9494244947263937
4-th component log probs | Train: 3.599515519818121 | Val: 1.3422187063494688
5-th component log probs | Train: 3.4785511278509564 | Val: 1.74685950396111
6-th component log probs | Train: 3.367010148491014 | Val: 1.716446827468892
7-th component log probs | Train: 3.5171701344606205 | Val: 1.5288533612982536
8-th component log probs | Train: 3.2390530666701682 | Val: 1.8843521042054692
9-th component log probs | Train: 3.5340360808152558 | Val: 0.9434698159313394
KEYWORD NR_SAMPLES:8000 DIM:300 AVG_DIFF:3.6947
Fitting PCA...
0-th component log probs | Train: 3.8651261869111058 | Val: 0.36627118131648084
1-th component log probs | Train: 3.7619550497650622 | Val: 2.3059936026699255
2-th component log probs | Train: 3.431937458437111 | Val: 2.5368034478590764
3-th component log probs | Train: 3.4729299845859845 | Val: 1.9345348530169462
4-th component log probs | Train: 3.7404245830102836 | Val: 1.1408055339250338
5-th component log probs | Train: 3.612787504901314 | Val: 1.6632292057568785
6-th component log probs | Train: 3.500971227474238 | Val: 1.6055373897987488
7-th component log probs | Train: 3.666759693193187 | Val: 1.2642555193048248
8-th component log probs | Train: 3.368718121795198 | Val: 1.874837550067055
9-th component log probs | Train: 3.676682982285713 | Val: 0.6773412828951272
KEYWORD NR_SAMPLES:8000 DIM:350 AVG_DIFF:4.8681
Fitting PCA...
0-th component log probs | Train: 3.996032204583654 | Val: 0.08701473379333441
1-th component log probs | Train: 3.8826621595212836 | Val: 2.2299425419873864
2-th component log probs | Train: 3.547894994522294 | Val: 2.5424481388129565
3-th component log probs | Train: 3.585092867296164 | Val: 1.9197549817635724
4-th component log probs | Train: 3.8678307385352397 | Val: 0.8940890247036059
5-th component log probs | Train: 3.734464424184516 | Val: 1.5462502251392962
6-th component log probs | Train: 3.622722566842474 | Val: 1.4683524255343012
7-th component log probs | Train: 3.8040126235490224 | Val: 0.9979154825884845
8-th component log probs | Train: 3.48636779505178 | Val: 1.80167784540454
9-th component log probs | Train: 3.808417782687723 | Val: 0.40929156337470557
KEYWORD NR_SAMPLES:8000 DIM:400 AVG_DIFF:6.2335
Fitting PCA...
0-th component log probs | Train: 4.117252519465623 | Val: -0.2541165924841017
1-th component log probs | Train: 3.9943404364345527 | Val: 2.1870255670106697
2-th component log probs | Train: 3.6546126799082645 | Val: 2.513282872686657
3-th component log probs | Train: 3.6879701692457836 | Val: 1.8556607434340024
4-th component log probs | Train: 3.9854443568827356 | Val: 0.6823027082107649
5-th component log probs | Train: 3.845614012081748 | Val: 1.4095635942742228
6-th component log probs | Train: 3.7379886943768312 | Val: 1.2593382718523747
7-th component log probs | Train: 3.9294238623734814 | Val: 0.6427495497077629
8-th component log probs | Train: 3.5928954728325873 | Val: 1.6924689810966826
9-th component log probs | Train: 3.9306583601648906 | Val: 0.09411333169957954
KEYWORD NR_SAMPLES:8000 DIM:450 AVG_DIFF:7.9157
Fitting PCA...
0-th component log probs | Train: 4.229250332464467 | Val: -0.4810447868716794
1-th component log probs | Train: 4.10008725615839 | Val: 2.146132732074988
2-th component log probs | Train: 3.7578128395783126 | Val: 2.4702549214655276
3-th component log probs | Train: 3.7887613074841093 | Val: 1.78795639040257
4-th component log probs | Train: 4.09663214812406 | Val: 0.5241465606477028
5-th component log probs | Train: 3.9531488597404856 | Val: 1.2719149211468026
6-th component log probs | Train: 3.851385529508421 | Val: 1.0784366594142394
7-th component log probs | Train: 4.050115109567121 | Val: 0.32813098749090386
8-th component log probs | Train: 3.6977107344895477 | Val: 1.5724745592122942
9-th component log probs | Train: 4.048449492001475 | Val: -0.22514457498207097
KEYWORD NR_SAMPLES:8000 DIM:500 AVG_DIFF:9.5940
0-th component log probs | Train: 4.256378765330447 | Val: -0.5191074440908371
1-th component log probs | Train: 4.125671465388169 | Val: 2.1434152041588934
2-th component log probs | Train: 3.783427756957426 | Val: 2.4623091814132185
3-th component log probs | Train: 3.813453730168954 | Val: 1.7742585498042605
4-th component log probs | Train: 4.123732119334024 | Val: 0.502213811113708
5-th component log probs | Train: 3.9789396306345743 | Val: 1.2221825950384182
6-th component log probs | Train: 3.8803793784025413 | Val: 1.049498452336214
7-th component log probs | Train: 4.077704236776083 | Val: 0.28462325963400276
8-th component log probs | Train: 3.723502706135297 | Val: 1.5413506024274268
9-th component log probs | Train: 4.0765779497500825 | Val: -0.28978606386213573
KEYWORD NR_SAMPLES:8000 DIM:512 AVG_DIFF:9.9582
best average differences at 50 dimensions: 0.5723736514631298
2022-01-10 00:57.26 [info     ] Training complete              train_loss=0.3642941415309906
2022-01-10 00:57.26 [info     ] Starting evaluating            dataset=26032
2022-01-10 00:57.30 [info     ] Testing complete               test_loss=0.4899880588054657
{'dataset_size': 8000,
 'end_test_accuracy': 0.8524903059005737,
 'end_test_loss': 0.4899880588054657,
 'end_train_accuracy': 0.9668750166893005,
 'end_train_loss': 0.3642941415309906,
 'end_val_accuracy': 0.8746750354766846,
 'end_val_loss': 0.6181964874267578}
2022-01-10 00:57.30 [info     ] Start Predict                  dataset=50606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 00:57.56 [info     ] Starting training              dataset=10000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
10000
Fitting PCA...
0-th component log probs | Train: 2.2147691955435693 | Val: 1.4091275994605954
1-th component log probs | Train: 1.9621604843551408 | Val: 1.6453421539526845
2-th component log probs | Train: 2.024715415371793 | Val: 1.7182778956070701
3-th component log probs | Train: 1.9240293305977436 | Val: 1.4325587138211062
4-th component log probs | Train: 1.9790950916149401 | Val: 1.5074403949290265
5-th component log probs | Train: 2.0202938620396673 | Val: 1.5357791149242193
6-th component log probs | Train: 2.0343466518328523 | Val: 1.2185445826428132
7-th component log probs | Train: 1.9432115454878502 | Val: 1.5984142025142947
8-th component log probs | Train: 2.0910040038511304 | Val: 0.9768841767300763
9-th component log probs | Train: 1.9115005255524993 | Val: 1.385757383222852
KEYWORD NR_SAMPLES:10000 DIM:50 AVG_DIFF:0.3844
Fitting PCA...
0-th component log probs | Train: 2.7451979789909817 | Val: 1.6422398325748375
1-th component log probs | Train: 2.447669909308862 | Val: 2.0879134037553824
2-th component log probs | Train: 2.553909492701031 | Val: 2.104658069272088
3-th component log probs | Train: 2.427656879483583 | Val: 1.8309401416346747
4-th component log probs | Train: 2.506814259165264 | Val: 1.8044216720148496
5-th component log probs | Train: 2.5121375519579305 | Val: 1.8998145416611738
6-th component log probs | Train: 2.522296440789796 | Val: 1.4477888722645846
7-th component log probs | Train: 2.455025809660717 | Val: 1.916552669760477
8-th component log probs | Train: 2.6063721260455197 | Val: 1.0408104278511
9-th component log probs | Train: 2.419663072021837 | Val: 1.6803721516893337
KEYWORD NR_SAMPLES:10000 DIM:100 AVG_DIFF:0.7214
Fitting PCA...
0-th component log probs | Train: 3.0490725382063113 | Val: 1.8015510468021072
1-th component log probs | Train: 2.7304526786684447 | Val: 2.3481737364594584
2-th component log probs | Train: 2.8471294714205655 | Val: 2.3475934649325487
3-th component log probs | Train: 2.7199076848366133 | Val: 2.115285267611434
4-th component log probs | Train: 2.8041423599980146 | Val: 2.0283923952263523
5-th component log probs | Train: 2.802537049759044 | Val: 2.099146146323225
6-th component log probs | Train: 2.812364957646811 | Val: 1.5977361264106817
7-th component log probs | Train: 2.7556994869627314 | Val: 2.092700488876389
8-th component log probs | Train: 2.9043698094904125 | Val: 1.2313133750679175
9-th component log probs | Train: 2.7221964725542063 | Val: 1.8574679888163026
KEYWORD NR_SAMPLES:10000 DIM:150 AVG_DIFF:0.8876
Fitting PCA...
0-th component log probs | Train: 3.2832043393178667 | Val: 1.8350820610403913
1-th component log probs | Train: 2.9513141258833486 | Val: 2.546337589884087
2-th component log probs | Train: 3.0717185574046577 | Val: 2.517543922630164
3-th component log probs | Train: 2.9439905394865553 | Val: 2.3020950316735624
4-th component log probs | Train: 3.030605815345748 | Val: 2.208198076969511
5-th component log probs | Train: 3.0275992695621263 | Val: 2.2350077254349783
6-th component log probs | Train: 3.0433510146028224 | Val: 1.6665683302647747
7-th component log probs | Train: 2.998091875408523 | Val: 2.2122524285448577
8-th component log probs | Train: 3.135818246803669 | Val: 1.3088745974282614
9-th component log probs | Train: 2.958882683124208 | Val: 1.968372555890164
KEYWORD NR_SAMPLES:10000 DIM:200 AVG_DIFF:1.1117
Fitting PCA...
0-th component log probs | Train: 3.4708621563729265 | Val: 1.8045443910323224
1-th component log probs | Train: 3.132125794143008 | Val: 2.6862582436081524
2-th component log probs | Train: 3.251337299938803 | Val: 2.65963682749765
3-th component log probs | Train: 3.1242209095493587 | Val: 2.438491297231952
4-th component log probs | Train: 3.213989965151028 | Val: 2.337245401721333
5-th component log probs | Train: 3.2111382460616986 | Val: 2.31546935609537
6-th component log probs | Train: 3.2276625499635214 | Val: 1.678937798262689
7-th component log probs | Train: 3.1990261099374235 | Val: 2.250948887066566
8-th component log probs | Train: 3.3190034122035805 | Val: 1.3402060264478979
9-th component log probs | Train: 3.1471055062561026 | Val: 2.0468380765148204
KEYWORD NR_SAMPLES:10000 DIM:250 AVG_DIFF:1.3790
Fitting PCA...
0-th component log probs | Train: 3.6297367545522725 | Val: 1.7282908501761511
1-th component log probs | Train: 3.27827932403856 | Val: 2.7904312308461954
2-th component log probs | Train: 3.3980601426619454 | Val: 2.7542488959731286
3-th component log probs | Train: 3.2708655471636217 | Val: 2.534764990752272
4-th component log probs | Train: 3.365557894176266 | Val: 2.393622073076226
5-th component log probs | Train: 3.363488813646937 | Val: 2.364768150772468
6-th component log probs | Train: 3.3833395080211544 | Val: 1.6219141096229075
7-th component log probs | Train: 3.3652944603296198 | Val: 2.2229835705296375
8-th component log probs | Train: 3.469829810803684 | Val: 1.2883992647252442
9-th component log probs | Train: 3.3051186556830006 | Val: 2.0270736399885667
KEYWORD NR_SAMPLES:10000 DIM:300 AVG_DIFF:1.7551
Fitting PCA...
0-th component log probs | Train: 3.7668587257245645 | Val: 1.5693522520496355
1-th component log probs | Train: 3.403072709742065 | Val: 2.864767486220053
2-th component log probs | Train: 3.5228005596650838 | Val: 2.811318889452848
3-th component log probs | Train: 3.3949529670462932 | Val: 2.601356831712879
4-th component log probs | Train: 3.4931050247649025 | Val: 2.4277544896902925
5-th component log probs | Train: 3.4955216562230236 | Val: 2.3716239449085874
6-th component log probs | Train: 3.5174420841756975 | Val: 1.4878976845285863
7-th component log probs | Train: 3.511974301803284 | Val: 2.118792640425728
8-th component log probs | Train: 3.602355021318557 | Val: 1.220877384933091
9-th component log probs | Train: 3.4412050080684953 | Val: 1.976318595253089
KEYWORD NR_SAMPLES:10000 DIM:350 AVG_DIFF:2.2530
Fitting PCA...
0-th component log probs | Train: 3.8897102212004913 | Val: 1.426523230261879
1-th component log probs | Train: 3.513457536920637 | Val: 2.91239257532878
2-th component log probs | Train: 3.6340797931644273 | Val: 2.8482836268616563
3-th component log probs | Train: 3.5047722370998478 | Val: 2.6473168805186855
4-th component log probs | Train: 3.6052349634477543 | Val: 2.43620246069656
5-th component log probs | Train: 3.6140666802874937 | Val: 2.3261463029598617
6-th component log probs | Train: 3.638430515726529 | Val: 1.3177891488822095
7-th component log probs | Train: 3.64265282811044 | Val: 1.9827155225769992
8-th component log probs | Train: 3.721102484744014 | Val: 1.1027057675480032
9-th component log probs | Train: 3.5646161014691207 | Val: 1.857434852103381
KEYWORD NR_SAMPLES:10000 DIM:400 AVG_DIFF:2.8718
Fitting PCA...
0-th component log probs | Train: 4.002200019803077 | Val: 1.2441679130365844
1-th component log probs | Train: 3.6114535676947157 | Val: 2.946168200021199
2-th component log probs | Train: 3.734543346590936 | Val: 2.8559218398785813
3-th component log probs | Train: 3.6016471480023826 | Val: 2.677681884368293
4-th component log probs | Train: 3.7075523875126093 | Val: 2.416222016517523
5-th component log probs | Train: 3.724021793235373 | Val: 2.2745963406141074
6-th component log probs | Train: 3.749779107005296 | Val: 1.1030545247325785
7-th component log probs | Train: 3.7634291350878337 | Val: 1.7772050943110982
8-th component log probs | Train: 3.8278577308680406 | Val: 0.9452652141590661
9-th component log probs | Train: 3.675790384791229 | Val: 1.7113892892581735
KEYWORD NR_SAMPLES:10000 DIM:450 AVG_DIFF:3.6562
Fitting PCA...
0-th component log probs | Train: 4.109713234820152 | Val: 1.1043231819366075
1-th component log probs | Train: 3.7058348273525823 | Val: 2.977545333898164
2-th component log probs | Train: 3.8302135531568924 | Val: 2.8625694565576407
3-th component log probs | Train: 3.695592058196179 | Val: 2.708749797506651
4-th component log probs | Train: 3.8040972154816886 | Val: 2.382592753759291
5-th component log probs | Train: 3.830542593534465 | Val: 2.187999903392038
6-th component log probs | Train: 3.86080833887909 | Val: 0.8896749775332568
7-th component log probs | Train: 3.879376099101068 | Val: 1.572929254156227
8-th component log probs | Train: 3.932479034296574 | Val: 0.7701924345021262
9-th component log probs | Train: 3.7851906552028756 | Val: 1.55555641964569
KEYWORD NR_SAMPLES:10000 DIM:500 AVG_DIFF:4.5310
0-th component log probs | Train: 4.1346679945984945 | Val: 1.0980606803210706
1-th component log probs | Train: 3.7276008892467076 | Val: 2.986374696057522
2-th component log probs | Train: 3.8534419506328788 | Val: 2.869610298989013
3-th component log probs | Train: 3.718920571455308 | Val: 2.7144869893434413
4-th component log probs | Train: 3.828255982950906 | Val: 2.3845111148445577
5-th component log probs | Train: 3.855639097640352 | Val: 2.185188456847413
6-th component log probs | Train: 3.8870959537193577 | Val: 0.848152185923509
7-th component log probs | Train: 3.9074128156094523 | Val: 1.530770906140016
8-th component log probs | Train: 3.958190908267143 | Val: 0.7457482651175026
9-th component log probs | Train: 3.811223343488558 | Val: 1.5150849445490844
KEYWORD NR_SAMPLES:10000 DIM:512 AVG_DIFF:4.7098
best average differences at 50 dimensions: 0.38441793142779845
2022-01-10 01:10.48 [info     ] Training complete              train_loss=0.36757975816726685
2022-01-10 01:10.48 [info     ] Starting evaluating            dataset=26032
2022-01-10 01:10.52 [info     ] Testing complete               test_loss=0.4097205400466919
{'dataset_size': 10000,
 'end_test_accuracy': 0.8772266507148743,
 'end_test_loss': 0.4097205400466919,
 'end_train_accuracy': 0.9695461988449097,
 'end_train_loss': 0.36757975816726685,
 'end_val_accuracy': 0.8886115550994873,
 'end_val_loss': 0.5352597236633301}
2022-01-10 01:10.52 [info     ] Start Predict                  dataset=48606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 01:11.23 [info     ] Starting training              dataset=20000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
20000
Fitting PCA...
0-th component log probs | Train: 1.952245680497616 | Val: 1.6672093898082982
1-th component log probs | Train: 1.8336189506648477 | Val: 1.7033396317249605
2-th component log probs | Train: 2.0082764157439845 | Val: 1.6724914114117604
3-th component log probs | Train: 1.9223026646373944 | Val: 1.4302265203083706
4-th component log probs | Train: 2.001886419065899 | Val: 1.7526843534732452
5-th component log probs | Train: 2.0057478109091984 | Val: 1.5186049448442114
6-th component log probs | Train: 1.9764073116724694 | Val: 1.5403222386557702
7-th component log probs | Train: 2.1853948912433236 | Val: 1.5592118616862063
8-th component log probs | Train: 2.080909014666509 | Val: 1.2384669024037622
9-th component log probs | Train: 1.9719664667504953 | Val: 1.4981405503301577
KEYWORD NR_SAMPLES:20000 DIM:50 AVG_DIFF:0.2269
Fitting PCA...
0-th component log probs | Train: 2.481740700461123 | Val: 2.0541859379509426
1-th component log probs | Train: 2.3791218847924935 | Val: 2.2206094714577382
2-th component log probs | Train: 2.551005577979704 | Val: 2.1283002791967287
3-th component log probs | Train: 2.466558398659668 | Val: 1.8851267704692642
4-th component log probs | Train: 2.5459995552009937 | Val: 2.1419658612719816
5-th component log probs | Train: 2.541855402060586 | Val: 1.9674878258944868
6-th component log probs | Train: 2.505346512025366 | Val: 1.9321948837081535
7-th component log probs | Train: 2.723675064894027 | Val: 1.7991080807495898
8-th component log probs | Train: 2.6341022337532003 | Val: 1.5157402044518606
9-th component log probs | Train: 2.4922968021278464 | Val: 1.848957210910498
KEYWORD NR_SAMPLES:20000 DIM:100 AVG_DIFF:0.4066
Fitting PCA...
0-th component log probs | Train: 2.760175113794756 | Val: 2.3186479828484643
1-th component log probs | Train: 2.6626151554433473 | Val: 2.5086888451251457
2-th component log probs | Train: 2.8279638129861087 | Val: 2.413278412975768
3-th component log probs | Train: 2.754888637280992 | Val: 2.186435834800078
4-th component log probs | Train: 2.8376763723092164 | Val: 2.387658975140009
5-th component log probs | Train: 2.8121060956328905 | Val: 2.2526896953515196
6-th component log probs | Train: 2.784171983849072 | Val: 2.1688080298872072
7-th component log probs | Train: 3.008353309026426 | Val: 1.9904222588300213
8-th component log probs | Train: 2.9153250129997805 | Val: 1.7737525657259456
9-th component log probs | Train: 2.770214656828758 | Val: 2.0764507856617422
KEYWORD NR_SAMPLES:20000 DIM:150 AVG_DIFF:0.4429
Fitting PCA...
0-th component log probs | Train: 2.9667286138862017 | Val: 2.508293303140016
1-th component log probs | Train: 2.8698506509571806 | Val: 2.714460259322916
2-th component log probs | Train: 3.031301509377922 | Val: 2.614053635633582
3-th component log probs | Train: 2.9647363557610733 | Val: 2.399364093596612
4-th component log probs | Train: 3.049354804715522 | Val: 2.575612123931319
5-th component log probs | Train: 3.0195627683396076 | Val: 2.450011572592275
6-th component log probs | Train: 2.996603194368625 | Val: 2.3644441724976404
7-th component log probs | Train: 3.2207376404948547 | Val: 2.0921114276966857
8-th component log probs | Train: 3.1258611372759817 | Val: 1.9642658473344652
9-th component log probs | Train: 2.9815862839288947 | Val: 2.228545574286104
KEYWORD NR_SAMPLES:20000 DIM:200 AVG_DIFF:0.4867
Fitting PCA...
0-th component log probs | Train: 3.1387653330817633 | Val: 2.649696626137522
1-th component log probs | Train: 3.044996979917236 | Val: 2.880019569368802
2-th component log probs | Train: 3.2006576028250984 | Val: 2.77775015048991
3-th component log probs | Train: 3.142133774057223 | Val: 2.5504394038970077
4-th component log probs | Train: 3.232076314690441 | Val: 2.703793166624994
5-th component log probs | Train: 3.192228184597545 | Val: 2.6008133918139276
6-th component log probs | Train: 3.1737453066210084 | Val: 2.4780534883816614
7-th component log probs | Train: 3.4066290350201434 | Val: 2.1110860144116805
8-th component log probs | Train: 3.301964140348927 | Val: 2.0992745556801222
9-th component log probs | Train: 3.161636367856017 | Val: 2.3314072006736666
KEYWORD NR_SAMPLES:20000 DIM:250 AVG_DIFF:0.5722
Fitting PCA...
0-th component log probs | Train: 3.2866384737324905 | Val: 2.760725939209444
1-th component log probs | Train: 3.1910174871759964 | Val: 3.0182312255084547
2-th component log probs | Train: 3.3456584954194666 | Val: 2.910099612865586
3-th component log probs | Train: 3.2896281083154393 | Val: 2.671737158555452
4-th component log probs | Train: 3.383834867586693 | Val: 2.793109720792985
5-th component log probs | Train: 3.3371725819828515 | Val: 2.712101901444968
6-th component log probs | Train: 3.3229143340670855 | Val: 2.5712081754566194
7-th component log probs | Train: 3.564108681064573 | Val: 2.1127299532355637
8-th component log probs | Train: 3.449342393681217 | Val: 2.1778183269719644
9-th component log probs | Train: 3.315605983290845 | Val: 2.3879722108150094
KEYWORD NR_SAMPLES:20000 DIM:300 AVG_DIFF:0.6766
Fitting PCA...
0-th component log probs | Train: 3.4120830961268607 | Val: 2.8552906858460343
1-th component log probs | Train: 3.3156721293371 | Val: 3.131132021712925
2-th component log probs | Train: 3.4699354078954148 | Val: 3.0157890630337563
3-th component log probs | Train: 3.415743419813619 | Val: 2.7587337687135816
4-th component log probs | Train: 3.511981327884754 | Val: 2.8704956638172647
5-th component log probs | Train: 3.461429084456632 | Val: 2.81621158172887
6-th component log probs | Train: 3.451753017259072 | Val: 2.6388447947282545
7-th component log probs | Train: 3.701350921790098 | Val: 2.0532753799270127
8-th component log probs | Train: 3.5769319885118183 | Val: 2.212759669065554
9-th component log probs | Train: 3.4456406558030075 | Val: 2.431669066493073
KEYWORD NR_SAMPLES:20000 DIM:350 AVG_DIFF:0.8076
Fitting PCA...
0-th component log probs | Train: 3.5220637923873137 | Val: 2.923506403718612
1-th component log probs | Train: 3.423183662495385 | Val: 3.2275647683835915
2-th component log probs | Train: 3.577579408588212 | Val: 3.09877602900671
3-th component log probs | Train: 3.5252243026988634 | Val: 2.83322902965729
4-th component log probs | Train: 3.625182010040977 | Val: 2.9251187460214116
5-th component log probs | Train: 3.5724000296463028 | Val: 2.8871468295974947
6-th component log probs | Train: 3.564458737377109 | Val: 2.6575157440072985
7-th component log probs | Train: 3.8230032201270667 | Val: 1.975230336719091
8-th component log probs | Train: 3.690513339401964 | Val: 2.235070345779183
9-th component log probs | Train: 3.5622606938287116 | Val: 2.453593040319926
KEYWORD NR_SAMPLES:20000 DIM:400 AVG_DIFF:0.9649
Fitting PCA...
0-th component log probs | Train: 3.6220388361656273 | Val: 2.9786767626320887
1-th component log probs | Train: 3.5194960793537717 | Val: 3.3059719938917618
2-th component log probs | Train: 3.674731198730027 | Val: 3.1658097898440363
3-th component log probs | Train: 3.6234537249235634 | Val: 2.883851170897411
4-th component log probs | Train: 3.7277239653951533 | Val: 2.952863094354114
5-th component log probs | Train: 3.67148413379381 | Val: 2.9275666266906186
6-th component log probs | Train: 3.6683278238233146 | Val: 2.6909201676354457
7-th component log probs | Train: 3.932669054993062 | Val: 1.9450588285571158
8-th component log probs | Train: 3.7914992263610237 | Val: 2.244621340799548
9-th component log probs | Train: 3.6670014780324007 | Val: 2.442737510765121
KEYWORD NR_SAMPLES:20000 DIM:450 AVG_DIFF:1.1217
Fitting PCA...
0-th component log probs | Train: 3.7200596148028393 | Val: 3.0225819648953673
1-th component log probs | Train: 3.6127885813718903 | Val: 3.3866285899132493
2-th component log probs | Train: 3.7675576022359794 | Val: 3.237274086036037
3-th component log probs | Train: 3.7163086687515374 | Val: 2.947314086034755
4-th component log probs | Train: 3.822388580335501 | Val: 2.9966932174667416
5-th component log probs | Train: 3.769973370663719 | Val: 2.9735121673028497
6-th component log probs | Train: 3.769974636192738 | Val: 2.7377409120072542
7-th component log probs | Train: 4.034878746071324 | Val: 1.9348171670760812
8-th component log probs | Train: 3.8875544297838758 | Val: 2.264580144919076
9-th component log probs | Train: 3.766756486050846 | Val: 2.461229723287479
KEYWORD NR_SAMPLES:20000 DIM:500 AVG_DIFF:1.2541
0-th component log probs | Train: 3.744654955623982 | Val: 3.046594055873358
1-th component log probs | Train: 3.637488281796283 | Val: 3.4100201912674577
2-th component log probs | Train: 3.7915381884261308 | Val: 3.261229802460232
3-th component log probs | Train: 3.7407149748750643 | Val: 2.9730439275777045
4-th component log probs | Train: 3.8458844822529907 | Val: 3.017759099086161
5-th component log probs | Train: 3.7962868416955726 | Val: 2.996205152477142
6-th component log probs | Train: 3.7962549239582404 | Val: 2.7605377406672194
7-th component log probs | Train: 4.059310171257818 | Val: 1.9545060694878915
8-th component log probs | Train: 3.9107365359923194 | Val: 2.2936397897286698
9-th component log probs | Train: 3.7931378495722545 | Val: 2.4833732057762146
KEYWORD NR_SAMPLES:20000 DIM:512 AVG_DIFF:1.2569
best average differences at 50 dimensions: 0.22690138193577342
2022-01-10 01:34.48 [info     ] Training complete              train_loss=0.33897367119789124
2022-01-10 01:34.48 [info     ] Starting evaluating            dataset=26032
2022-01-10 01:34.52 [info     ] Testing complete               test_loss=0.3331139385700226
{'dataset_size': 20000,
 'end_test_accuracy': 0.9008625745773315,
 'end_test_loss': 0.3331139385700226,
 'end_train_accuracy': 0.9667032957077026,
 'end_train_loss': 0.33897367119789124,
 'end_val_accuracy': 0.9054705500602722,
 'end_val_loss': 0.4436323642730713}
2022-01-10 01:34.52 [info     ] Start Predict                  dataset=38606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 01:35.30 [info     ] Starting training              dataset=30000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
30000
Fitting PCA...
0-th component log probs | Train: 2.1587005213994206 | Val: 1.5545839749820427
1-th component log probs | Train: 2.0231151677230317 | Val: 1.3794886831111908
2-th component log probs | Train: 2.038087050823869 | Val: 1.352110933614878
3-th component log probs | Train: 2.00953296602834 | Val: 1.184855945303226
4-th component log probs | Train: 1.9598177116119315 | Val: 1.3800025419432917
5-th component log probs | Train: 2.0341283082427895 | Val: 1.1166435140459416
6-th component log probs | Train: 2.092236220938844 | Val: 1.0917526278720746
7-th component log probs | Train: 2.069793778585685 | Val: 1.2568987987751044
8-th component log probs | Train: 2.1159551522671913 | Val: 0.7650920361458183
9-th component log probs | Train: 2.1440046389118734 | Val: 1.010829466302217
KEYWORD NR_SAMPLES:30000 DIM:50 AVG_DIFF:0.7879
Fitting PCA...
0-th component log probs | Train: 2.7572655441192366 | Val: 1.8187640216228715
1-th component log probs | Train: 2.617967085200058 | Val: 1.8411687334365476
2-th component log probs | Train: 2.6258832858152332 | Val: 1.819252963157809
3-th component log probs | Train: 2.593603644899493 | Val: 1.494153102020391
4-th component log probs | Train: 2.5308051227901824 | Val: 1.8469269847508065
5-th component log probs | Train: 2.62103349094592 | Val: 1.4557547910172428
6-th component log probs | Train: 2.679131399049276 | Val: 1.4869917885530257
7-th component log probs | Train: 2.6606395753580365 | Val: 1.6374071188060355
8-th component log probs | Train: 2.717517117845661 | Val: 0.5421389028299631
9-th component log probs | Train: 2.7485173053495218 | Val: 0.873244070993468
KEYWORD NR_SAMPLES:30000 DIM:100 AVG_DIFF:1.5886
Fitting PCA...
0-th component log probs | Train: 3.0264439011875828 | Val: 2.077074019330909
1-th component log probs | Train: 2.893996281444315 | Val: 2.136716459140477
2-th component log probs | Train: 2.892922616703829 | Val: 2.1420322218497976
3-th component log probs | Train: 2.868280853211658 | Val: 1.8248562241259065
4-th component log probs | Train: 2.806510796463205 | Val: 2.1733810284585835
5-th component log probs | Train: 2.88308939601352 | Val: 1.7793267454512145
6-th component log probs | Train: 2.956124629891392 | Val: 1.7801270065995818
7-th component log probs | Train: 2.9305263469827696 | Val: 1.8954200680761724
8-th component log probs | Train: 2.9940155628446505 | Val: 0.7614878973844466
9-th component log probs | Train: 3.025313802952903 | Val: 1.0998929132183715
KEYWORD NR_SAMPLES:30000 DIM:150 AVG_DIFF:1.5892
Fitting PCA...
0-th component log probs | Train: 3.220768165985328 | Val: 2.259299846842549
1-th component log probs | Train: 3.0949645224686404 | Val: 2.3270653660133087
2-th component log probs | Train: 3.089730099186971 | Val: 2.359647755200847
3-th component log probs | Train: 3.0704912638481208 | Val: 2.0361631800365956
4-th component log probs | Train: 3.006729373162553 | Val: 2.3728350755375964
5-th component log probs | Train: 3.0745674048518037 | Val: 1.9965240270245166
6-th component log probs | Train: 3.1565775779782426 | Val: 1.929104085297388
7-th component log probs | Train: 3.1283788632707528 | Val: 2.101572897748024
8-th component log probs | Train: 3.1900275025207527 | Val: 0.9446501178742198
9-th component log probs | Train: 3.231633339222037 | Val: 1.0679826979428864
KEYWORD NR_SAMPLES:30000 DIM:200 AVG_DIFF:1.6965
Fitting PCA...
0-th component log probs | Train: 3.3859254119479627 | Val: 2.4159472971441476
1-th component log probs | Train: 3.2662015691639503 | Val: 2.48187937557993
2-th component log probs | Train: 3.257939782704736 | Val: 2.5333064528244225
3-th component log probs | Train: 3.242853571391469 | Val: 2.1945894879231145
4-th component log probs | Train: 3.1763432721811524 | Val: 2.5307273184431014
5-th component log probs | Train: 3.240448814716921 | Val: 2.14785416658155
6-th component log probs | Train: 3.327420850115386 | Val: 2.0279192997651574
7-th component log probs | Train: 3.2985049830255537 | Val: 2.224238615749042
8-th component log probs | Train: 3.3573909898168055 | Val: 1.1093497770509908
9-th component log probs | Train: 3.407477399654504 | Val: 1.1614232926268864
KEYWORD NR_SAMPLES:30000 DIM:250 AVG_DIFF:1.7732
Fitting PCA...
0-th component log probs | Train: 3.5291097977530543 | Val: 2.52761089219662
1-th component log probs | Train: 3.41368221725848 | Val: 2.6115677052197084
2-th component log probs | Train: 3.4031752872496948 | Val: 2.6657329667657352
3-th component log probs | Train: 3.3896880626605674 | Val: 2.3291461080350158
4-th component log probs | Train: 3.3214066065289853 | Val: 2.660491717497547
5-th component log probs | Train: 3.385332472592865 | Val: 2.2608192135572605
6-th component log probs | Train: 3.477034527717047 | Val: 2.0775845915956923
7-th component log probs | Train: 3.4463169370286404 | Val: 2.3161297536035845
8-th component log probs | Train: 3.5031450989442128 | Val: 1.2055954952471504
9-th component log probs | Train: 3.560697047347281 | Val: 1.1162535525167832
KEYWORD NR_SAMPLES:30000 DIM:300 AVG_DIFF:1.9506
Fitting PCA...
0-th component log probs | Train: 3.655386070568388 | Val: 2.622705305621754
1-th component log probs | Train: 3.5424529472793096 | Val: 2.7083133454937736
2-th component log probs | Train: 3.5294953949666183 | Val: 2.771449439267684
3-th component log probs | Train: 3.517898895820147 | Val: 2.43311520314195
4-th component log probs | Train: 3.4458185953848957 | Val: 2.775071424130645
5-th component log probs | Train: 3.514570613057265 | Val: 2.3680251506942223
6-th component log probs | Train: 3.608797693796622 | Val: 2.09511242011541
7-th component log probs | Train: 3.576101731205193 | Val: 2.395347747377003
8-th component log probs | Train: 3.6316557984851254 | Val: 1.2537444165269593
9-th component log probs | Train: 3.6951895975531523 | Val: 1.018047385587826
KEYWORD NR_SAMPLES:30000 DIM:350 AVG_DIFF:2.1785
Fitting PCA...
0-th component log probs | Train: 3.7682086954100282 | Val: 2.6752020043093006
1-th component log probs | Train: 3.6580856442734366 | Val: 2.800101100320613
2-th component log probs | Train: 3.641643553121155 | Val: 2.866267218213733
3-th component log probs | Train: 3.6328431576190714 | Val: 2.497579183833457
4-th component log probs | Train: 3.5562106914336216 | Val: 2.8661446659112757
5-th component log probs | Train: 3.6285581875432023 | Val: 2.447054069287778
6-th component log probs | Train: 3.724624559287592 | Val: 2.1587390511684883
7-th component log probs | Train: 3.6911968535996293 | Val: 2.44725599434453
8-th component log probs | Train: 3.74579143324167 | Val: 1.2747981085944102
9-th component log probs | Train: 3.816112431161282 | Val: 0.8687617082826402
KEYWORD NR_SAMPLES:30000 DIM:400 AVG_DIFF:2.4485
Fitting PCA...
0-th component log probs | Train: 3.8730963624269528 | Val: 2.743458782263439
1-th component log probs | Train: 3.7644460985191963 | Val: 2.868127242044841
2-th component log probs | Train: 3.7458218943829125 | Val: 2.947423769702902
3-th component log probs | Train: 3.7405857618089184 | Val: 2.563429256517847
4-th component log probs | Train: 3.6582677646816624 | Val: 2.9392889753747715
5-th component log probs | Train: 3.737070422870907 | Val: 2.4901104912590646
6-th component log probs | Train: 3.8337733047261087 | Val: 2.199839019506756
7-th component log probs | Train: 3.798233995727352 | Val: 2.4976682267074124
8-th component log probs | Train: 3.8504534025702943 | Val: 1.285830730616661
9-th component log probs | Train: 3.927344466058012 | Val: 0.7647148814456777
KEYWORD NR_SAMPLES:30000 DIM:450 AVG_DIFF:2.7115
Fitting PCA...
0-th component log probs | Train: 3.971522332750346 | Val: 2.845323731236035
1-th component log probs | Train: 3.8708089910491172 | Val: 2.959036451931597
2-th component log probs | Train: 3.8491971811444237 | Val: 3.0530511129160813
3-th component log probs | Train: 3.8453681452391555 | Val: 2.6575793257687224
4-th component log probs | Train: 3.761700031640035 | Val: 3.031203906146193
5-th component log probs | Train: 3.841915751189558 | Val: 2.580900304678629
6-th component log probs | Train: 3.9391766438941307 | Val: 2.2952172335300793
7-th component log probs | Train: 3.9028696320779024 | Val: 2.5879587839716662
8-th component log probs | Train: 3.9515702731554896 | Val: 1.4109174605271468
9-th component log probs | Train: 4.030445550685956 | Val: 0.875293967481144
KEYWORD NR_SAMPLES:30000 DIM:500 AVG_DIFF:2.7110
0-th component log probs | Train: 4.0008144892287625 | Val: 2.8904794500543285
1-th component log probs | Train: 3.9007546977423235 | Val: 3.001727239612683
2-th component log probs | Train: 3.8800463452377123 | Val: 3.0959274446848046
3-th component log probs | Train: 3.8763943883071237 | Val: 2.7067238174253663
4-th component log probs | Train: 3.792215134530547 | Val: 3.0708384949212992
5-th component log probs | Train: 3.871396603249352 | Val: 2.632546490579267
6-th component log probs | Train: 3.969151954097992 | Val: 2.3498141401634722
7-th component log probs | Train: 3.932078401439728 | Val: 2.6378042365173635
8-th component log probs | Train: 3.981053577435848 | Val: 1.4837160413052408
9-th component log probs | Train: 4.059386989378172 | Val: 0.9566121696074547
KEYWORD NR_SAMPLES:30000 DIM:512 AVG_DIFF:2.6241
best average differences at 50 dimensions: 0.7878514052315644
2022-01-10 02:13.25 [info     ] Training complete              train_loss=0.23698343336582184
2022-01-10 02:13.25 [info     ] Starting evaluating            dataset=26032
2022-01-10 02:13.29 [info     ] Testing complete               test_loss=0.30247440934181213
{'dataset_size': 30000,
 'end_test_accuracy': 0.9113559722900391,
 'end_test_loss': 0.30247440934181213,
 'end_train_accuracy': 0.9884839057922363,
 'end_train_loss': 0.23698343336582184,
 'end_val_accuracy': 0.9276515245437622,
 'end_val_loss': 0.3307598829269409}
2022-01-10 02:13.29 [info     ] Start Predict                  dataset=28606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 02:14.03 [info     ] Starting training              dataset=40000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
40000
Fitting PCA...
0-th component log probs | Train: 1.9574775220266534 | Val: 1.7204518086057454
1-th component log probs | Train: 1.827242647401436 | Val: 1.7002338457726356
2-th component log probs | Train: 1.8569673168890768 | Val: 1.6191382850192821
3-th component log probs | Train: 1.913392676722142 | Val: 1.4875022215463463
4-th component log probs | Train: 2.0207493920026334 | Val: 1.6070391589742015
5-th component log probs | Train: 2.092838588252166 | Val: 1.411032610107347
6-th component log probs | Train: 1.9558440130031443 | Val: 1.5260918081475483
7-th component log probs | Train: 2.071076769734179 | Val: 1.5396241850294659
8-th component log probs | Train: 1.9481611234472849 | Val: 1.3634654680470002
9-th component log probs | Train: 2.068639539008958 | Val: 1.423936446214358
KEYWORD NR_SAMPLES:40000 DIM:50 AVG_DIFF:0.2171
Fitting PCA...
0-th component log probs | Train: 2.5489109815560993 | Val: 2.216979446451764
1-th component log probs | Train: 2.4055091165212175 | Val: 2.2601964151110967
2-th component log probs | Train: 2.434598292544644 | Val: 2.20175380953763
3-th component log probs | Train: 2.500515739735551 | Val: 1.9889418316788527
4-th component log probs | Train: 2.606475029493045 | Val: 2.1213981798182444
5-th component log probs | Train: 2.6888541847933816 | Val: 1.8743258431095122
6-th component log probs | Train: 2.5428398529716585 | Val: 2.003208210720648
7-th component log probs | Train: 2.6540996690556216 | Val: 2.0724631242821205
8-th component log probs | Train: 2.537616968533282 | Val: 1.7661185073187764
9-th component log probs | Train: 2.65424184820447 | Val: 1.8678472361208127
KEYWORD NR_SAMPLES:40000 DIM:100 AVG_DIFF:0.3189
Fitting PCA...
0-th component log probs | Train: 2.8292116718105462 | Val: 2.493456220833643
1-th component log probs | Train: 2.6962592296118006 | Val: 2.560309914981262
2-th component log probs | Train: 2.7241115953870554 | Val: 2.510058163848377
3-th component log probs | Train: 2.7829229373938573 | Val: 2.29806732551268
4-th component log probs | Train: 2.886545020113102 | Val: 2.4147529779842616
5-th component log probs | Train: 2.9684438450406287 | Val: 2.1906494032048034
6-th component log probs | Train: 2.8300896838844585 | Val: 2.3053632070723373
7-th component log probs | Train: 2.9307391750011065 | Val: 2.368384024407852
8-th component log probs | Train: 2.822383338533504 | Val: 2.0617995788155334
9-th component log probs | Train: 2.9321837881583446 | Val: 2.1850920435941217
KEYWORD NR_SAMPLES:40000 DIM:150 AVG_DIFF:0.2968
Fitting PCA...
0-th component log probs | Train: 3.0346863545469813 | Val: 2.6917972795886356
1-th component log probs | Train: 2.907354965642501 | Val: 2.773977477278565
2-th component log probs | Train: 2.9294922245969137 | Val: 2.714925672078219
3-th component log probs | Train: 2.982444829971136 | Val: 2.511213905708594
4-th component log probs | Train: 3.0905618696931643 | Val: 2.6147609081798353
5-th component log probs | Train: 3.1687093344724078 | Val: 2.4060673956119403
6-th component log probs | Train: 3.0336783838808308 | Val: 2.5138268546732925
7-th component log probs | Train: 3.1318636705404836 | Val: 2.5630736673583003
8-th component log probs | Train: 3.0287908550394524 | Val: 2.26983441783566
9-th component log probs | Train: 3.1330823035069626 | Val: 2.4033866930229655
KEYWORD NR_SAMPLES:40000 DIM:200 AVG_DIFF:0.2914
Fitting PCA...
0-th component log probs | Train: 3.207533774694192 | Val: 2.8483887650046498
1-th component log probs | Train: 3.0802722040247263 | Val: 2.9434445471272683
2-th component log probs | Train: 3.098927947266785 | Val: 2.881630173945017
3-th component log probs | Train: 3.152078161391754 | Val: 2.690825774322619
4-th component log probs | Train: 3.264448350163038 | Val: 2.7848882782930473
5-th component log probs | Train: 3.3396686949516874 | Val: 2.572002192457944
6-th component log probs | Train: 3.206401784193621 | Val: 2.677141380339003
7-th component log probs | Train: 3.304433945556361 | Val: 2.716779669284997
8-th component log probs | Train: 3.203470603155913 | Val: 2.4297195477995213
9-th component log probs | Train: 3.3066929574505544 | Val: 2.5598981232208624
KEYWORD NR_SAMPLES:40000 DIM:250 AVG_DIFF:0.3009
Fitting PCA...
0-th component log probs | Train: 3.356622222741846 | Val: 2.978645646944029
1-th component log probs | Train: 3.2276418060160754 | Val: 3.0850621447282576
2-th component log probs | Train: 3.2448399258543748 | Val: 3.0224212242957953
3-th component log probs | Train: 3.2986901537597006 | Val: 2.8345904671993214
4-th component log probs | Train: 3.4125126762059006 | Val: 2.922587330565892
5-th component log probs | Train: 3.487214573496797 | Val: 2.7136611211347534
6-th component log probs | Train: 3.354842802966271 | Val: 2.8141175405274605
7-th component log probs | Train: 3.4542756626533144 | Val: 2.841756939593247
8-th component log probs | Train: 3.3533298710920185 | Val: 2.538990453901453
9-th component log probs | Train: 3.4544979434582412 | Val: 2.6888929435755538
KEYWORD NR_SAMPLES:40000 DIM:300 AVG_DIFF:0.3183
Fitting PCA...
0-th component log probs | Train: 3.4888789036186942 | Val: 3.086284668923943
1-th component log probs | Train: 3.355515238567469 | Val: 3.2045787966878345
2-th component log probs | Train: 3.3718598053456406 | Val: 3.1450629289054417
3-th component log probs | Train: 3.4269128146161254 | Val: 2.9552693806803227
4-th component log probs | Train: 3.5437392661153195 | Val: 3.0326719632425463
5-th component log probs | Train: 3.616490274076299 | Val: 2.8178363673399103
6-th component log probs | Train: 3.4838071771529364 | Val: 2.9209218572657423
7-th component log probs | Train: 3.585639384354058 | Val: 2.9448282069664855
8-th component log probs | Train: 3.485078882604367 | Val: 2.6291139960924634
9-th component log probs | Train: 3.5852679058973944 | Val: 2.8054981603624967
KEYWORD NR_SAMPLES:40000 DIM:350 AVG_DIFF:0.3426
Fitting PCA...
0-th component log probs | Train: 3.607278191810351 | Val: 3.182000511339753
1-th component log probs | Train: 3.4704302661233872 | Val: 3.310670679462229
2-th component log probs | Train: 3.4847190279404607 | Val: 3.2512437433681787
3-th component log probs | Train: 3.542737483533431 | Val: 3.056830659725211
4-th component log probs | Train: 3.6596268398470593 | Val: 3.1318305516198928
5-th component log probs | Train: 3.7315882299047765 | Val: 2.914461389234875
6-th component log probs | Train: 3.5970447328446533 | Val: 3.009169862110099
7-th component log probs | Train: 3.702341549589534 | Val: 3.0320443716131313
8-th component log probs | Train: 3.603234262498322 | Val: 2.707481152124354
9-th component log probs | Train: 3.7026155588839096 | Val: 2.901334828820627
KEYWORD NR_SAMPLES:40000 DIM:400 AVG_DIFF:0.3683
Fitting PCA...
0-th component log probs | Train: 3.7157465615672094 | Val: 3.268502685978047
1-th component log probs | Train: 3.5764035838222696 | Val: 3.40929840482519
2-th component log probs | Train: 3.58857609736174 | Val: 3.346797549187982
3-th component log probs | Train: 3.6486681675434767 | Val: 3.1538750368502853
4-th component log probs | Train: 3.765747725415063 | Val: 3.224750511691043
5-th component log probs | Train: 3.837094625658873 | Val: 2.993082595461179
6-th component log probs | Train: 3.7012949796364456 | Val: 3.093889470274332
7-th component log probs | Train: 3.807619158238805 | Val: 3.120153895767577
8-th component log probs | Train: 3.710827397882416 | Val: 2.7799248430970933
9-th component log probs | Train: 3.8100157875033065 | Val: 2.994887661040507
KEYWORD NR_SAMPLES:40000 DIM:450 AVG_DIFF:0.3909
Fitting PCA...
0-th component log probs | Train: 3.8227188786124557 | Val: 3.3704892701451925
1-th component log probs | Train: 3.681961102734517 | Val: 3.5140654790118875
2-th component log probs | Train: 3.6962367605085897 | Val: 3.4497757676097107
3-th component log probs | Train: 3.756973943617367 | Val: 3.268072469299238
4-th component log probs | Train: 3.8703788439221642 | Val: 3.3378460544788826
5-th component log probs | Train: 3.9433547085715586 | Val: 3.1063937361814604
6-th component log probs | Train: 3.807553866260367 | Val: 3.195702963022637
7-th component log probs | Train: 3.9098550411171384 | Val: 3.229975345527058
8-th component log probs | Train: 3.8215863416005207 | Val: 2.892556142224847
9-th component log probs | Train: 3.9118974445536625 | Val: 3.1148759391855765
KEYWORD NR_SAMPLES:40000 DIM:500 AVG_DIFF:0.3852
0-th component log probs | Train: 3.8551440319453922 | Val: 3.4072400593881467
1-th component log probs | Train: 3.717246597649098 | Val: 3.551067691548022
2-th component log probs | Train: 3.7312607705377117 | Val: 3.4871926571080687
3-th component log probs | Train: 3.7920668830892015 | Val: 3.309898774069725
4-th component log probs | Train: 3.9016081972453263 | Val: 3.3772697760081365
5-th component log probs | Train: 3.9752302601898193 | Val: 3.152131993239551
6-th component log probs | Train: 3.8402422136517815 | Val: 3.2358892410548474
7-th component log probs | Train: 3.942430727653555 | Val: 3.2729901304806424
8-th component log probs | Train: 3.8548004970942285 | Val: 2.938805257973753
9-th component log probs | Train: 3.9440889323346835 | Val: 3.158198006019139
KEYWORD NR_SAMPLES:40000 DIM:512 AVG_DIFF:0.3743
best average differences at 50 dimensions: 0.21709131961407552
2022-01-10 02:59.17 [info     ] Training complete              train_loss=0.2932668924331665
2022-01-10 02:59.17 [info     ] Starting evaluating            dataset=26032
2022-01-10 02:59.21 [info     ] Testing complete               test_loss=0.28307849168777466
{'dataset_size': 40000,
 'end_test_accuracy': 0.9184709787368774,
 'end_test_loss': 0.28307849168777466,
 'end_train_accuracy': 0.9696750044822693,
 'end_train_loss': 0.2932668924331665,
 'end_val_accuracy': 0.9180251359939575,
 'end_val_loss': 0.3468957543373108}
2022-01-10 02:59.22 [info     ] Start Predict                  dataset=18606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 02:59.53 [info     ] Starting training              dataset=50000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
50000
Fitting PCA...
0-th component log probs | Train: 2.162470111444322 | Val: 1.2009572475208667
1-th component log probs | Train: 1.910594219181478 | Val: 1.5335181978977392
2-th component log probs | Train: 1.9714755674868574 | Val: 1.24854605284961
3-th component log probs | Train: 1.9872388849608011 | Val: 0.9131213041441727
4-th component log probs | Train: 2.018179189195541 | Val: 1.210540189052936
5-th component log probs | Train: 2.0847368725899647 | Val: 0.7317972776871113
6-th component log probs | Train: 2.0774056092970308 | Val: 0.7170933795879317
7-th component log probs | Train: 2.170977004720589 | Val: 0.7825798587342447
8-th component log probs | Train: 2.1093536148717518 | Val: 0.5381772013798783
9-th component log probs | Train: 2.09193282960686 | Val: 1.0561941563220696
KEYWORD NR_SAMPLES:50000 DIM:50 AVG_DIFF:1.2545
Fitting PCA...
0-th component log probs | Train: 2.7823010759165876 | Val: 1.6725324544027325
1-th component log probs | Train: 2.5463467889331035 | Val: 2.1229512435899873
2-th component log probs | Train: 2.5920335902495952 | Val: 1.830450506378375
3-th component log probs | Train: 2.626295973945076 | Val: 1.3635197091626359
4-th component log probs | Train: 2.638253613605377 | Val: 1.5875429759221957
5-th component log probs | Train: 2.696379027532155 | Val: 1.2320838426884069
6-th component log probs | Train: 2.6955574314078503 | Val: 1.1157459495116029
7-th component log probs | Train: 2.7966560527522186 | Val: 1.2142270310539827
8-th component log probs | Train: 2.736939343680064 | Val: 0.7609863474782698
9-th component log probs | Train: 2.716997055077508 | Val: 1.2706835495433326
KEYWORD NR_SAMPLES:50000 DIM:100 AVG_DIFF:1.7830
Fitting PCA...
0-th component log probs | Train: 3.0653489687693014 | Val: 1.9586618873301151
1-th component log probs | Train: 2.844253859152414 | Val: 2.441642449933286
2-th component log probs | Train: 2.8763861570080453 | Val: 2.146887072124246
3-th component log probs | Train: 2.910766535086975 | Val: 1.7650126362815335
4-th component log probs | Train: 2.919576466310979 | Val: 1.9696812791004787
5-th component log probs | Train: 2.968823486579652 | Val: 1.5307860738793062
6-th component log probs | Train: 2.969300857782449 | Val: 1.4444582322358748
7-th component log probs | Train: 3.071406052231988 | Val: 1.5262299092701297
8-th component log probs | Train: 3.0208020762056793 | Val: 1.1304895095105896
9-th component log probs | Train: 2.9978921860865073 | Val: 1.6224599991070459
KEYWORD NR_SAMPLES:50000 DIM:150 AVG_DIFF:1.6380
Fitting PCA...
0-th component log probs | Train: 3.2642446263690186 | Val: 2.1775829163100586
1-th component log probs | Train: 3.0541577708741734 | Val: 2.6590964282648595
2-th component log probs | Train: 3.080279754287155 | Val: 2.356764734290965
3-th component log probs | Train: 3.115492440472311 | Val: 2.0038049374976876
4-th component log probs | Train: 3.1261683420113004 | Val: 2.2136425376019293
5-th component log probs | Train: 3.165287478252617 | Val: 1.7675234933656205
6-th component log probs | Train: 3.168900440863487 | Val: 1.6266978204102722
7-th component log probs | Train: 3.270647251754638 | Val: 1.7519056582172328
8-th component log probs | Train: 3.2264054013530767 | Val: 1.3946691724234919
9-th component log probs | Train: 3.2035102021579624 | Val: 1.8136154145971894
KEYWORD NR_SAMPLES:50000 DIM:200 AVG_DIFF:1.5855
Fitting PCA...
0-th component log probs | Train: 3.4404837368395156 | Val: 2.291513682760655
1-th component log probs | Train: 3.2339600323817583 | Val: 2.8434020758687564
2-th component log probs | Train: 3.256578593327134 | Val: 2.536155165343419
3-th component log probs | Train: 3.292670961438839 | Val: 2.183084725522459
4-th component log probs | Train: 3.30214406242781 | Val: 2.395256071830191
5-th component log probs | Train: 3.33948182154731 | Val: 1.9369291360566205
6-th component log probs | Train: 3.344534152127949 | Val: 1.7365481124909736
7-th component log probs | Train: 3.444288996747111 | Val: 1.9291155398817266
8-th component log probs | Train: 3.4066073153689205 | Val: 1.5485380583544415
9-th component log probs | Train: 3.382991423909632 | Val: 1.9174906725831558
KEYWORD NR_SAMPLES:50000 DIM:250 AVG_DIFF:1.6494
Fitting PCA...
0-th component log probs | Train: 3.5952097512513737 | Val: 2.4098558407141994
1-th component log probs | Train: 3.3874723722093028 | Val: 2.9823626188937498
2-th component log probs | Train: 3.4083487182367604 | Val: 2.6751030660087816
3-th component log probs | Train: 3.4470894711504974 | Val: 2.3131298831257703
4-th component log probs | Train: 3.451912789723355 | Val: 2.5485231661355514
5-th component log probs | Train: 3.490531607125676 | Val: 2.083043725717779
6-th component log probs | Train: 3.500126051069086 | Val: 1.8442038864599266
7-th component log probs | Train: 3.596050829601007 | Val: 2.047147014015006
8-th component log probs | Train: 3.5635315423340814 | Val: 1.6597779799471566
9-th component log probs | Train: 3.538048737229055 | Val: 2.052670339776037
KEYWORD NR_SAMPLES:50000 DIM:300 AVG_DIFF:1.7162
Fitting PCA...
0-th component log probs | Train: 3.732031380005503 | Val: 2.5090204287645785
1-th component log probs | Train: 3.5235931416980013 | Val: 3.1027585753498688
2-th component log probs | Train: 3.542223339477109 | Val: 2.8041710801433832
3-th component log probs | Train: 3.584493268131636 | Val: 2.422005670205106
4-th component log probs | Train: 3.585010932127632 | Val: 2.662777113259985
5-th component log probs | Train: 3.6261808279492866 | Val: 2.219601958349236
6-th component log probs | Train: 3.6373523971715755 | Val: 1.9324511757324594
7-th component log probs | Train: 3.7282484043379167 | Val: 2.1606080712104
8-th component log probs | Train: 3.7018013359127493 | Val: 1.7036832138213447
9-th component log probs | Train: 3.676776540595241 | Val: 2.155421638053057
KEYWORD NR_SAMPLES:50000 DIM:350 AVG_DIFF:1.8069
Fitting PCA...
0-th component log probs | Train: 3.8551101625030832 | Val: 2.614085328263216
1-th component log probs | Train: 3.6465979476106627 | Val: 3.215770553047724
2-th component log probs | Train: 3.6639490257427747 | Val: 2.917440942950448
3-th component log probs | Train: 3.7102645139563553 | Val: 2.520822874728064
4-th component log probs | Train: 3.705581119254892 | Val: 2.7585355089329107
5-th component log probs | Train: 3.749734661865246 | Val: 2.3414269279474733
6-th component log probs | Train: 3.7658779840364707 | Val: 2.0150950756537584
7-th component log probs | Train: 3.8467935069938974 | Val: 2.2730118287719554
8-th component log probs | Train: 3.8289953561368457 | Val: 1.7509391879679121
9-th component log probs | Train: 3.8034492001513827 | Val: 2.2385759045891245
KEYWORD NR_SAMPLES:50000 DIM:400 AVG_DIFF:1.8887
Fitting PCA...
0-th component log probs | Train: 3.9664990552464703 | Val: 2.710561528486326
1-th component log probs | Train: 3.7613302121377212 | Val: 3.3233312146509455
2-th component log probs | Train: 3.7771300159721584 | Val: 3.0307801572870274
3-th component log probs | Train: 3.826846490839091 | Val: 2.6264895400617427
4-th component log probs | Train: 3.818283186944344 | Val: 2.8677778634079965
5-th component log probs | Train: 3.8647089690840795 | Val: 2.46234072105762
6-th component log probs | Train: 3.885851725729085 | Val: 2.1151208513645767
7-th component log probs | Train: 3.9557705148752684 | Val: 2.4122823327949594
8-th component log probs | Train: 3.9452034246947405 | Val: 1.8268855444004632
9-th component log probs | Train: 3.920154733544111 | Val: 2.3336314702150656
KEYWORD NR_SAMPLES:50000 DIM:450 AVG_DIFF:1.9159
Fitting PCA...
0-th component log probs | Train: 4.085702695448217 | Val: 2.9021784468883665
1-th component log probs | Train: 3.8875031634484967 | Val: 3.4717842597735706
2-th component log probs | Train: 3.902844288392783 | Val: 3.204416410163422
3-th component log probs | Train: 3.9514524330058647 | Val: 2.813294710168352
4-th component log probs | Train: 3.939239588032429 | Val: 3.047911707678079
5-th component log probs | Train: 3.9846452056982176 | Val: 2.6719402059405186
6-th component log probs | Train: 4.008206489224426 | Val: 2.346325963653029
7-th component log probs | Train: 4.072314148710346 | Val: 2.626245532303854
8-th component log probs | Train: 4.063061980536889 | Val: 2.062189152200969
9-th component log probs | Train: 4.040551220492242 | Val: 2.5393000159372874
KEYWORD NR_SAMPLES:50000 DIM:500 AVG_DIFF:1.6985
0-th component log probs | Train: 4.126207070267891 | Val: 2.968406306319825
1-th component log probs | Train: 3.9316066518840858 | Val: 3.524834412679046
2-th component log probs | Train: 3.946784022119481 | Val: 3.263570362021454
3-th component log probs | Train: 3.99465460868368 | Val: 2.8815697587569327
4-th component log probs | Train: 3.982140364245336 | Val: 3.1102072254524793
5-th component log probs | Train: 4.026899792826885 | Val: 2.743161109643777
6-th component log probs | Train: 4.050314906784179 | Val: 2.4252118845801705
7-th component log probs | Train: 4.112600628016861 | Val: 2.69875588508701
8-th component log probs | Train: 4.103506872596695 | Val: 2.146766416653379
9-th component log probs | Train: 4.081022821505507 | Val: 2.612411968253757
KEYWORD NR_SAMPLES:50000 DIM:512 AVG_DIFF:1.6246
best average differences at 50 dimensions: 1.2545221194807805
2022-01-10 04:01.53 [info     ] Training complete              train_loss=0.21243813633918762
2022-01-10 04:01.53 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:01.57 [info     ] Testing complete               test_loss=0.2915182411670685
{'dataset_size': 50000,
 'end_test_accuracy': 0.9179719090461731,
 'end_test_loss': 0.2915182411670685,
 'end_train_accuracy': 0.9878516793251038,
 'end_train_loss': 0.21243813633918762,
 'end_val_accuracy': 0.9330418109893799,
 'end_val_loss': 0.2932223081588745}
2022-01-10 04:01.57 [info     ] Start Predict                  dataset=8606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

wandb: Waiting for W&B process to finish, PID 21668... (success).
wandb: - 0.53MB of 0.53MB uploaded (0.00MB deduped)wandb: \ 0.53MB of 0.53MB uploaded (0.00MB deduped)wandb: | 0.53MB of 0.53MB uploaded (0.00MB deduped)wandb: / 0.53MB of 0.93MB uploaded (0.00MB deduped)wandb: - 0.53MB of 0.93MB uploaded (0.00MB deduped)wandb: \ 0.89MB of 0.93MB uploaded (0.00MB deduped)wandb: | 0.93MB of 0.93MB uploaded (0.00MB deduped)wandb: / 0.93MB of 0.93MB uploaded (0.00MB deduped)wandb: - 0.93MB of 0.93MB uploaded (0.00MB deduped)wandb: \ 0.93MB of 0.93MB uploaded (0.00MB deduped)wandb: | 0.93MB of 0.93MB uploaded (0.00MB deduped)wandb: / 0.93MB of 0.93MB uploaded (0.00MB deduped)wandb: - 0.93MB of 0.93MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:           accuracy_0 ▁▂▃▅▅▆▇▇▇█▇██████████
wandb:           accuracy_1 ▁▂▃▃▃▄▄▄▆▅▇▇██▇▇▇▇▆█▇
wandb:          accuracy_10 ▁▃▄▅▆▆▆▆▇▇▇▇▇▇███████████████
wandb:          accuracy_11 ▁▄▅▆▆▆▇▇▇▇▇▇▇███████████████
wandb:          accuracy_12 ▁▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇██████████████
wandb:          accuracy_13 ▁▅▆▆▆▇▇▇▇▇▇▇▇███████████████
wandb:          accuracy_14 ▁▅▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇████████
wandb:           accuracy_2 ▁▂▂▄▄▅▆▆▇▇▇▇▇▇██▇████
wandb:           accuracy_3 ▁▂▂▃▄▄▅▆▆▇▇▇▇▇▇▇▇▇▇██████████▇█████████
wandb:           accuracy_4 ▁▂▂▃▄▅▅▆▆▇▇▇██████████████████
wandb:           accuracy_5 ▁▁▂▄▅▆▆▆▇▇▇▇▇███████████████
wandb:           accuracy_6 ▁▁▂▄▅▆▆▇▇▇▇▇▇█▇█████████████████████████
wandb:           accuracy_7 ▁▁▂▄▄▅▆▆▆▇▇▇▇▇▇▇████████████
wandb:           accuracy_8 ▁▁▃▄▅▅▆▆▆▇▇▇▇▇▇▇▇██████████████
wandb:           accuracy_9 ▁▂▃▄▅▆▆▆▇▇▇▇▇▇████████████████
wandb:              class_0 ▇▇▆▄▅▆▂▃▂▄▂█▄▂▁
wandb:              class_1 ▁▄▅█▅▄▃▃▂▂▃▅▃▃▃
wandb:              class_2 ▁▆▄▃▁▂▅▆▅▃▄▆▇▅█
wandb:              class_3 ▃▂▁▂▃▄▆▆██▇▅▄▆▅
wandb:              class_4 ▄▃▃▆▃▄▃▃▁▃▆▂▆█▆
wandb:              class_5 ▃▄▂▃▃▁▅▂▄▃▂▅█▃▄
wandb:              class_6 ▅▄█▄█▆▆▄▄▅▃▂▁▂▃
wandb:              class_7 █▅▃▂▁▄▂▃▃▄▃▁▆▅▆
wandb:              class_8 ▇▄▃▅▇▄▆▇██▆▆▄▂▁
wandb:              class_9 █▄▆▄▄▆▅▅▆▅▄▃▁▅▄
wandb:         dataset_size ▁▁▁▁▁▁▁▂▂▂▂▄▅▇█
wandb:    end_test_accuracy ▁▁▁▄▅▅▇▇▇▇█████
wandb:        end_test_loss ███▇▆▅▃▂▂▂▁▁▁▁▁
wandb:   end_train_accuracy ▇▁▆█▇██▇█▇▇▇█▇█
wandb:       end_train_loss ▄█▄▂▂▂▁▂▂▂▂▂▁▁▁
wandb:     end_val_accuracy ▁▁▃▄▅▆▇▇▇▇█████
wandb:         end_val_loss █▆▅▄▃▃▂▂▁▁▁▁▁▁▁
wandb:                epoch ▁▃▁▃▂▄▂▄▅▁▃▅▂▄▁▃▄▆█▁▃▅▂▄▅▂▄▁▃▅▂▄▁▃▅▂▄▁▃▅
wandb:               loss_0 █▇▆▅▄▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:               loss_1 █▇▆▆▅▅▄▄▃▄▂▂▂▁▂▃▂▂▃▁▂
wandb:              loss_10 █▆▅▄▄▃▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              loss_11 █▅▄▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              loss_12 █▅▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:              loss_13 █▄▄▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              loss_14 █▅▄▄▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb:               loss_2 █▇▆▅▄▄▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb:               loss_3 █▇▆▆▅▄▄▃▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_4 █▇▇▆▅▄▃▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_5 █▇▆▅▄▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_6 █▇▇▅▄▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_7 █▇▇▅▅▄▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_8 █▇▆▅▄▄▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_9 █▇▆▅▄▄▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_0 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_1 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                lr_10 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                lr_11 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                lr_12 █████████████████████████████▁▁
wandb:                lr_13 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                lr_14 █████████████████████████████▁▁
wandb:                 lr_2 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_3 █████████████████████████████▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_4 █████████████████████████████▁
wandb:                 lr_5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_6 ████████████████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_7 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_8 █████████████████████████████▁▁
wandb:                 lr_9 █████████████████████████████▁
wandb:       val_accuracy_0 ▁▂▃▄▄▄▅▆▇██████▇▇▇▇██
wandb:       val_accuracy_1 ▁▁▃▃▄▄▄▅▄▅▅▅▆▇█▇▆▄▄▅▇
wandb:      val_accuracy_10 ▁▅▇▇▇▇███████████████████████
wandb:      val_accuracy_11 ▁▅▆▇▇███████████████████████
wandb:      val_accuracy_12 ▁▅▆▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇█▇▇█▇▇▇█▇▇▇▇█
wandb:      val_accuracy_13 ▁▄▅▆▆▇▇███▇█▇▇▇▇▇█▇██▇██▇███
wandb:      val_accuracy_14 ▁▄▄▆▆▆▆▆▆▆▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█
wandb:       val_accuracy_2 ▁▂▂▃▂▄▄▄▅▅▅▆▅▅▆▇▆▇▇▆█
wandb:       val_accuracy_3 ▁▁▂▂▃▃▅▅▅▅▆▆▆▆▇▆▆▇█▇▇▇▇█▇█▇▇█▇▇████████
wandb:       val_accuracy_4 ▁▁▃▃▄▅▆▆▆▇▇▇▇▇██████▇█▇███████
wandb:       val_accuracy_5 ▁▂▃▄▆▆▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇██████
wandb:       val_accuracy_6 ▁▁▃▅▆▆▇▇▇▇▇▇▇██▇▇███████████████████████
wandb:       val_accuracy_7 ▁▂▅▆▆▇▇█████████████████████
wandb:       val_accuracy_8 ▁▄▅▆▇▇▇▇███████████████████████
wandb:       val_accuracy_9 ▁▄▆▇▇▇▇███████████████████████
wandb:           val_loss_0 ▁▁▁▁▂▁▁▁▂▃▃▄▅▅▅▅▇▇██▆
wandb:           val_loss_1 ▁▁▂▁▁▂▂▃▄▄▄▅▄▄▅▇█▇▆█▆
wandb:          val_loss_10 █▄▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▂
wandb:          val_loss_11 █▄▂▂▁▁▁▁▁▁▁▁▂▁▁▂▁▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_loss_12 █▄▃▂▂▂▁▁▁▁▁▁▂▂▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_loss_13 █▅▄▃▂▂▂▁▁▁▁▁▂▂▂▂▃▁▃▂▂▃▃▃▃▃▃▃
wandb:          val_loss_14 █▄▄▂▃▂▂▂▁▂▁▂▂▁▂▁▂▂▁▂▂▂▂▂▂▃▂▂▂▂▁
wandb:           val_loss_2 ▁▃▂▂▄▂▄▄▃▅▆▅▆█▆▄▅▅▄▇▃
wandb:           val_loss_3 ▂█▃▂▁▂▂▂▂▂▁▁▂▂▁▂▂▁▁▁▁▂▂▂▂▂▂▂▁▂▂▁▁▁▁▁▁▁▁
wandb:           val_loss_4 █▇▃▂▂▃▁▂▃▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▁▁▂▁
wandb:           val_loss_5 █▇▄▃▂▂▃▁▂▂▂▂▂▁▂▂▂▂▄▂▃▂▁▂▁▂▁▂
wandb:           val_loss_6 █▆▅▃▂▃▁▁▁▁▁▁▁▂▁▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_loss_7 █▇▄▃▂▂▁▁▁▁▁▁▂▁▁▁▂▁▂▂▁▁▂▂▁▁▁▂
wandb:           val_loss_8 █▅▄▃▂▂▁▂▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▂▁▂▂▂▁▁
wandb:           val_loss_9 █▅▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂
wandb: 
wandb: Run summary:
wandb:           accuracy_0 0.95052
wandb:           accuracy_1 0.67578
wandb:          accuracy_10 0.96955
wandb:          accuracy_11 0.9667
wandb:          accuracy_12 0.98848
wandb:          accuracy_13 0.96968
wandb:          accuracy_14 0.98785
wandb:           accuracy_2 0.91518
wandb:           accuracy_3 0.99844
wandb:           accuracy_4 0.97236
wandb:           accuracy_5 0.97695
wandb:           accuracy_6 0.99854
wandb:           accuracy_7 0.96726
wandb:           accuracy_8 0.98432
wandb:           accuracy_9 0.96688
wandb:              class_0 0.06526
wandb:              class_1 0.13116
wandb:              class_2 0.15386
wandb:              class_3 0.12336
wandb:              class_4 0.10958
wandb:              class_5 0.1052
wandb:              class_6 0.08092
wandb:              class_7 0.0878
wandb:              class_8 0.06824
wandb:              class_9 0.07462
wandb:         dataset_size 50000
wandb:    end_test_accuracy 0.91797
wandb:        end_test_loss 0.29152
wandb:   end_train_accuracy 0.98785
wandb:       end_train_loss 0.21244
wandb:     end_val_accuracy 0.93304
wandb:         end_val_loss 0.29322
wandb:                epoch 31
wandb:               loss_0 0.65369
wandb:               loss_1 1.36357
wandb:              loss_10 0.36758
wandb:              loss_11 0.33897
wandb:              loss_12 0.23698
wandb:              loss_13 0.29327
wandb:              loss_14 0.21244
wandb:               loss_2 0.76017
wandb:               loss_3 0.3226
wandb:               loss_4 0.41169
wandb:               loss_5 0.37564
wandb:               loss_6 0.23676
wandb:               loss_7 0.38157
wandb:               loss_8 0.29775
wandb:               loss_9 0.36429
wandb:                 lr_0 0.001
wandb:                 lr_1 0.001
wandb:                lr_10 0.001
wandb:                lr_11 0.001
wandb:                lr_12 0.0001
wandb:                lr_13 0.001
wandb:                lr_14 0.0001
wandb:                 lr_2 0.001
wandb:                 lr_3 0.0001
wandb:                 lr_4 0.0001
wandb:                 lr_5 0.001
wandb:                 lr_6 0.0001
wandb:                 lr_7 0.001
wandb:                 lr_8 0.0001
wandb:                 lr_9 0.0001
wandb:       val_accuracy_0 0.1686
wandb:       val_accuracy_1 0.20609
wandb:      val_accuracy_10 0.88861
wandb:      val_accuracy_11 0.90547
wandb:      val_accuracy_12 0.92765
wandb:      val_accuracy_13 0.91803
wandb:      val_accuracy_14 0.93304
wandb:       val_accuracy_2 0.4025
wandb:       val_accuracy_3 0.5223
wandb:       val_accuracy_4 0.61315
wandb:       val_accuracy_5 0.66459
wandb:       val_accuracy_6 0.79387
wandb:       val_accuracy_7 0.81742
wandb:       val_accuracy_8 0.87831
wandb:       val_accuracy_9 0.87468
wandb:           val_loss_0 4.84907
wandb:           val_loss_1 3.50616
wandb:          val_loss_10 0.53526
wandb:          val_loss_11 0.44363
wandb:          val_loss_12 0.33076
wandb:          val_loss_13 0.3469
wandb:          val_loss_14 0.29322
wandb:           val_loss_2 2.73051
wandb:           val_loss_3 2.1866
wandb:           val_loss_4 1.78189
wandb:           val_loss_5 1.58199
wandb:           val_loss_6 0.92743
wandb:           val_loss_7 0.83014
wandb:           val_loss_8 0.55383
wandb:           val_loss_9 0.6182
wandb: 
wandb: Synced 6 W&B file(s), 30 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced svhn_hu_greedy_l2_run2: https://wandb.ai/fanconic/hidden_uncertainty/runs/3se444sd
wandb: Find logs at: ./wandb/run-20220110_000710-3se444sd/logs/debug.log
wandb: 
wandb: Tracking run with wandb version 0.12.7
wandb: Syncing run svhn_hu_greedy_l2_run3
wandb:  View project at https://wandb.ai/fanconic/hidden_uncertainty
wandb:  View run at https://wandb.ai/fanconic/hidden_uncertainty/runs/j74yoqbg
wandb: Run data is saved locally in /scratch_net/airfox/fanconic/semproj2/hidden_uncertainty_active_learning/wandb/run-20220110_040201-j74yoqbg
wandb: Run `wandb offline` to turn off syncing.

Cuda is available:  True
Using downloaded and verified file: /tmp/train_32x32.mat
Using downloaded and verified file: /tmp/test_32x32.mat
2022-01-10 04:02.27 [info     ] Starting training              dataset=100 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
100
Fitting PCA...
0-th component log probs | Train: 5.057597461141642 | Val: -4666.842336064622
1-th component log probs | Train: 5.022973683477661 | Val: -5358.62602254645
2-th component log probs | Train: 5.036964265429468 | Val: -4716.44324093163
3-th component log probs | Train: 5.123458395214682 | Val: -5301.429291955086
4-th component log probs | Train: 5.0902479849694835 | Val: -5000.1612730833795
5-th component log probs | Train: 5.106410484434448 | Val: -5448.543617378124
6-th component log probs | Train: 5.042351019215255 | Val: -4689.830986529932
7-th component log probs | Train: 5.069199124219698 | Val: -4885.282335524858
8-th component log probs | Train: 5.003765782254906 | Val: -4442.1581096408445
9-th component log probs | Train: 5.052691329154041 | Val: -5873.176454664484
KEYWORD NR_SAMPLES:100 DIM:50 AVG_DIFF:25613029.8807
0-th component log probs | Train: 30.179444052059562 | Val: -3343.197632434526
1-th component log probs | Train: 30.168683561456923 | Val: -3425.4104773606737
2-th component log probs | Train: 30.17343503604286 | Val: -3167.3532327184685
3-th component log probs | Train: 30.201805360418767 | Val: -3835.135277332648
4-th component log probs | Train: 30.190159627919705 | Val: -3405.8152038626954
5-th component log probs | Train: 30.195931210670047 | Val: -3691.5982065588255
6-th component log probs | Train: 30.17481308771671 | Val: -3184.429111783916
7-th component log probs | Train: 30.183607134614686 | Val: -3406.6848829145356
8-th component log probs | Train: 30.160517591698618 | Val: -3073.598894500468
9-th component log probs | Train: 30.17938585622673 | Val: -3733.419893640093
KEYWORD NR_SAMPLES:100 DIM:100 AVG_DIFF:12008733.7690
best average differences at 100 dimensions: 12008733.768974831
2022-01-10 04:03.35 [info     ] Training complete              train_loss=0.6153924465179443
2022-01-10 04:03.35 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:03.39 [info     ] Testing complete               test_loss=2.3108975887298584
{'dataset_size': 100,
 'end_test_accuracy': 0.13773290812969208,
 'end_test_loss': 2.3108975887298584,
 'end_train_accuracy': 0.9583333730697632,
 'end_train_loss': 0.6153924465179443,
 'end_val_accuracy': 0.1574561893939972,
 'end_val_loss': 5.222660541534424}
2022-01-10 04:03.39 [info     ] Start Predict                  dataset=58506
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:04.12 [info     ] Starting training              dataset=200 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
200
Fitting PCA...
0-th component log probs | Train: 4.769740245836775 | Val: -2620.4584433212535
1-th component log probs | Train: 2.871621125253521 | Val: -396.0480480180193
2-th component log probs | Train: 4.139566712540041 | Val: -1154.8481666686375
3-th component log probs | Train: 3.971285332374101 | Val: -1404.4479761746277
4-th component log probs | Train: 4.30124081659855 | Val: -1601.1589724245607
5-th component log probs | Train: 4.4287875370964995 | Val: -1546.8780496153058
6-th component log probs | Train: 4.465107169896669 | Val: -1946.7863415227598
7-th component log probs | Train: 4.5910038649331755 | Val: -1980.9390852036363
8-th component log probs | Train: 4.548542806594836 | Val: -2255.3902009374774
9-th component log probs | Train: 4.430851957154324 | Val: -2344.441668359156
KEYWORD NR_SAMPLES:200 DIM:50 AVG_DIFF:3373614.9893
Fitting PCA...
0-th component log probs | Train: 5.357278652224289 | Val: -1662.9587254367998
1-th component log probs | Train: 4.234630431684383 | Val: -695.339900545213
2-th component log probs | Train: 5.030528632975772 | Val: -813.0285711035724
3-th component log probs | Train: 4.940142926444898 | Val: -1011.9969109228948
4-th component log probs | Train: 5.109999878960699 | Val: -1109.5620000786528
5-th component log probs | Train: 5.184103149322068 | Val: -1022.9690788004085
6-th component log probs | Train: 5.204718972327231 | Val: -1277.3545905490894
7-th component log probs | Train: 5.27135980904687 | Val: -1302.183719826187
8-th component log probs | Train: 5.250583957233865 | Val: -1396.7469504653166
9-th component log probs | Train: 5.182911948708874 | Val: -1446.4360710477047
KEYWORD NR_SAMPLES:200 DIM:100 AVG_DIFF:1470284.9035
Fitting PCA...
0-th component log probs | Train: 5.559532976375894 | Val: -1202.381999870602
1-th component log probs | Train: 4.775371227450029 | Val: -579.1704623528593
2-th component log probs | Train: 5.339928241095982 | Val: -617.8203478963069
3-th component log probs | Train: 5.2820476385599555 | Val: -750.6942710986447
4-th component log probs | Train: 5.392256413386756 | Val: -835.9846624696492
5-th component log probs | Train: 5.445549077848194 | Val: -753.3640768037088
6-th component log probs | Train: 5.461258613128935 | Val: -922.3602827406816
7-th component log probs | Train: 5.505779403318979 | Val: -946.9916075112847
8-th component log probs | Train: 5.492356274019934 | Val: -999.8082053023553
9-th component log probs | Train: 5.44487990247282 | Val: -1027.4421335960903
KEYWORD NR_SAMPLES:200 DIM:150 AVG_DIFF:788924.0462
0-th component log probs | Train: 15.006660263911419 | Val: -1012.7864399217882
1-th component log probs | Train: 14.40291908727405 | Val: -556.2875371368864
2-th component log probs | Train: 14.840474685315872 | Val: -571.9430639060814
3-th component log probs | Train: 14.799747103061776 | Val: -669.3570478712858
4-th component log probs | Train: 14.881826961028144 | Val: -739.0875793751081
5-th component log probs | Train: 14.921863863592025 | Val: -671.8474527129915
6-th component log probs | Train: 14.934727746606477 | Val: -793.9084156131211
7-th component log probs | Train: 14.96741933053351 | Val: -826.5706198444709
8-th component log probs | Train: 14.95844645744865 | Val: -853.4723654811798
9-th component log probs | Train: 14.921231749898459 | Val: -872.2020881680384
KEYWORD NR_SAMPLES:200 DIM:200 AVG_DIFF:613812.7017
best average differences at 200 dimensions: 613812.7016573183
2022-01-10 04:05.27 [info     ] Training complete              train_loss=1.170979619026184
2022-01-10 04:05.27 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:05.31 [info     ] Testing complete               test_loss=2.2823004722595215
{'dataset_size': 200,
 'end_test_accuracy': 0.1913134604692459,
 'end_test_loss': 2.2823004722595215,
 'end_train_accuracy': 0.80078125,
 'end_train_loss': 1.170979619026184,
 'end_val_accuracy': 0.16628694534301758,
 'end_val_loss': 3.825920820236206}
2022-01-10 04:05.31 [info     ] Start Predict                  dataset=58406
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:06.03 [info     ] Starting training              dataset=400 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
400
Fitting PCA...
0-th component log probs | Train: 3.8829735370730543 | Val: -1281.000378944529
1-th component log probs | Train: 2.123281264923525 | Val: -6.957613414867929
2-th component log probs | Train: 2.3606463296114364 | Val: -9.125834963799122
3-th component log probs | Train: 2.624912726057991 | Val: -47.7962186263202
4-th component log probs | Train: 3.806179720171238 | Val: -772.4874686339948
5-th component log probs | Train: 3.624297398521644 | Val: -462.1774244732915
6-th component log probs | Train: 3.2557188335478178 | Val: -512.8250495062829
7-th component log probs | Train: 3.6392774523641904 | Val: -644.1927143995688
8-th component log probs | Train: 3.9418616791271988 | Val: -906.1828147244605
9-th component log probs | Train: 3.7633240289990884 | Val: -1109.5872450863592
KEYWORD NR_SAMPLES:400 DIM:50 AVG_DIFF:522718.7060
Fitting PCA...
0-th component log probs | Train: 4.880118922020192 | Val: -998.2340249450083
1-th component log probs | Train: 3.188541464099767 | Val: -126.44237648844313
2-th component log probs | Train: 3.658806523341778 | Val: -168.21202007440212
3-th component log probs | Train: 4.005885324352444 | Val: -253.15261070326113
4-th component log probs | Train: 4.831034134058027 | Val: -698.4693476684441
5-th component log probs | Train: 4.743652423400544 | Val: -426.6903321070058
6-th component log probs | Train: 4.528079580816885 | Val: -548.6622533831121
7-th component log probs | Train: 4.750632555145591 | Val: -645.2329636969189
8-th component log probs | Train: 4.9315566539910956 | Val: -717.8015848257027
9-th component log probs | Train: 4.819407011983322 | Val: -882.5001795038337
KEYWORD NR_SAMPLES:400 DIM:100 AVG_DIFF:383765.6406
Fitting PCA...
0-th component log probs | Train: 5.232969252562281 | Val: -760.2784528157698
1-th component log probs | Train: 3.9786610253638877 | Val: -191.45567238575958
2-th component log probs | Train: 4.3471314263615914 | Val: -193.77148874884958
3-th component log probs | Train: 4.607545805060048 | Val: -250.4995779210966
4-th component log probs | Train: 5.196935472071657 | Val: -562.651950856727
5-th component log probs | Train: 5.140918230468319 | Val: -354.4505296626648
6-th component log probs | Train: 4.987754352724755 | Val: -456.3208584893851
7-th component log probs | Train: 5.146807543425367 | Val: -533.9886058649054
8-th component log probs | Train: 5.273231060814998 | Val: -573.4540236371126
9-th component log probs | Train: 5.195346246205825 | Val: -690.3471901231853
KEYWORD NR_SAMPLES:400 DIM:150 AVG_DIFF:250246.8601
Fitting PCA...
0-th component log probs | Train: 5.414719575390697 | Val: -613.5522770326712
1-th component log probs | Train: 4.430894669343331 | Val: -191.2545078355938
2-th component log probs | Train: 4.721574532770554 | Val: -179.77781770966845
3-th component log probs | Train: 4.927442862429244 | Val: -223.18648571249003
4-th component log probs | Train: 5.385606264840578 | Val: -461.7882952674531
5-th component log probs | Train: 5.345873020052876 | Val: -296.7047920969907
6-th component log probs | Train: 5.227408384592864 | Val: -377.6223497976903
7-th component log probs | Train: 5.349980603454262 | Val: -441.6667614070874
8-th component log probs | Train: 5.44822429036102 | Val: -471.65068455132797
9-th component log probs | Train: 5.387918275831597 | Val: -557.6723067753502
KEYWORD NR_SAMPLES:400 DIM:200 AVG_DIFF:170803.3059
Fitting PCA...
0-th component log probs | Train: 5.5262380222449305 | Val: -517.0998623675798
1-th component log probs | Train: 4.719655865747517 | Val: -178.420000265068
2-th component log probs | Train: 4.9569704654533195 | Val: -162.12358640129344
3-th component log probs | Train: 5.128369733310124 | Val: -196.49496709543118
4-th component log probs | Train: 5.501475427546239 | Val: -393.64264051073883
5-th component log probs | Train: 5.471148275235108 | Val: -252.83214484570337
6-th component log probs | Train: 5.375265380059521 | Val: -322.4353385227152
7-th component log probs | Train: 5.4747997238852415 | Val: -372.02625206287513
8-th component log probs | Train: 5.554581499317159 | Val: -398.1024905506737
9-th component log probs | Train: 5.505741444464395 | Val: -465.9513460960708
KEYWORD NR_SAMPLES:400 DIM:250 AVG_DIFF:123646.0327
Fitting PCA...
0-th component log probs | Train: 5.601607383132737 | Val: -444.3191288996929
1-th component log probs | Train: 4.920375668041339 | Val: -161.87814895453266
2-th component log probs | Train: 5.120829870343444 | Val: -145.52056476602556
3-th component log probs | Train: 5.266220316213535 | Val: -173.31040714316637
4-th component log probs | Train: 5.580365673593166 | Val: -340.784480849851
5-th component log probs | Train: 5.555743987835748 | Val: -220.19223899257696
6-th component log probs | Train: 5.47536334114533 | Val: -280.02394751296356
7-th component log probs | Train: 5.559331965085753 | Val: -321.95970017156884
8-th component log probs | Train: 5.626243022826433 | Val: -343.26203313808685
9-th component log probs | Train: 5.5852385822865225 | Val: -398.00886375386585
KEYWORD NR_SAMPLES:400 DIM:300 AVG_DIFF:92915.3419
Fitting PCA...
0-th component log probs | Train: 5.656220775988209 | Val: -389.18977574636
1-th component log probs | Train: 5.068209355429373 | Val: -146.26462186451514
2-th component log probs | Train: 5.241077833603884 | Val: -131.111796177326
3-th component log probs | Train: 5.36717872012952 | Val: -154.61526677132167
4-th component log probs | Train: 5.637743121294827 | Val: -298.89847992152613
5-th component log probs | Train: 5.61686745297856 | Val: -194.51137146286538
6-th component log probs | Train: 5.547873389212343 | Val: -246.7757643388388
7-th component log probs | Train: 5.620211033686104 | Val: -282.8890487347479
8-th component log probs | Train: 5.677776035018509 | Val: -300.7442584822011
9-th component log probs | Train: 5.642573570969221 | Val: -347.05772530412764
KEYWORD NR_SAMPLES:400 DIM:350 AVG_DIFF:72098.1874
0-th component log probs | Train: 7.374509974228493 | Val: -354.75469260150845
1-th component log probs | Train: 6.8585407367924525 | Val: -142.2440617337355
2-th component log probs | Train: 7.010205594753074 | Val: -127.05091702071901
3-th component log probs | Train: 7.120972362187991 | Val: -146.553523335962
4-th component log probs | Train: 7.358215686593014 | Val: -274.6377699460182
5-th component log probs | Train: 7.340033120570166 | Val: -180.8302985120068
6-th component log probs | Train: 7.279640291679384 | Val: -229.31685295098782
7-th component log probs | Train: 7.343056227586957 | Val: -262.07461313568314
8-th component log probs | Train: 7.393472986370015 | Val: -276.324334626143
9-th component log probs | Train: 7.362643165613373 | Val: -316.59176197340406
KEYWORD NR_SAMPLES:400 DIM:400 AVG_DIFF:62389.3222
best average differences at 400 dimensions: 62389.32224115359
2022-01-10 04:07.29 [info     ] Training complete              train_loss=1.0560672283172607
2022-01-10 04:07.29 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:07.32 [info     ] Testing complete               test_loss=2.2735209465026855
{'dataset_size': 400,
 'end_test_accuracy': 0.17465190589427948,
 'end_test_loss': 2.2735209465026855,
 'end_train_accuracy': 0.8459821343421936,
 'end_train_loss': 1.0560672283172607,
 'end_val_accuracy': 0.3649607300758362,
 'end_val_loss': 2.754409074783325}
2022-01-10 04:07.33 [info     ] Start Predict                  dataset=58206
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:08.05 [info     ] Starting training              dataset=600 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
600
Fitting PCA...
0-th component log probs | Train: 3.274630205307127 | Val: -484.33759310001545
1-th component log probs | Train: 2.2443098104385126 | Val: -6.449988301453402
2-th component log probs | Train: 2.3333176438713856 | Val: -8.863756027956113
3-th component log probs | Train: 2.455572664671899 | Val: -17.037003285540226
4-th component log probs | Train: 3.205022418012824 | Val: -327.8874934810075
5-th component log probs | Train: 2.998268817418743 | Val: -168.67399483050147
6-th component log probs | Train: 3.0136964979054217 | Val: -182.24147494876723
7-th component log probs | Train: 2.8547181089926252 | Val: -64.46394509020102
8-th component log probs | Train: 3.371602634229793 | Val: -863.8574508620168
9-th component log probs | Train: 3.6901880556078615 | Val: -845.5030677069205
KEYWORD NR_SAMPLES:600 DIM:50 AVG_DIFF:188950.6924
Fitting PCA...
0-th component log probs | Train: 4.493065436469313 | Val: -650.6521059057825
1-th component log probs | Train: 2.950549307078431 | Val: -24.51256262661233
2-th component log probs | Train: 3.078065598039612 | Val: -41.912406113164266
3-th component log probs | Train: 3.6054195842671755 | Val: -234.63829773001774
4-th component log probs | Train: 4.449615939825593 | Val: -553.6975197276581
5-th component log probs | Train: 4.30523290155947 | Val: -387.789490315465
6-th component log probs | Train: 4.319288559132119 | Val: -429.8033384482348
7-th component log probs | Train: 4.118389617724894 | Val: -285.1253331367546
8-th component log probs | Train: 4.564565952860038 | Val: -1000.0013995791857
9-th component log probs | Train: 4.776831630749173 | Val: -993.5169572989054
KEYWORD NR_SAMPLES:600 DIM:100 AVG_DIFF:323188.7781
Fitting PCA...
0-th component log probs | Train: 4.9542858123587195 | Val: -544.4272221285403
1-th component log probs | Train: 3.5561555905663984 | Val: -87.61147337417952
2-th component log probs | Train: 3.7560336666584053 | Val: -116.87467839526487
3-th component log probs | Train: 4.290334579206861 | Val: -283.1609878488131
4-th component log probs | Train: 4.9256067961392995 | Val: -477.89809028995205
5-th component log probs | Train: 4.819517710877463 | Val: -353.6633656994345
6-th component log probs | Train: 4.835399589293314 | Val: -398.8939637139402
7-th component log probs | Train: 4.677427386481234 | Val: -278.1128087412829
8-th component log probs | Train: 5.004885014298913 | Val: -817.5484373127857
9-th component log probs | Train: 5.161193520581758 | Val: -800.93430290043
KEYWORD NR_SAMPLES:600 DIM:150 AVG_DIFF:233829.1943
Fitting PCA...
0-th component log probs | Train: 5.196665316851323 | Val: -464.3676403497358
1-th component log probs | Train: 4.041155960026766 | Val: -113.37525925966037
2-th component log probs | Train: 4.218630638277177 | Val: -136.3688539739172
3-th component log probs | Train: 4.6730672598324645 | Val: -264.2366943091613
4-th component log probs | Train: 5.174955927041102 | Val: -406.6583465023993
5-th component log probs | Train: 5.092019737233969 | Val: -308.21433391997914
6-th component log probs | Train: 5.1057955399342925 | Val: -342.45992381314903
7-th component log probs | Train: 4.977482875449862 | Val: -244.79020625754592
8-th component log probs | Train: 5.23760171271999 | Val: -658.9693009970911
9-th component log probs | Train: 5.359287524888408 | Val: -665.0298462395788
KEYWORD NR_SAMPLES:600 DIM:200 AVG_DIFF:166790.0321
Fitting PCA...
0-th component log probs | Train: 5.346258722584216 | Val: -399.8166922721457
1-th component log probs | Train: 4.3739268515049154 | Val: -116.84299640826805
2-th component log probs | Train: 4.5284113297538555 | Val: -136.8938643610521
3-th component log probs | Train: 4.916436237286807 | Val: -237.19358817811144
4-th component log probs | Train: 5.329247665504547 | Val: -350.63852092677985
5-th component log probs | Train: 5.261263863417742 | Val: -270.37209852271843
6-th component log probs | Train: 5.273611249460571 | Val: -298.4200482061869
7-th component log probs | Train: 5.1668491155670875 | Val: -216.0902183711152
8-th component log probs | Train: 5.380762086856548 | Val: -556.7971545130458
9-th component log probs | Train: 5.481061929986832 | Val: -562.6951109990388
KEYWORD NR_SAMPLES:600 DIM:250 AVG_DIFF:124020.7588
Fitting PCA...
0-th component log probs | Train: 5.448792633267295 | Val: -350.7250586348488
1-th component log probs | Train: 4.614879802462224 | Val: -113.08288962744894
2-th component log probs | Train: 4.750282826468962 | Val: -129.24326660217588
3-th component log probs | Train: 5.0853946946688975 | Val: -213.57832357513664
4-th component log probs | Train: 5.434581983318756 | Val: -305.8421535418715
5-th component log probs | Train: 5.376903631654453 | Val: -237.17169153812208
6-th component log probs | Train: 5.388086044467676 | Val: -263.12963838485695
7-th component log probs | Train: 5.29615317909675 | Val: -192.95500618404614
8-th component log probs | Train: 5.4780677220775615 | Val: -481.7188772728721
9-th component log probs | Train: 5.56374098291503 | Val: -487.6202380702916
KEYWORD NR_SAMPLES:600 DIM:300 AVG_DIFF:95420.0288
Fitting PCA...
0-th component log probs | Train: 5.523188354574433 | Val: -310.46392764273406
1-th component log probs | Train: 4.795550248397524 | Val: -106.7330993738867
2-th component log probs | Train: 4.9143954349337395 | Val: -120.70350084457048
3-th component log probs | Train: 5.20893723884907 | Val: -191.82230217838872
4-th component log probs | Train: 5.511053167687417 | Val: -271.70582613548805
5-th component log probs | Train: 5.461332750298164 | Val: -211.56811462907854
6-th component log probs | Train: 5.471465134276234 | Val: -234.93148002559812
7-th component log probs | Train: 5.39103231326627 | Val: -173.70365506610688
8-th component log probs | Train: 5.548831049317082 | Val: -425.68793562062854
9-th component log probs | Train: 5.623361554207437 | Val: -429.36404757942563
KEYWORD NR_SAMPLES:600 DIM:350 AVG_DIFF:75588.6320
Fitting PCA...
0-th component log probs | Train: 5.580110931377363 | Val: -278.8645746688741
1-th component log probs | Train: 4.936051642907798 | Val: -99.79470153977233
2-th component log probs | Train: 5.042071465932767 | Val: -111.78315799849807
3-th component log probs | Train: 5.3035686654093865 | Val: -174.09657004512837
4-th component log probs | Train: 5.569444817355621 | Val: -244.0638073719029
5-th component log probs | Train: 5.525720527592072 | Val: -190.35924770968924
6-th component log probs | Train: 5.534868114724715 | Val: -211.92828139481318
7-th component log probs | Train: 5.4636994362904785 | Val: -157.44335365593284
8-th component log probs | Train: 5.602787770498067 | Val: -378.83595218596776
9-th component log probs | Train: 5.668544920598112 | Val: -382.9146826242493
KEYWORD NR_SAMPLES:600 DIM:400 AVG_DIFF:61101.6534
Fitting PCA...
0-th component log probs | Train: 5.625022561646728 | Val: -252.86864015513754
1-th component log probs | Train: 5.048998324744453 | Val: -93.01042818095935
2-th component log probs | Train: 5.144180802844875 | Val: -103.47366854390374
3-th component log probs | Train: 5.378319871545923 | Val: -158.8235640601523
4-th component log probs | Train: 5.615359562986695 | Val: -221.54818045942238
5-th component log probs | Train: 5.576422314936534 | Val: -172.83290170880116
6-th component log probs | Train: 5.5847124408956335 | Val: -192.67857217966804
7-th component log probs | Train: 5.521122405451513 | Val: -143.76933768815675
8-th component log probs | Train: 5.645273024639144 | Val: -341.1644673227805
9-th component log probs | Train: 5.703931690557149 | Val: -345.03207567778173
KEYWORD NR_SAMPLES:600 DIM:450 AVG_DIFF:50351.6596
Fitting PCA...
0-th component log probs | Train: 5.661226108976308 | Val: -231.160285254787
1-th component log probs | Train: 5.141444397206923 | Val: -86.82465436606914
2-th component log probs | Train: 5.227551265044853 | Val: -96.06815081032096
3-th component log probs | Train: 5.438978988976142 | Val: -146.0273179240573
4-th component log probs | Train: 5.652514150306951 | Val: -202.97247231896498
5-th component log probs | Train: 5.617454691533757 | Val: -158.26453122510546
6-th component log probs | Train: 5.62495803677085 | Val: -176.5745363392616
7-th component log probs | Train: 5.567600739997757 | Val: -132.2707414556633
8-th component log probs | Train: 5.679501915791186 | Val: -310.54323239885736
9-th component log probs | Train: 5.732365292247763 | Val: -314.14048458870275
KEYWORD NR_SAMPLES:600 DIM:500 AVG_DIFF:42263.8262
0-th component log probs | Train: 5.668894380814597 | Val: -226.49367232110177
1-th component log probs | Train: 5.161189643903799 | Val: -85.49739204938362
2-th component log probs | Train: 5.245333983874869 | Val: -94.45285762507157
3-th component log probs | Train: 5.451843750550694 | Val: -143.2549177476196
4-th component log probs | Train: 5.660386545433456 | Val: -198.94618001622908
5-th component log probs | Train: 5.626146460347858 | Val: -155.1033284709983
6-th component log probs | Train: 5.6334771841160425 | Val: -173.1697234066687
7-th component log probs | Train: 5.577456029900855 | Val: -129.8162215738733
8-th component log probs | Train: 5.686743748582782 | Val: -304.01620419157683
9-th component log probs | Train: 5.738372649350098 | Val: -307.55143951224653
KEYWORD NR_SAMPLES:600 DIM:512 AVG_DIFF:40623.8132
best average differences at 512 dimensions: 40623.813217314324
2022-01-10 04:10.44 [info     ] Training complete              train_loss=0.44498223066329956
2022-01-10 04:10.44 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:10.48 [info     ] Testing complete               test_loss=1.7271722555160522
{'dataset_size': 600,
 'end_test_accuracy': 0.502367377281189,
 'end_test_loss': 1.7271722555160522,
 'end_train_accuracy': 0.994270920753479,
 'end_train_loss': 0.44498223066329956,
 'end_val_accuracy': 0.5712995529174805,
 'end_val_loss': 1.7984459400177002}
2022-01-10 04:10.48 [info     ] Start Predict                  dataset=58006
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:11.23 [info     ] Starting training              dataset=800 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
800
Fitting PCA...
0-th component log probs | Train: 2.85138013570814 | Val: -64.07570699169577
1-th component log probs | Train: 2.275500336456602 | Val: -2.041044992418961
2-th component log probs | Train: 2.354097031177992 | Val: -9.13436466522603
3-th component log probs | Train: 2.441039094132618 | Val: -6.472611829283832
4-th component log probs | Train: 2.813163342214603 | Val: -35.70906019670752
5-th component log probs | Train: 2.719266874440481 | Val: -33.024978296457476
6-th component log probs | Train: 2.789797756551117 | Val: -80.60469812185966
7-th component log probs | Train: 2.635510569747187 | Val: -14.12122574019878
8-th component log probs | Train: 3.059498950475086 | Val: -281.86804469461384
9-th component log probs | Train: 3.0814526971612155 | Val: -170.05630575825327
KEYWORD NR_SAMPLES:800 DIM:50 AVG_DIFF:12586.6737
Fitting PCA...
0-th component log probs | Train: 4.144103173694571 | Val: -304.65922325486684
1-th component log probs | Train: 2.984726554856585 | Val: -11.228652415259576
2-th component log probs | Train: 3.059080175237426 | Val: -24.190062330451568
3-th component log probs | Train: 3.300680733080383 | Val: -60.99979945616971
4-th component log probs | Train: 3.956746595072532 | Val: -175.39772512925822
5-th component log probs | Train: 3.8802168312030534 | Val: -220.76682539362668
6-th component log probs | Train: 4.071547414416318 | Val: -342.61959624810873
7-th component log probs | Train: 3.587712369883069 | Val: -83.71210969143397
8-th component log probs | Train: 4.334175929715664 | Val: -495.4617649245181
9-th component log probs | Train: 4.30120610370655 | Val: -411.55426752183786
KEYWORD NR_SAMPLES:800 DIM:100 AVG_DIFF:73362.0668
Fitting PCA...
0-th component log probs | Train: 4.6986221661762215 | Val: -298.44556412874414
1-th component log probs | Train: 3.5184462397290353 | Val: -29.641619697334455
2-th component log probs | Train: 3.618409601877835 | Val: -62.299664350723454
3-th component log probs | Train: 3.9849442880474446 | Val: -124.64936009402884
4-th component log probs | Train: 4.538335544656711 | Val: -191.86762142095307
5-th component log probs | Train: 4.495593724813159 | Val: -223.06366669238253
6-th component log probs | Train: 4.646458435093159 | Val: -357.30167089670795
7-th component log probs | Train: 4.226270659564239 | Val: -124.06923343769697
8-th component log probs | Train: 4.840036118013253 | Val: -452.7773350446723
9-th component log probs | Train: 4.814471534283624 | Val: -366.0469841366672
KEYWORD NR_SAMPLES:800 DIM:150 AVG_DIFF:69866.4544
Fitting PCA...
0-th component log probs | Train: 4.99707497642552 | Val: -258.59790130072383
1-th component log probs | Train: 3.962477615716888 | Val: -46.73435966052113
2-th component log probs | Train: 4.069311852601861 | Val: -89.77917225335959
3-th component log probs | Train: 4.415178421544115 | Val: -136.9172078970253
4-th component log probs | Train: 4.8645775902931945 | Val: -178.4835348295538
5-th component log probs | Train: 4.832842370349466 | Val: -204.30289741301607
6-th component log probs | Train: 4.954993543969826 | Val: -329.41301668029195
7-th component log probs | Train: 4.604924466028516 | Val: -124.62999374349324
8-th component log probs | Train: 5.10638412518742 | Val: -387.2532674453973
9-th component log probs | Train: 5.084901338335809 | Val: -314.61652593454073
KEYWORD NR_SAMPLES:800 DIM:200 AVG_DIFF:56284.7879
Fitting PCA...
0-th component log probs | Train: 5.181808667621885 | Val: -232.62427981129048
1-th component log probs | Train: 4.291861929067305 | Val: -53.23111491836776
2-th component log probs | Train: 4.3896370636402375 | Val: -96.68409685549072
3-th component log probs | Train: 4.6963230782572785 | Val: -129.3045977332669
4-th component log probs | Train: 5.068472545147167 | Val: -161.59502244449652
5-th component log probs | Train: 5.045712911720317 | Val: -184.18882754279545
6-th component log probs | Train: 5.148538233655423 | Val: -289.423784606647
7-th component log probs | Train: 4.850856214562195 | Val: -116.05671075083258
8-th component log probs | Train: 5.272267963203301 | Val: -336.32208864904896
9-th component log probs | Train: 5.2528656393292525 | Val: -273.50381230815594
KEYWORD NR_SAMPLES:800 DIM:250 AVG_DIFF:44740.2690
Fitting PCA...
0-th component log probs | Train: 5.308938066774976 | Val: -207.07142390255703
1-th component log probs | Train: 4.536317207154533 | Val: -54.13948504641626
2-th component log probs | Train: 4.621918038936312 | Val: -94.9160735379516
3-th component log probs | Train: 4.892772410007206 | Val: -120.65267653415253
4-th component log probs | Train: 5.210071348068487 | Val: -144.93871163461415
5-th component log probs | Train: 5.193059026804344 | Val: -164.78276796560166
6-th component log probs | Train: 5.281589948697058 | Val: -257.3760584674384
7-th component log probs | Train: 5.022548732788609 | Val: -106.36010802118314
8-th component log probs | Train: 5.385728152530799 | Val: -295.1711379237054
9-th component log probs | Train: 5.368909086932673 | Val: -239.61354880590113
KEYWORD NR_SAMPLES:800 DIM:300 AVG_DIFF:35740.0149
Fitting PCA...
0-th component log probs | Train: 5.401374384478999 | Val: -185.97596960854895
1-th component log probs | Train: 4.720691132326676 | Val: -52.319827274041835
2-th component log probs | Train: 4.797614923285364 | Val: -90.33753206412554
3-th component log probs | Train: 5.039556931391705 | Val: -110.67263372696797
4-th component log probs | Train: 5.314151458186739 | Val: -131.2450510286192
5-th component log probs | Train: 5.301123053225495 | Val: -148.6357368116886
6-th component log probs | Train: 5.378701274954035 | Val: -229.20299520588893
7-th component log probs | Train: 5.149981263896098 | Val: -96.64080344460633
8-th component log probs | Train: 5.468353584964842 | Val: -262.44745422885154
9-th component log probs | Train: 5.453201538815689 | Val: -213.8974927436694
KEYWORD NR_SAMPLES:800 DIM:350 AVG_DIFF:28994.7432
Fitting PCA...
0-th component log probs | Train: 5.472386165418127 | Val: -168.3640093989467
1-th component log probs | Train: 4.866206576748809 | Val: -49.74137432631996
2-th component log probs | Train: 4.935990849889828 | Val: -84.93123612898412
3-th component log probs | Train: 5.152167087587275 | Val: -102.04736811524914
4-th component log probs | Train: 5.394265153496827 | Val: -119.39609258146432
5-th component log probs | Train: 5.383794413056462 | Val: -134.76615708070918
6-th component log probs | Train: 5.452838882675068 | Val: -205.92483639141702
7-th component log probs | Train: 5.24893196556179 | Val: -88.23130077435285
8-th component log probs | Train: 5.531401806542104 | Val: -235.5863451739692
9-th component log probs | Train: 5.51782629407209 | Val: -192.4838175873179
KEYWORD NR_SAMPLES:800 DIM:400 AVG_DIFF:23874.5076
Fitting PCA...
0-th component log probs | Train: 5.528382417691544 | Val: -153.0936884987848
1-th component log probs | Train: 4.984014191354391 | Val: -46.95671179481181
2-th component log probs | Train: 5.046517663988429 | Val: -79.09484913700479
3-th component log probs | Train: 5.241971035208285 | Val: -94.11802416213396
4-th component log probs | Train: 5.457905391084263 | Val: -109.14665635564344
5-th component log probs | Train: 5.449422105024015 | Val: -122.67979670713943
6-th component log probs | Train: 5.511205391128238 | Val: -186.7023303084091
7-th component log probs | Train: 5.327656524729794 | Val: -80.98023791561543
8-th component log probs | Train: 5.581071518769622 | Val: -213.82222896494807
9-th component log probs | Train: 5.568953948617117 | Val: -174.62022789421957
KEYWORD NR_SAMPLES:800 DIM:450 AVG_DIFF:19936.3326
Fitting PCA...
0-th component log probs | Train: 5.573836743419538 | Val: -140.2053648216686
1-th component log probs | Train: 5.080804464127724 | Val: -44.23612583469519
2-th component log probs | Train: 5.1378048785572545 | Val: -73.88186475127053
3-th component log probs | Train: 5.315252751987552 | Val: -87.02576638948568
4-th component log probs | Train: 5.509860626021782 | Val: -100.37668873917043
5-th component log probs | Train: 5.502545273668619 | Val: -112.52556134440887
6-th component log probs | Train: 5.558491690617921 | Val: -170.6066975661556
7-th component log probs | Train: 5.392055612426934 | Val: -74.57742083279925
8-th component log probs | Train: 5.6213556295447376 | Val: -195.19289817197992
9-th component log probs | Train: 5.610380584865876 | Val: -159.54758213444126
KEYWORD NR_SAMPLES:800 DIM:500 AVG_DIFF:16863.0111
0-th component log probs | Train: 5.583500839774769 | Val: -137.38795999999812
1-th component log probs | Train: 5.101599534465331 | Val: -43.594158387414346
2-th component log probs | Train: 5.157403128393245 | Val: -72.61459233294879
3-th component log probs | Train: 5.330854696238432 | Val: -85.40032024138921
4-th component log probs | Train: 5.520923249727022 | Val: -98.44339841553838
5-th component log probs | Train: 5.5138579129534655 | Val: -110.28464402451553
6-th component log probs | Train: 5.568523007117311 | Val: -167.15720538477999
7-th component log probs | Train: 5.405852306260226 | Val: -73.15144557970372
8-th component log probs | Train: 5.629900957588962 | Val: -191.10842043267786
9-th component log probs | Train: 5.619183704427033 | Val: -156.28521426506612
KEYWORD NR_SAMPLES:800 DIM:512 AVG_DIFF:16223.5046
best average differences at 50 dimensions: 12586.673693425444
2022-01-10 04:14.14 [info     ] Training complete              train_loss=0.43297961354255676
2022-01-10 04:14.14 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:14.18 [info     ] Testing complete               test_loss=1.5717551708221436
{'dataset_size': 800,
 'end_test_accuracy': 0.5665693879127502,
 'end_test_loss': 1.5717551708221436,
 'end_train_accuracy': 0.9963942170143127,
 'end_train_loss': 0.43297961354255676,
 'end_val_accuracy': 0.6394003033638,
 'end_val_loss': 1.5202407836914062}
2022-01-10 04:14.18 [info     ] Start Predict                  dataset=57806
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:14.44 [info     ] Starting training              dataset=1000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
1000
Fitting PCA...
0-th component log probs | Train: 2.63957122000023 | Val: -17.79705643371677
1-th component log probs | Train: 2.2799975725746777 | Val: -4.097049095682673
2-th component log probs | Train: 2.2798020880740038 | Val: -3.825918316354223
3-th component log probs | Train: 2.3886541185384846 | Val: -9.149765109468838
4-th component log probs | Train: 2.6789065469524007 | Val: -14.2400104443659
5-th component log probs | Train: 2.5947683783630247 | Val: -21.74136168250911
6-th component log probs | Train: 2.5680445453806966 | Val: -32.269434318775716
7-th component log probs | Train: 2.545618345627598 | Val: -8.695258279765898
8-th component log probs | Train: 2.5876745468720337 | Val: -22.553692383122264
9-th component log probs | Train: 2.5442241641888224 | Val: -13.250883369094147
KEYWORD NR_SAMPLES:1000 DIM:50 AVG_DIFF:372.8815
Fitting PCA...
0-th component log probs | Train: 3.689199424781734 | Val: -140.93848481080772
1-th component log probs | Train: 2.921033233975886 | Val: -10.894674655567044
2-th component log probs | Train: 2.9672067874348564 | Val: -14.119201429388871
3-th component log probs | Train: 3.1907324947264826 | Val: -54.105568276182694
4-th component log probs | Train: 3.670600770306141 | Val: -136.66170056062973
5-th component log probs | Train: 3.6122775401463514 | Val: -172.06590905803822
6-th component log probs | Train: 3.466860213535287 | Val: -122.09458468758483
7-th component log probs | Train: 3.462691028759155 | Val: -75.67229749792293
8-th component log probs | Train: 3.46307175272422 | Val: -150.51518321621407
9-th component log probs | Train: 3.560831249694081 | Val: -163.17847248857072
KEYWORD NR_SAMPLES:1000 DIM:100 AVG_DIFF:14877.8154
Fitting PCA...
0-th component log probs | Train: 4.328417911453668 | Val: -171.23987096805507
1-th component log probs | Train: 3.419925319859425 | Val: -31.23210081117175
2-th component log probs | Train: 3.5010988989912946 | Val: -45.673266678941424
3-th component log probs | Train: 3.8714479663466896 | Val: -130.48944032961867
4-th component log probs | Train: 4.315522421155149 | Val: -174.5323810821482
5-th component log probs | Train: 4.280137276527788 | Val: -223.5414496885627
6-th component log probs | Train: 4.116274920011671 | Val: -196.96139717672497
7-th component log probs | Train: 4.132871867896298 | Val: -127.49485003512058
8-th component log probs | Train: 4.115469790644067 | Val: -256.75506799719983
9-th component log probs | Train: 4.231943577798057 | Val: -228.12632961564813
KEYWORD NR_SAMPLES:1000 DIM:150 AVG_DIFF:31618.7094
Fitting PCA...
0-th component log probs | Train: 4.694950436535293 | Val: -175.66472604993385
1-th component log probs | Train: 3.867337328145922 | Val: -54.34916096123632
2-th component log probs | Train: 3.956122543410836 | Val: -68.9621504688177
3-th component log probs | Train: 4.317715951495792 | Val: -145.55778579841274
4-th component log probs | Train: 4.682051801098579 | Val: -171.19627187167129
5-th component log probs | Train: 4.6589457603335 | Val: -216.38838878675344
6-th component log probs | Train: 4.514826113145823 | Val: -202.7862500581087
7-th component log probs | Train: 4.533927493910561 | Val: -130.49370519599495
8-th component log probs | Train: 4.5195849066369265 | Val: -264.5468074726829
9-th component log probs | Train: 4.618672741469022 | Val: -221.30831914596942
KEYWORD NR_SAMPLES:1000 DIM:200 AVG_DIFF:32813.9550
Fitting PCA...
0-th component log probs | Train: 4.929124417873927 | Val: -161.93887244293967
1-th component log probs | Train: 4.208843793307799 | Val: -61.08529860563532
2-th component log probs | Train: 4.288263895503678 | Val: -80.52406925445212
3-th component log probs | Train: 4.61090280874037 | Val: -143.51169552526935
4-th component log probs | Train: 4.916388951484887 | Val: -156.39321766993731
5-th component log probs | Train: 4.899544540710127 | Val: -198.93727511595625
6-th component log probs | Train: 4.77588188550919 | Val: -188.34433092101528
7-th component log probs | Train: 4.793975168153262 | Val: -123.90522031504344
8-th component log probs | Train: 4.7799998674648005 | Val: -252.79998195227162
9-th component log probs | Train: 4.8659962255450795 | Val: -203.7245711155469
KEYWORD NR_SAMPLES:1000 DIM:250 AVG_DIFF:29252.8299
Fitting PCA...
0-th component log probs | Train: 5.090721845314314 | Val: -149.86633920583157
1-th component log probs | Train: 4.460521410884348 | Val: -63.545344342674646
2-th component log probs | Train: 4.531654735558151 | Val: -80.19663829618695
3-th component log probs | Train: 4.818082103642482 | Val: -136.57507558769262
4-th component log probs | Train: 5.079577490619407 | Val: -143.4972550282773
5-th component log probs | Train: 5.066530052362198 | Val: -184.58023408177343
6-th component log probs | Train: 4.957800912627273 | Val: -172.74521183429874
7-th component log probs | Train: 4.976608983646775 | Val: -113.78536148245804
8-th component log probs | Train: 4.961985378630154 | Val: -229.50599063474417
9-th component log probs | Train: 5.037651954580655 | Val: -184.96995620712738
KEYWORD NR_SAMPLES:1000 DIM:300 AVG_DIFF:25060.9257
Fitting PCA...
0-th component log probs | Train: 5.209835417138958 | Val: -136.709289909132
1-th component log probs | Train: 4.652864073577886 | Val: -62.32436349624354
2-th component log probs | Train: 4.716751436674304 | Val: -77.38328431740207
3-th component log probs | Train: 4.9719429877613175 | Val: -126.253980062409
4-th component log probs | Train: 5.19987773799617 | Val: -130.5086369741962
5-th component log probs | Train: 5.189190957011846 | Val: -168.30230357057704
6-th component log probs | Train: 5.093099578628456 | Val: -158.04975392843284
7-th component log probs | Train: 5.110756665189953 | Val: -104.89932431053002
8-th component log probs | Train: 5.096638593415504 | Val: -211.3714548098675
9-th component log probs | Train: 5.164044599102437 | Val: -169.04511933189823
KEYWORD NR_SAMPLES:1000 DIM:350 AVG_DIFF:21302.8822
Fitting PCA...
0-th component log probs | Train: 5.301923227671079 | Val: -125.44823972034864
1-th component log probs | Train: 4.8049830689250355 | Val: -59.30451968683741
2-th component log probs | Train: 4.861989780639631 | Val: -73.11237259963781
3-th component log probs | Train: 5.090965362195867 | Val: -116.86540894000991
4-th component log probs | Train: 5.292491554466108 | Val: -119.69256111521216
5-th component log probs | Train: 5.2837098388686385 | Val: -154.48252209723302
6-th component log probs | Train: 5.198163299009943 | Val: -145.8748780083947
7-th component log probs | Train: 5.214073218597255 | Val: -96.79510364638664
8-th component log probs | Train: 5.20088170897774 | Val: -194.01082366071284
9-th component log probs | Train: 5.261186435109338 | Val: -154.91543830785363
KEYWORD NR_SAMPLES:1000 DIM:400 AVG_DIFF:18187.6295
Fitting PCA...
0-th component log probs | Train: 5.3750982112194885 | Val: -115.23465818237194
1-th component log probs | Train: 4.927597754559846 | Val: -56.240648594798266
2-th component log probs | Train: 4.979113352148394 | Val: -68.61862842832662
3-th component log probs | Train: 5.1863752597574155 | Val: -107.98034264370786
4-th component log probs | Train: 5.366212783457869 | Val: -110.39767873992854
5-th component log probs | Train: 5.358793383942938 | Val: -142.01078138892146
6-th component log probs | Train: 5.281738545768046 | Val: -134.16793129342017
7-th component log probs | Train: 5.2963558783128235 | Val: -89.64490643717915
8-th component log probs | Train: 5.284090307240767 | Val: -178.34245886280112
9-th component log probs | Train: 5.33841365590151 | Val: -142.35725440532883
KEYWORD NR_SAMPLES:1000 DIM:450 AVG_DIFF:15562.3445
Fitting PCA...
0-th component log probs | Train: 5.434714468546959 | Val: -106.57288233112044
1-th component log probs | Train: 5.0290677276909115 | Val: -53.11636462958367
2-th component log probs | Train: 5.075777371450908 | Val: -64.31079093024971
3-th component log probs | Train: 5.264154676002794 | Val: -100.29628311657129
4-th component log probs | Train: 5.426247611038383 | Val: -102.13196265582705
5-th component log probs | Train: 5.420031087606539 | Val: -131.08649620196306
6-th component log probs | Train: 5.350096992610799 | Val: -124.12473371528088
7-th component log probs | Train: 5.363734960097691 | Val: -83.2377444115407
8-th component log probs | Train: 5.352221016159741 | Val: -164.4202715372148
9-th component log probs | Train: 5.401701237835141 | Val: -131.48051522551967
KEYWORD NR_SAMPLES:1000 DIM:500 AVG_DIFF:13426.0290
0-th component log probs | Train: 5.447452102861104 | Val: -104.57211991557263
1-th component log probs | Train: 5.050861703195708 | Val: -52.37122067740136
2-th component log probs | Train: 5.096594277079024 | Val: -63.290694168697655
3-th component log probs | Train: 5.280794567954541 | Val: -98.56608403347305
4-th component log probs | Train: 5.439133432497477 | Val: -100.23707286298381
5-th component log probs | Train: 5.433108701229523 | Val: -128.59493750157193
6-th component log probs | Train: 5.364741165518999 | Val: -121.7955377063238
7-th component log probs | Train: 5.378138712655476 | Val: -81.743490721069
8-th component log probs | Train: 5.366820810306848 | Val: -161.2912244114182
9-th component log probs | Train: 5.415198146171439 | Val: -128.98045444183157
KEYWORD NR_SAMPLES:1000 DIM:512 AVG_DIFF:12959.0585
best average differences at 50 dimensions: 372.88153865173524
2022-01-10 04:20.52 [info     ] Training complete              train_loss=0.30591922998428345
2022-01-10 04:20.52 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:20.56 [info     ] Testing complete               test_loss=1.4812431335449219
{'dataset_size': 1000,
 'end_test_accuracy': 0.6639409065246582,
 'end_test_loss': 1.4812431335449219,
 'end_train_accuracy': 1.0,
 'end_train_loss': 0.30591922998428345,
 'end_val_accuracy': 0.6953558921813965,
 'end_val_loss': 1.3147661685943604}
2022-01-10 04:20.56 [info     ] Start Predict                  dataset=57606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:21.21 [info     ] Starting training              dataset=2000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
2000
Fitting PCA...
0-th component log probs | Train: 2.405113739061963 | Val: -1.1441141339611645
1-th component log probs | Train: 2.2062124095732143 | Val: 0.3701921943233802
2-th component log probs | Train: 2.366497144137247 | Val: -1.2147907700314415
3-th component log probs | Train: 2.2223744787118327 | Val: -1.2265050220133378
4-th component log probs | Train: 2.42030581919647 | Val: -1.6264977316897828
5-th component log probs | Train: 2.4401425608675034 | Val: -2.6344449420468354
6-th component log probs | Train: 2.336219581381004 | Val: -2.8552087500012435
7-th component log probs | Train: 2.497415697299661 | Val: -3.264114328157993
8-th component log probs | Train: 2.373160102225166 | Val: -3.543948155956051
9-th component log probs | Train: 2.262710842472392 | Val: -2.6221575255562364
KEYWORD NR_SAMPLES:2000 DIM:50 AVG_DIFF:20.1837
Fitting PCA...
0-th component log probs | Train: 3.032914073614884 | Val: -5.34302353185478
1-th component log probs | Train: 2.77794448282384 | Val: -0.7103286192443646
2-th component log probs | Train: 2.9981701095515203 | Val: -4.499775889214662
3-th component log probs | Train: 2.796611462787584 | Val: -4.160826977378671
4-th component log probs | Train: 3.0686613901668425 | Val: -8.521250534543734
5-th component log probs | Train: 3.0480302416139593 | Val: -8.836549995813233
6-th component log probs | Train: 2.9071158421219514 | Val: -6.021543837916979
7-th component log probs | Train: 3.2040419001273737 | Val: -16.175653024392847
8-th component log probs | Train: 2.9659240336317163 | Val: -9.21688982169973
9-th component log probs | Train: 2.8924512740315 | Val: -8.787246391130116
KEYWORD NR_SAMPLES:2000 DIM:100 AVG_DIFF:120.2649
Fitting PCA...
0-th component log probs | Train: 3.444388448614027 | Val: -12.812026414031344
1-th component log probs | Train: 3.154291802595361 | Val: -2.190894305286554
2-th component log probs | Train: 3.4114092314519335 | Val: -8.255606836087589
3-th component log probs | Train: 3.1749688814240713 | Val: -7.5276019061404105
4-th component log probs | Train: 3.5643611353908424 | Val: -22.630446102221942
5-th component log probs | Train: 3.4478211309169207 | Val: -16.716398130154563
6-th component log probs | Train: 3.261764562056974 | Val: -8.446716356039854
7-th component log probs | Train: 3.7584158899308875 | Val: -42.2073614915685
8-th component log probs | Train: 3.349758489303248 | Val: -16.76824407516386
9-th component log probs | Train: 3.3678709004562832 | Val: -21.70281525302967
KEYWORD NR_SAMPLES:2000 DIM:150 AVG_DIFF:491.9485
Fitting PCA...
0-th component log probs | Train: 3.8125142813753596 | Val: -21.758345808372137
1-th component log probs | Train: 3.4677345199616183 | Val: -4.957542551442052
2-th component log probs | Train: 3.748139466863957 | Val: -14.300551636070221
3-th component log probs | Train: 3.4991595057803693 | Val: -14.603852886870744
4-th component log probs | Train: 3.9980644311693334 | Val: -37.15454821525616
5-th component log probs | Train: 3.8042805148924677 | Val: -28.80074290294467
6-th component log probs | Train: 3.557062620446374 | Val: -12.945559961086945
7-th component log probs | Train: 4.189759528380138 | Val: -57.60651499504814
8-th component log probs | Train: 3.6815292846094825 | Val: -24.671124540736947
9-th component log probs | Train: 3.7926180255950848 | Val: -40.4950846748376
KEYWORD NR_SAMPLES:2000 DIM:200 AVG_DIFF:1099.1343
Fitting PCA...
0-th component log probs | Train: 4.119004657249012 | Val: -29.10414446926036
1-th component log probs | Train: 3.7479479932959263 | Val: -9.434221569477248
2-th component log probs | Train: 4.037803068967481 | Val: -20.005595685713633
3-th component log probs | Train: 3.8099105416870045 | Val: -23.982255339032996
4-th component log probs | Train: 4.318416887377255 | Val: -43.58037867268086
5-th component log probs | Train: 4.1055620123702665 | Val: -36.421886832073014
6-th component log probs | Train: 3.817034526692265 | Val: -18.814272791193677
7-th component log probs | Train: 4.489406889834053 | Val: -60.63392576571757
8-th component log probs | Train: 3.972112391424586 | Val: -34.21536769067011
9-th component log probs | Train: 4.131177878863668 | Val: -50.873309437173695
KEYWORD NR_SAMPLES:2000 DIM:250 AVG_DIFF:1580.1807
Fitting PCA...
0-th component log probs | Train: 4.362754384643141 | Val: -32.32015118213662
1-th component log probs | Train: 3.9978845421228653 | Val: -12.891485558553272
2-th component log probs | Train: 4.272903212624002 | Val: -22.35783160442833
3-th component log probs | Train: 4.072469220502005 | Val: -29.404722892515206
4-th component log probs | Train: 4.55496225408566 | Val: -45.04646818263825
5-th component log probs | Train: 4.3441894903210665 | Val: -40.53823653571805
6-th component log probs | Train: 4.051410182669106 | Val: -24.0126176238842
7-th component log probs | Train: 4.705576367311519 | Val: -59.71394781322471
8-th component log probs | Train: 4.216817725353458 | Val: -40.110423237188954
9-th component log probs | Train: 4.386850615624423 | Val: -54.265305406530864
KEYWORD NR_SAMPLES:2000 DIM:300 AVG_DIFF:1827.7983
Fitting PCA...
0-th component log probs | Train: 4.553846009752981 | Val: -33.06816238424207
1-th component log probs | Train: 4.209338660810805 | Val: -15.208743711119377
2-th component log probs | Train: 4.462174987216869 | Val: -23.319158864494103
3-th component log probs | Train: 4.290910137746484 | Val: -33.04768817259097
4-th component log probs | Train: 4.7338380854816124 | Val: -44.36245580956135
5-th component log probs | Train: 4.532835182552521 | Val: -41.10502094381223
6-th component log probs | Train: 4.2532308824365295 | Val: -27.647408130334934
7-th component log probs | Train: 4.868523117917912 | Val: -56.77770039966408
8-th component log probs | Train: 4.418139235975533 | Val: -41.86510624823149
9-th component log probs | Train: 4.583329990413556 | Val: -54.51094864599678
KEYWORD NR_SAMPLES:2000 DIM:350 AVG_DIFF:1890.3891
Fitting PCA...
0-th component log probs | Train: 4.7075313329758774 | Val: -32.821536406387175
1-th component log probs | Train: 4.387631658455864 | Val: -16.19783611194148
2-th component log probs | Train: 4.616848167022761 | Val: -23.383836420335317
3-th component log probs | Train: 4.467889144410956 | Val: -34.48073810264498
4-th component log probs | Train: 4.873934546086572 | Val: -42.71709385616031
5-th component log probs | Train: 4.686454940079306 | Val: -40.532973421330006
6-th component log probs | Train: 4.42342693049316 | Val: -28.91720969365046
7-th component log probs | Train: 4.995134604707025 | Val: -53.78964570381863
8-th component log probs | Train: 4.580575081608443 | Val: -41.87974442565135
9-th component log probs | Train: 4.7394261997243134 | Val: -53.051305279897235
KEYWORD NR_SAMPLES:2000 DIM:400 AVG_DIFF:1850.8507
Fitting PCA...
0-th component log probs | Train: 4.832938110414901 | Val: -31.7368620973071
1-th component log probs | Train: 4.536760110064315 | Val: -16.665469880776367
2-th component log probs | Train: 4.74542475403774 | Val: -22.953069767415922
3-th component log probs | Train: 4.61533620538736 | Val: -34.09695645081695
4-th component log probs | Train: 4.986555066240891 | Val: -40.83900968597532
5-th component log probs | Train: 4.812436875298914 | Val: -39.094010534002415
6-th component log probs | Train: 4.566641526331065 | Val: -29.272937818834745
7-th component log probs | Train: 5.096442023547676 | Val: -50.703867909562966
8-th component log probs | Train: 4.714549088356847 | Val: -41.50825463467963
9-th component log probs | Train: 4.865184853321577 | Val: -51.53955234476129
KEYWORD NR_SAMPLES:2000 DIM:450 AVG_DIFF:1765.7325
Fitting PCA...
0-th component log probs | Train: 4.937786281098763 | Val: -30.370231753296117
1-th component log probs | Train: 4.663981193931455 | Val: -16.66012892280429
2-th component log probs | Train: 4.854638153974398 | Val: -22.11691235722053
3-th component log probs | Train: 4.739230934075231 | Val: -33.42497529514839
4-th component log probs | Train: 5.079641488352871 | Val: -38.624695305569126
5-th component log probs | Train: 4.918136139241392 | Val: -37.34404552257317
6-th component log probs | Train: 4.689050836391519 | Val: -28.600582034998745
7-th component log probs | Train: 5.179932027068788 | Val: -47.648461248209095
8-th component log probs | Train: 4.827357448273732 | Val: -40.15485505513869
9-th component log probs | Train: 4.9690833624036355 | Val: -48.98246621431051
KEYWORD NR_SAMPLES:2000 DIM:500 AVG_DIFF:1641.4714
0-th component log probs | Train: 4.96042062306655 | Val: -30.016289219463744
1-th component log probs | Train: 4.6920042549274585 | Val: -16.58243763309733
2-th component log probs | Train: 4.878334222339303 | Val: -21.891231853248957
3-th component log probs | Train: 4.76609012345829 | Val: -33.16349005386782
4-th component log probs | Train: 5.099663412088185 | Val: -38.09044344261661
5-th component log probs | Train: 4.941031121295157 | Val: -36.834657469749956
6-th component log probs | Train: 4.716017241317039 | Val: -28.36963368566007
7-th component log probs | Train: 5.19791160639318 | Val: -46.87168203767063
8-th component log probs | Train: 4.852174116978387 | Val: -39.682322498043874
9-th component log probs | Train: 4.991483243100214 | Val: -48.28736038245137
KEYWORD NR_SAMPLES:2000 DIM:512 AVG_DIFF:1606.9688
best average differences at 50 dimensions: 20.18367044304747
2022-01-10 04:25.39 [info     ] Training complete              train_loss=0.33363187313079834
2022-01-10 04:25.39 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:25.43 [info     ] Testing complete               test_loss=0.9773097634315491
{'dataset_size': 2000,
 'end_test_accuracy': 0.72591632604599,
 'end_test_loss': 0.9773097634315491,
 'end_train_accuracy': 0.99365234375,
 'end_train_loss': 0.33363187313079834,
 'end_val_accuracy': 0.7794123888015747,
 'end_val_loss': 0.9188498258590698}
2022-01-10 04:25.43 [info     ] Start Predict                  dataset=56606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:26.10 [info     ] Starting training              dataset=4000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
4000
Fitting PCA...
0-th component log probs | Train: 2.2839173921154297 | Val: 1.0252348797392088
1-th component log probs | Train: 2.145448873152715 | Val: 1.3506705882172783
2-th component log probs | Train: 2.0936144572092776 | Val: 1.4424210080369786
3-th component log probs | Train: 2.1124783264734854 | Val: 0.5729441524624779
4-th component log probs | Train: 2.1316973413399625 | Val: 1.1274155008955964
5-th component log probs | Train: 2.1184823422108643 | Val: 0.8032340582273144
6-th component log probs | Train: 2.04437097465026 | Val: 0.7509146409340086
7-th component log probs | Train: 2.251258846266707 | Val: 1.1292217270147462
8-th component log probs | Train: 2.0499744052421662 | Val: 0.49993012578189555
9-th component log probs | Train: 2.1199192417434003 | Val: 0.634797652071469
KEYWORD NR_SAMPLES:4000 DIM:50 AVG_DIFF:1.5289
Fitting PCA...
0-th component log probs | Train: 2.8465283235757584 | Val: 0.5114463944231963
1-th component log probs | Train: 2.681056126698413 | Val: 1.4135016589323126
2-th component log probs | Train: 2.633992334041416 | Val: 1.6706402969421879
3-th component log probs | Train: 2.6610117135353675 | Val: 0.3579309244652474
4-th component log probs | Train: 2.6868645186700597 | Val: 0.804378224474119
5-th component log probs | Train: 2.6720390007044217 | Val: 0.34856014483546527
6-th component log probs | Train: 2.571910272885207 | Val: 0.34403997260943237
7-th component log probs | Train: 2.8209759482849073 | Val: 0.1678208298288629
8-th component log probs | Train: 2.5743743694768657 | Val: 0.41944379525314324
9-th component log probs | Train: 2.654799723871195 | Val: 0.007878869302733064
KEYWORD NR_SAMPLES:4000 DIM:100 AVG_DIFF:4.5886
Fitting PCA...
0-th component log probs | Train: 3.1857450580045885 | Val: -0.08971391843677579
1-th component log probs | Train: 2.9957050718993683 | Val: 1.3404880942219857
2-th component log probs | Train: 2.9385985287483622 | Val: 1.8027725664839627
3-th component log probs | Train: 2.9684931742270657 | Val: 0.2541366316455607
4-th component log probs | Train: 3.023558365402098 | Val: 0.2480718752046463
5-th component log probs | Train: 3.020783320858896 | Val: -0.3654874458236655
6-th component log probs | Train: 2.8968700685846143 | Val: 0.023388764298015917
7-th component log probs | Train: 3.196280057695248 | Val: -1.3563775219038146
8-th component log probs | Train: 2.889541463581638 | Val: 0.2615491299154784
9-th component log probs | Train: 2.990563262190104 | Val: -0.5332511075140633
KEYWORD NR_SAMPLES:4000 DIM:150 AVG_DIFF:8.9604
Fitting PCA...
0-th component log probs | Train: 3.45768801738734 | Val: -0.9807593173071938
1-th component log probs | Train: 3.238922833000287 | Val: 1.1902851595065764
2-th component log probs | Train: 3.165708256054979 | Val: 1.833021055560724
3-th component log probs | Train: 3.2095169363060374 | Val: -0.014030020444963017
4-th component log probs | Train: 3.2930340283941026 | Val: -0.4422465465790903
5-th component log probs | Train: 3.3016181627617445 | Val: -1.6076640108663307
6-th component log probs | Train: 3.158048656096331 | Val: -0.5241101118676368
7-th component log probs | Train: 3.514548166814594 | Val: -4.02430408873999
8-th component log probs | Train: 3.126897024316021 | Val: -0.013293613795651424
9-th component log probs | Train: 3.261132452377716 | Val: -1.4070488289060252
KEYWORD NR_SAMPLES:4000 DIM:200 AVG_DIFF:17.6163
Fitting PCA...
0-th component log probs | Train: 3.685549615789479 | Val: -1.994716325395329
1-th component log probs | Train: 3.4467278292558086 | Val: 0.8646746405894229
2-th component log probs | Train: 3.35432083005781 | Val: 1.7838894668229066
3-th component log probs | Train: 3.4083585569840467 | Val: -0.34846457409792425
4-th component log probs | Train: 3.5279366940313373 | Val: -1.5769216282548582
5-th component log probs | Train: 3.544241223759772 | Val: -3.3454597384001845
6-th component log probs | Train: 3.3807945781232815 | Val: -1.475033125883677
7-th component log probs | Train: 3.804856902777204 | Val: -7.725350539196171
8-th component log probs | Train: 3.3276777826369104 | Val: -0.30936575060243776
9-th component log probs | Train: 3.493117849103768 | Val: -2.915870201405789
KEYWORD NR_SAMPLES:4000 DIM:250 AVG_DIFF:33.9868
Fitting PCA...
0-th component log probs | Train: 3.8889943120159702 | Val: -3.2491805206764277
1-th component log probs | Train: 3.627661813591046 | Val: 0.34291268669524255
2-th component log probs | Train: 3.510532891349262 | Val: 1.6633488453544636
3-th component log probs | Train: 3.5798929804486983 | Val: -0.9285377715976351
4-th component log probs | Train: 3.742080747757797 | Val: -3.2505863180765022
5-th component log probs | Train: 3.766263967622388 | Val: -5.362528527961837
6-th component log probs | Train: 3.5796965429141974 | Val: -3.1036519374889373
7-th component log probs | Train: 4.054264340157047 | Val: -10.536546750813569
8-th component log probs | Train: 3.50503287218935 | Val: -1.021742827150541
9-th component log probs | Train: 3.7035543501888886 | Val: -5.1077733716911835
KEYWORD NR_SAMPLES:4000 DIM:300 AVG_DIFF:57.3404
Fitting PCA...
0-th component log probs | Train: 4.070322380443469 | Val: -4.67631384954877
1-th component log probs | Train: 3.7921213396086655 | Val: -0.27501340316016787
2-th component log probs | Train: 3.6503647776406516 | Val: 1.4721448173594245
3-th component log probs | Train: 3.7340831462875546 | Val: -1.6736591276008848
4-th component log probs | Train: 3.938053657080309 | Val: -4.964428135709314
5-th component log probs | Train: 3.962180306707105 | Val: -7.5523582476049915
6-th component log probs | Train: 3.764352380967947 | Val: -4.787316217529984
7-th component log probs | Train: 4.265423504206855 | Val: -12.60213826043327
8-th component log probs | Train: 3.6636757512297784 | Val: -1.7897711966271654
9-th component log probs | Train: 3.897260218648647 | Val: -7.205418317566616
KEYWORD NR_SAMPLES:4000 DIM:350 AVG_DIFF:84.9528
Fitting PCA...
0-th component log probs | Train: 4.230620711114303 | Val: -5.612069042566363
1-th component log probs | Train: 3.940355566467784 | Val: -0.9143425482714588
2-th component log probs | Train: 3.7792896388096313 | Val: 1.2882568727227621
3-th component log probs | Train: 3.876412867202221 | Val: -2.4912671235225465
4-th component log probs | Train: 4.112234846075515 | Val: -6.50224832321039
5-th component log probs | Train: 4.140161782445557 | Val: -9.298567744236818
6-th component log probs | Train: 3.93603431991795 | Val: -6.525001649566882
7-th component log probs | Train: 4.439896676955038 | Val: -13.694470457457516
8-th component log probs | Train: 3.8122815987950567 | Val: -2.8478370367190435
9-th component log probs | Train: 4.074146881074242 | Val: -9.18185055420663
KEYWORD NR_SAMPLES:4000 DIM:400 AVG_DIFF:111.8833
Fitting PCA...
0-th component log probs | Train: 4.369808107165793 | Val: -6.262204826435845
1-th component log probs | Train: 4.077657843230289 | Val: -1.5536150256922439
2-th component log probs | Train: 3.8986344638815478 | Val: 1.0323902009251078
3-th component log probs | Train: 4.008774982924354 | Val: -3.2196951878113373
4-th component log probs | Train: 4.268525771994572 | Val: -7.592426803257862
5-th component log probs | Train: 4.294045577769486 | Val: -10.271504447247558
6-th component log probs | Train: 4.092253330511643 | Val: -7.776902172904035
7-th component log probs | Train: 4.583494314187724 | Val: -14.091542600107081
8-th component log probs | Train: 3.9532021616933415 | Val: -3.8951526618365544
9-th component log probs | Train: 4.230920563170688 | Val: -10.496117359210873
KEYWORD NR_SAMPLES:4000 DIM:450 AVG_DIFF:132.6171
Fitting PCA...
0-th component log probs | Train: 4.494050996038688 | Val: -6.608631105069613
1-th component log probs | Train: 4.205822698807699 | Val: -2.0451760470155844
2-th component log probs | Train: 4.013755976193967 | Val: 0.8095450635839979
3-th component log probs | Train: 4.13533948354993 | Val: -3.8593415040111374
4-th component log probs | Train: 4.406065994226883 | Val: -8.223963019881964
5-th component log probs | Train: 4.430547650081094 | Val: -10.780424963690617
6-th component log probs | Train: 4.234048529859395 | Val: -8.70530886055513
7-th component log probs | Train: 4.704890669843222 | Val: -14.132931863868565
8-th component log probs | Train: 4.085798967055444 | Val: -4.752318498518266
9-th component log probs | Train: 4.370261236310351 | Val: -11.348662008729631
KEYWORD NR_SAMPLES:4000 DIM:500 AVG_DIFF:147.4905
0-th component log probs | Train: 4.521602154780401 | Val: -6.636450265769421
1-th component log probs | Train: 4.235724045697912 | Val: -2.1337531324943515
2-th component log probs | Train: 4.041986689223627 | Val: 0.7759474869510498
3-th component log probs | Train: 4.164934084180256 | Val: -3.955325721232587
4-th component log probs | Train: 4.436607158212798 | Val: -8.315885636556908
5-th component log probs | Train: 4.460878744412426 | Val: -10.815335729106717
6-th component log probs | Train: 4.2663550252987 | Val: -8.872665865929253
7-th component log probs | Train: 4.731472636227726 | Val: -14.049946896457355
8-th component log probs | Train: 4.116544895146424 | Val: -4.916238034215406
9-th component log probs | Train: 4.401708804369696 | Val: -11.467328322264835
KEYWORD NR_SAMPLES:4000 DIM:512 AVG_DIFF:149.6460
best average differences at 50 dimensions: 1.528885262253442
2022-01-10 04:32.28 [info     ] Training complete              train_loss=0.39227280020713806
2022-01-10 04:32.28 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:32.32 [info     ] Testing complete               test_loss=0.7256457805633545
{'dataset_size': 4000,
 'end_test_accuracy': 0.7816595435142517,
 'end_test_loss': 0.7256457805633545,
 'end_train_accuracy': 0.9722222089767456,
 'end_train_loss': 0.39227280020713806,
 'end_val_accuracy': 0.8341397643089294,
 'end_val_loss': 0.7472828030586243}
2022-01-10 04:32.32 [info     ] Start Predict                  dataset=54606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:32.58 [info     ] Starting training              dataset=6000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
6000
Fitting PCA...
0-th component log probs | Train: 2.030295674893276 | Val: 1.4127073462677657
1-th component log probs | Train: 2.0434341347509326 | Val: 1.603589708052761
2-th component log probs | Train: 2.0429059503906686 | Val: 1.3735541270626157
3-th component log probs | Train: 2.064436130744279 | Val: 0.7747476815509325
4-th component log probs | Train: 2.0076325029845803 | Val: 1.2743596481861363
5-th component log probs | Train: 2.072440969849898 | Val: 1.1012339922728855
6-th component log probs | Train: 1.941114579798348 | Val: 1.2137169181198209
7-th component log probs | Train: 2.0817670531727805 | Val: 1.337088501302516
8-th component log probs | Train: 2.0691594046516593 | Val: 1.0213739718455974
9-th component log probs | Train: 2.0450642887348884 | Val: 0.7152868556059461
KEYWORD NR_SAMPLES:6000 DIM:50 AVG_DIFF:0.8117
Fitting PCA...
0-th component log probs | Train: 2.5751979491484684 | Val: 1.4875450372379906
1-th component log probs | Train: 2.574149993940442 | Val: 1.8553022114215652
2-th component log probs | Train: 2.58120206578071 | Val: 1.6734453435277081
3-th component log probs | Train: 2.606041882522321 | Val: 0.8833657357451256
4-th component log probs | Train: 2.5572356939920744 | Val: 1.4602289312923147
5-th component log probs | Train: 2.60949928509985 | Val: 1.0652738725537958
6-th component log probs | Train: 2.4711434942240684 | Val: 1.4430102779996252
7-th component log probs | Train: 2.653678931671848 | Val: 1.337884175968237
8-th component log probs | Train: 2.6253183549267205 | Val: 0.9025811347189289
9-th component log probs | Train: 2.5794504681475883 | Val: 0.6192168887466842
KEYWORD NR_SAMPLES:6000 DIM:100 AVG_DIFF:1.8678
Fitting PCA...
0-th component log probs | Train: 2.895817858314387 | Val: 1.525800683212111
1-th component log probs | Train: 2.892774499416865 | Val: 1.9869851788873063
2-th component log probs | Train: 2.888237584248434 | Val: 1.862098292610352
3-th component log probs | Train: 2.908648622666986 | Val: 1.0573987706572017
4-th component log probs | Train: 2.880429844692494 | Val: 1.4840798373176398
5-th component log probs | Train: 2.9151029077457307 | Val: 1.1622520664485443
6-th component log probs | Train: 2.775678818834715 | Val: 1.6283201262220535
7-th component log probs | Train: 2.9917169280418685 | Val: 1.1971051213487525
8-th component log probs | Train: 2.9466017632281605 | Val: 0.9586938912952476
9-th component log probs | Train: 2.899535213920144 | Val: 0.5005185889505267
KEYWORD NR_SAMPLES:6000 DIM:150 AVG_DIFF:2.6444
Fitting PCA...
0-th component log probs | Train: 3.1417016785430945 | Val: 1.460171506498672
1-th component log probs | Train: 3.138450216398963 | Val: 2.0524928367792015
2-th component log probs | Train: 3.113628354600568 | Val: 1.999085751038596
3-th component log probs | Train: 3.1358687642840715 | Val: 1.1422872214785567
4-th component log probs | Train: 3.1292089168064754 | Val: 1.381922113750309
5-th component log probs | Train: 3.1519274915808535 | Val: 1.0892615519581295
6-th component log probs | Train: 3.0083515204158715 | Val: 1.7204836820434841
7-th component log probs | Train: 3.2529055216239646 | Val: 0.8661506810986849
8-th component log probs | Train: 3.1830177972305753 | Val: 0.9078709427929148
9-th component log probs | Train: 3.1465492665332233 | Val: 0.3202650918649444
KEYWORD NR_SAMPLES:6000 DIM:200 AVG_DIFF:3.7050
Fitting PCA...
0-th component log probs | Train: 3.3430499104586153 | Val: 1.2210278496631204
1-th component log probs | Train: 3.3325573208551713 | Val: 2.0677431712279986
2-th component log probs | Train: 3.293230481681189 | Val: 2.0404776031267757
3-th component log probs | Train: 3.3200534597999614 | Val: 1.1687583912318122
4-th component log probs | Train: 3.333360508260411 | Val: 1.1960023979022303
5-th component log probs | Train: 3.350114314612218 | Val: 0.8974692355955699
6-th component log probs | Train: 3.195376486358091 | Val: 1.6942651139120923
7-th component log probs | Train: 3.475131018115904 | Val: 0.2394562966663072
8-th component log probs | Train: 3.373293791608386 | Val: 0.7849498663305793
9-th component log probs | Train: 3.350032691718109 | Val: -0.07296632201321415
KEYWORD NR_SAMPLES:6000 DIM:250 AVG_DIFF:5.4023
Fitting PCA...
0-th component log probs | Train: 3.512988006134746 | Val: 0.9709295767378298
1-th component log probs | Train: 3.495681584302991 | Val: 2.002110725245536
2-th component log probs | Train: 3.4488637797609174 | Val: 2.0533275843591476
3-th component log probs | Train: 3.470926478818043 | Val: 1.0717197603557869
4-th component log probs | Train: 3.510296990844954 | Val: 0.8136457142064975
5-th component log probs | Train: 3.5211352655831756 | Val: 0.4706679945198119
6-th component log probs | Train: 3.3503627036158483 | Val: 1.6242159601099195
7-th component log probs | Train: 3.673785560121045 | Val: -0.6318757784094138
8-th component log probs | Train: 3.534317332133869 | Val: 0.5766786354814707
9-th component log probs | Train: 3.5225919255192584 | Val: -0.7656587218895607
KEYWORD NR_SAMPLES:6000 DIM:300 AVG_DIFF:8.1629
Fitting PCA...
0-th component log probs | Train: 3.6695856464611305 | Val: 0.5758597446803059
1-th component log probs | Train: 3.633774304587947 | Val: 1.919100144143044
2-th component log probs | Train: 3.579343828101857 | Val: 2.0338867302563624
3-th component log probs | Train: 3.603439424757411 | Val: 0.8896138606108438
4-th component log probs | Train: 3.6720161166859246 | Val: 0.17030159545807638
5-th component log probs | Train: 3.6715921033226864 | Val: -0.0755404180989779
6-th component log probs | Train: 3.4871555264690794 | Val: 1.5145676375451347
7-th component log probs | Train: 3.8532547586002566 | Val: -1.6536129013481236
8-th component log probs | Train: 3.6757553007800237 | Val: 0.3038893990986159
9-th component log probs | Train: 3.67451327402664 | Val: -1.413659563590821
KEYWORD NR_SAMPLES:6000 DIM:350 AVG_DIFF:12.0043
Fitting PCA...
0-th component log probs | Train: 3.8139522605913707 | Val: 0.0390238958278559
1-th component log probs | Train: 3.758877391689693 | Val: 1.770630031505813
2-th component log probs | Train: 3.6976982698716006 | Val: 1.931854475628613
3-th component log probs | Train: 3.7237181952690013 | Val: 0.7010412498128632
4-th component log probs | Train: 3.823530460592087 | Val: -0.5205857260912685
5-th component log probs | Train: 3.8127782747881374 | Val: -0.6368179929246955
6-th component log probs | Train: 3.612373079044804 | Val: 1.33073637322058
7-th component log probs | Train: 4.015879448106865 | Val: -2.5873484613497473
8-th component log probs | Train: 3.8037122859932655 | Val: -0.01700623907740244
9-th component log probs | Train: 3.8168537035945653 | Val: -2.187741171092431
KEYWORD NR_SAMPLES:6000 DIM:400 AVG_DIFF:16.8590
Fitting PCA...
0-th component log probs | Train: 3.9482939881697736 | Val: -0.49696589979530753
1-th component log probs | Train: 3.874481039182256 | Val: 1.6017733233841485
2-th component log probs | Train: 3.805681640313976 | Val: 1.8333053188438808
3-th component log probs | Train: 3.832833646596279 | Val: 0.5043934841039891
4-th component log probs | Train: 3.967081704916702 | Val: -1.2603381471878718
5-th component log probs | Train: 3.9438579199127477 | Val: -1.1745379014630974
6-th component log probs | Train: 3.7280521134707056 | Val: 1.0964824393625934
7-th component log probs | Train: 4.164389309329841 | Val: -3.3437627224463307
8-th component log probs | Train: 3.919997734203847 | Val: -0.37981962040986267
9-th component log probs | Train: 3.9500477993461263 | Val: -3.055117231400706
KEYWORD NR_SAMPLES:6000 DIM:450 AVG_DIFF:22.4276
Fitting PCA...
0-th component log probs | Train: 4.078118564636304 | Val: -1.0166811583360895
1-th component log probs | Train: 3.9852663230054017 | Val: 1.4239802755181705
2-th component log probs | Train: 3.9114261336353793 | Val: 1.718757705568166
3-th component log probs | Train: 3.9392520626090683 | Val: 0.31612609223539373
4-th component log probs | Train: 4.0997846538655045 | Val: -1.8561560415276606
5-th component log probs | Train: 4.068491345358014 | Val: -1.6724836567032788
6-th component log probs | Train: 3.8422822064320568 | Val: 0.8305361106730851
7-th component log probs | Train: 4.298373606891148 | Val: -3.8379946810201346
8-th component log probs | Train: 4.031574616933134 | Val: -0.7181708879689607
9-th component log probs | Train: 4.0760445677070525 | Val: -3.748141608413907
KEYWORD NR_SAMPLES:6000 DIM:500 AVG_DIFF:27.7933
0-th component log probs | Train: 4.108703466876638 | Val: -1.1097303121921958
1-th component log probs | Train: 4.011719049918374 | Val: 1.393191578078503
2-th component log probs | Train: 3.93675691495998 | Val: 1.6933667984270149
3-th component log probs | Train: 3.9636359421001215 | Val: 0.28049515852718454
4-th component log probs | Train: 4.13061130699452 | Val: -1.9806140232025224
5-th component log probs | Train: 4.097248691932554 | Val: -1.7482742630845005
6-th component log probs | Train: 3.8710355238848657 | Val: 0.7837931526571853
7-th component log probs | Train: 4.32847145168778 | Val: -3.9282837422288384
8-th component log probs | Train: 4.058112054554458 | Val: -0.7768327317014504
9-th component log probs | Train: 4.105414422746462 | Val: -3.871477190529197
KEYWORD NR_SAMPLES:6000 DIM:512 AVG_DIFF:28.8917
best average differences at 50 dimensions: 0.8116954534296326
2022-01-10 04:41.38 [info     ] Training complete              train_loss=0.3631620705127716
2022-01-10 04:41.38 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:41.42 [info     ] Testing complete               test_loss=0.5660302639007568
{'dataset_size': 6000,
 'end_test_accuracy': 0.8332949876785278,
 'end_test_loss': 0.5660302639007568,
 'end_train_accuracy': 0.977892279624939,
 'end_train_loss': 0.3631620705127716,
 'end_val_accuracy': 0.8591923117637634,
 'end_val_loss': 0.6528627872467041}
2022-01-10 04:41.42 [info     ] Start Predict                  dataset=52606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:42.07 [info     ] Starting training              dataset=8000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
8000
Fitting PCA...
0-th component log probs | Train: 2.265728073607922 | Val: 1.4248414049816087
1-th component log probs | Train: 2.016158132536284 | Val: 1.6874531437413927
2-th component log probs | Train: 1.9740405721284675 | Val: 1.7040852275941558
3-th component log probs | Train: 1.9594714985520987 | Val: 1.21676521534663
4-th component log probs | Train: 1.8897604963031993 | Val: 1.435118844202156
5-th component log probs | Train: 2.019924372227014 | Val: 1.463109665949996
6-th component log probs | Train: 2.0830610272130596 | Val: 1.1307207309424139
7-th component log probs | Train: 2.2144667971733623 | Val: 1.4617118985803004
8-th component log probs | Train: 1.916530549472453 | Val: 1.315837681046858
9-th component log probs | Train: 2.1003287182937367 | Val: 1.1633124487066
KEYWORD NR_SAMPLES:8000 DIM:50 AVG_DIFF:0.4669
Fitting PCA...
0-th component log probs | Train: 2.822435617276708 | Val: 1.4639931799969443
1-th component log probs | Train: 2.5336515576495873 | Val: 2.0278980180146156
2-th component log probs | Train: 2.5055449194995627 | Val: 2.109083001791208
3-th component log probs | Train: 2.479326395005252 | Val: 1.6236799450407402
4-th component log probs | Train: 2.425458158631462 | Val: 1.8402833252981634
5-th component log probs | Train: 2.550602926401999 | Val: 1.735267674710517
6-th component log probs | Train: 2.631371674817217 | Val: 1.4217129153553032
7-th component log probs | Train: 2.752986887129389 | Val: 1.4403559847910838
8-th component log probs | Train: 2.456844198993366 | Val: 1.568339894153536
9-th component log probs | Train: 2.6570980415316128 | Val: 1.3484732851152392
KEYWORD NR_SAMPLES:8000 DIM:100 AVG_DIFF:0.9686
Fitting PCA...
0-th component log probs | Train: 3.1446610685223986 | Val: 1.4948989197812221
1-th component log probs | Train: 2.840205925768442 | Val: 2.292122686785351
2-th component log probs | Train: 2.821349517322079 | Val: 2.348762838241877
3-th component log probs | Train: 2.7836524175661705 | Val: 1.9174971734639683
4-th component log probs | Train: 2.752225268158801 | Val: 2.069505251042929
5-th component log probs | Train: 2.8658645116533674 | Val: 1.9169513969779843
6-th component log probs | Train: 2.9429610932422774 | Val: 1.6088209680932408
7-th component log probs | Train: 3.085523159255288 | Val: 1.4538587617544312
8-th component log probs | Train: 2.775332266952124 | Val: 1.7782499493329953
9-th component log probs | Train: 2.9761756373515276 | Val: 1.5215336759662499
KEYWORD NR_SAMPLES:8000 DIM:150 AVG_DIFF:1.2915
Fitting PCA...
0-th component log probs | Train: 3.3848089605562683 | Val: 1.5438642938134672
1-th component log probs | Train: 3.0739131737431755 | Val: 2.442763157083517
2-th component log probs | Train: 3.0505033879772334 | Val: 2.513696789613837
3-th component log probs | Train: 3.012145989930927 | Val: 2.0822497686526296
4-th component log probs | Train: 2.9940867046253348 | Val: 2.2230796251599307
5-th component log probs | Train: 3.109436003455637 | Val: 2.011637320541493
6-th component log probs | Train: 3.178285258451305 | Val: 1.6826719225636293
7-th component log probs | Train: 3.344622755835867 | Val: 1.2853572123033203
8-th component log probs | Train: 3.012390753323635 | Val: 1.9398355832302825
9-th component log probs | Train: 3.2235351858952237 | Val: 1.5523699563633038
KEYWORD NR_SAMPLES:8000 DIM:200 AVG_DIFF:1.7161
Fitting PCA...
0-th component log probs | Train: 3.579652637767896 | Val: 1.4046541227871845
1-th component log probs | Train: 3.2585350757170453 | Val: 2.5399088509055883
2-th component log probs | Train: 3.235697898194085 | Val: 2.6240503193873406
3-th component log probs | Train: 3.1940222394018907 | Val: 2.2092555575811055
4-th component log probs | Train: 3.186198151267485 | Val: 2.302495228628973
5-th component log probs | Train: 3.3025729834964626 | Val: 2.0400823479402517
6-th component log probs | Train: 3.3685958201294683 | Val: 1.6767010564399973
7-th component log probs | Train: 3.5601838861063926 | Val: 0.940126543164947
8-th component log probs | Train: 3.20142013136456 | Val: 2.0283694322839643
9-th component log probs | Train: 3.415271167851195 | Val: 1.5446481206522316
KEYWORD NR_SAMPLES:8000 DIM:250 AVG_DIFF:2.3568
Fitting PCA...
0-th component log probs | Train: 3.744744824913478 | Val: 1.240650559155143
1-th component log probs | Train: 3.4090913249583603 | Val: 2.586531240249655
2-th component log probs | Train: 3.3877507430357814 | Val: 2.6860094565474397
3-th component log probs | Train: 3.3387611243114272 | Val: 2.290335037652974
4-th component log probs | Train: 3.3408225695603955 | Val: 2.3307645457600454
5-th component log probs | Train: 3.4630374270062707 | Val: 1.977272359090588
6-th component log probs | Train: 3.5244098455513595 | Val: 1.6182725023133842
7-th component log probs | Train: 3.7435852832724805 | Val: 0.5670937803269174
8-th component log probs | Train: 3.3578089087527387 | Val: 2.041115830710567
9-th component log probs | Train: 3.5732522234102237 | Val: 1.443045128171775
KEYWORD NR_SAMPLES:8000 DIM:300 AVG_DIFF:3.1761
Fitting PCA...
0-th component log probs | Train: 3.8856995815473296 | Val: 1.0654957893304025
1-th component log probs | Train: 3.53900092929406 | Val: 2.6056126469705116
2-th component log probs | Train: 3.5169389167006893 | Val: 2.7194612270622134
3-th component log probs | Train: 3.4641286706136576 | Val: 2.325937050882932
4-th component log probs | Train: 3.4734912606142467 | Val: 2.32085933233411
5-th component log probs | Train: 3.602060777273889 | Val: 1.8703949807954026
6-th component log probs | Train: 3.6596576987659 | Val: 1.5090859938884325
7-th component log probs | Train: 3.9057214447475856 | Val: 0.13325338392979164
8-th component log probs | Train: 3.4926415474964845 | Val: 1.9847978026054331
9-th component log probs | Train: 3.7110486526622637 | Val: 1.2704898008779848
KEYWORD NR_SAMPLES:8000 DIM:350 AVG_DIFF:4.2170
Fitting PCA...
0-th component log probs | Train: 4.014885404022777 | Val: 0.8580691844337178
1-th component log probs | Train: 3.6558026964398764 | Val: 2.597088687021283
2-th component log probs | Train: 3.6327133721651315 | Val: 2.7262829644958937
3-th component log probs | Train: 3.5758995730682432 | Val: 2.3197873626825225
4-th component log probs | Train: 3.5932719751550324 | Val: 2.2603350091364023
5-th component log probs | Train: 3.725928225424101 | Val: 1.7447038872178546
6-th component log probs | Train: 3.7792634491817227 | Val: 1.3659257426689955
7-th component log probs | Train: 4.050756443702338 | Val: -0.3619573050036277
8-th component log probs | Train: 3.6131811079732463 | Val: 1.887067467484502
9-th component log probs | Train: 3.835369885748983 | Val: 1.0886999654194554
KEYWORD NR_SAMPLES:8000 DIM:400 AVG_DIFF:5.5008
Fitting PCA...
0-th component log probs | Train: 4.13047293835569 | Val: 0.7138809601385353
1-th component log probs | Train: 3.7616647466148767 | Val: 2.56775587890763
2-th component log probs | Train: 3.736554699157997 | Val: 2.706003254473223
3-th component log probs | Train: 3.6781352284834514 | Val: 2.2934061308802147
4-th component log probs | Train: 3.7016238899753873 | Val: 2.177097377388697
5-th component log probs | Train: 3.839088488990148 | Val: 1.5579672231419193
6-th component log probs | Train: 3.888692635869635 | Val: 1.1989402760243395
7-th component log probs | Train: 4.1829860548486435 | Val: -0.7209179002556889
8-th component log probs | Train: 3.7228612280691804 | Val: 1.7385314467989545
9-th component log probs | Train: 3.9476697246200647 | Val: 0.9048053152152107
KEYWORD NR_SAMPLES:8000 DIM:450 AVG_DIFF:6.8085
Fitting PCA...
0-th component log probs | Train: 4.241404616883806 | Val: 0.6284683045362633
1-th component log probs | Train: 3.8655724484618497 | Val: 2.5248328048867195
2-th component log probs | Train: 3.837293730198201 | Val: 2.6902024982027077
3-th component log probs | Train: 3.7784321304664883 | Val: 2.2587636760246004
4-th component log probs | Train: 3.806979715198177 | Val: 2.0877491666632477
5-th component log probs | Train: 3.9489819559775534 | Val: 1.422666209583888
6-th component log probs | Train: 3.9945299943239427 | Val: 1.1020694944022817
7-th component log probs | Train: 4.30461860730007 | Val: -0.9846430669832045
8-th component log probs | Train: 3.830115342919997 | Val: 1.6085325991947679
9-th component log probs | Train: 4.056212118311834 | Val: 0.7437955698012092
KEYWORD NR_SAMPLES:8000 DIM:500 AVG_DIFF:8.0064
0-th component log probs | Train: 4.268313831165855 | Val: 0.6353353354037659
1-th component log probs | Train: 3.8903651741578256 | Val: 2.5162524052936424
2-th component log probs | Train: 3.861875301948806 | Val: 2.6896250734946583
3-th component log probs | Train: 3.802739709775715 | Val: 2.2601807877651714
4-th component log probs | Train: 3.832547081182078 | Val: 2.068056492110721
5-th component log probs | Train: 3.9753401130159673 | Val: 1.4000289060688877
6-th component log probs | Train: 4.018708397053035 | Val: 1.0946475637103188
7-th component log probs | Train: 4.33262014963873 | Val: -1.007570761306301
8-th component log probs | Train: 3.855837235609098 | Val: 1.5847683958186611
9-th component log probs | Train: 4.081918613303208 | Val: 0.7117495708974734
KEYWORD NR_SAMPLES:8000 DIM:512 AVG_DIFF:8.2170
best average differences at 50 dimensions: 0.4668790908144236
2022-01-10 04:51.41 [info     ] Training complete              train_loss=0.40507763624191284
2022-01-10 04:51.41 [info     ] Starting evaluating            dataset=26032
2022-01-10 04:51.45 [info     ] Testing complete               test_loss=0.4935775399208069
{'dataset_size': 8000,
 'end_test_accuracy': 0.8507498502731323,
 'end_test_loss': 0.4935775399208069,
 'end_train_accuracy': 0.9642500281333923,
 'end_train_loss': 0.40507763624191284,
 'end_val_accuracy': 0.8757274150848389,
 'end_val_loss': 0.5635561943054199}
2022-01-10 04:51.45 [info     ] Start Predict                  dataset=50606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 04:52.09 [info     ] Starting training              dataset=10000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
10000
Fitting PCA...
0-th component log probs | Train: 2.1163342675724253 | Val: 1.5210353124928353
1-th component log probs | Train: 1.8853390505458896 | Val: 1.6085901915421468
2-th component log probs | Train: 1.899696207080567 | Val: 1.6244204018835529
3-th component log probs | Train: 1.9579740628430782 | Val: 1.3285800997082258
4-th component log probs | Train: 2.050094366156907 | Val: 1.5346179447957877
5-th component log probs | Train: 1.995756037965398 | Val: 1.606804404164561
6-th component log probs | Train: 1.9578894192547156 | Val: 1.2976547035497812
7-th component log probs | Train: 2.099658516362307 | Val: 1.501393038543026
8-th component log probs | Train: 1.869820545956714 | Val: 1.278475525342533
9-th component log probs | Train: 1.973232901312214 | Val: 1.3474851182313112
KEYWORD NR_SAMPLES:10000 DIM:50 AVG_DIFF:0.2855
Fitting PCA...
0-th component log probs | Train: 2.6826339894913773 | Val: 1.6657918689444908
1-th component log probs | Train: 2.421286231080661 | Val: 1.99365567238238
2-th component log probs | Train: 2.4276475832113382 | Val: 2.005848760894658
3-th component log probs | Train: 2.4991563451191188 | Val: 1.6051791517878022
4-th component log probs | Train: 2.5947659316917453 | Val: 1.9123802899145066
5-th component log probs | Train: 2.553001872034603 | Val: 1.9695086412058713
6-th component log probs | Train: 2.4980131136788266 | Val: 1.6305549302600157
7-th component log probs | Train: 2.6382013389924333 | Val: 1.7932833924807106
8-th component log probs | Train: 2.41806445051353 | Val: 1.5501943522026067
9-th component log probs | Train: 2.5016982530023797 | Val: 1.570790590367774
KEYWORD NR_SAMPLES:10000 DIM:100 AVG_DIFF:0.6086
Fitting PCA...
0-th component log probs | Train: 2.99428172674185 | Val: 1.7851904912478613
1-th component log probs | Train: 2.7154197945725698 | Val: 2.25235534852963
2-th component log probs | Train: 2.7251451514186518 | Val: 2.2560146321864423
3-th component log probs | Train: 2.7981261307446417 | Val: 1.8367213129825541
4-th component log probs | Train: 2.8995577100836223 | Val: 2.0770728762445634
5-th component log probs | Train: 2.8542423973080417 | Val: 2.195812775378033
6-th component log probs | Train: 2.792419582755837 | Val: 1.861910506144281
7-th component log probs | Train: 2.94231743977343 | Val: 1.9192679215950532
8-th component log probs | Train: 2.7252010078726525 | Val: 1.7864213704059364
9-th component log probs | Train: 2.802111783280032 | Val: 1.7548782386942638
KEYWORD NR_SAMPLES:10000 DIM:150 AVG_DIFF:0.7821
Fitting PCA...
0-th component log probs | Train: 3.2318712683814104 | Val: 1.863876673463562
1-th component log probs | Train: 2.943951774076283 | Val: 2.450848690923685
2-th component log probs | Train: 2.953241636603456 | Val: 2.448539071185016
3-th component log probs | Train: 3.022099318931934 | Val: 2.0428118950328407
4-th component log probs | Train: 3.1334389706056562 | Val: 2.239345225533639
5-th component log probs | Train: 3.083909712836909 | Val: 2.360963066676152
6-th component log probs | Train: 3.022313895060745 | Val: 2.006621515726356
7-th component log probs | Train: 3.183933678622296 | Val: 1.9753613732369726
8-th component log probs | Train: 2.9585020873458467 | Val: 1.9851760972502568
9-th component log probs | Train: 3.036101401222723 | Val: 1.908483219680031
KEYWORD NR_SAMPLES:10000 DIM:200 AVG_DIFF:0.9362
Fitting PCA...
0-th component log probs | Train: 3.4214683898331226 | Val: 1.860598435244815
1-th component log probs | Train: 3.127656666143119 | Val: 2.5983369549358395
2-th component log probs | Train: 3.1343695288945645 | Val: 2.5758603793297943
3-th component log probs | Train: 3.2013767614995334 | Val: 2.1895104385811237
4-th component log probs | Train: 3.3195415201584746 | Val: 2.3357651284893657
5-th component log probs | Train: 3.267421257330555 | Val: 2.464568766287225
6-th component log probs | Train: 3.2035828382133635 | Val: 2.1112628799063433
7-th component log probs | Train: 3.3776552805678746 | Val: 1.9504327404681474
8-th component log probs | Train: 3.14333008575404 | Val: 2.0828243739110524
9-th component log probs | Train: 3.2234518782185964 | Val: 1.9882281698262139
KEYWORD NR_SAMPLES:10000 DIM:250 AVG_DIFF:1.1545
Fitting PCA...
0-th component log probs | Train: 3.581019634520989 | Val: 1.8128346824942647
1-th component log probs | Train: 3.27800537015674 | Val: 2.694371494498186
2-th component log probs | Train: 3.2821695087163465 | Val: 2.6586689088793256
3-th component log probs | Train: 3.3475313341243123 | Val: 2.2618428727595803
4-th component log probs | Train: 3.470427649824061 | Val: 2.3891189731782534
5-th component log probs | Train: 3.418692571656161 | Val: 2.5173220694632548
6-th component log probs | Train: 3.352950744169472 | Val: 2.172343715836065
7-th component log probs | Train: 3.542353277533688 | Val: 1.8466617918433783
8-th component log probs | Train: 3.296096474424711 | Val: 2.1358468060513482
9-th component log probs | Train: 3.3755149988344195 | Val: 1.9753276048178032
KEYWORD NR_SAMPLES:10000 DIM:300 AVG_DIFF:1.4592
Fitting PCA...
0-th component log probs | Train: 3.718808318518398 | Val: 1.6747657432942837
1-th component log probs | Train: 3.4055479131815396 | Val: 2.7557379125068184
2-th component log probs | Train: 3.4062668509018423 | Val: 2.7103762468446386
3-th component log probs | Train: 3.4731106931028455 | Val: 2.3238784155885157
4-th component log probs | Train: 3.6011904778270565 | Val: 2.3924139350030242
5-th component log probs | Train: 3.548837953003966 | Val: 2.529212289652797
6-th component log probs | Train: 3.4826342800717374 | Val: 2.160122157119949
7-th component log probs | Train: 3.683725163073065 | Val: 1.7108506987211982
8-th component log probs | Train: 3.4266561122363868 | Val: 2.144941978116798
9-th component log probs | Train: 3.506849965659751 | Val: 1.9415644295816976
KEYWORD NR_SAMPLES:10000 DIM:350 AVG_DIFF:1.8640
Fitting PCA...
0-th component log probs | Train: 3.843167838715242 | Val: 1.540790948457537
1-th component log probs | Train: 3.5196227804241054 | Val: 2.7862300941923155
2-th component log probs | Train: 3.5192631582394793 | Val: 2.7346692365194727
3-th component log probs | Train: 3.5840617704777014 | Val: 2.352260197766989
4-th component log probs | Train: 3.7183952150589517 | Val: 2.3786585084810543
5-th component log probs | Train: 3.6647891485680177 | Val: 2.5272418838964055
6-th component log probs | Train: 3.5964544278200705 | Val: 2.1281366968246513
7-th component log probs | Train: 3.8129705838082963 | Val: 1.5803930100395995
8-th component log probs | Train: 3.540649754101756 | Val: 2.1357904682272446
9-th component log probs | Train: 3.6255441851520134 | Val: 1.8888684408639287
KEYWORD NR_SAMPLES:10000 DIM:400 AVG_DIFF:2.3191
Fitting PCA...
0-th component log probs | Train: 3.9547349553384255 | Val: 1.4095956128283877
1-th component log probs | Train: 3.621967685645066 | Val: 2.79211578263711
2-th component log probs | Train: 3.621404369510961 | Val: 2.7403677696144895
3-th component log probs | Train: 3.684813430968254 | Val: 2.331145069714373
4-th component log probs | Train: 3.8235920539362693 | Val: 2.337709355800281
5-th component log probs | Train: 3.7722509273975735 | Val: 2.504304044530147
6-th component log probs | Train: 3.7029997334263527 | Val: 2.061482851812045
7-th component log probs | Train: 3.9301353217752193 | Val: 1.4408313221529818
8-th component log probs | Train: 3.645317848107015 | Val: 2.0866103269873872
9-th component log probs | Train: 3.7348718784497086 | Val: 1.7759710922558696
KEYWORD NR_SAMPLES:10000 DIM:450 AVG_DIFF:2.8749
Fitting PCA...
0-th component log probs | Train: 4.065834683875079 | Val: 1.3050624133407938
1-th component log probs | Train: 3.7206770525131434 | Val: 2.8085566203271943
2-th component log probs | Train: 3.7218537073554048 | Val: 2.749735744054589
3-th component log probs | Train: 3.7838622779564437 | Val: 2.318277302750754
4-th component log probs | Train: 3.9245131892906304 | Val: 2.291246666791767
5-th component log probs | Train: 3.875091718011696 | Val: 2.490389059261208
6-th component log probs | Train: 3.8058500224741163 | Val: 1.9983084892409875
7-th component log probs | Train: 4.044240073094408 | Val: 1.3170605690178006
8-th component log probs | Train: 3.7466742975512863 | Val: 2.0367310813337856
9-th component log probs | Train: 3.8407358839386863 | Val: 1.6485646063891846
KEYWORD NR_SAMPLES:10000 DIM:500 AVG_DIFF:3.4566
0-th component log probs | Train: 4.093069474725982 | Val: 1.299285204778243
1-th component log probs | Train: 3.744929459594292 | Val: 2.8182384295569176
2-th component log probs | Train: 3.746384843270925 | Val: 2.7562558235414176
3-th component log probs | Train: 3.8075347049895703 | Val: 2.3263034309314476
4-th component log probs | Train: 3.9491424837011215 | Val: 2.284627515680283
5-th component log probs | Train: 3.8993642834324955 | Val: 2.488752300365612
6-th component log probs | Train: 3.830541605213596 | Val: 1.996572759540492
7-th component log probs | Train: 4.0706896997347135 | Val: 1.3186073060238204
8-th component log probs | Train: 3.7714116248244256 | Val: 2.029305220352613
9-th component log probs | Train: 3.8656271121975845 | Val: 1.6345728880994552
KEYWORD NR_SAMPLES:10000 DIM:512 AVG_DIFF:3.5549
best average differences at 50 dimensions: 0.2854964304259952
2022-01-10 05:05.04 [info     ] Training complete              train_loss=0.408724308013916
2022-01-10 05:05.04 [info     ] Starting evaluating            dataset=26032
2022-01-10 05:05.08 [info     ] Testing complete               test_loss=0.4555698037147522
{'dataset_size': 10000,
 'end_test_accuracy': 0.8625741600990295,
 'end_test_loss': 0.4555698037147522,
 'end_train_accuracy': 0.9566082954406738,
 'end_train_loss': 0.408724308013916,
 'end_val_accuracy': 0.8907892107963562,
 'end_val_loss': 0.4809888005256653}
2022-01-10 05:05.08 [info     ] Start Predict                  dataset=48606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 05:05.38 [info     ] Starting training              dataset=20000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
20000
Fitting PCA...
0-th component log probs | Train: 2.1851778718211032 | Val: 1.4882724846460549
1-th component log probs | Train: 2.028020348354196 | Val: 1.3272641585840808
2-th component log probs | Train: 2.0516219974508227 | Val: 1.3671555643319357
3-th component log probs | Train: 1.9599799025445734 | Val: 1.0271284092141328
4-th component log probs | Train: 2.206662799950031 | Val: 1.2577899409944844
5-th component log probs | Train: 2.1507451193180893 | Val: 1.3552820416765925
6-th component log probs | Train: 2.181010240002858 | Val: 0.2996100728510958
7-th component log probs | Train: 2.0718682915846167 | Val: 1.3621409815967889
8-th component log probs | Train: 2.0966554092091654 | Val: 0.7916011225611389
9-th component log probs | Train: 2.1689246150359733 | Val: 1.0301800979565485
KEYWORD NR_SAMPLES:20000 DIM:50 AVG_DIFF:1.0892
Fitting PCA...
0-th component log probs | Train: 2.7446117132360817 | Val: 1.6028445092332806
1-th component log probs | Train: 2.5798849850312777 | Val: 1.838326651845449
2-th component log probs | Train: 2.6179802387542837 | Val: 1.6642130482498552
3-th component log probs | Train: 2.5110595158152282 | Val: 1.2988712922798822
4-th component log probs | Train: 2.777835637352101 | Val: 1.4242384249787086
5-th component log probs | Train: 2.709215521205172 | Val: 1.6325345177472452
6-th component log probs | Train: 2.740476734048577 | Val: 0.2948946332427444
7-th component log probs | Train: 2.6134326948419675 | Val: 1.7093810506773057
8-th component log probs | Train: 2.6481570694684473 | Val: 0.8117633395574146
9-th component log probs | Train: 2.7150897315591407 | Val: 1.1059366292734003
KEYWORD NR_SAMPLES:20000 DIM:100 AVG_DIFF:1.9984
Fitting PCA...
0-th component log probs | Train: 3.016965750124588 | Val: 1.8445312627131139
1-th component log probs | Train: 2.8464666778206187 | Val: 2.1277153275437066
2-th component log probs | Train: 2.89832550160539 | Val: 1.963332480655577
3-th component log probs | Train: 2.787522949729765 | Val: 1.5925331242144016
4-th component log probs | Train: 3.0628135983593814 | Val: 1.5986780853847
5-th component log probs | Train: 2.9843693324587233 | Val: 1.9140153167634326
6-th component log probs | Train: 3.0130747591569014 | Val: 0.6007975904648429
7-th component log probs | Train: 2.890053455022982 | Val: 1.927007455127692
8-th component log probs | Train: 2.92785217830326 | Val: 0.9505999856416633
9-th component log probs | Train: 2.9884532941765047 | Val: 1.2689087232843625
KEYWORD NR_SAMPLES:20000 DIM:150 AVG_DIFF:2.1096
Fitting PCA...
0-th component log probs | Train: 3.2224849653425878 | Val: 1.9658524197271254
1-th component log probs | Train: 3.0497085026619177 | Val: 2.326785362878404
2-th component log probs | Train: 3.103804592499236 | Val: 2.178353206923868
3-th component log probs | Train: 2.994041487527051 | Val: 1.7976290484915909
4-th component log probs | Train: 3.272753104543239 | Val: 1.604950298470307
5-th component log probs | Train: 3.1881364042587546 | Val: 2.0875656086243652
6-th component log probs | Train: 3.220406256365748 | Val: 0.6296454074488071
7-th component log probs | Train: 3.099416828757273 | Val: 2.0812166527106015
8-th component log probs | Train: 3.1348975941692414 | Val: 1.040883665601785
9-th component log probs | Train: 3.1966117190683216 | Val: 1.423856058686025
KEYWORD NR_SAMPLES:20000 DIM:200 AVG_DIFF:2.3659
Fitting PCA...
0-th component log probs | Train: 3.3972515572355095 | Val: 2.0689805916803
1-th component log probs | Train: 3.2192851435420744 | Val: 2.4985722348113253
2-th component log probs | Train: 3.2727317492622463 | Val: 2.3261098385134233
3-th component log probs | Train: 3.1641974986027983 | Val: 1.9724763470946711
4-th component log probs | Train: 3.4464928467076845 | Val: 1.6167469328135888
5-th component log probs | Train: 3.358944687838369 | Val: 2.215408788150541
6-th component log probs | Train: 3.3952209539066187 | Val: 0.6694938913998696
7-th component log probs | Train: 3.2759983001766946 | Val: 2.1690974471223696
8-th component log probs | Train: 3.3110001247025482 | Val: 1.0960370515870346
9-th component log probs | Train: 3.371535814698721 | Val: 1.5012327539976957
KEYWORD NR_SAMPLES:20000 DIM:250 AVG_DIFF:2.6315
Fitting PCA...
0-th component log probs | Train: 3.548805102726725 | Val: 2.108139393555714
1-th component log probs | Train: 3.364703329165112 | Val: 2.6407984992166367
2-th component log probs | Train: 3.417333627266547 | Val: 2.449984534184031
3-th component log probs | Train: 3.309060959158836 | Val: 2.0988354038745136
4-th component log probs | Train: 3.5953559616918276 | Val: 1.6123191424234806
5-th component log probs | Train: 3.5058657343035415 | Val: 2.3162876430075685
6-th component log probs | Train: 3.545598443363436 | Val: 0.7105973787176445
7-th component log probs | Train: 3.4263444701373595 | Val: 2.23003763861411
8-th component log probs | Train: 3.4595313872244433 | Val: 1.150588124968875
9-th component log probs | Train: 3.523006045757525 | Val: 1.5290538701207197
KEYWORD NR_SAMPLES:20000 DIM:300 AVG_DIFF:2.9123
Fitting PCA...
0-th component log probs | Train: 3.6790708568028654 | Val: 2.1236938890626007
1-th component log probs | Train: 3.489428549900366 | Val: 2.7414346691248244
2-th component log probs | Train: 3.54301067775959 | Val: 2.5423215860036477
3-th component log probs | Train: 3.432472004954361 | Val: 2.198241890444864
4-th component log probs | Train: 3.7215798092041767 | Val: 1.647644502462371
5-th component log probs | Train: 3.632875252748564 | Val: 2.3461024151693683
6-th component log probs | Train: 3.6771156179656264 | Val: 0.6766373933156827
7-th component log probs | Train: 3.5554946271492955 | Val: 2.2622291476488225
8-th component log probs | Train: 3.588765787769276 | Val: 1.1639546527579756
9-th component log probs | Train: 3.651395445586862 | Val: 1.5524661730495437
KEYWORD NR_SAMPLES:20000 DIM:350 AVG_DIFF:3.2421
Fitting PCA...
0-th component log probs | Train: 3.7938505372028675 | Val: 2.134599114464809
1-th component log probs | Train: 3.598522777899675 | Val: 2.8175216477299947
2-th component log probs | Train: 3.6548027774301035 | Val: 2.602608514047006
3-th component log probs | Train: 3.541309060773815 | Val: 2.2546750886425504
4-th component log probs | Train: 3.832599976416966 | Val: 1.6024477518144469
5-th component log probs | Train: 3.7467084059671643 | Val: 2.3956788975378274
6-th component log probs | Train: 3.792956703629208 | Val: 0.6025752463328337
7-th component log probs | Train: 3.671307688575729 | Val: 2.238564064736659
8-th component log probs | Train: 3.7041632335877015 | Val: 1.1654891129427745
9-th component log probs | Train: 3.7650924907679633 | Val: 1.5431493038654684
KEYWORD NR_SAMPLES:20000 DIM:400 AVG_DIFF:3.6538
Fitting PCA...
0-th component log probs | Train: 3.8987084413067303 | Val: 2.1196863274977296
1-th component log probs | Train: 3.6988606098196377 | Val: 2.869541257648743
2-th component log probs | Train: 3.7546126986571013 | Val: 2.641358619148772
3-th component log probs | Train: 3.6413353398020254 | Val: 2.303040388279975
4-th component log probs | Train: 3.933910876690303 | Val: 1.5841606728359743
5-th component log probs | Train: 3.849629336081806 | Val: 2.3950942548422187
6-th component log probs | Train: 3.899309249629541 | Val: 0.4991672175157894
7-th component log probs | Train: 3.7769830794485286 | Val: 2.1980448924730154
8-th component log probs | Train: 3.80994022957954 | Val: 1.081395184891479
9-th component log probs | Train: 3.8679806999691273 | Val: 1.5018124128910169
KEYWORD NR_SAMPLES:20000 DIM:450 AVG_DIFF:4.1618
Fitting PCA...
0-th component log probs | Train: 3.9959507627304816 | Val: 2.1201936313334695
1-th component log probs | Train: 3.794890248497836 | Val: 2.9361595435873267
2-th component log probs | Train: 3.85251390648706 | Val: 2.677431464637834
3-th component log probs | Train: 3.740849932606291 | Val: 2.344145630983529
4-th component log probs | Train: 4.0332498558222065 | Val: 1.5447319370834975
5-th component log probs | Train: 3.9491026239155325 | Val: 2.45630251455167
6-th component log probs | Train: 4.001110367128095 | Val: 0.458174086840284
7-th component log probs | Train: 3.879405183139755 | Val: 2.1432232179129445
8-th component log probs | Train: 3.913876286240909 | Val: 1.0293566869594868
9-th component log probs | Train: 3.966537671824518 | Val: 1.4514574570215382
KEYWORD NR_SAMPLES:20000 DIM:500 AVG_DIFF:4.6221
0-th component log probs | Train: 4.01865867298098 | Val: 2.140317730423509
1-th component log probs | Train: 3.8187509488724563 | Val: 2.9639592390560185
2-th component log probs | Train: 3.878259417811782 | Val: 2.70033452125993
3-th component log probs | Train: 3.7652658682129885 | Val: 2.36598066578361
4-th component log probs | Train: 4.056177620919213 | Val: 1.5748417418974454
5-th component log probs | Train: 3.972772379613355 | Val: 2.4871462790984804
6-th component log probs | Train: 4.024383908887592 | Val: 0.5072133179309497
7-th component log probs | Train: 3.9059149272899076 | Val: 2.148100775451556
8-th component log probs | Train: 3.937664202888676 | Val: 1.0478830197202338
9-th component log probs | Train: 3.9887409113261425 | Val: 1.47445445014601
KEYWORD NR_SAMPLES:20000 DIM:512 AVG_DIFF:4.6101
best average differences at 50 dimensions: 1.0891848982981496
2022-01-10 05:32.23 [info     ] Training complete              train_loss=0.22112445533275604
2022-01-10 05:32.23 [info     ] Starting evaluating            dataset=26032
2022-01-10 05:32.27 [info     ] Testing complete               test_loss=0.336799293756485
{'dataset_size': 20000,
 'end_test_accuracy': 0.9033322930335999,
 'end_test_loss': 0.336799293756485,
 'end_train_accuracy': 0.9950079917907715,
 'end_train_loss': 0.22112445533275604,
 'end_val_accuracy': 0.9244504570960999,
 'end_val_loss': 0.34459322690963745}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 05:32.27 [info     ] Start Predict                  dataset=38606
2022-01-10 05:33.02 [info     ] Starting training              dataset=30000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
30000
Fitting PCA...
0-th component log probs | Train: 2.149360670602348 | Val: 1.6319905967863604
1-th component log probs | Train: 1.9834821389046882 | Val: 1.4092149852129425
2-th component log probs | Train: 2.0196037673628826 | Val: 1.4892507612220136
3-th component log probs | Train: 2.094302571870508 | Val: 0.959073282460053
4-th component log probs | Train: 2.04987803043675 | Val: 1.2528842810311513
5-th component log probs | Train: 2.096879052185803 | Val: 1.0530544811165141
6-th component log probs | Train: 2.074978425056912 | Val: 0.5866827826954275
7-th component log probs | Train: 2.0861600869726438 | Val: 1.4663321108167116
8-th component log probs | Train: 2.121558506256123 | Val: 0.9495972753481144
9-th component log probs | Train: 2.0786963454120055 | Val: 1.0133329757071912
KEYWORD NR_SAMPLES:30000 DIM:50 AVG_DIFF:0.9000
Fitting PCA...
0-th component log probs | Train: 2.754939480698878 | Val: 1.8575749655787057
1-th component log probs | Train: 2.5712607408140724 | Val: 1.9734134307271396
2-th component log probs | Train: 2.628147980144519 | Val: 1.8724334636519069
3-th component log probs | Train: 2.703668482789604 | Val: 1.1377231526297047
4-th component log probs | Train: 2.631490306005064 | Val: 1.6989230047376407
5-th component log probs | Train: 2.6979012616984415 | Val: 1.5325450341261837
6-th component log probs | Train: 2.6703192694828983 | Val: 0.8109333288667467
7-th component log probs | Train: 2.6896371553462117 | Val: 1.906609912025498
8-th component log probs | Train: 2.720939036735444 | Val: 0.9250839533357325
9-th component log probs | Train: 2.66864420751119 | Val: 0.9185568548541293
KEYWORD NR_SAMPLES:30000 DIM:100 AVG_DIFF:1.6772
Fitting PCA...
0-th component log probs | Train: 3.02616171831048 | Val: 2.0626920470240395
1-th component log probs | Train: 2.8380284643734144 | Val: 2.2937971888923636
2-th component log probs | Train: 2.8993489956799943 | Val: 2.160933007277281
3-th component log probs | Train: 2.976529879963704 | Val: 1.4859064427472615
4-th component log probs | Train: 2.891541560485371 | Val: 2.0047714273798034
5-th component log probs | Train: 2.960662747115457 | Val: 1.8256448274540484
6-th component log probs | Train: 2.933737141225689 | Val: 1.1412396289898052
7-th component log probs | Train: 2.963659485589616 | Val: 2.1221901742552887
8-th component log probs | Train: 2.995280875786092 | Val: 1.1578144647468613
9-th component log probs | Train: 2.933189917044939 | Val: 1.1281242083930887
KEYWORD NR_SAMPLES:30000 DIM:150 AVG_DIFF:1.6622
Fitting PCA...
0-th component log probs | Train: 3.220438075694776 | Val: 2.2140833523303347
1-th component log probs | Train: 3.030077807127669 | Val: 2.5041496405859376
2-th component log probs | Train: 3.092862328445513 | Val: 2.359988606280408
3-th component log probs | Train: 3.1685226381213165 | Val: 1.6636949876397102
4-th component log probs | Train: 3.082056181861361 | Val: 2.2261634755946034
5-th component log probs | Train: 3.1473872792672184 | Val: 2.00526940256095
6-th component log probs | Train: 3.1240612949530324 | Val: 1.3195188140173157
7-th component log probs | Train: 3.158885550749139 | Val: 2.266518924831298
8-th component log probs | Train: 3.1927955327463473 | Val: 1.2872826974006708
9-th component log probs | Train: 3.1267618520287503 | Val: 1.241255725724137
KEYWORD NR_SAMPLES:30000 DIM:200 AVG_DIFF:1.7367
Fitting PCA...
0-th component log probs | Train: 3.3871409146990996 | Val: 2.349424820617321
1-th component log probs | Train: 3.1918320308243646 | Val: 2.6810233629385434
2-th component log probs | Train: 3.25718395920705 | Val: 2.5086553883188865
3-th component log probs | Train: 3.3320622515504734 | Val: 1.8072258420710032
4-th component log probs | Train: 3.2465175300447475 | Val: 2.403503673546864
5-th component log probs | Train: 3.308354666705728 | Val: 2.1407268751550457
6-th component log probs | Train: 3.288591136440071 | Val: 1.4117651455551534
7-th component log probs | Train: 3.3292221955936485 | Val: 2.3559450549821346
8-th component log probs | Train: 3.3599057506583963 | Val: 1.3876561684277422
9-th component log probs | Train: 3.2943819217687906 | Val: 1.2833977072284806
KEYWORD NR_SAMPLES:30000 DIM:250 AVG_DIFF:1.8701
Fitting PCA...
0-th component log probs | Train: 3.531927517834751 | Val: 2.4465192026801152
1-th component log probs | Train: 3.3316303720230778 | Val: 2.823068385509642
2-th component log probs | Train: 3.398947138472028 | Val: 2.6281712869671505
3-th component log probs | Train: 3.474394507425815 | Val: 1.923241502049765
4-th component log probs | Train: 3.388821603246303 | Val: 2.5192260340587063
5-th component log probs | Train: 3.449509463509758 | Val: 2.23855106731336
6-th component log probs | Train: 3.432367238551248 | Val: 1.4699406248281817
7-th component log probs | Train: 3.474067631021362 | Val: 2.4452176517623667
8-th component log probs | Train: 3.505058703223483 | Val: 1.4361256984504456
9-th component log probs | Train: 3.441360273619838 | Val: 1.3315613667536996
KEYWORD NR_SAMPLES:30000 DIM:300 AVG_DIFF:2.0301
Fitting PCA...
0-th component log probs | Train: 3.659824663524095 | Val: 2.499874193339993
1-th component log probs | Train: 3.4536411270151954 | Val: 2.942737400908682
2-th component log probs | Train: 3.523025967303994 | Val: 2.712093382427431
3-th component log probs | Train: 3.60021635641051 | Val: 1.969892314956152
4-th component log probs | Train: 3.5133071964108424 | Val: 2.6095562038072804
5-th component log probs | Train: 3.574297067012537 | Val: 2.313507453568837
6-th component log probs | Train: 3.558900950654368 | Val: 1.4386125186172798
7-th component log probs | Train: 3.6051602015612074 | Val: 2.475187257726757
8-th component log probs | Train: 3.632898442295047 | Val: 1.4868190512234987
9-th component log probs | Train: 3.5683101781285385 | Val: 1.3468696090942402
KEYWORD NR_SAMPLES:30000 DIM:350 AVG_DIFF:2.2641
Fitting PCA...
0-th component log probs | Train: 3.7751992468258977 | Val: 2.5419088324797
1-th component log probs | Train: 3.5628747237436147 | Val: 3.04652890216784
2-th component log probs | Train: 3.6358742911801247 | Val: 2.7774910191987736
3-th component log probs | Train: 3.711158370343594 | Val: 2.002218558928461
4-th component log probs | Train: 3.6262426859612837 | Val: 2.6889009689217196
5-th component log probs | Train: 3.685673831919993 | Val: 2.354988050205266
6-th component log probs | Train: 3.6745682000030513 | Val: 1.3846854827275505
7-th component log probs | Train: 3.7226216414770064 | Val: 2.4841467794914793
8-th component log probs | Train: 3.7489414639213017 | Val: 1.474343110526398
9-th component log probs | Train: 3.683674888564877 | Val: 1.3439545008301572
KEYWORD NR_SAMPLES:30000 DIM:400 AVG_DIFF:2.5520
Fitting PCA...
0-th component log probs | Train: 3.881032332909485 | Val: 2.5677156862031594
1-th component log probs | Train: 3.66394946053959 | Val: 3.131310211825241
2-th component log probs | Train: 3.740488410493645 | Val: 2.8397038075364454
3-th component log probs | Train: 3.8133596937491414 | Val: 2.03863324593895
4-th component log probs | Train: 3.7304662907879638 | Val: 2.7523109422268432
5-th component log probs | Train: 3.790855927488913 | Val: 2.391334320230841
6-th component log probs | Train: 3.7817114490543924 | Val: 1.3354999476493072
7-th component log probs | Train: 3.8296486439612645 | Val: 2.5043927255648843
8-th component log probs | Train: 3.855891722849077 | Val: 1.478466029916828
9-th component log probs | Train: 3.7895063005413636 | Val: 1.2867511052388447
KEYWORD NR_SAMPLES:30000 DIM:450 AVG_DIFF:2.8541
Fitting PCA...
0-th component log probs | Train: 3.979564718910786 | Val: 2.6379703723955616
1-th component log probs | Train: 3.762939476745886 | Val: 3.230175216646188
2-th component log probs | Train: 3.842062287612893 | Val: 2.9167665792914237
3-th component log probs | Train: 3.9094338830979227 | Val: 2.135788984230713
4-th component log probs | Train: 3.8303205024957 | Val: 2.838187876953273
5-th component log probs | Train: 3.8896271322250002 | Val: 2.4829356729009198
6-th component log probs | Train: 3.885185808638657 | Val: 1.384336333634765
7-th component log probs | Train: 3.9300529513412905 | Val: 2.5525923499385104
8-th component log probs | Train: 3.9592542242310875 | Val: 1.5049828742656137
9-th component log probs | Train: 3.890789068859949 | Val: 1.3571764388224785
KEYWORD NR_SAMPLES:30000 DIM:500 AVG_DIFF:2.9643
0-th component log probs | Train: 4.004867812958484 | Val: 2.679966053895851
1-th component log probs | Train: 3.789901371892539 | Val: 3.263972605736319
2-th component log probs | Train: 3.8676314201384856 | Val: 2.9546914266967863
3-th component log probs | Train: 3.9348836403150664 | Val: 2.1848775539776675
4-th component log probs | Train: 3.856009760589577 | Val: 2.875785235796036
5-th component log probs | Train: 3.9144205052228807 | Val: 2.527816003648271
6-th component log probs | Train: 3.910729062237199 | Val: 1.4430911002818365
7-th component log probs | Train: 3.9562044990295466 | Val: 2.5904781237873435
8-th component log probs | Train: 3.9839870396762738 | Val: 1.5596541973122615
9-th component log probs | Train: 3.9158985680953613 | Val: 1.4189210595517499
KEYWORD NR_SAMPLES:30000 DIM:512 AVG_DIFF:2.8878
best average differences at 50 dimensions: 0.8999946054865138
2022-01-10 06:10.59 [info     ] Training complete              train_loss=0.22775334119796753
2022-01-10 06:10.59 [info     ] Starting evaluating            dataset=26032
2022-01-10 06:11.03 [info     ] Testing complete               test_loss=0.2967830002307892
{'dataset_size': 30000,
 'end_test_accuracy': 0.9163467288017273,
 'end_test_loss': 0.2967830002307892,
 'end_train_accuracy': 0.9883618354797363,
 'end_train_loss': 0.22775334119796753,
 'end_val_accuracy': 0.9271172285079956,
 'end_val_loss': 0.3249623775482178}
2022-01-10 06:11.03 [info     ] Start Predict                  dataset=28606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 06:11.39 [info     ] Starting training              dataset=40000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
40000
Fitting PCA...
0-th component log probs | Train: 2.0820357194662233 | Val: 1.6750784990991787
1-th component log probs | Train: 1.8714999798155358 | Val: 1.5767556816500758
2-th component log probs | Train: 1.9220868259926986 | Val: 1.6611562729044336
3-th component log probs | Train: 1.8653629549295208 | Val: 1.256583976579186
4-th component log probs | Train: 2.0005096040530628 | Val: 1.5553647303256564
5-th component log probs | Train: 2.047632647831483 | Val: 1.505078625278023
6-th component log probs | Train: 2.0403523915510378 | Val: 1.2555803846967981
7-th component log probs | Train: 2.03311730184419 | Val: 1.6527090681958447
8-th component log probs | Train: 2.023376533467384 | Val: 1.3191551485426802
9-th component log probs | Train: 2.008280982572671 | Val: 1.4739169762636408
KEYWORD NR_SAMPLES:40000 DIM:50 AVG_DIFF:0.2726
Fitting PCA...
0-th component log probs | Train: 2.6660740185215084 | Val: 2.1728392763060462
1-th component log probs | Train: 2.4532158928807535 | Val: 2.1500783375196653
2-th component log probs | Train: 2.5271459118410853 | Val: 2.2073703212079674
3-th component log probs | Train: 2.458245989128517 | Val: 1.8368477292765482
4-th component log probs | Train: 2.5901323750425864 | Val: 1.9748433632788442
5-th component log probs | Train: 2.653906672136237 | Val: 2.0066827052329157
6-th component log probs | Train: 2.628866773213781 | Val: 1.6544595606122996
7-th component log probs | Train: 2.6320510453604458 | Val: 2.1591151488672886
8-th component log probs | Train: 2.624745432197905 | Val: 1.797828759752568
9-th component log probs | Train: 2.604511273714482 | Val: 1.8967312618308174
KEYWORD NR_SAMPLES:40000 DIM:100 AVG_DIFF:0.3979
Fitting PCA...
0-th component log probs | Train: 2.939858306096348 | Val: 2.4433581178700403
1-th component log probs | Train: 2.7242909079291584 | Val: 2.4479558342989245
2-th component log probs | Train: 2.8072205595458595 | Val: 2.511038351123612
3-th component log probs | Train: 2.7311462597211715 | Val: 2.1558198773860133
4-th component log probs | Train: 2.8600697695448924 | Val: 2.2522955343966076
5-th component log probs | Train: 2.917719266852186 | Val: 2.2811364968500025
6-th component log probs | Train: 2.8877618312793576 | Val: 1.959084919299042
7-th component log probs | Train: 2.9154850258244953 | Val: 2.4275390141946516
8-th component log probs | Train: 2.898474226732573 | Val: 2.0932842597217793
9-th component log probs | Train: 2.8749741999660596 | Val: 2.185709729718786
KEYWORD NR_SAMPLES:40000 DIM:150 AVG_DIFF:0.3740
Fitting PCA...
0-th component log probs | Train: 3.1377050358214027 | Val: 2.615970738911463
1-th component log probs | Train: 2.9244918862286253 | Val: 2.6622317396821704
2-th component log probs | Train: 3.0095272515299945 | Val: 2.723495803745033
3-th component log probs | Train: 2.928232236678128 | Val: 2.3775823630819675
4-th component log probs | Train: 3.0564488232162295 | Val: 2.4674688945415935
5-th component log probs | Train: 3.1144131025025072 | Val: 2.485425880852404
6-th component log probs | Train: 3.07883220930059 | Val: 2.162026958981916
7-th component log probs | Train: 3.1202797543541507 | Val: 2.604890380779787
8-th component log probs | Train: 3.0997804543089518 | Val: 2.290074008272636
9-th component log probs | Train: 3.0745854800489147 | Val: 2.3573839641011114
KEYWORD NR_SAMPLES:40000 DIM:200 AVG_DIFF:0.3745
Fitting PCA...
0-th component log probs | Train: 3.3034980143670025 | Val: 2.7477899481370947
1-th component log probs | Train: 3.0907325379508372 | Val: 2.836010053505182
2-th component log probs | Train: 3.1760049044162617 | Val: 2.8926717630395586
3-th component log probs | Train: 3.0914674185688074 | Val: 2.5602337685321483
4-th component log probs | Train: 3.2193425565181526 | Val: 2.619465978525896
5-th component log probs | Train: 3.279513596995362 | Val: 2.638061909039878
6-th component log probs | Train: 3.2424308325727034 | Val: 2.3316675671490987
7-th component log probs | Train: 3.2901450155013516 | Val: 2.7360593692574557
8-th component log probs | Train: 3.267346934186851 | Val: 2.456219482914996
9-th component log probs | Train: 3.2414893398987 | Val: 2.4976645267312927
KEYWORD NR_SAMPLES:40000 DIM:250 AVG_DIFF:0.3855
Fitting PCA...
0-th component log probs | Train: 3.4509939087088135 | Val: 2.8429883465427115
1-th component log probs | Train: 3.2337218534735594 | Val: 2.982216268820985
2-th component log probs | Train: 3.317857878033274 | Val: 3.029987560063278
3-th component log probs | Train: 3.2332913984143543 | Val: 2.7072966176729163
4-th component log probs | Train: 3.3639203704028877 | Val: 2.7503291215739902
5-th component log probs | Train: 3.42453634335339 | Val: 2.761440677023935
6-th component log probs | Train: 3.387798214810395 | Val: 2.447306700843915
7-th component log probs | Train: 3.437960495658265 | Val: 2.8342380613143088
8-th component log probs | Train: 3.412414526544625 | Val: 2.586805042126836
9-th component log probs | Train: 3.3899914252505345 | Val: 2.5887697568781385
KEYWORD NR_SAMPLES:40000 DIM:300 AVG_DIFF:0.4181
Fitting PCA...
0-th component log probs | Train: 3.583636255891542 | Val: 2.929298497765075
1-th component log probs | Train: 3.360840818532349 | Val: 3.107194012383603
2-th component log probs | Train: 3.444644025270208 | Val: 3.1481330969962187
3-th component log probs | Train: 3.3615567589858646 | Val: 2.828685212902734
4-th component log probs | Train: 3.492665703360321 | Val: 2.8506295460934514
5-th component log probs | Train: 3.5543302548470903 | Val: 2.8595631296967228
6-th component log probs | Train: 3.5183591731221977 | Val: 2.527810362994969
7-th component log probs | Train: 3.5688111795962514 | Val: 2.924531997618874
8-th component log probs | Train: 3.5424771779725868 | Val: 2.692531055789827
9-th component log probs | Train: 3.5234709451974346 | Val: 2.6675910793424396
KEYWORD NR_SAMPLES:40000 DIM:350 AVG_DIFF:0.4610
Fitting PCA...
0-th component log probs | Train: 3.7029476438331654 | Val: 3.005618563684188
1-th component log probs | Train: 3.4747135015720825 | Val: 3.2221343398021243
2-th component log probs | Train: 3.5594244487360673 | Val: 3.254049072030179
3-th component log probs | Train: 3.4787216391846196 | Val: 2.9364691116433472
4-th component log probs | Train: 3.608846708182996 | Val: 2.9450531836469023
5-th component log probs | Train: 3.672245164159127 | Val: 2.9451134993322095
6-th component log probs | Train: 3.6365706758662446 | Val: 2.601914867657051
7-th component log probs | Train: 3.684939253336686 | Val: 2.9949639192369752
8-th component log probs | Train: 3.6604777192680413 | Val: 2.777046726277426
9-th component log probs | Train: 3.643751375574399 | Val: 2.7221434905904913
KEYWORD NR_SAMPLES:40000 DIM:400 AVG_DIFF:0.5083
Fitting PCA...
0-th component log probs | Train: 3.812706696722811 | Val: 3.072064723195087
1-th component log probs | Train: 3.5805778511767024 | Val: 3.326557820638354
2-th component log probs | Train: 3.665468765368245 | Val: 3.3471128569428745
3-th component log probs | Train: 3.587824195916573 | Val: 3.0340115217782797
4-th component log probs | Train: 3.7182585329726536 | Val: 3.035792892971705
5-th component log probs | Train: 3.7846617828930174 | Val: 3.0283438622909085
6-th component log probs | Train: 3.7456743841870126 | Val: 2.682464875859361
7-th component log probs | Train: 3.790786998408338 | Val: 3.067189238261242
8-th component log probs | Train: 3.769524346404229 | Val: 2.8499347839655176
9-th component log probs | Train: 3.7587297722179387 | Val: 2.7791767954970963
KEYWORD NR_SAMPLES:40000 DIM:450 AVG_DIFF:0.5518
Fitting PCA...
0-th component log probs | Train: 3.9265317481801363 | Val: 3.188822983819131
1-th component log probs | Train: 3.6967563813757027 | Val: 3.448286472387453
2-th component log probs | Train: 3.7768605436915945 | Val: 3.46173172595779
3-th component log probs | Train: 3.705304839899252 | Val: 3.161609192951988
4-th component log probs | Train: 3.8312023968441453 | Val: 3.1620249379265286
5-th component log probs | Train: 3.8988845716710983 | Val: 3.1594611726814334
6-th component log probs | Train: 3.856814840072372 | Val: 2.822322185755832
7-th component log probs | Train: 3.9013604575582774 | Val: 3.1894546335876814
8-th component log probs | Train: 3.8831460331199374 | Val: 2.979426180789771
9-th component log probs | Train: 3.8761413913541407 | Val: 2.8941469598566254
KEYWORD NR_SAMPLES:40000 DIM:500 AVG_DIFF:0.5353
0-th component log probs | Train: 3.9642268699376535 | Val: 3.238600866430044
1-th component log probs | Train: 3.7378292447731023 | Val: 3.4935577525942096
2-th component log probs | Train: 3.8162253476985852 | Val: 3.506423341948749
3-th component log probs | Train: 3.74587629583019 | Val: 3.2120164069888615
4-th component log probs | Train: 3.8694822965002236 | Val: 3.212269017200893
5-th component log probs | Train: 3.936117761597518 | Val: 3.210927123667392
6-th component log probs | Train: 3.8954235771954977 | Val: 2.880067138452722
7-th component log probs | Train: 3.939670035275617 | Val: 3.238857065862526
8-th component log probs | Train: 3.9214983377186097 | Val: 3.033190795814369
9-th component log probs | Train: 3.913418836076876 | Val: 2.9487472021687053
KEYWORD NR_SAMPLES:40000 DIM:512 AVG_DIFF:0.5167
best average differences at 50 dimensions: 0.2725753981714264
2022-01-10 07:00.04 [info     ] Training complete              train_loss=0.290293425321579
2022-01-10 07:00.04 [info     ] Starting evaluating            dataset=26032
2022-01-10 07:00.08 [info     ] Testing complete               test_loss=0.2901529371738434
{'dataset_size': 40000,
 'end_test_accuracy': 0.9152845740318298,
 'end_test_loss': 0.2901529371738434,
 'end_train_accuracy': 0.9697999954223633,
 'end_train_loss': 0.290293425321579,
 'end_val_accuracy': 0.9241093397140503,
 'end_val_loss': 0.31510767340660095}
2022-01-10 07:00.08 [info     ] Start Predict                  dataset=18606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-10 07:00.40 [info     ] Starting training              dataset=50000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
50000
Fitting PCA...
0-th component log probs | Train: 1.9900360830221013 | Val: 1.55255104829485
1-th component log probs | Train: 1.7949780807891775 | Val: 1.5937436772210256
2-th component log probs | Train: 1.8257912612486098 | Val: 1.4838623138572378
3-th component log probs | Train: 1.8064470967117348 | Val: 1.3948000011443404
4-th component log probs | Train: 1.9128799277203894 | Val: 1.5194078549838916
5-th component log probs | Train: 1.9643231307063422 | Val: 1.5662590913668544
6-th component log probs | Train: 1.976859101392242 | Val: 1.3274871421911805
7-th component log probs | Train: 1.916241961767789 | Val: 1.6566555638195177
8-th component log probs | Train: 1.872402662560368 | Val: 1.4192238162951507
9-th component log probs | Train: 2.025464041060543 | Val: 1.3412959806198386
KEYWORD NR_SAMPLES:50000 DIM:50 AVG_DIFF:0.1994
Fitting PCA...
0-th component log probs | Train: 2.6065352786853753 | Val: 2.0475806521370314
1-th component log probs | Train: 2.4034814616920896 | Val: 2.1773021023965096
2-th component log probs | Train: 2.4502901844210934 | Val: 2.0518038272907893
3-th component log probs | Train: 2.423731760452944 | Val: 1.926716759363342
4-th component log probs | Train: 2.5175365634283153 | Val: 2.022583354984835
5-th component log probs | Train: 2.5805372489494833 | Val: 2.0933032905345805
6-th component log probs | Train: 2.5927350646709564 | Val: 1.8163769987627012
7-th component log probs | Train: 2.53789719445412 | Val: 2.2055734209849724
8-th component log probs | Train: 2.47388567118778 | Val: 1.9317615408473574
9-th component log probs | Train: 2.665938810145435 | Val: 1.7679628913422398
KEYWORD NR_SAMPLES:50000 DIM:100 AVG_DIFF:0.3065
Fitting PCA...
0-th component log probs | Train: 2.895148125757576 | Val: 2.3642056561552924
1-th component log probs | Train: 2.6995178883330535 | Val: 2.4883904524824194
2-th component log probs | Train: 2.736845420310891 | Val: 2.3731267499755586
3-th component log probs | Train: 2.719814073881885 | Val: 2.255621595608535
4-th component log probs | Train: 2.808574033149225 | Val: 2.325736496821383
5-th component log probs | Train: 2.8691506508646043 | Val: 2.4005774550816033
6-th component log probs | Train: 2.8817266407890143 | Val: 2.1329408242752272
7-th component log probs | Train: 2.834453399338195 | Val: 2.5034290168224342
8-th component log probs | Train: 2.7712690942301537 | Val: 2.258609610848021
9-th component log probs | Train: 2.9613089677022413 | Val: 2.034632888946131
KEYWORD NR_SAMPLES:50000 DIM:150 AVG_DIFF:0.2919
Fitting PCA...
0-th component log probs | Train: 3.099019346199566 | Val: 2.5776856854221366
1-th component log probs | Train: 2.90635625386492 | Val: 2.702401607550558
2-th component log probs | Train: 2.9381475042656513 | Val: 2.593815639790057
3-th component log probs | Train: 2.928796172469748 | Val: 2.469567510324477
4-th component log probs | Train: 3.012080159698601 | Val: 2.5392989465710962
5-th component log probs | Train: 3.069948281454958 | Val: 2.6181514947509763
6-th component log probs | Train: 3.083510867989678 | Val: 2.3458871208407923
7-th component log probs | Train: 3.042288434244769 | Val: 2.700704757592639
8-th component log probs | Train: 2.9803042778720803 | Val: 2.473910700411166
9-th component log probs | Train: 3.1717039375529152 | Val: 2.215144001773838
KEYWORD NR_SAMPLES:50000 DIM:200 AVG_DIFF:0.2903
Fitting PCA...
0-th component log probs | Train: 3.2692398787211836 | Val: 2.7415784173362954
1-th component log probs | Train: 3.0775852971815048 | Val: 2.8760683173322503
2-th component log probs | Train: 3.104828651804383 | Val: 2.773220797476983
3-th component log probs | Train: 3.099254443890067 | Val: 2.6404395794847058
4-th component log probs | Train: 3.1812926237683357 | Val: 2.7074841152821842
5-th component log probs | Train: 3.2376898098219997 | Val: 2.77690291657118
6-th component log probs | Train: 3.2526654034898876 | Val: 2.515212879956002
7-th component log probs | Train: 3.215464942199241 | Val: 2.854647033992636
8-th component log probs | Train: 3.1554226006431834 | Val: 2.635593678690127
9-th component log probs | Train: 3.34815561473386 | Val: 2.329277172664156
KEYWORD NR_SAMPLES:50000 DIM:250 AVG_DIFF:0.3059
Fitting PCA...
0-th component log probs | Train: 3.4173445745565703 | Val: 2.880948487738581
1-th component log probs | Train: 3.2272232392571785 | Val: 3.0221861816462345
2-th component log probs | Train: 3.252645187687298 | Val: 2.914835444946837
3-th component log probs | Train: 3.249044525943385 | Val: 2.7852434047514647
4-th component log probs | Train: 3.331972187025925 | Val: 2.849796452711458
5-th component log probs | Train: 3.3880363935897226 | Val: 2.911065477042922
6-th component log probs | Train: 3.404704041953832 | Val: 2.645685362740013
7-th component log probs | Train: 3.366639190303837 | Val: 2.9768424012612473
8-th component log probs | Train: 3.305368719033166 | Val: 2.76670952698977
9-th component log probs | Train: 3.505171094204325 | Val: 2.413608049727799
KEYWORD NR_SAMPLES:50000 DIM:300 AVG_DIFF:0.3329
Fitting PCA...
0-th component log probs | Train: 3.547965235213741 | Val: 2.9972479777075534
1-th component log probs | Train: 3.3579134937311683 | Val: 3.1472493706320965
2-th component log probs | Train: 3.3846368056763287 | Val: 3.030049615262378
3-th component log probs | Train: 3.3813555335292977 | Val: 2.9027091129126013
4-th component log probs | Train: 3.4645306535740747 | Val: 2.9739719284577215
5-th component log probs | Train: 3.5211486418171267 | Val: 3.0270146416680057
6-th component log probs | Train: 3.5395511960917365 | Val: 2.746020440753999
7-th component log probs | Train: 3.5021767537948243 | Val: 3.0803509564233758
8-th component log probs | Train: 3.4373299912162736 | Val: 2.879687162262943
9-th component log probs | Train: 3.6455346108369473 | Val: 2.474882986768234
KEYWORD NR_SAMPLES:50000 DIM:350 AVG_DIFF:0.3676
Fitting PCA...
0-th component log probs | Train: 3.665815728715786 | Val: 3.0985854908619563
1-th component log probs | Train: 3.4749682395848835 | Val: 3.2594998778671243
2-th component log probs | Train: 3.505714589558311 | Val: 3.141508125756208
3-th component log probs | Train: 3.4981642854677686 | Val: 3.0087239022447325
4-th component log probs | Train: 3.583747894243311 | Val: 3.0803787563774803
5-th component log probs | Train: 3.6425902751875223 | Val: 3.1266378252384226
6-th component log probs | Train: 3.662440314555598 | Val: 2.831826279967468
7-th component log probs | Train: 3.6231253617264905 | Val: 3.1743203110051517
8-th component log probs | Train: 3.554967795988287 | Val: 2.9778096581865667
9-th component log probs | Train: 3.7704330355187325 | Val: 2.553171997084551
KEYWORD NR_SAMPLES:50000 DIM:400 AVG_DIFF:0.3966
Fitting PCA...
0-th component log probs | Train: 3.7763352376779595 | Val: 3.1959867402726605
1-th component log probs | Train: 3.584979840947363 | Val: 3.367117708918812
2-th component log probs | Train: 3.620855510301945 | Val: 3.250317949658645
3-th component log probs | Train: 3.609039123657941 | Val: 3.1088812827072276
4-th component log probs | Train: 3.6946772380571598 | Val: 3.188807879395582
5-th component log probs | Train: 3.759096385558403 | Val: 3.2242800653768042
6-th component log probs | Train: 3.778089929218764 | Val: 2.926075967145437
7-th component log probs | Train: 3.7360785982580453 | Val: 3.2587431715210897
8-th component log probs | Train: 3.6655045102725867 | Val: 3.0760833673269943
9-th component log probs | Train: 3.8860001012826144 | Val: 2.6475403793844663
KEYWORD NR_SAMPLES:50000 DIM:450 AVG_DIFF:0.4149
Fitting PCA...
0-th component log probs | Train: 3.9017213796878996 | Val: 3.3408687448803254
1-th component log probs | Train: 3.7140491181570847 | Val: 3.503375013878768
2-th component log probs | Train: 3.748497201253032 | Val: 3.3941505771174962
3-th component log probs | Train: 3.739870268275425 | Val: 3.2556120349245106
4-th component log probs | Train: 3.8185479908886495 | Val: 3.332673440829132
5-th component log probs | Train: 3.8838865085318286 | Val: 3.3673245898876325
6-th component log probs | Train: 3.903020392564505 | Val: 3.083048160071979
7-th component log probs | Train: 3.8627290402494014 | Val: 3.393510802286606
8-th component log probs | Train: 3.792069572692686 | Val: 3.2191432421854316
9-th component log probs | Train: 4.006740115105061 | Val: 2.827861672762056
KEYWORD NR_SAMPLES:50000 DIM:500 AVG_DIFF:0.3832
0-th component log probs | Train: 3.9428819038649294 | Val: 3.392002957340384
1-th component log probs | Train: 3.759739237869876 | Val: 3.55297431997839
2-th component log probs | Train: 3.792043138550855 | Val: 3.444905224869392
3-th component log probs | Train: 3.784961337290042 | Val: 3.310207491380658
4-th component log probs | Train: 3.861809059806797 | Val: 3.385570665481195
5-th component log probs | Train: 3.9268788156568606 | Val: 3.420893077491192
6-th component log probs | Train: 3.9456517416748205 | Val: 3.142104156525107
7-th component log probs | Train: 3.9044778799340882 | Val: 3.443132134814632
8-th component log probs | Train: 3.8364933704384607 | Val: 3.2746875179315382
9-th component log probs | Train: 4.04601666705863 | Val: 2.8907971438222457
KEYWORD NR_SAMPLES:50000 DIM:512 AVG_DIFF:0.3684
best average differences at 50 dimensions: 0.1994058469607655
2022-01-10 08:00.43 [info     ] Training complete              train_loss=0.2776545584201813
2022-01-10 08:00.43 [info     ] Starting evaluating            dataset=26032
2022-01-10 08:00.47 [info     ] Testing complete               test_loss=0.29370126128196716
{'dataset_size': 50000,
 'end_test_accuracy': 0.91470867395401,
 'end_test_loss': 0.29370126128196716,
 'end_train_accuracy': 0.9722666144371033,
 'end_train_loss': 0.2776545584201813,
 'end_val_accuracy': 0.9194637537002563,
 'end_val_loss': 0.32726433873176575}
2022-01-10 08:00.47 [info     ] Start Predict                  dataset=8606
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

wandb: Waiting for W&B process to finish, PID 17069... (success).
wandb: - 0.53MB of 0.53MB uploaded (0.00MB deduped)wandb: \ 0.53MB of 0.53MB uploaded (0.00MB deduped)wandb: | 0.53MB of 0.53MB uploaded (0.00MB deduped)wandb: / 0.53MB of 0.94MB uploaded (0.00MB deduped)wandb: - 0.53MB of 0.94MB uploaded (0.00MB deduped)wandb: \ 0.79MB of 0.94MB uploaded (0.00MB deduped)wandb: | 0.79MB of 0.94MB uploaded (0.00MB deduped)wandb: / 0.79MB of 0.94MB uploaded (0.00MB deduped)wandb: - 0.79MB of 0.94MB uploaded (0.00MB deduped)wandb: \ 0.79MB of 0.94MB uploaded (0.00MB deduped)wandb: | 0.79MB of 0.94MB uploaded (0.00MB deduped)wandb: / 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: - 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: \ 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: | 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: / 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: - 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: \ 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb: | 0.94MB of 0.94MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:           accuracy_0 ▁▃▄▅▅▆▇▇█████████████
wandb:           accuracy_1 ▁▂▃▃▂▄▃▄▅▅▅▆▆▆▆▆█▇▇██
wandb:          accuracy_10 ▁▃▄▅▆▆▆▆▇▇▇▇▇▇███████████████
wandb:          accuracy_11 ▁▄▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇█████████████
wandb:          accuracy_12 ▁▄▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇███████████
wandb:          accuracy_13 ▁▅▆▆▆▇▇▇▇▇▇▇▇█████████████████
wandb:          accuracy_14 ▁▅▆▆▆▆▇▇▇▇▇▇▇▇████████████████
wandb:           accuracy_2 ▁▂▂▃▄▄▄▅▆▆▇▇▇████████
wandb:           accuracy_3 ▁▂▂▃▄▄▅▅▆▆▆▇▇▇▇▇▇▇▇▇███████████████
wandb:           accuracy_4 ▁▂▂▃▄▄▅▆▆▆▆▇▇▇▇▇▇█████████████████
wandb:           accuracy_5 ▁▂▃▅▅▆▇▇▇▇▇▇█▇██████████████████████████
wandb:           accuracy_6 ▁▁▂▂▃▄▅▆▆▆▇▇▇▇▇▇▇▇▇▇▇████████████
wandb:           accuracy_7 ▁▁▂▃▄▅▅▆▆▇▇▇▇▇▇▇██████████████
wandb:           accuracy_8 ▁▂▄▅▅▆▆▆▇▇▇▇▇▇▇▇▇█████████████
wandb:           accuracy_9 ▁▂▄▅▆▆▆▇▇▇▇▇▇▇████████████
wandb:              class_0 █▃▂▂▂▄▇▅▅▄▃▃▃▁▄
wandb:              class_1 ▁█▇█▆▄▂▂▃▂▂▅▇▇▆
wandb:              class_2 ▁▁▇█▇▅▂▆▄▃▂▂▃▂▅
wandb:              class_3 ▁▂▆▄▄▂▃▄▄▇█▅▂▆▄
wandb:              class_4 ▅▅▁▁▃▃▂▃▂▅▅██▅▆
wandb:              class_5 ▆▃▁▂▃▂▆▃▄▆▆▄█▄▆
wandb:              class_6 ▅▂▃▂▁▄█▄▇▅▅▃▃▃▂
wandb:              class_7 ▇▄▃▆█▆▂▂▂▁▃▃▁▁▁
wandb:              class_8 ▆▃▁▁▁▅▇█▇▆▅▄▂▄▃
wandb:              class_9 █▆▃▁▃▆▆▆▆▇▇▅▄▃▄
wandb:         dataset_size ▁▁▁▁▁▁▁▂▂▂▂▄▅▇█
wandb:    end_test_accuracy ▁▁▁▄▅▆▆▇▇▇█████
wandb:        end_test_loss ███▆▅▅▃▃▂▂▂▁▁▁▁
wandb:   end_train_accuracy ▇▁▃████▇▇▇▆██▇▇
wandb:       end_train_loss ▄█▇▃▃▂▂▂▂▂▂▁▁▂▁
wandb:     end_val_accuracy ▁▁▃▅▅▆▇▇▇██████
wandb:         end_val_loss █▆▄▃▃▂▂▂▁▁▁▁▁▁▁
wandb:                epoch ▁▂▁▃▂▃▂▃▅▂▃▅▂▄▅▇█▁▃▄▂▃▁▂▄▂▃▁▃▄▂▄▁▃▄▂▃▁▃▄
wandb:               loss_0 █▆▅▄▄▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁
wandb:               loss_1 █▆▅▅▅▄▄▄▃▃▃▂▂▂▂▂▁▁▁▂▁
wandb:              loss_10 █▆▅▄▄▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              loss_11 █▅▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:              loss_12 █▅▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:              loss_13 █▄▄▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              loss_14 █▄▄▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_2 █▇▆▅▄▄▃▃▃▂▂▂▂▁▁▁▁▁▁▁▁
wandb:               loss_3 █▇▆▅▄▄▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_4 █▇▆▅▄▄▄▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_5 █▇▆▄▄▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_6 █▇▆▆▅▄▄▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_7 █▇▇▆▅▄▄▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_8 █▇▅▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               loss_9 █▇▅▄▄▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_0 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_1 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                lr_10 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                lr_11 █████████████████████████████▁▁▁
wandb:                lr_12 █████████████████████████████▁▁
wandb:                lr_13 █████████████████████████████▁
wandb:                lr_14 █████████████████████████████▁
wandb:                 lr_2 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 lr_3 █████████████████████████████▁▁▁▁▁▁
wandb:                 lr_4 █████████████████████████████▁▁▁▁▁
wandb:                 lr_5 █████████████████▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁
wandb:                 lr_6 █████████████████████████████▁▁▁▁
wandb:                 lr_7 █████████████████████████████▁
wandb:                 lr_8 █████████████████████████████▁
wandb:                 lr_9 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       val_accuracy_0 ▄▁▁▄▃▄▄▅▅▅▅▇█▇███████
wandb:       val_accuracy_1 ▇▄▄▃▁▂▂▂▂▃▃▃▃▄▃▂▃▅▅█▅
wandb:      val_accuracy_10 ▁▅▇▇▇████████████████████████
wandb:      val_accuracy_11 ▁▅▆▆▇▇▇▇█▇██████████████████████
wandb:      val_accuracy_12 ▁▄▆▆▇▇▇▇▇▇█▇▇██▇█▇▇█▇██▇▇█▇▇▇▇█
wandb:      val_accuracy_13 ▁▅▅▆▆▇▇▇██▇▇█████▇████████████
wandb:      val_accuracy_14 ▁▄▅▅▇▇▇▇█▇▇███████████████████
wandb:       val_accuracy_2 ▂▁▁▃▃▃▃▅▄▆▅▆▇▆▇▇█▇▇▇▇
wandb:       val_accuracy_3 ▁▁▂▂▃▃▃▄▅▆▅▅▆▆▇▇▆▆▇▇▇▇▇▇▇▇█▇███████
wandb:       val_accuracy_4 ▁▂▂▃▃▃▅▅▅▆▆▇▇▇▇▇▇▇▇▇█▇▇▇▇█▇▇█▇████
wandb:       val_accuracy_5 ▁▂▃▄▅▅▆▇▆▇▇▇▇▇███▇██████████████████████
wandb:       val_accuracy_6 ▁▁▂▃▅▆▇▆▇▇▇▇█▇▇█▇█▇██████████████
wandb:       val_accuracy_7 ▁▁▃▅▆▇▇▇▇█████████▇███████████
wandb:       val_accuracy_8 ▁▄▆▇▇▇█▇▇█████████████████████
wandb:       val_accuracy_9 ▁▅▆▇▇█████████████████████
wandb:           val_loss_0 ▁▁▁▁▁▁▁▁▂▃▃▄▅▆▇▇█████
wandb:           val_loss_1 ▁▁▂▃▄▆▄▆▇▅▅▆▆▆▇█▇██▇█
wandb:          val_loss_10 █▄▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_loss_11 █▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▁▂▂▁▂▂▂▂▂▂▁▁
wandb:          val_loss_12 █▅▃▂▂▁▁▁▂▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▃▃▂▂
wandb:          val_loss_13 █▄▄▂▂▂▂▁▁▁▂▂▂▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▃▂
wandb:          val_loss_14 █▄▃▃▂▂▁▂▁▁▁▁▁▁▁▁▁▂▁▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_loss_2 ▁▃▃▂▂▁▄▂▇▂▄▆▁▅▃▄▂▅▅██
wandb:           val_loss_3 ▄▅▆█▅▃▅▃▄▃▃▄▃▂▁▂▃▄▂▂▃▃▃▂▃▂▂▂▂▃▂▂▂▁▁
wandb:           val_loss_4 ▇█▆▆▅▆▃▄▃▃▂▂▂▁▂▃▂▂▃▃▂▃▃▂▄▃▃▅▃▅▂▂▁▁
wandb:           val_loss_5 █▅▄▃▂▃▂▂▂▂▂▂▂▂▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_loss_6 █▇▆▅▃▂▂▂▁▁▁▁▁▁▂▁▂▁▂▂▂▁▁▁▁▂▁▁▂▂▁▁▁
wandb:           val_loss_7 ██▆▄▃▂▁▁▁▁▁▁▁▁▂▁▁▁▂▁▁▁▁▂▂▂▂▂▁▁
wandb:           val_loss_8 █▅▃▂▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▂▂▁▂
wandb:           val_loss_9 █▅▃▂▂▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:           accuracy_0 0.95833
wandb:           accuracy_1 0.80078
wandb:          accuracy_10 0.95661
wandb:          accuracy_11 0.99501
wandb:          accuracy_12 0.98836
wandb:          accuracy_13 0.9698
wandb:          accuracy_14 0.97227
wandb:           accuracy_2 0.84598
wandb:           accuracy_3 0.99427
wandb:           accuracy_4 0.99639
wandb:           accuracy_5 1.0
wandb:           accuracy_6 0.99365
wandb:           accuracy_7 0.97222
wandb:           accuracy_8 0.97789
wandb:           accuracy_9 0.96425
wandb:              class_0 0.07684
wandb:              class_1 0.1781
wandb:              class_2 0.14342
wandb:              class_3 0.1203
wandb:              class_4 0.10652
wandb:              class_5 0.09662
wandb:              class_6 0.0814
wandb:              class_7 0.05272
wandb:              class_8 0.07592
wandb:              class_9 0.06816
wandb:         dataset_size 50000
wandb:    end_test_accuracy 0.91471
wandb:        end_test_loss 0.2937
wandb:   end_train_accuracy 0.97227
wandb:       end_train_loss 0.27765
wandb:     end_val_accuracy 0.91946
wandb:         end_val_loss 0.32726
wandb:                epoch 30
wandb:               loss_0 0.61539
wandb:               loss_1 1.17098
wandb:              loss_10 0.40872
wandb:              loss_11 0.22112
wandb:              loss_12 0.22775
wandb:              loss_13 0.29029
wandb:              loss_14 0.27765
wandb:               loss_2 1.05607
wandb:               loss_3 0.44498
wandb:               loss_4 0.43298
wandb:               loss_5 0.30592
wandb:               loss_6 0.33363
wandb:               loss_7 0.39227
wandb:               loss_8 0.36316
wandb:               loss_9 0.40508
wandb:                 lr_0 0.001
wandb:                 lr_1 0.001
wandb:                lr_10 0.001
wandb:                lr_11 0.0001
wandb:                lr_12 0.0001
wandb:                lr_13 0.0001
wandb:                lr_14 0.0001
wandb:                 lr_2 0.001
wandb:                 lr_3 0.0001
wandb:                 lr_4 0.0001
wandb:                 lr_5 1e-05
wandb:                 lr_6 0.0001
wandb:                 lr_7 0.0001
wandb:                 lr_8 0.0001
wandb:                 lr_9 0.001
wandb:       val_accuracy_0 0.15746
wandb:       val_accuracy_1 0.16629
wandb:      val_accuracy_10 0.89079
wandb:      val_accuracy_11 0.92445
wandb:      val_accuracy_12 0.92712
wandb:      val_accuracy_13 0.92411
wandb:      val_accuracy_14 0.91946
wandb:       val_accuracy_2 0.36496
wandb:       val_accuracy_3 0.5713
wandb:       val_accuracy_4 0.6394
wandb:       val_accuracy_5 0.69536
wandb:       val_accuracy_6 0.77941
wandb:       val_accuracy_7 0.83414
wandb:       val_accuracy_8 0.85919
wandb:       val_accuracy_9 0.87573
wandb:           val_loss_0 5.22266
wandb:           val_loss_1 3.82592
wandb:          val_loss_10 0.48099
wandb:          val_loss_11 0.34459
wandb:          val_loss_12 0.32496
wandb:          val_loss_13 0.31511
wandb:          val_loss_14 0.32726
wandb:           val_loss_2 2.75441
wandb:           val_loss_3 1.79845
wandb:           val_loss_4 1.52024
wandb:           val_loss_5 1.31477
wandb:           val_loss_6 0.91885
wandb:           val_loss_7 0.74728
wandb:           val_loss_8 0.65286
wandb:           val_loss_9 0.56356
wandb: 
wandb: Synced 6 W&B file(s), 30 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced svhn_hu_greedy_l2_run3: https://wandb.ai/fanconic/hidden_uncertainty/runs/j74yoqbg
wandb: Find logs at: ./wandb/run-20220110_040201-j74yoqbg/logs/debug.log
wandb: 
