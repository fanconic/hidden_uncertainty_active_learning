cifar10_hu_greedy_l2
wandb: Currently logged in as: eth_dlad_team32 (use `wandb login --relogin` to force relogin)
wandb: wandb version 0.12.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.7
wandb: Syncing run cifar10_hu_greedy_l2_run1
wandb:  View project at https://wandb.ai/fanconic/hidden_uncertainty
wandb:  View run at https://wandb.ai/fanconic/hidden_uncertainty/runs/2ycu6x8l
wandb: Run data is saved locally in /scratch_net/airfox/fanconic/semproj2/hidden_uncertainty_active_learning/wandb/run-20220109_004820-2ycu6x8l
wandb: Run `wandb offline` to turn off syncing.

Cuda is available:  True
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /tmp/cifar-10-python.tar.gz
  0% 0/170498071 [00:00<?, ?it/s]  0% 17408/170498071 [00:00<16:32, 171766.36it/s]  0% 50176/170498071 [00:00<10:50, 262076.08it/s]  0% 115712/170498071 [00:00<06:27, 440092.87it/s]  0% 246784/170498071 [00:00<03:38, 780953.74it/s]  0% 492544/170498071 [00:00<02:02, 1383267.26it/s]  1% 902144/170498071 [00:00<01:13, 2302528.30it/s]  1% 1819648/170498071 [00:00<00:37, 4537556.32it/s]  2% 3671040/170498071 [00:00<00:18, 8826295.25it/s]  3% 5882880/170498071 [00:01<00:16, 9794286.15it/s]  5% 9012224/170498071 [00:01<00:10, 14995524.35it/s]  7% 11781120/170498071 [00:01<00:08, 18056850.54it/s]  9% 14779392/170498071 [00:01<00:07, 20927036.87it/s] 11% 17908736/170498071 [00:01<00:06, 23725462.15it/s] 12% 21038080/170498071 [00:01<00:05, 25806362.46it/s] 14% 24151040/170498071 [00:01<00:05, 27302878.91it/s] 16% 27189248/170498071 [00:01<00:05, 28195559.49it/s] 18% 30054400/170498071 [00:01<00:04, 28116058.76it/s] 19% 33113088/170498071 [00:01<00:04, 28526169.67it/s] 21% 36226048/170498071 [00:02<00:04, 29233033.65it/s] 23% 39339008/170498071 [00:02<00:04, 29747321.77it/s] 25% 42435584/170498071 [00:02<00:04, 30045972.49it/s] 27% 45564928/170498071 [00:02<00:04, 30342274.37it/s] 29% 48661504/170498071 [00:02<00:03, 30464639.58it/s] 30% 51713024/170498071 [00:02<00:03, 30255953.48it/s] 32% 54743040/170498071 [00:02<00:03, 29187504.98it/s] 34% 57754624/170498071 [00:02<00:04, 28012878.14it/s] 36% 60834816/170498071 [00:02<00:03, 27910414.33it/s] 38% 63947776/170498071 [00:02<00:03, 28372946.58it/s] 39% 67011584/170498071 [00:03<00:03, 28968929.15it/s] 41% 70140928/170498071 [00:03<00:03, 29577408.66it/s] 43% 73270272/170498071 [00:03<00:03, 29599545.87it/s] 45% 76416000/170498071 [00:03<00:03, 29787520.26it/s] 47% 79496192/170498071 [00:03<00:03, 30026088.79it/s] 48% 82502656/170498071 [00:03<00:02, 29634018.87it/s] 50% 85469184/170498071 [00:03<00:02, 28924897.37it/s] 52% 88366080/170498071 [00:03<00:02, 28565147.73it/s] 54% 91472896/170498071 [00:03<00:02, 29221998.84it/s] 55% 94602240/170498071 [00:04<00:02, 29715664.64it/s] 57% 97682432/170498071 [00:04<00:02, 29994723.32it/s] 59% 100795392/170498071 [00:04<00:02, 30301083.19it/s] 61% 103908352/170498071 [00:04<00:02, 30512619.65it/s] 63% 107021312/170498071 [00:04<00:02, 30121072.94it/s] 65% 110036992/170498071 [00:04<00:02, 29109571.55it/s] 66% 112956416/170498071 [00:04<00:01, 28877906.80it/s] 68% 115885056/170498071 [00:04<00:01, 28765122.83it/s] 70% 119014400/170498071 [00:04<00:01, 29448672.89it/s] 72% 122110976/170498071 [00:04<00:01, 29837281.37it/s] 73% 125240320/170498071 [00:05<00:01, 30218375.17it/s] 75% 128336896/170498071 [00:05<00:01, 30385279.90it/s] 77% 131417088/170498071 [00:05<00:01, 30448522.57it/s] 79% 134464512/170498071 [00:05<00:01, 30071102.61it/s] 81% 137474048/170498071 [00:05<00:01, 29068731.95it/s] 82% 140388352/170498071 [00:05<00:01, 28701296.57it/s] 84% 143377408/170498071 [00:05<00:00, 29045152.79it/s] 86% 146457600/170498071 [00:05<00:00, 29545298.55it/s] 88% 149488640/170498071 [00:05<00:00, 29583052.65it/s] 90% 152601600/170498071 [00:05<00:00, 29994814.26it/s] 91% 155603968/170498071 [00:06<00:00, 29909641.61it/s] 93% 158597120/170498071 [00:06<00:00, 29632149.08it/s] 95% 161563648/170498071 [00:06<00:00, 29051360.20it/s] 96% 164471808/170498071 [00:06<00:00, 28392723.23it/s] 98% 167330816/170498071 [00:06<00:00, 28297048.23it/s]100% 170394624/170498071 [00:06<00:00, 28651386.58it/s]170499072it [00:06, 25816737.29it/s]                   
Extracting /tmp/cifar-10-python.tar.gz to /tmp
Files already downloaded and verified
2022-01-09 00:48.56 [info     ] Starting training              dataset=100 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
100
Fitting PCA...
0-th component log probs | Train: 5.013485805326144 | Val: -1713.6864143453872
1-th component log probs | Train: 4.958294974369811 | Val: -2703.4950902126607
2-th component log probs | Train: 5.025106601890634 | Val: -1649.0193254487704
3-th component log probs | Train: 4.9987104853448985 | Val: -2131.9549299594123
4-th component log probs | Train: 5.007836350752375 | Val: -1664.5022969828003
5-th component log probs | Train: 5.020635087482359 | Val: -1657.1758768747093
6-th component log probs | Train: 5.123458323199724 | Val: -1692.737937270995
7-th component log probs | Train: 5.024829009657276 | Val: -2104.7708721915697
8-th component log probs | Train: 5.013344130607796 | Val: -1606.0827285852345
9-th component log probs | Train: 4.971625710751022 | Val: -2598.4625736574244
KEYWORD NR_SAMPLES:100 DIM:50 AVG_DIFF:3984971.5666
0-th component log probs | Train: 30.165156695986905 | Val: -1236.7942383177656
1-th component log probs | Train: 30.14515726409246 | Val: -1791.2926526402753
2-th component log probs | Train: 30.17211579175961 | Val: -1151.3204103443386
3-th component log probs | Train: 30.16112237974925 | Val: -1451.2263552234144
4-th component log probs | Train: 30.164255504342805 | Val: -1141.2939400082782
5-th component log probs | Train: 30.168870965956057 | Val: -1207.4675395632419
6-th component log probs | Train: 30.2081963860763 | Val: -1247.968073913207
7-th component log probs | Train: 30.17133896022482 | Val: -1494.419710733038
8-th component log probs | Train: 30.164221463529223 | Val: -1270.9485566976005
9-th component log probs | Train: 30.147804560802598 | Val: -1822.8116862575205
KEYWORD NR_SAMPLES:100 DIM:100 AVG_DIFF:2050177.9223
best average differences at 100 dimensions: 2050177.9223447903
2022-01-09 00:50.05 [info     ] Training complete              train_loss=1.6690857410430908
2022-01-09 00:50.05 [info     ] Starting evaluating            dataset=10000
2022-01-09 00:50.06 [info     ] Testing complete               test_loss=2.2054343223571777
{'dataset_size': 100,
 'end_test_accuracy': 0.2146695852279663,
 'end_test_loss': 2.2054343223571777,
 'end_train_accuracy': 0.7578125,
 'end_train_loss': 1.6690857410430908,
 'end_val_accuracy': 0.24323248863220215,
 'end_val_loss': 3.4319403171539307}
2022-01-09 00:50.07 [info     ] Start Predict                  dataset=39900
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 00:50.34 [info     ] Starting training              dataset=200 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
200
Fitting PCA...
0-th component log probs | Train: 4.592041281699893 | Val: -895.1639886140377
1-th component log probs | Train: 4.469199197316886 | Val: -1198.5115634807955
2-th component log probs | Train: 4.299157315314225 | Val: -423.23812217164505
3-th component log probs | Train: 4.1587109499551955 | Val: -874.6415585398645
4-th component log probs | Train: 4.491930892942514 | Val: -361.2477075690722
5-th component log probs | Train: 3.2726666298043794 | Val: -214.39704995906393
6-th component log probs | Train: 4.265645644596158 | Val: -467.0059167153319
7-th component log probs | Train: 3.468375111172047 | Val: -513.5432836059022
8-th component log probs | Train: 4.5156142341393295 | Val: -746.7163882465976
9-th component log probs | Train: 4.16693942444271 | Val: -931.2936339217672
KEYWORD NR_SAMPLES:200 DIM:50 AVG_DIFF:532178.1203
Fitting PCA...
0-th component log probs | Train: 5.281620621060942 | Val: -557.5827875728575
1-th component log probs | Train: 5.2003564355727665 | Val: -775.0657476252577
2-th component log probs | Train: 5.121114896032748 | Val: -303.71780867039837
3-th component log probs | Train: 5.0561306861087525 | Val: -565.2835487342323
4-th component log probs | Train: 5.218581297993767 | Val: -261.85985893925516
5-th component log probs | Train: 4.560037719933627 | Val: -232.52782583957642
6-th component log probs | Train: 5.1029398288166945 | Val: -343.0172498605489
7-th component log probs | Train: 4.666142696361991 | Val: -406.13367068907104
8-th component log probs | Train: 5.2418309502840765 | Val: -484.9665234355772
9-th component log probs | Train: 5.056146116163318 | Val: -647.1168617156144
KEYWORD NR_SAMPLES:200 DIM:100 AVG_DIFF:242941.9930
Fitting PCA...
0-th component log probs | Train: 5.515599696734623 | Val: -410.48319431370084
1-th component log probs | Train: 5.455677527740969 | Val: -568.5705590338789
2-th component log probs | Train: 5.403536808837657 | Val: -239.419670763759
3-th component log probs | Train: 5.363646073063062 | Val: -409.95641841145704
4-th component log probs | Train: 5.4694535182516475 | Val: -203.0820711625729
5-th component log probs | Train: 5.023760224395758 | Val: -193.97033331621336
6-th component log probs | Train: 5.391074329429946 | Val: -267.8932108131529
7-th component log probs | Train: 5.097539679631069 | Val: -308.04114929372423
8-th component log probs | Train: 5.48835585342691 | Val: -359.3941377992063
9-th component log probs | Train: 5.363190655906806 | Val: -472.1095034498611
KEYWORD NR_SAMPLES:200 DIM:150 AVG_DIFF:135194.2210
0-th component log probs | Train: 14.976150933402268 | Val: -376.33695803682645
1-th component log probs | Train: 14.929200910626056 | Val: -499.3624162168537
2-th component log probs | Train: 14.889723262789495 | Val: -219.781920761586
3-th component log probs | Train: 14.861888345681761 | Val: -361.772041661637
4-th component log probs | Train: 14.938489220008748 | Val: -187.4832861357049
5-th component log probs | Train: 14.603946888661678 | Val: -201.22210714641162
6-th component log probs | Train: 14.881288277557411 | Val: -238.48400309873395
7-th component log probs | Train: 14.661094633390931 | Val: -290.16294142348164
8-th component log probs | Train: 14.955372828410407 | Val: -337.9847916982348
9-th component log probs | Train: 14.861469135257869 | Val: -439.5633096744105
KEYWORD NR_SAMPLES:200 DIM:200 AVG_DIFF:119028.1478
best average differences at 200 dimensions: 119028.14783444206
2022-01-09 00:51.38 [info     ] Training complete              train_loss=2.79654860496521
2022-01-09 00:51.38 [info     ] Starting evaluating            dataset=10000
2022-01-09 00:51.40 [info     ] Testing complete               test_loss=2.2634363174438477
{'dataset_size': 200,
 'end_test_accuracy': 0.14759156107902527,
 'end_test_loss': 2.2634363174438477,
 'end_train_accuracy': 0.37890625,
 'end_train_loss': 2.79654860496521,
 'end_val_accuracy': 0.22730891406536102,
 'end_val_loss': 2.497779369354248}
2022-01-09 00:51.40 [info     ] Start Predict                  dataset=39800
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 00:52.05 [info     ] Starting training              dataset=400 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
400
Fitting PCA...
0-th component log probs | Train: 3.84744287010332 | Val: -463.40953725949055
1-th component log probs | Train: 3.425294003930497 | Val: -377.6356954333399
2-th component log probs | Train: 2.935480157903069 | Val: -297.0228714122594
3-th component log probs | Train: 2.1612177846544665 | Val: -50.983947346647646
4-th component log probs | Train: 3.5321463661004584 | Val: -551.2109964748328
5-th component log probs | Train: 1.9018202198124547 | Val: -2.9605926515683203
6-th component log probs | Train: 2.4832869414429695 | Val: -57.823086138372354
7-th component log probs | Train: 2.460643065588506 | Val: -225.41946954218477
8-th component log probs | Train: 3.924818819930305 | Val: -515.3073220568883
9-th component log probs | Train: 3.1941965090501565 | Val: -356.95266865521256
KEYWORD NR_SAMPLES:400 DIM:50 AVG_DIFF:121897.3567
Fitting PCA...
0-th component log probs | Train: 4.881845837689425 | Val: -376.74519482354515
1-th component log probs | Train: 4.640967084288749 | Val: -382.1385936809928
2-th component log probs | Train: 4.405520759389543 | Val: -313.3718489485762
3-th component log probs | Train: 3.6396518221597716 | Val: -329.0043612546188
4-th component log probs | Train: 4.697436114348488 | Val: -534.5756637612126
5-th component log probs | Train: 3.4302583990316386 | Val: -155.9171772187636
6-th component log probs | Train: 3.965769124000182 | Val: -262.406948914479
7-th component log probs | Train: 4.069205629911499 | Val: -426.7449095911809
8-th component log probs | Train: 4.92444956285704 | Val: -398.7444060877796
9-th component log probs | Train: 4.524147339502896 | Val: -374.7478135712616
KEYWORD NR_SAMPLES:400 DIM:100 AVG_DIFF:138643.0197
Fitting PCA...
0-th component log probs | Train: 5.241838921915207 | Val: -290.97224980719136
1-th component log probs | Train: 5.072994882955715 | Val: -310.69931603104675
2-th component log probs | Train: 4.919433059215013 | Val: -256.838020244337
3-th component log probs | Train: 4.368832027728159 | Val: -320.9952297643165
4-th component log probs | Train: 5.111721503992672 | Val: -425.1541480768428
5-th component log probs | Train: 4.226057170259184 | Val: -167.17524605128756
6-th component log probs | Train: 4.594582964716096 | Val: -243.2478248079627
7-th component log probs | Train: 4.677309785644719 | Val: -353.21079752442347
8-th component log probs | Train: 5.270937812783925 | Val: -312.5210143734779
9-th component log probs | Train: 4.9960547869584815 | Val: -300.8998857920935
KEYWORD NR_SAMPLES:400 DIM:150 AVG_DIFF:96041.4609
Fitting PCA...
0-th component log probs | Train: 5.424958345734765 | Val: -237.20120358953787
1-th component log probs | Train: 5.294718103795537 | Val: -258.7501005602869
2-th component log probs | Train: 5.181132255580129 | Val: -214.53058978338512
3-th component log probs | Train: 4.753314830955546 | Val: -273.1083235393402
4-th component log probs | Train: 5.324054610234684 | Val: -348.3651965654799
5-th component log probs | Train: 4.645716110709199 | Val: -154.14411934814427
6-th component log probs | Train: 4.924195972129377 | Val: -210.59100776092336
7-th component log probs | Train: 4.994094474203692 | Val: -295.04713224947596
8-th component log probs | Train: 5.447040628531024 | Val: -257.2282999248774
9-th component log probs | Train: 5.2387500525761554 | Val: -250.207508007211
KEYWORD NR_SAMPLES:400 DIM:200 AVG_DIFF:67510.0416
Fitting PCA...
0-th component log probs | Train: 5.535933986633765 | Val: -200.53549832979343
1-th component log probs | Train: 5.4300924291639445 | Val: -221.30941960980903
2-th component log probs | Train: 5.340299302661727 | Val: -183.2371983990841
3-th component log probs | Train: 4.990609385111516 | Val: -236.3086977577073
4-th component log probs | Train: 5.453620507045512 | Val: -293.03863740423344
5-th component log probs | Train: 4.9057314211917955 | Val: -136.56714334415437
6-th component log probs | Train: 5.127037338513283 | Val: -185.2961436617874
7-th component log probs | Train: 5.188731894588888 | Val: -251.6826815769883
8-th component log probs | Train: 5.55374574349273 | Val: -217.82312402688333
9-th component log probs | Train: 5.386533258327143 | Val: -213.50332123530418
KEYWORD NR_SAMPLES:400 DIM:250 AVG_DIFF:49682.9177
Fitting PCA...
0-th component log probs | Train: 5.610484327886368 | Val: -174.1850842135795
1-th component log probs | Train: 5.521589637996891 | Val: -192.6081729039171
2-th component log probs | Train: 5.447349442502292 | Val: -159.8489432804508
3-th component log probs | Train: 5.1526972636804675 | Val: -207.0763245070204
4-th component log probs | Train: 5.541173192732972 | Val: -253.55101100434797
5-th component log probs | Train: 5.082376311077816 | Val: -121.67142344826291
6-th component log probs | Train: 5.265213421527965 | Val: -163.70511608538402
7-th component log probs | Train: 5.32049253302127 | Val: -218.13638545317954
8-th component log probs | Train: 5.625555341741967 | Val: -188.5802372367323
9-th component log probs | Train: 5.486137280583698 | Val: -185.99786246569178
KEYWORD NR_SAMPLES:400 DIM:300 AVG_DIFF:38000.7118
Fitting PCA...
0-th component log probs | Train: 5.664118358405669 | Val: -153.9153349713684
1-th component log probs | Train: 5.587760994198361 | Val: -170.0861164396726
2-th component log probs | Train: 5.524326021365117 | Val: -141.70729802304024
3-th component log probs | Train: 5.269874938470681 | Val: -183.79620695061888
4-th component log probs | Train: 5.604232639976022 | Val: -223.12873798266716
5-th component log probs | Train: 5.210363481924524 | Val: -109.63605406324768
6-th component log probs | Train: 5.365512141026688 | Val: -146.34401366806358
7-th component log probs | Train: 5.415508910410802 | Val: -192.6898800596178
8-th component log probs | Train: 5.6771650626557175 | Val: -166.09207245355907
9-th component log probs | Train: 5.5577197417609785 | Val: -164.7949096069617
KEYWORD NR_SAMPLES:400 DIM:350 AVG_DIFF:30004.4734
0-th component log probs | Train: 7.381475962589396 | Val: -143.88132025623278
1-th component log probs | Train: 7.314633874127603 | Val: -160.33682489872922
2-th component log probs | Train: 7.259161577633882 | Val: -133.95842090374327
3-th component log probs | Train: 7.035881832271623 | Val: -172.8558048440978
4-th component log probs | Train: 7.3289197050537025 | Val: -205.88972782817555
5-th component log probs | Train: 6.984146220322839 | Val: -107.68398629413633
6-th component log probs | Train: 7.118954432454747 | Val: -138.20970431386246
7-th component log probs | Train: 7.163936088729769 | Val: -182.02596695136953
8-th component log probs | Train: 7.392916687860724 | Val: -155.13261889657042
9-th component log probs | Train: 7.288431601424184 | Val: -157.24191556211755
KEYWORD NR_SAMPLES:400 DIM:400 AVG_DIFF:27229.9865
best average differences at 400 dimensions: 27229.98652760979
2022-01-09 00:54.08 [info     ] Training complete              train_loss=1.7028802633285522
2022-01-09 00:54.08 [info     ] Starting evaluating            dataset=10000
2022-01-09 00:54.10 [info     ] Testing complete               test_loss=1.9851410388946533
{'dataset_size': 400,
 'end_test_accuracy': 0.32752788066864014,
 'end_test_loss': 1.9851410388946533,
 'end_train_accuracy': 0.6741071343421936,
 'end_train_loss': 1.7028802633285522,
 'end_val_accuracy': 0.3353901207447052,
 'end_val_loss': 2.106135129928589}
2022-01-09 00:54.10 [info     ] Start Predict                  dataset=39600
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 00:54.35 [info     ] Starting training              dataset=600 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
600
Fitting PCA...
0-th component log probs | Train: 2.1952778601882788 | Val: -21.786716090060214
1-th component log probs | Train: 2.301688444141618 | Val: -23.00347042104168
2-th component log probs | Train: 2.222851542740832 | Val: -71.69700302570669
3-th component log probs | Train: 1.7978758150370338 | Val: -1.1842416901902757
4-th component log probs | Train: 2.7880012076639447 | Val: -214.21462865354692
5-th component log probs | Train: 1.9102516901070818 | Val: -1.739842964041319
6-th component log probs | Train: 2.3641769708881544 | Val: -9.943948858261793
7-th component log probs | Train: 2.0512023132497217 | Val: -6.955056772279115
8-th component log probs | Train: 2.303297166191308 | Val: -12.415017380929262
9-th component log probs | Train: 2.0277166363148145 | Val: -3.76398698173015
KEYWORD NR_SAMPLES:600 DIM:50 AVG_DIFF:5427.4765
Fitting PCA...
0-th component log probs | Train: 3.835407271469541 | Val: -197.42729556521616
1-th component log probs | Train: 3.8770682560426937 | Val: -260.2949028149614
2-th component log probs | Train: 3.9543165648272804 | Val: -254.8085902886851
3-th component log probs | Train: 2.9075344922180784 | Val: -100.63521672270599
4-th component log probs | Train: 4.249905952564968 | Val: -338.36623812115545
5-th component log probs | Train: 3.14011131370705 | Val: -124.14740959641732
6-th component log probs | Train: 3.718138427458894 | Val: -144.6939314923256
7-th component log probs | Train: 3.4694068235011613 | Val: -215.76607933684562
8-th component log probs | Train: 3.855397180990756 | Val: -143.307259558982
9-th component log probs | Train: 3.5357502758102366 | Val: -155.72018292688472
KEYWORD NR_SAMPLES:600 DIM:100 AVG_DIFF:43867.0425
Fitting PCA...
0-th component log probs | Train: 4.514279218562013 | Val: -193.15068412625106
1-th component log probs | Train: 4.531732887072183 | Val: -248.0026576087813
2-th component log probs | Train: 4.605126190236538 | Val: -229.98552855956103
3-th component log probs | Train: 3.8263250001690636 | Val: -171.66486809152605
4-th component log probs | Train: 4.7980959254261935 | Val: -287.8981306584734
5-th component log probs | Train: 3.997302174309413 | Val: -162.49258224428826
6-th component log probs | Train: 4.406225031067221 | Val: -157.02830645676755
7-th component log probs | Train: 4.237785634607742 | Val: -226.9417458559439
8-th component log probs | Train: 4.520757759896895 | Val: -148.79642846476258
9-th component log probs | Train: 4.290981914710637 | Val: -170.00909564676917
KEYWORD NR_SAMPLES:600 DIM:150 AVG_DIFF:43545.6713
Fitting PCA...
0-th component log probs | Train: 4.867720722289378 | Val: -170.7383798807244
1-th component log probs | Train: 4.877951606543291 | Val: -219.56302914742346
2-th component log probs | Train: 4.940797781915026 | Val: -198.11894261232084
3-th component log probs | Train: 4.333378418932968 | Val: -167.96308406526325
4-th component log probs | Train: 5.0840957194400325 | Val: -242.50484223222097
5-th component log probs | Train: 4.4649737347458975 | Val: -154.84779173996608
6-th component log probs | Train: 4.77562016804435 | Val: -144.61103417663864
7-th component log probs | Train: 4.649178779865644 | Val: -206.19040857664208
8-th component log probs | Train: 4.869709988656528 | Val: -134.32257589590412
9-th component log probs | Train: 4.692677252939129 | Val: -156.26460688149143
KEYWORD NR_SAMPLES:600 DIM:200 AVG_DIFF:35086.2869
Fitting PCA...
0-th component log probs | Train: 5.0846808257681655 | Val: -150.11463714523862
1-th component log probs | Train: 5.0916662856784445 | Val: -192.9775570727436
2-th component log probs | Train: 5.145644789218446 | Val: -172.31168381059592
3-th component log probs | Train: 4.649010503484621 | Val: -155.72295343565906
4-th component log probs | Train: 5.25890853505897 | Val: -207.6174948764423
5-th component log probs | Train: 4.755736470495941 | Val: -142.73571272354397
6-th component log probs | Train: 5.004616010549308 | Val: -130.54439338288225
7-th component log probs | Train: 4.905181834252601 | Val: -183.89140746309735
8-th component log probs | Train: 5.084311182273625 | Val: -121.15746031943934
9-th component log probs | Train: 4.942243495363361 | Val: -141.43844134344516
KEYWORD NR_SAMPLES:600 DIM:250 AVG_DIFF:27898.0582
Fitting PCA...
0-th component log probs | Train: 5.231754419568067 | Val: -133.24180294593862
1-th component log probs | Train: 5.236494654169964 | Val: -171.80713910767872
2-th component log probs | Train: 5.283665306533867 | Val: -152.40278945885296
3-th component log probs | Train: 4.865072153454243 | Val: -142.13832600076285
4-th component log probs | Train: 5.376977386848503 | Val: -182.24889231185156
5-th component log probs | Train: 4.953163686383524 | Val: -129.85681505260857
6-th component log probs | Train: 5.16102388348252 | Val: -118.36349203613412
7-th component log probs | Train: 5.0799134091352895 | Val: -164.0930294631331
8-th component log probs | Train: 5.230343292726422 | Val: -109.15312749640806
9-th component log probs | Train: 5.111783578637306 | Val: -128.5257224243071
KEYWORD NR_SAMPLES:600 DIM:300 AVG_DIFF:22519.1941
Fitting PCA...
0-th component log probs | Train: 5.338064670402902 | Val: -119.81365356644481
1-th component log probs | Train: 5.341559873152018 | Val: -154.3987164631807
2-th component log probs | Train: 5.383168998784369 | Val: -136.33373909048967
3-th component log probs | Train: 5.021722751435719 | Val: -129.23766321422787
4-th component log probs | Train: 5.4623736167932195 | Val: -162.00305520959546
5-th component log probs | Train: 5.0970681737859165 | Val: -118.28482217447485
6-th component log probs | Train: 5.2751603253019965 | Val: -107.39766221129847
7-th component log probs | Train: 5.20669563968157 | Val: -147.67901442856595
8-th component log probs | Train: 5.335929200901643 | Val: -99.18767353960688
9-th component log probs | Train: 5.234652572031229 | Val: -116.76204269735359
KEYWORD NR_SAMPLES:600 DIM:350 AVG_DIFF:18443.4516
Fitting PCA...
0-th component log probs | Train: 5.41838893839633 | Val: -108.62151598239421
1-th component log probs | Train: 5.421285428301774 | Val: -140.10376768677918
2-th component log probs | Train: 5.458298335525847 | Val: -123.31954066405831
3-th component log probs | Train: 5.140718361800353 | Val: -118.05919638596228
4-th component log probs | Train: 5.527044783014146 | Val: -145.68072440299864
5-th component log probs | Train: 5.206531916118249 | Val: -108.07199102812547
6-th component log probs | Train: 5.362092503886267 | Val: -98.20466241219927
7-th component log probs | Train: 5.302871208560361 | Val: -133.82370410620842
8-th component log probs | Train: 5.416212258223782 | Val: -90.60925080280501
9-th component log probs | Train: 5.3276542239913205 | Val: -107.016821414316
KEYWORD NR_SAMPLES:600 DIM:400 AVG_DIFF:15356.4852
Fitting PCA...
0-th component log probs | Train: 5.48139701692783 | Val: -99.46971998927876
1-th component log probs | Train: 5.483906100187928 | Val: -128.38873896663193
2-th component log probs | Train: 5.517001646801281 | Val: -112.738066143814
3-th component log probs | Train: 5.234201740022308 | Val: -108.51244680069792
4-th component log probs | Train: 5.577809262738586 | Val: -132.3521241798883
5-th component log probs | Train: 5.2925156504869175 | Val: -99.52566675110566
6-th component log probs | Train: 5.430388298735538 | Val: -90.25012535347403
7-th component log probs | Train: 5.378370752489326 | Val: -122.55538980243523
8-th component log probs | Train: 5.479114945406812 | Val: -83.48809842405086
9-th component log probs | Train: 5.400564322268748 | Val: -98.8671950689741
KEYWORD NR_SAMPLES:600 DIM:450 AVG_DIFF:13017.9440
Fitting PCA...
0-th component log probs | Train: 5.532011871357839 | Val: -91.71583394142066
1-th component log probs | Train: 5.534265970033308 | Val: -118.47898700486587
2-th component log probs | Train: 5.564109114427207 | Val: -103.77526771372885
3-th component log probs | Train: 5.30941555958184 | Val: -100.46414527881198
4-th component log probs | Train: 5.618699381208356 | Val: -121.22636296773393
5-th component log probs | Train: 5.361866391258386 | Val: -92.19698099955032
6-th component log probs | Train: 5.485779488614226 | Val: -83.35619165564147
7-th component log probs | Train: 5.439197737677115 | Val: -112.97360490829129
8-th component log probs | Train: 5.529872321650445 | Val: -77.3925114208528
9-th component log probs | Train: 5.459240349046419 | Val: -91.92400110826165
KEYWORD NR_SAMPLES:600 DIM:500 AVG_DIFF:11186.1080
0-th component log probs | Train: 5.542710923289464 | Val: -90.04220860621125
1-th component log probs | Train: 5.544913289769124 | Val: -116.35145360331335
2-th component log probs | Train: 5.5740594244288 | Val: -101.85347098305948
3-th component log probs | Train: 5.325321931344121 | Val: -98.71895274837863
4-th component log probs | Train: 5.627360316442374 | Val: -118.84670554104108
5-th component log probs | Train: 5.376546068151705 | Val: -90.63151309073426
6-th component log probs | Train: 5.4975418208147016 | Val: -81.84324024546815
7-th component log probs | Train: 5.452067157301033 | Val: -110.92202393208869
8-th component log probs | Train: 5.540617051691568 | Val: -76.05004730267645
9-th component log probs | Train: 5.471642437792796 | Val: -90.42735886535998
KEYWORD NR_SAMPLES:600 DIM:512 AVG_DIFF:10809.7423
best average differences at 50 dimensions: 5427.476485897239
2022-01-09 00:56.59 [info     ] Training complete              train_loss=1.3581860065460205
2022-01-09 00:56.59 [info     ] Starting evaluating            dataset=10000
2022-01-09 00:57.01 [info     ] Testing complete               test_loss=1.8539694547653198
{'dataset_size': 600,
 'end_test_accuracy': 0.38077229261398315,
 'end_test_loss': 1.8539694547653198,
 'end_train_accuracy': 0.7906249761581421,
 'end_train_loss': 1.3581860065460205,
 'end_val_accuracy': 0.39132165908813477,
 'end_val_loss': 2.038332223892212}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 00:57.01 [info     ] Start Predict                  dataset=39400
2022-01-09 00:57.20 [info     ] Starting training              dataset=800 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
800
Fitting PCA...
0-th component log probs | Train: 2.033014815091825 | Val: -0.874364691837468
1-th component log probs | Train: 2.036631038252071 | Val: -3.2355624290305296
2-th component log probs | Train: 1.7933557131036442 | Val: -0.5330436315923093
3-th component log probs | Train: 1.6671143151306806 | Val: 0.27324117963785677
4-th component log probs | Train: 2.1173598420983297 | Val: -7.3986809541572995
5-th component log probs | Train: 1.7496474377787603 | Val: 0.4015216484616698
6-th component log probs | Train: 2.1108012115300068 | Val: -3.1855992636506834
7-th component log probs | Train: 1.9369301341364742 | Val: -2.9308221486397894
8-th component log probs | Train: 2.1276750448883663 | Val: -0.7925551651860697
9-th component log probs | Train: 2.051608418677299 | Val: -2.97598730108808
KEYWORD NR_SAMPLES:800 DIM:50 AVG_DIFF:22.1528
Fitting PCA...
0-th component log probs | Train: 2.9752453749446603 | Val: -27.207437728918617
1-th component log probs | Train: 3.3243991047094372 | Val: -119.88487075288074
2-th component log probs | Train: 3.2768603455979366 | Val: -119.97639805299514
3-th component log probs | Train: 2.704709212386131 | Val: -43.98458713991349
4-th component log probs | Train: 3.6927022842195485 | Val: -177.5446361915156
5-th component log probs | Train: 2.9026899595173847 | Val: -55.25565572692019
6-th component log probs | Train: 3.295171473677853 | Val: -90.05590746211739
7-th component log probs | Train: 3.2884315311390737 | Val: -156.13975366972284
8-th component log probs | Train: 3.025592684304952 | Val: -22.757949280979627
9-th component log probs | Train: 3.34464488691677 | Val: -121.27335690966632
KEYWORD NR_SAMPLES:800 DIM:100 AVG_DIFF:12001.8348
Fitting PCA...
0-th component log probs | Train: 3.768321624415013 | Val: -75.54275435029896
1-th component log probs | Train: 4.134755610861756 | Val: -155.2061013707574
2-th component log probs | Train: 4.117084749777361 | Val: -137.9988205735663
3-th component log probs | Train: 3.645639816452441 | Val: -121.60595413645592
4-th component log probs | Train: 4.413651076399871 | Val: -182.30412023253805
5-th component log probs | Train: 3.814503494647885 | Val: -98.59767288269171
6-th component log probs | Train: 4.0864122996678365 | Val: -129.7416197706248
7-th component log probs | Train: 4.114440218557549 | Val: -179.6202049986662
8-th component log probs | Train: 3.8189186212337396 | Val: -57.663668872466985
9-th component log probs | Train: 4.138657265169793 | Val: -148.8178074237225
KEYWORD NR_SAMPLES:800 DIM:150 AVG_DIFF:19176.0578
Fitting PCA...
0-th component log probs | Train: 4.259489856189476 | Val: -85.87090204201108
1-th component log probs | Train: 4.568492285597343 | Val: -146.7249131103008
2-th component log probs | Train: 4.564530908071229 | Val: -128.90990894982932
3-th component log probs | Train: 4.187833289915203 | Val: -131.31990229731426
4-th component log probs | Train: 4.7894197252394894 | Val: -165.60642139837663
5-th component log probs | Train: 4.32057277949505 | Val: -102.54670428869441
6-th component log probs | Train: 4.523292811392501 | Val: -129.31695588955682
7-th component log probs | Train: 4.555336979146881 | Val: -167.62842966395093
8-th component log probs | Train: 4.298241824833018 | Val: -67.1052462690606
9-th component log probs | Train: 4.56905871872948 | Val: -140.1094419315071
KEYWORD NR_SAMPLES:800 DIM:200 AVG_DIFF:18123.7100
Fitting PCA...
0-th component log probs | Train: 4.575995908367822 | Val: -84.80479649593094
1-th component log probs | Train: 4.8380264404075035 | Val: -135.2263749954752
2-th component log probs | Train: 4.839990256786986 | Val: -116.85105004704103
3-th component log probs | Train: 4.529329122855041 | Val: -124.73111210835248
4-th component log probs | Train: 5.0201841437190025 | Val: -148.48703027691556
5-th component log probs | Train: 4.63690771004193 | Val: -97.71500881358924
6-th component log probs | Train: 4.796330678997174 | Val: -119.76442246969391
7-th component log probs | Train: 4.829412145330553 | Val: -151.00685705191628
8-th component log probs | Train: 4.607331292714091 | Val: -67.29119223711137
9-th component log probs | Train: 4.83797507370429 | Val: -130.00125509594343
KEYWORD NR_SAMPLES:800 DIM:250 AVG_DIFF:15631.5653
Fitting PCA...
0-th component log probs | Train: 4.79392736022321 | Val: -80.62545100299012
1-th component log probs | Train: 5.022151564786648 | Val: -123.17308418265306
2-th component log probs | Train: 5.0262746969735845 | Val: -105.36792205728237
3-th component log probs | Train: 4.762801559968648 | Val: -115.90180765036465
4-th component log probs | Train: 5.176542987970329 | Val: -132.8930587983483
5-th component log probs | Train: 4.853341356599965 | Val: -91.41641867387807
6-th component log probs | Train: 4.984713619708847 | Val: -110.38308617952889
7-th component log probs | Train: 5.016211074849653 | Val: -136.2331216989487
8-th component log probs | Train: 4.819658066529305 | Val: -64.30932346813074
9-th component log probs | Train: 5.021754164056855 | Val: -118.70020686930285
KEYWORD NR_SAMPLES:800 DIM:300 AVG_DIFF:13215.5440
Fitting PCA...
0-th component log probs | Train: 4.954913158579527 | Val: -75.10302810880653
1-th component log probs | Train: 5.156026082469317 | Val: -112.76281136085116
2-th component log probs | Train: 5.16095672544096 | Val: -95.75959202363181
3-th component log probs | Train: 4.93295768923772 | Val: -106.78745348202612
4-th component log probs | Train: 5.289651882578305 | Val: -119.77406355068221
5-th component log probs | Train: 5.010826603879102 | Val: -84.90385753405164
6-th component log probs | Train: 5.121764921171724 | Val: -101.13908356946223
7-th component log probs | Train: 5.151530271925835 | Val: -123.59971381235543
8-th component log probs | Train: 4.976802001152837 | Val: -60.76594629317842
9-th component log probs | Train: 5.15536878571781 | Val: -108.69070017135755
KEYWORD NR_SAMPLES:800 DIM:350 AVG_DIFF:11185.7404
Fitting PCA...
0-th component log probs | Train: 5.078408302366298 | Val: -70.07277245497825
1-th component log probs | Train: 5.257758529795134 | Val: -103.30283253522974
2-th component log probs | Train: 5.262888405272162 | Val: -87.71134233093626
3-th component log probs | Train: 5.062411076264789 | Val: -98.5280015019656
4-th component log probs | Train: 5.375259576296049 | Val: -108.9735438445006
5-th component log probs | Train: 5.130551700960045 | Val: -78.75153357846816
6-th component log probs | Train: 5.226385946819454 | Val: -92.8255753752676
7-th component log probs | Train: 5.2541483292216355 | Val: -113.07034017328701
8-th component log probs | Train: 5.097533640177576 | Val: -57.149680328977816
9-th component log probs | Train: 5.257138150214028 | Val: -99.96442105797779
KEYWORD NR_SAMPLES:800 DIM:400 AVG_DIFF:9548.1300
Fitting PCA...
0-th component log probs | Train: 5.17608484008248 | Val: -65.504987612025
1-th component log probs | Train: 5.337690916840082 | Val: -95.3918612454196
2-th component log probs | Train: 5.342662606395363 | Val: -80.96066600860946
3-th component log probs | Train: 5.163980060946826 | Val: -91.26785966326247
4-th component log probs | Train: 5.44253133757227 | Val: -99.94001071123083
5-th component log probs | Train: 5.224591205532182 | Val: -73.37896573132198
6-th component log probs | Train: 5.308964928768306 | Val: -85.41719165469789
7-th component log probs | Train: 5.334807914202098 | Val: -103.90555603712386
8-th component log probs | Train: 5.193483539976545 | Val: -53.60337664870521
9-th component log probs | Train: 5.337240417965013 | Val: -92.43927223303956
KEYWORD NR_SAMPLES:800 DIM:450 AVG_DIFF:8235.5630
Fitting PCA...
0-th component log probs | Train: 5.255658398075971 | Val: -61.22847804572216
1-th component log probs | Train: 5.402295512284838 | Val: -88.43999840420699
2-th component log probs | Train: 5.406855507715313 | Val: -75.11499742949286
3-th component log probs | Train: 5.245874229879461 | Val: -84.91500389937323
4-th component log probs | Train: 5.496719027911767 | Val: -92.14504835747768
5-th component log probs | Train: 5.300480677684016 | Val: -68.56725618000898
6-th component log probs | Train: 5.375858237572556 | Val: -78.99205975361377
7-th component log probs | Train: 5.399749469821306 | Val: -96.15982272932702
8-th component log probs | Train: 5.271394844012637 | Val: -50.30058532050354
9-th component log probs | Train: 5.401870627751462 | Val: -85.91836876874078
KEYWORD NR_SAMPLES:800 DIM:500 AVG_DIFF:7168.9550
0-th component log probs | Train: 5.272629790771783 | Val: -60.25556569730425
1-th component log probs | Train: 5.415989865012825 | Val: -86.87579653510178
2-th component log probs | Train: 5.420445419176766 | Val: -73.8436546525279
3-th component log probs | Train: 5.263222862458394 | Val: -83.50554296275324
4-th component log probs | Train: 5.508207151349757 | Val: -90.47341701145479
5-th component log probs | Train: 5.316552951329859 | Val: -67.49325944620588
6-th component log probs | Train: 5.390087270906162 | Val: -77.63507110679178
7-th component log probs | Train: 5.413507569919236 | Val: -94.48912418274928
8-th component log probs | Train: 5.28803302140962 | Val: -49.53019820982819
9-th component log probs | Train: 5.415576757708403 | Val: -84.48305009249727
KEYWORD NR_SAMPLES:800 DIM:512 AVG_DIFF:6944.8665
best average differences at 50 dimensions: 22.152770484364574
2022-01-09 00:59.12 [info     ] Training complete              train_loss=1.6687308549880981
2022-01-09 00:59.12 [info     ] Starting evaluating            dataset=10000
2022-01-09 00:59.14 [info     ] Testing complete               test_loss=1.8061332702636719
{'dataset_size': 800,
 'end_test_accuracy': 0.36494824290275574,
 'end_test_loss': 1.8061332702636719,
 'end_train_accuracy': 0.6286057829856873,
 'end_train_loss': 1.6687308549880981,
 'end_val_accuracy': 0.40137341618537903,
 'end_val_loss': 1.8654240369796753}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 00:59.14 [info     ] Start Predict                  dataset=39200
2022-01-09 00:59.32 [info     ] Starting training              dataset=1000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
1000
Fitting PCA...
0-th component log probs | Train: 1.8364729571069607 | Val: 0.1626965681049522
1-th component log probs | Train: 1.8792436917470503 | Val: 0.16752219726496512
2-th component log probs | Train: 1.7889443930914706 | Val: -0.6000095677675198
3-th component log probs | Train: 1.743160201560421 | Val: -0.19048962039680267
4-th component log probs | Train: 2.0248222432715317 | Val: -4.483697864615016
5-th component log probs | Train: 1.8115214170311595 | Val: -0.024878428018514406
6-th component log probs | Train: 2.0422162623894122 | Val: -0.9917001506930074
7-th component log probs | Train: 2.0358092025926195 | Val: -3.229588982396669
8-th component log probs | Train: 2.0033659208615155 | Val: 0.5051457363952261
9-th component log probs | Train: 1.9426580048878037 | Val: -0.2310716138348411
KEYWORD NR_SAMPLES:1000 DIM:50 AVG_DIFF:10.4810
Fitting PCA...
0-th component log probs | Train: 2.603260626061171 | Val: -9.405349749182509
1-th component log probs | Train: 2.5746401980043747 | Val: -4.897771332873416
2-th component log probs | Train: 3.0085282386899768 | Val: -107.30011201592997
3-th component log probs | Train: 2.5351066773029 | Val: -19.81649918463143
4-th component log probs | Train: 3.345487133085412 | Val: -136.5547373881499
5-th component log probs | Train: 2.79523758020039 | Val: -41.22836651437803
6-th component log probs | Train: 2.8537196786490098 | Val: -18.24469039934855
7-th component log probs | Train: 3.151062504338107 | Val: -135.35127990949528
8-th component log probs | Train: 2.7423939604073473 | Val: -5.634973019003849
9-th component log probs | Train: 2.7026565669121303 | Val: -15.705541090922361
KEYWORD NR_SAMPLES:1000 DIM:100 AVG_DIFF:5441.4868
Fitting PCA...
0-th component log probs | Train: 3.3873368236093695 | Val: -60.063158930413245
1-th component log probs | Train: 3.3191892707229043 | Val: -45.944172765638626
2-th component log probs | Train: 3.9090712647060646 | Val: -145.69046472191383
3-th component log probs | Train: 3.458916641638224 | Val: -107.36392235616786
4-th component log probs | Train: 4.147820599499711 | Val: -163.94417109982007
5-th component log probs | Train: 3.7073528192955165 | Val: -100.68502290323153
6-th component log probs | Train: 3.6019258347361607 | Val: -59.30511015172114
7-th component log probs | Train: 3.981326371313558 | Val: -197.05960730859812
8-th component log probs | Train: 3.4675646574635883 | Val: -32.42075460528808
9-th component log probs | Train: 3.5472135340633892 | Val: -72.34450130792752
KEYWORD NR_SAMPLES:1000 DIM:150 AVG_DIFF:13168.9529
Fitting PCA...
0-th component log probs | Train: 3.9487614082535143 | Val: -78.00292387704108
1-th component log probs | Train: 3.895564338884054 | Val: -67.85913129387461
2-th component log probs | Train: 4.399492804896926 | Val: -142.11400362574358
3-th component log probs | Train: 4.033380901209481 | Val: -123.08762372793174
4-th component log probs | Train: 4.580172851867393 | Val: -152.19289370604076
5-th component log probs | Train: 4.230772462360253 | Val: -107.40250150690022
6-th component log probs | Train: 4.1118739663114034 | Val: -78.25434189681069
7-th component log probs | Train: 4.444827525406135 | Val: -185.760202712725
8-th component log probs | Train: 4.003002961899839 | Val: -47.687183995440996
9-th component log probs | Train: 4.090962136448657 | Val: -89.39050961180051
KEYWORD NR_SAMPLES:1000 DIM:200 AVG_DIFF:14090.3360
Fitting PCA...
0-th component log probs | Train: 4.319211235112226 | Val: -80.25556403953424
1-th component log probs | Train: 4.274304896885519 | Val: -72.4056665429932
2-th component log probs | Train: 4.7024759126329885 | Val: -131.35928105697968
3-th component log probs | Train: 4.398606221340379 | Val: -123.20689441546791
4-th component log probs | Train: 4.847577498540442 | Val: -137.4193817942533
5-th component log probs | Train: 4.560833934581553 | Val: -103.76054409586615
6-th component log probs | Train: 4.447579056540819 | Val: -80.22076789566515
7-th component log probs | Train: 4.734018549220849 | Val: -169.6408824579878
8-th component log probs | Train: 4.356029547628852 | Val: -51.96371261958906
9-th component log probs | Train: 4.4405525852238545 | Val: -89.69183010934903
KEYWORD NR_SAMPLES:1000 DIM:250 AVG_DIFF:12941.0239
Fitting PCA...
0-th component log probs | Train: 4.57628147223145 | Val: -77.43838273588722
1-th component log probs | Train: 4.538551914617631 | Val: -71.49345372803369
2-th component log probs | Train: 4.909165258404728 | Val: -120.15464706320405
3-th component log probs | Train: 4.650837428598458 | Val: -115.75661422747878
4-th component log probs | Train: 5.030353441882664 | Val: -124.97554218409917
5-th component log probs | Train: 4.787410552252026 | Val: -97.34494068251472
6-th component log probs | Train: 4.68249558012226 | Val: -78.66512946341874
7-th component log probs | Train: 4.93296726872845 | Val: -153.774409272527
8-th component log probs | Train: 4.604283474882061 | Val: -52.647726629738614
9-th component log probs | Train: 4.682091296542437 | Val: -86.16136141062033
KEYWORD NR_SAMPLES:1000 DIM:300 AVG_DIFF:11364.3916
Fitting PCA...
0-th component log probs | Train: 4.766116028603886 | Val: -73.04476398978382
1-th component log probs | Train: 4.733759393660426 | Val: -68.82202152651463
2-th component log probs | Train: 5.059134508463023 | Val: -110.08654370783763
3-th component log probs | Train: 4.83476753679728 | Val: -108.19008832960674
4-th component log probs | Train: 5.1623215157006905 | Val: -113.99868594079906
5-th component log probs | Train: 4.952445465305472 | Val: -90.91074797008197
6-th component log probs | Train: 4.855871397838236 | Val: -74.05870973638152
7-th component log probs | Train: 5.077984141986552 | Val: -140.4636461408008
8-th component log probs | Train: 4.7885228640409 | Val: -51.01729281453775
9-th component log probs | Train: 4.859880061231645 | Val: -81.25847431808302
KEYWORD NR_SAMPLES:1000 DIM:350 AVG_DIFF:9882.7766
Fitting PCA...
0-th component log probs | Train: 4.911785327245676 | Val: -68.5491146122703
1-th component log probs | Train: 4.883788146963538 | Val: -65.11027877306171
2-th component log probs | Train: 5.172872453163551 | Val: -101.41096447385208
3-th component log probs | Train: 4.974812362281688 | Val: -100.61002467800348
4-th component log probs | Train: 5.2626146276767365 | Val: -104.5950726057111
5-th component log probs | Train: 5.078395395800008 | Val: -84.69477330771157
6-th component log probs | Train: 4.989263845196124 | Val: -70.10843859157103
7-th component log probs | Train: 5.188302131748276 | Val: -128.62582869054978
8-th component log probs | Train: 4.930381778685349 | Val: -48.7968841589755
9-th component log probs | Train: 4.995597839950743 | Val: -76.09017964813783
KEYWORD NR_SAMPLES:1000 DIM:400 AVG_DIFF:8593.9288
Fitting PCA...
0-th component log probs | Train: 5.027165612124495 | Val: -64.32316747272486
1-th component log probs | Train: 5.002528204959689 | Val: -61.541766943448216
2-th component log probs | Train: 5.26210583301064 | Val: -93.60004146700912
3-th component log probs | Train: 5.085150134739392 | Val: -93.84756837592641
4-th component log probs | Train: 5.341531329951716 | Val: -96.42143951380467
5-th component log probs | Train: 5.17720305491878 | Val: -79.12301574594291
6-th component log probs | Train: 5.0954557740555195 | Val: -66.001288006596
7-th component log probs | Train: 5.275269057551567 | Val: -118.27096829317331
8-th component log probs | Train: 5.04320365538696 | Val: -46.481486522284165
9-th component log probs | Train: 5.102891226540276 | Val: -71.4483474672501
KEYWORD NR_SAMPLES:1000 DIM:450 AVG_DIFF:7509.4554
Fitting PCA...
0-th component log probs | Train: 5.1209352573814355 | Val: -60.48111653217841
1-th component log probs | Train: 5.099133050181221 | Val: -58.111352807343835
2-th component log probs | Train: 5.334077353093225 | Val: -86.72993662769645
3-th component log probs | Train: 5.174367412573944 | Val: -87.5451171310933
4-th component log probs | Train: 5.405282398588461 | Val: -89.34729555111818
5-th component log probs | Train: 5.257268664146599 | Val: -73.97658175170513
6-th component log probs | Train: 5.182019330559508 | Val: -62.05334844680231
7-th component log probs | Train: 5.345597743367591 | Val: -109.34612736217949
8-th component log probs | Train: 5.134997468896566 | Val: -44.094997760514815
9-th component log probs | Train: 5.189988989424238 | Val: -67.07600514282738
KEYWORD NR_SAMPLES:1000 DIM:500 AVG_DIFF:6594.8687
0-th component log probs | Train: 5.14097195014756 | Val: -59.53210287436129
1-th component log probs | Train: 5.119704723718025 | Val: -57.28504065484209
2-th component log probs | Train: 5.349312881156685 | Val: -85.20318902826646
3-th component log probs | Train: 5.193307073003061 | Val: -86.0707448880821
4-th component log probs | Train: 5.418821177228136 | Val: -87.77201849219323
5-th component log probs | Train: 5.274245790957522 | Val: -72.78416432320023
6-th component log probs | Train: 5.200523383963541 | Val: -61.14947772979479
7-th component log probs | Train: 5.3605283340497945 | Val: -107.38242955763425
8-th component log probs | Train: 5.1546331300204145 | Val: -43.509835666473464
9-th component log probs | Train: 5.208504409907927 | Val: -66.05268261863226
KEYWORD NR_SAMPLES:1000 DIM:512 AVG_DIFF:6394.3174
best average differences at 50 dimensions: 10.480964994628733
2022-01-09 01:02.47 [info     ] Training complete              train_loss=1.24357008934021
2022-01-09 01:02.47 [info     ] Starting evaluating            dataset=10000
2022-01-09 01:02.48 [info     ] Testing complete               test_loss=1.7243430614471436
{'dataset_size': 1000,
 'end_test_accuracy': 0.4325238764286041,
 'end_test_loss': 1.7243430614471436,
 'end_train_accuracy': 0.769335925579071,
 'end_train_loss': 1.24357008934021,
 'end_val_accuracy': 0.44735270738601685,
 'end_val_loss': 1.9595690965652466}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 01:02.49 [info     ] Start Predict                  dataset=39000
2022-01-09 01:03.07 [info     ] Starting training              dataset=2000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
2000
Fitting PCA...
0-th component log probs | Train: 1.7018873252560018 | Val: 1.1370882579217565
1-th component log probs | Train: 1.8258358692782586 | Val: 0.9465329080129945
2-th component log probs | Train: 1.5356235992180387 | Val: 1.067454213290282
3-th component log probs | Train: 1.5133695001575649 | Val: 1.1570933126293992
4-th component log probs | Train: 1.6708611692395685 | Val: 0.8511102812641582
5-th component log probs | Train: 1.5618204212672888 | Val: 1.2171380729404895
6-th component log probs | Train: 1.6993522184413663 | Val: 1.1278495145513676
7-th component log probs | Train: 1.694658656089227 | Val: 0.8007026088801299
8-th component log probs | Train: 1.8437091879871077 | Val: 1.3266104998866204
9-th component log probs | Train: 1.680943015911274 | Val: 1.1428234379139248
KEYWORD NR_SAMPLES:2000 DIM:50 AVG_DIFF:0.3912
Fitting PCA...
0-th component log probs | Train: 2.2343900284828995 | Val: 1.1133570677176858
1-th component log probs | Train: 2.3741035910630823 | Val: 0.4788742223121315
2-th component log probs | Train: 2.1017017597373777 | Val: 0.9298267815433635
3-th component log probs | Train: 2.0442313043276585 | Val: 1.2438941468764906
4-th component log probs | Train: 2.2240275112947447 | Val: 0.59952273336836
5-th component log probs | Train: 2.0924723015193742 | Val: 1.2755833227889108
6-th component log probs | Train: 2.252983096128107 | Val: 1.0560579272102864
7-th component log probs | Train: 2.2266206471014978 | Val: 0.7166612149013247
8-th component log probs | Train: 2.4219200071906815 | Val: 0.7350897114666288
9-th component log probs | Train: 2.1715329415730076 | Val: 1.2730279259710917
KEYWORD NR_SAMPLES:2000 DIM:100 AVG_DIFF:1.7534
Fitting PCA...
0-th component log probs | Train: 2.640073848501514 | Val: -0.42759993837856963
1-th component log probs | Train: 2.7852600322658168 | Val: -2.566156144361666
2-th component log probs | Train: 2.573503882875283 | Val: -3.812058563312489
3-th component log probs | Train: 2.4409298660846197 | Val: -0.2155366122000546
4-th component log probs | Train: 2.629494031624168 | Val: -1.3294178926008433
5-th component log probs | Train: 2.50797948742258 | Val: -0.6043577124901021
6-th component log probs | Train: 2.6431131860566004 | Val: -0.05911246899788212
7-th component log probs | Train: 2.594403016383222 | Val: -0.2945810890568429
8-th component log probs | Train: 2.897358479122142 | Val: -2.934735927628477
9-th component log probs | Train: 2.5135834221414237 | Val: 0.8095612396135147
KEYWORD NR_SAMPLES:2000 DIM:150 AVG_DIFF:16.3805
Fitting PCA...
0-th component log probs | Train: 3.055469196997999 | Val: -7.7641885217446625
1-th component log probs | Train: 3.235163243014142 | Val: -17.440604647961084
2-th component log probs | Train: 3.1555014388449565 | Val: -32.4360619859883
3-th component log probs | Train: 2.88880436049167 | Val: -11.63989908965298
4-th component log probs | Train: 3.033690963743878 | Val: -9.99843832758407
5-th component log probs | Train: 2.990661299555625 | Val: -14.494055288181052
6-th component log probs | Train: 3.0204142984486393 | Val: -5.216708192875342
7-th component log probs | Train: 2.9349863855621745 | Val: -3.937234593861154
8-th component log probs | Train: 3.40315976762927 | Val: -16.05187942278483
9-th component log probs | Train: 2.8346531513818443 | Val: -1.389482820723545
KEYWORD NR_SAMPLES:2000 DIM:200 AVG_DIFF:300.9366
Fitting PCA...
0-th component log probs | Train: 3.489130610738981 | Val: -22.355156463779448
1-th component log probs | Train: 3.671374809423317 | Val: -31.837964610022397
2-th component log probs | Train: 3.64267080006705 | Val: -49.890891127364796
3-th component log probs | Train: 3.3653493294605545 | Val: -32.343065768987444
4-th component log probs | Train: 3.461289521663675 | Val: -27.15164802564174
5-th component log probs | Train: 3.474207091041581 | Val: -31.410432178698322
6-th component log probs | Train: 3.4267204622704943 | Val: -16.25279166370977
7-th component log probs | Train: 3.2845466157451315 | Val: -13.38914933374472
8-th component log probs | Train: 3.824392299790535 | Val: -26.535459229113304
9-th component log probs | Train: 3.180921872555881 | Val: -9.21022818616759
KEYWORD NR_SAMPLES:2000 DIM:250 AVG_DIFF:996.4420
Fitting PCA...
0-th component log probs | Train: 3.841287525433137 | Val: -30.19914916061356
1-th component log probs | Train: 4.002047204078964 | Val: -39.015379910277
2-th component log probs | Train: 4.000132728190083 | Val: -56.630560496483234
3-th component log probs | Train: 3.7471357408969053 | Val: -42.307028389919424
4-th component log probs | Train: 3.8121830330998314 | Val: -37.041565692309945
5-th component log probs | Train: 3.842385492827912 | Val: -39.10827956217246
6-th component log probs | Train: 3.7756294459552744 | Val: -24.325471214953435
7-th component log probs | Train: 3.6164593269921146 | Val: -24.239660648916345
8-th component log probs | Train: 4.137033832398133 | Val: -31.392615107152732
9-th component log probs | Train: 3.5331126629441054 | Val: -18.547638436336328
KEYWORD NR_SAMPLES:2000 DIM:300 AVG_DIFF:1563.5657
Fitting PCA...
0-th component log probs | Train: 4.112265541102556 | Val: -33.57786349960979
1-th component log probs | Train: 4.253407395144769 | Val: -41.310084057870704
2-th component log probs | Train: 4.263516883437615 | Val: -58.31941722954262
3-th component log probs | Train: 4.03589508729116 | Val: -46.71593502933014
4-th component log probs | Train: 4.085488371524529 | Val: -41.55410098162605
5-th component log probs | Train: 4.121154105898772 | Val: -42.03757431480367
6-th component log probs | Train: 4.048478380566535 | Val: -28.644999101700535
7-th component log probs | Train: 3.895784756287711 | Val: -30.80508950709032
8-th component log probs | Train: 4.374456065755547 | Val: -33.7230887678329
9-th component log probs | Train: 3.825627043397705 | Val: -24.42111946117937
KEYWORD NR_SAMPLES:2000 DIM:350 AVG_DIFF:1872.4866
Fitting PCA...
0-th component log probs | Train: 4.324788399878916 | Val: -35.37314308722145
1-th component log probs | Train: 4.450982343412274 | Val: -42.213636986150014
2-th component log probs | Train: 4.467179587438717 | Val: -57.78900474948849
3-th component log probs | Train: 4.261399970841043 | Val: -48.139264282163886
4-th component log probs | Train: 4.300667567785724 | Val: -43.252391109540206
5-th component log probs | Train: 4.337940652870816 | Val: -43.161969387865334
6-th component log probs | Train: 4.2652938461078564 | Val: -30.544457060905945
7-th component log probs | Train: 4.122158529960794 | Val: -33.65877052266354
8-th component log probs | Train: 4.55833199988076 | Val: -34.39036238789706
9-th component log probs | Train: 4.064771547754181 | Val: -27.47984804248244
KEYWORD NR_SAMPLES:2000 DIM:400 AVG_DIFF:2004.3891
Fitting PCA...
0-th component log probs | Train: 4.4961544992048115 | Val: -35.50613817995445
1-th component log probs | Train: 4.608372479582007 | Val: -41.828916755374166
2-th component log probs | Train: 4.628405816965499 | Val: -55.91889206717461
3-th component log probs | Train: 4.4419892857612915 | Val: -47.82226278209731
4-th component log probs | Train: 4.474482648638894 | Val: -43.475053237730336
5-th component log probs | Train: 4.510513292019489 | Val: -43.015956695163844
6-th component log probs | Train: 4.439409273466471 | Val: -31.219454132705955
7-th component log probs | Train: 4.307945924480266 | Val: -34.908831965312075
8-th component log probs | Train: 4.706268551016871 | Val: -33.925895811717844
9-th component log probs | Train: 4.258119997777596 | Val: -29.110711530205034
KEYWORD NR_SAMPLES:2000 DIM:450 AVG_DIFF:2012.7489
Fitting PCA...
0-th component log probs | Train: 4.637058518686589 | Val: -34.85920666861188
1-th component log probs | Train: 4.7385841258135315 | Val: -40.61189860942401
2-th component log probs | Train: 4.7596099557301965 | Val: -53.844981020894835
3-th component log probs | Train: 4.58998713067828 | Val: -46.83748288897324
4-th component log probs | Train: 4.617132020988806 | Val: -42.837358856538096
5-th component log probs | Train: 4.652001940485082 | Val: -42.095271731636934
6-th component log probs | Train: 4.5842511432342885 | Val: -31.060239879805696
7-th component log probs | Train: 4.4628445121537315 | Val: -34.97619823640409
8-th component log probs | Train: 4.827201062173763 | Val: -33.18266350257195
9-th component log probs | Train: 4.41957648161542 | Val: -29.51428040446446
KEYWORD NR_SAMPLES:2000 DIM:500 AVG_DIFF:1955.5365
0-th component log probs | Train: 4.667293218404708 | Val: -34.67133747928865
1-th component log probs | Train: 4.766572318341871 | Val: -40.260142480569094
2-th component log probs | Train: 4.787606414014332 | Val: -53.26548546382756
3-th component log probs | Train: 4.621627580505866 | Val: -46.51777601766003
4-th component log probs | Train: 4.647736885483304 | Val: -42.521704258677005
5-th component log probs | Train: 4.682231581607525 | Val: -41.77382611910823
6-th component log probs | Train: 4.615299696195249 | Val: -30.96934788545385
7-th component log probs | Train: 4.496339786546902 | Val: -34.90057253770445
8-th component log probs | Train: 4.853038775915388 | Val: -32.993408133937564
9-th component log probs | Train: 4.454398669123681 | Val: -29.510671916613365
KEYWORD NR_SAMPLES:2000 DIM:512 AVG_DIFF:1934.7818
best average differences at 50 dimensions: 0.3911820907810204
2022-01-09 01:07.31 [info     ] Training complete              train_loss=1.256907343864441
2022-01-09 01:07.31 [info     ] Starting evaluating            dataset=10000
2022-01-09 01:07.33 [info     ] Testing complete               test_loss=1.347516655921936
{'dataset_size': 2000,
 'end_test_accuracy': 0.5400079488754272,
 'end_test_loss': 1.347516655921936,
 'end_train_accuracy': 0.7353515625,
 'end_train_loss': 1.256907343864441,
 'end_val_accuracy': 0.5420979261398315,
 'end_val_loss': 1.500794768333435}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 01:07.33 [info     ] Start Predict                  dataset=38000
2022-01-09 01:07.53 [info     ] Starting training              dataset=4000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
4000
Fitting PCA...
0-th component log probs | Train: 1.5548984907767274 | Val: 1.3801086740450081
1-th component log probs | Train: 1.6805040872547006 | Val: 1.426461611938062
2-th component log probs | Train: 1.4941470788193458 | Val: 1.3250565444808895
3-th component log probs | Train: 1.380943027668216 | Val: 1.2865977410197091
4-th component log probs | Train: 1.500788410561007 | Val: 1.1881595892167784
5-th component log probs | Train: 1.4693267936884105 | Val: 1.3602034519053396
6-th component log probs | Train: 1.5459965910689544 | Val: 1.382224681370141
7-th component log probs | Train: 1.5222097278073128 | Val: 1.223108488257088
8-th component log probs | Train: 1.6578517774039563 | Val: 1.4943420751891519
9-th component log probs | Train: 1.562621619409051 | Val: 1.4373765400969694
KEYWORD NR_SAMPLES:4000 DIM:50 AVG_DIFF:0.0401
Fitting PCA...
0-th component log probs | Train: 2.0496514938513632 | Val: 1.8046905347864752
1-th component log probs | Train: 2.1710981649141208 | Val: 1.8183596787662517
2-th component log probs | Train: 1.990321659897081 | Val: 1.7089211496559575
3-th component log probs | Train: 1.8379056519608261 | Val: 1.708208821388742
4-th component log probs | Train: 1.9931518410659768 | Val: 1.5245310841949569
5-th component log probs | Train: 1.9546572128755642 | Val: 1.7647093321148717
6-th component log probs | Train: 2.0486497467995743 | Val: 1.744882577302646
7-th component log probs | Train: 1.997363710556548 | Val: 1.6465211188390692
8-th component log probs | Train: 2.1676125755349624 | Val: 1.8429575466646955
9-th component log probs | Train: 2.031173398939175 | Val: 1.8613028572164272
KEYWORD NR_SAMPLES:4000 DIM:100 AVG_DIFF:0.0886
Fitting PCA...
0-th component log probs | Train: 2.3464517310144295 | Val: 1.9305471945856152
1-th component log probs | Train: 2.4471256178047622 | Val: 1.9194564103998801
2-th component log probs | Train: 2.3004775301470186 | Val: 1.7632551887779189
3-th component log probs | Train: 2.11810945550359 | Val: 1.8775142365663715
4-th component log probs | Train: 2.298878756332625 | Val: 1.5738943592003969
5-th component log probs | Train: 2.2463760924863854 | Val: 1.9004604190839864
6-th component log probs | Train: 2.350966230815305 | Val: 1.8202631858524734
7-th component log probs | Train: 2.284508588247201 | Val: 1.7713637860854219
8-th component log probs | Train: 2.4861682000088754 | Val: 1.883435292735456
9-th component log probs | Train: 2.298136100077498 | Val: 2.0261615092673084
KEYWORD NR_SAMPLES:4000 DIM:150 AVG_DIFF:0.2425
Fitting PCA...
0-th component log probs | Train: 2.5908847933844883 | Val: 1.903075963091722
1-th component log probs | Train: 2.670899598618687 | Val: 1.85792991986048
2-th component log probs | Train: 2.5570882726528614 | Val: 1.5997135376878304
3-th component log probs | Train: 2.340774223868814 | Val: 1.943821217135565
4-th component log probs | Train: 2.5501695505300783 | Val: 1.4486575750959172
5-th component log probs | Train: 2.491330595575939 | Val: 1.8376074364485344
6-th component log probs | Train: 2.6016188854321216 | Val: 1.7338497281281626
7-th component log probs | Train: 2.5206609278593284 | Val: 1.751645560075312
8-th component log probs | Train: 2.7513972706243353 | Val: 1.6611694868404643
9-th component log probs | Train: 2.518235501294221 | Val: 2.0799355023069905
KEYWORD NR_SAMPLES:4000 DIM:200 AVG_DIFF:0.6574
Fitting PCA...
0-th component log probs | Train: 2.8064734252695525 | Val: 1.7120040475282936
1-th component log probs | Train: 2.8731255892579863 | Val: 1.6434337404639983
2-th component log probs | Train: 2.7937604167002066 | Val: 0.9982764277879076
3-th component log probs | Train: 2.5483379324365103 | Val: 1.8873006157394836
4-th component log probs | Train: 2.779854722054621 | Val: 0.9509283485263476
5-th component log probs | Train: 2.714495269310916 | Val: 1.5691172580104675
6-th component log probs | Train: 2.832304315828076 | Val: 1.2550372420404938
7-th component log probs | Train: 2.7285009411469106 | Val: 1.590195193347348
8-th component log probs | Train: 2.9900656843884583 | Val: 1.1481977163571735
9-th component log probs | Train: 2.715302217016526 | Val: 2.054365075680183
KEYWORD NR_SAMPLES:4000 DIM:250 AVG_DIFF:1.8640
Fitting PCA...
0-th component log probs | Train: 3.0028038883635646 | Val: 1.2885439120377171
1-th component log probs | Train: 3.0614666436596325 | Val: 1.2999094016474084
2-th component log probs | Train: 3.029645220750856 | Val: -0.603710637807062
3-th component log probs | Train: 2.736147425856583 | Val: 1.6944197955449798
4-th component log probs | Train: 2.9997390735224103 | Val: -0.2632741045439247
5-th component log probs | Train: 2.9305507679731053 | Val: 0.8430357501510004
6-th component log probs | Train: 3.0562637459470925 | Val: 0.21174891277685062
7-th component log probs | Train: 2.919932357345392 | Val: 1.2252259299556847
8-th component log probs | Train: 3.2291381961932712 | Val: -0.3563047628988789
9-th component log probs | Train: 2.895594999022259 | Val: 1.9228293318008913
KEYWORD NR_SAMPLES:4000 DIM:300 AVG_DIFF:6.0098
Fitting PCA...
0-th component log probs | Train: 3.196760371023432 | Val: 0.3744106348079021
1-th component log probs | Train: 3.2435395897646804 | Val: 0.5328662694844477
2-th component log probs | Train: 3.281454427074292 | Val: -4.143678067614494
3-th component log probs | Train: 2.9169122557543568 | Val: 1.1901969094658376
4-th component log probs | Train: 3.2243395702103013 | Val: -2.922589621251897
5-th component log probs | Train: 3.152289445899178 | Val: -1.1129642528616202
6-th component log probs | Train: 3.2786912861113056 | Val: -2.118082421416192
7-th component log probs | Train: 3.0973051502587037 | Val: 0.49664354153255325
8-th component log probs | Train: 3.4668145561632704 | Val: -2.7505661124482397
9-th component log probs | Train: 3.0640403168807215 | Val: 1.622391764259889
KEYWORD NR_SAMPLES:4000 DIM:350 AVG_DIFF:20.6027
Fitting PCA...
0-th component log probs | Train: 3.390331846591339 | Val: -1.208922778838819
1-th component log probs | Train: 3.421095598791409 | Val: -0.6674391629414198
2-th component log probs | Train: 3.5276426048217804 | Val: -8.522706274930233
3-th component log probs | Train: 3.101396652423692 | Val: -0.07606176943212471
4-th component log probs | Train: 3.4519759215683954 | Val: -6.861126480829283
5-th component log probs | Train: 3.3858480715601544 | Val: -4.332633576383613
6-th component log probs | Train: 3.502207447815904 | Val: -5.216782216764036
7-th component log probs | Train: 3.2770910687947605 | Val: -0.9389649393659285
8-th component log probs | Train: 3.692053722959436 | Val: -5.389708081077321
9-th component log probs | Train: 3.229609179808696 | Val: 0.956585835103044
KEYWORD NR_SAMPLES:4000 DIM:400 AVG_DIFF:54.0552
Fitting PCA...
0-th component log probs | Train: 3.581772564335501 | Val: -3.208793638426107
1-th component log probs | Train: 3.5949348028031594 | Val: -2.3157574648282364
2-th component log probs | Train: 3.7499895988547736 | Val: -11.59593064339748
3-th component log probs | Train: 3.28888780314696 | Val: -2.146899145182104
4-th component log probs | Train: 3.6667928875715474 | Val: -10.851170293898782
5-th component log probs | Train: 3.6047521816311674 | Val: -7.5931942246860356
6-th component log probs | Train: 3.7124083664395857 | Val: -8.13122962491647
7-th component log probs | Train: 3.4569397823222694 | Val: -2.843729388130332
8-th component log probs | Train: 3.8947584770511967 | Val: -7.54116580212419
9-th component log probs | Train: 3.3918663239191327 | Val: -0.05245109230915206
KEYWORD NR_SAMPLES:4000 DIM:450 AVG_DIFF:100.4872
Fitting PCA...
0-th component log probs | Train: 3.7660584723769115 | Val: -5.038170746158961
1-th component log probs | Train: 3.7638415710046744 | Val: -3.9252488252808657
2-th component log probs | Train: 3.9430157248869957 | Val: -13.78504395432518
3-th component log probs | Train: 3.483877734303842 | Val: -4.8023974556371085
4-th component log probs | Train: 3.8604206382615947 | Val: -13.655761059758644
5-th component log probs | Train: 3.8030147734422943 | Val: -10.02769775637477
6-th component log probs | Train: 3.9003245490133223 | Val: -10.234275700832475
7-th component log probs | Train: 3.6351366331177717 | Val: -4.912606622663848
8-th component log probs | Train: 4.071137946699749 | Val: -9.003264166031574
9-th component log probs | Train: 3.558646380371971 | Val: -1.4373565143644609
KEYWORD NR_SAMPLES:4000 DIM:500 AVG_DIFF:148.6439
0-th component log probs | Train: 3.807433976962193 | Val: -5.419530460932211
1-th component log probs | Train: 3.802790209057921 | Val: -4.257569403081447
2-th component log probs | Train: 3.985641146038866 | Val: -14.161093783259966
3-th component log probs | Train: 3.5304437151982433 | Val: -5.396006717498186
4-th component log probs | Train: 3.9034241761105 | Val: -14.117491713697579
5-th component log probs | Train: 3.8472435955572517 | Val: -10.469962319005983
6-th component log probs | Train: 3.942389372051242 | Val: -10.684754299492687
7-th component log probs | Train: 3.677417117685327 | Val: -5.44075417205993
8-th component log probs | Train: 4.109655313218134 | Val: -9.291261150419666
9-th component log probs | Train: 3.5977280895541552 | Val: -1.7473127556619066
KEYWORD NR_SAMPLES:4000 DIM:512 AVG_DIFF:159.4076
best average differences at 50 dimensions: 0.04009309273878938
2022-01-09 01:15.24 [info     ] Training complete              train_loss=1.2204127311706543
2022-01-09 01:15.24 [info     ] Starting evaluating            dataset=10000
2022-01-09 01:15.26 [info     ] Testing complete               test_loss=1.0862983465194702
{'dataset_size': 4000,
 'end_test_accuracy': 0.6259952187538147,
 'end_test_loss': 1.0862983465194702,
 'end_train_accuracy': 0.7403273582458496,
 'end_train_loss': 1.2204127311706543,
 'end_val_accuracy': 0.6362460255622864,
 'end_val_loss': 1.138441562652588}
2022-01-09 01:15.26 [info     ] Start Predict                  dataset=36000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 01:15.47 [info     ] Starting training              dataset=6000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
6000
Fitting PCA...
0-th component log probs | Train: 1.4794356149708632 | Val: 1.4983932518241034
1-th component log probs | Train: 1.5787689104108298 | Val: 1.455272869376012
2-th component log probs | Train: 1.389186095206895 | Val: 1.3006856306324561
3-th component log probs | Train: 1.3488756789602958 | Val: 1.3347354540854748
4-th component log probs | Train: 1.4267041385554566 | Val: 1.319286347995426
5-th component log probs | Train: 1.4414217785298367 | Val: 1.4140721213725487
6-th component log probs | Train: 1.534625227249537 | Val: 1.4812072703743844
7-th component log probs | Train: 1.458487312823333 | Val: 1.3484576093329392
8-th component log probs | Train: 1.542377866698408 | Val: 1.4193946894124603
9-th component log probs | Train: 1.4717844198189678 | Val: 1.4085370427190214
KEYWORD NR_SAMPLES:6000 DIM:50 AVG_DIFF:0.0070
Fitting PCA...
0-th component log probs | Train: 1.9498413178744776 | Val: 1.9468704227232598
1-th component log probs | Train: 2.0534234844214088 | Val: 1.8956999450429255
2-th component log probs | Train: 1.8497306482343845 | Val: 1.7440174582660677
3-th component log probs | Train: 1.7916129043433024 | Val: 1.7818770337859555
4-th component log probs | Train: 1.879086871951321 | Val: 1.754213941996624
5-th component log probs | Train: 1.9083126111600464 | Val: 1.8578386817905497
6-th component log probs | Train: 1.9999479800502238 | Val: 1.8850099904150293
7-th component log probs | Train: 1.9119808932878066 | Val: 1.7866424672142942
8-th component log probs | Train: 2.0123434353879857 | Val: 1.8441399996861096
9-th component log probs | Train: 1.9165708890657462 | Val: 1.8600528267613397
KEYWORD NR_SAMPLES:6000 DIM:100 AVG_DIFF:0.0115
Fitting PCA...
0-th component log probs | Train: 2.2216193760375655 | Val: 2.1312200571730124
1-th component log probs | Train: 2.3197711057908954 | Val: 2.061371050271455
2-th component log probs | Train: 2.122927334283046 | Val: 1.9270097063812244
3-th component log probs | Train: 2.052115110810427 | Val: 1.9793945240095439
4-th component log probs | Train: 2.151302205395664 | Val: 1.9356113188620823
5-th component log probs | Train: 2.187462960577814 | Val: 2.0332842148099224
6-th component log probs | Train: 2.2803120037869298 | Val: 2.06020068391411
7-th component log probs | Train: 2.176751403809994 | Val: 1.9759692730723644
8-th component log probs | Train: 2.288096889265596 | Val: 1.9908372134164813
9-th component log probs | Train: 2.17559738367332 | Val: 2.0286530227898694
KEYWORD NR_SAMPLES:6000 DIM:150 AVG_DIFF:0.0388
Fitting PCA...
0-th component log probs | Train: 2.4345998926717822 | Val: 2.2469813491369557
1-th component log probs | Train: 2.5300823194931032 | Val: 2.1075861774043974
2-th component log probs | Train: 2.341951749529085 | Val: 2.011797229229083
3-th component log probs | Train: 2.2548277062509174 | Val: 2.1159182550596163
4-th component log probs | Train: 2.3642853458102993 | Val: 2.0285360778631225
5-th component log probs | Train: 2.4077698614775147 | Val: 2.1191584934052
6-th component log probs | Train: 2.5023319621348974 | Val: 2.1356013571794783
7-th component log probs | Train: 2.3888373079900322 | Val: 2.07006201721481
8-th component log probs | Train: 2.507132356546835 | Val: 2.035898946601632
9-th component log probs | Train: 2.3823674710101628 | Val: 2.126579873684905
KEYWORD NR_SAMPLES:6000 DIM:200 AVG_DIFF:0.1062
Fitting PCA...
0-th component log probs | Train: 2.6156697959606747 | Val: 2.320328275830386
1-th component log probs | Train: 2.715728095761276 | Val: 2.136105791429041
2-th component log probs | Train: 2.532103529624267 | Val: 2.042855757168958
3-th component log probs | Train: 2.4363024466109544 | Val: 2.207385931678493
4-th component log probs | Train: 2.5519580211659605 | Val: 2.0862531893411282
5-th component log probs | Train: 2.602221617663041 | Val: 2.1244651452187546
6-th component log probs | Train: 2.698032012884306 | Val: 2.119195592757474
7-th component log probs | Train: 2.572217118950988 | Val: 2.1317640133839273
8-th component log probs | Train: 2.7022285429027177 | Val: 1.9967988526008267
9-th component log probs | Train: 2.5645170151013668 | Val: 2.185987928426385
KEYWORD NR_SAMPLES:6000 DIM:250 AVG_DIFF:0.2330
Fitting PCA...
0-th component log probs | Train: 2.7795603663185737 | Val: 2.362318513277442
1-th component log probs | Train: 2.884609898600923 | Val: 2.1040930193593756
2-th component log probs | Train: 2.7027811250137677 | Val: 2.027486790547867
3-th component log probs | Train: 2.6024912022639666 | Val: 2.258349217074358
4-th component log probs | Train: 2.7175489301216547 | Val: 2.0944306598773896
5-th component log probs | Train: 2.779425983561397 | Val: 2.0695679004330274
6-th component log probs | Train: 2.8722117888517142 | Val: 2.050622371384412
7-th component log probs | Train: 2.7370054144836 | Val: 2.1411924368101714
8-th component log probs | Train: 2.8771445569747987 | Val: 1.8870572672195494
9-th component log probs | Train: 2.7297590828102676 | Val: 2.20476323792826
KEYWORD NR_SAMPLES:6000 DIM:300 AVG_DIFF:0.4536
Fitting PCA...
0-th component log probs | Train: 2.92677409989485 | Val: 2.3626134479609124
1-th component log probs | Train: 3.039626026928465 | Val: 1.990044540761037
2-th component log probs | Train: 2.8599881281489177 | Val: 1.914162480762693
3-th component log probs | Train: 2.7525601897685164 | Val: 2.2614004251812942
4-th component log probs | Train: 2.8669674126782168 | Val: 2.024445888446127
5-th component log probs | Train: 2.9446362501237746 | Val: 1.8899092022129533
6-th component log probs | Train: 3.0345343043948367 | Val: 1.8466213108030172
7-th component log probs | Train: 2.8866847367366795 | Val: 2.1019086572588592
8-th component log probs | Train: 3.036204480227642 | Val: 1.6691382249650093
9-th component log probs | Train: 2.879279521023201 | Val: 2.174140374733744
KEYWORD NR_SAMPLES:6000 DIM:350 AVG_DIFF:0.8771
Fitting PCA...
0-th component log probs | Train: 3.0607180006407595 | Val: 2.313546154696911
1-th component log probs | Train: 3.181997578723217 | Val: 1.7847572162578695
2-th component log probs | Train: 3.0064344364134583 | Val: 1.678990217082771
3-th component log probs | Train: 2.890604582466485 | Val: 2.202882052180334
4-th component log probs | Train: 3.004913996098405 | Val: 1.8775099911037683
5-th component log probs | Train: 3.101192218825196 | Val: 1.5074330244639167
6-th component log probs | Train: 3.18759097332972 | Val: 1.4968400969817506
7-th component log probs | Train: 3.0234846792704437 | Val: 1.992306736065405
8-th component log probs | Train: 3.1903235559713874 | Val: 1.2551548883876633
9-th component log probs | Train: 3.0167561790525426 | Val: 2.0833811827049193
KEYWORD NR_SAMPLES:6000 DIM:400 AVG_DIFF:1.7095
Fitting PCA...
0-th component log probs | Train: 3.1867304339108213 | Val: 2.191149990124074
1-th component log probs | Train: 3.3156225789564817 | Val: 1.43419156997716
2-th component log probs | Train: 3.145902964811679 | Val: 1.2322353390771899
3-th component log probs | Train: 3.018908355669033 | Val: 2.0708034270276547
4-th component log probs | Train: 3.1339018592687515 | Val: 1.6024310975564628
5-th component log probs | Train: 3.2549575376534343 | Val: 0.8018508986354957
6-th component log probs | Train: 3.335447577744175 | Val: 0.8807747144938967
7-th component log probs | Train: 3.1499184171584194 | Val: 1.796095297966936
8-th component log probs | Train: 3.334635075658623 | Val: 0.6507328433013134
9-th component log probs | Train: 3.1436346037714364 | Val: 1.9025052636155155
KEYWORD NR_SAMPLES:6000 DIM:450 AVG_DIFF:3.4057
Fitting PCA...
0-th component log probs | Train: 3.3105198874627115 | Val: 2.001613831332163
1-th component log probs | Train: 3.448847825429717 | Val: 0.9276393695145269
2-th component log probs | Train: 3.2908240826802033 | Val: 0.4755944198846696
3-th component log probs | Train: 3.148195776013291 | Val: 1.8228866965753296
4-th component log probs | Train: 3.2653906627317295 | Val: 1.170640234023336
5-th component log probs | Train: 3.413655398367325 | Val: -0.21306218006861696
6-th component log probs | Train: 3.486124034632977 | Val: 0.05454257905281904
7-th component log probs | Train: 3.277639551107506 | Val: 1.4625151174177302
8-th component log probs | Train: 3.4802782676738753 | Val: -0.21532988287361468
9-th component log probs | Train: 3.270349122404524 | Val: 1.5848775372806203
KEYWORD NR_SAMPLES:6000 DIM:500 AVG_DIFF:6.6862
0-th component log probs | Train: 3.340599086204805 | Val: 1.952240551607433
1-th component log probs | Train: 3.481528930945598 | Val: 0.7920284708043958
2-th component log probs | Train: 3.326195013427443 | Val: 0.2587920276102328
3-th component log probs | Train: 3.1805689836066824 | Val: 1.7327992624590005
4-th component log probs | Train: 3.29752725543841 | Val: 1.0366449884676798
5-th component log probs | Train: 3.451503687675976 | Val: -0.48232170891799886
6-th component log probs | Train: 3.5227042730764615 | Val: -0.17234521097257316
7-th component log probs | Train: 3.3080961862936595 | Val: 1.370563875206741
8-th component log probs | Train: 3.517297186337989 | Val: -0.4583774803339465
9-th component log probs | Train: 3.3021832974592478 | Val: 1.4872737133927472
KEYWORD NR_SAMPLES:6000 DIM:512 AVG_DIFF:7.7760
best average differences at 50 dimensions: 0.007001463418342402
2022-01-09 01:26.27 [info     ] Training complete              train_loss=1.1155060529708862
2022-01-09 01:26.27 [info     ] Starting evaluating            dataset=10000
2022-01-09 01:26.29 [info     ] Testing complete               test_loss=0.950701892375946
{'dataset_size': 6000,
 'end_test_accuracy': 0.6818272471427917,
 'end_test_loss': 0.950701892375946,
 'end_train_accuracy': 0.7631316781044006,
 'end_train_loss': 1.1155060529708862,
 'end_val_accuracy': 0.6889928579330444,
 'end_val_loss': 0.9764143824577332}
2022-01-09 01:26.29 [info     ] Start Predict                  dataset=34000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 01:26.50 [info     ] Starting training              dataset=8000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
8000
Fitting PCA...
0-th component log probs | Train: 1.3775638758456779 | Val: 1.3772902969534229
1-th component log probs | Train: 1.5805951612257092 | Val: 1.5947815947395863
2-th component log probs | Train: 1.3430194495086616 | Val: 1.3088870026718158
3-th component log probs | Train: 1.313786076793192 | Val: 1.3203724063675368
4-th component log probs | Train: 1.413001909364531 | Val: 1.3911687755204
5-th component log probs | Train: 1.4063837335932667 | Val: 1.4107445129572407
6-th component log probs | Train: 1.4825691272693342 | Val: 1.4868848565078518
7-th component log probs | Train: 1.4401789971177854 | Val: 1.3877844913913064
8-th component log probs | Train: 1.482623732950083 | Val: 1.420958589915052
9-th component log probs | Train: 1.4210150032484123 | Val: 1.4478422581521493
KEYWORD NR_SAMPLES:8000 DIM:50 AVG_DIFF:0.0009
Fitting PCA...
0-th component log probs | Train: 1.8224735910609797 | Val: 1.8512054483974123
1-th component log probs | Train: 2.061211843913421 | Val: 2.0392331308133667
2-th component log probs | Train: 1.7885483452964912 | Val: 1.7525072003760167
3-th component log probs | Train: 1.7484327596218086 | Val: 1.7643238773821934
4-th component log probs | Train: 1.8568779478184179 | Val: 1.8372532079430033
5-th component log probs | Train: 1.8538137566266932 | Val: 1.851219745634318
6-th component log probs | Train: 1.9457734608577275 | Val: 1.929595037578456
7-th component log probs | Train: 1.8886186957898812 | Val: 1.835264888898016
8-th component log probs | Train: 1.9471369106733356 | Val: 1.9114095137716505
9-th component log probs | Train: 1.8830756873596235 | Val: 1.9087936239320356
KEYWORD NR_SAMPLES:8000 DIM:100 AVG_DIFF:0.0008
Fitting PCA...
0-th component log probs | Train: 2.0802943737755726 | Val: 2.0705705978099265
1-th component log probs | Train: 2.3185313526147784 | Val: 2.2163022267352104
2-th component log probs | Train: 2.0431849012858594 | Val: 1.9546851142349606
3-th component log probs | Train: 1.9926302895549948 | Val: 1.972537403071488
4-th component log probs | Train: 2.115912546736006 | Val: 2.0423039909044003
5-th component log probs | Train: 2.106692242448794 | Val: 2.0392899825516424
6-th component log probs | Train: 2.2123453403863143 | Val: 2.126955934183987
7-th component log probs | Train: 2.1403378450016373 | Val: 2.027280086294353
8-th component log probs | Train: 2.2026949125350397 | Val: 2.1171436901204035
9-th component log probs | Train: 2.1341697571686105 | Val: 2.1287233684476425
KEYWORD NR_SAMPLES:8000 DIM:150 AVG_DIFF:0.0056
Fitting PCA...
0-th component log probs | Train: 2.2804074331156867 | Val: 2.23009427638899
1-th component log probs | Train: 2.5125832329259583 | Val: 2.3051193131545613
2-th component log probs | Train: 2.2427285108357333 | Val: 2.092398638000539
3-th component log probs | Train: 2.186938375130989 | Val: 2.112275579452595
4-th component log probs | Train: 2.3179578129097784 | Val: 2.1811476746933423
5-th component log probs | Train: 2.3072305958913057 | Val: 2.1572731346959753
6-th component log probs | Train: 2.4152646281459194 | Val: 2.2511854893767653
7-th component log probs | Train: 2.33685151779523 | Val: 2.1611513792786745
8-th component log probs | Train: 2.396607049378722 | Val: 2.2432674710721314
9-th component log probs | Train: 2.3240686646595496 | Val: 2.2699762378410093
KEYWORD NR_SAMPLES:8000 DIM:200 AVG_DIFF:0.0199
Fitting PCA...
0-th component log probs | Train: 2.4507052687073454 | Val: 2.351086122363119
1-th component log probs | Train: 2.681524492631536 | Val: 2.3610836852526584
2-th component log probs | Train: 2.4182866595306556 | Val: 2.1960056398170598
3-th component log probs | Train: 2.3554504960981237 | Val: 2.228062780037099
4-th component log probs | Train: 2.4906301398290793 | Val: 2.28731713360813
5-th component log probs | Train: 2.4822251448250876 | Val: 2.239365306702954
6-th component log probs | Train: 2.5946337011919516 | Val: 2.3204337361520886
7-th component log probs | Train: 2.506893986818384 | Val: 2.2627980354642574
8-th component log probs | Train: 2.5668450642029774 | Val: 2.339136161946938
9-th component log probs | Train: 2.492395593935324 | Val: 2.376865371679126
KEYWORD NR_SAMPLES:8000 DIM:250 AVG_DIFF:0.0479
Fitting PCA...
0-th component log probs | Train: 2.6020276015027903 | Val: 2.446467806996123
1-th component log probs | Train: 2.8365836130456885 | Val: 2.380176614697297
2-th component log probs | Train: 2.575423898999033 | Val: 2.2570471879588956
3-th component log probs | Train: 2.5072637613737725 | Val: 2.3225443382915136
4-th component log probs | Train: 2.64357438553049 | Val: 2.362380599127187
5-th component log probs | Train: 2.6400635017758334 | Val: 2.2960021521082523
6-th component log probs | Train: 2.757288793762007 | Val: 2.342635922919317
7-th component log probs | Train: 2.6568055680447293 | Val: 2.3484712695402035
8-th component log probs | Train: 2.7210040910621616 | Val: 2.4123412073388417
9-th component log probs | Train: 2.6414286117417602 | Val: 2.4682889615257917
KEYWORD NR_SAMPLES:8000 DIM:300 AVG_DIFF:0.0958
Fitting PCA...
0-th component log probs | Train: 2.738737129578637 | Val: 2.5213223850081623
1-th component log probs | Train: 2.9792023811635056 | Val: 2.3822289891881825
2-th component log probs | Train: 2.7164081332195593 | Val: 2.295709210960417
3-th component log probs | Train: 2.6436877937049497 | Val: 2.390491516893118
4-th component log probs | Train: 2.7807181104310703 | Val: 2.408972485767008
5-th component log probs | Train: 2.7853777322307676 | Val: 2.307298807122449
6-th component log probs | Train: 2.902242720095296 | Val: 2.3339646234107514
7-th component log probs | Train: 2.792522234705613 | Val: 2.4037140778075425
8-th component log probs | Train: 2.859041198373719 | Val: 2.448826964020422
9-th component log probs | Train: 2.776638579994332 | Val: 2.53058992735394
KEYWORD NR_SAMPLES:8000 DIM:350 AVG_DIFF:0.1714
Fitting PCA...
0-th component log probs | Train: 2.860389863325401 | Val: 2.5703551181408417
1-th component log probs | Train: 3.1117067893307073 | Val: 2.3432483636286703
2-th component log probs | Train: 2.8448085368794374 | Val: 2.301365107955608
3-th component log probs | Train: 2.767932910861634 | Val: 2.4306482886268883
4-th component log probs | Train: 2.9045486241375964 | Val: 2.430286152543444
5-th component log probs | Train: 2.9191488828214824 | Val: 2.2684838476689277
6-th component log probs | Train: 3.0363364271827282 | Val: 2.269831622048071
7-th component log probs | Train: 2.9158140925997484 | Val: 2.429286832977426
8-th component log probs | Train: 2.9856377279407003 | Val: 2.4532000097428357
9-th component log probs | Train: 2.9001303084027708 | Val: 2.5630087254773932
KEYWORD NR_SAMPLES:8000 DIM:400 AVG_DIFF:0.2953
Fitting PCA...
0-th component log probs | Train: 2.9695102148020682 | Val: 2.5959753622662523
1-th component log probs | Train: 3.233593990000214 | Val: 2.2382354529995716
2-th component log probs | Train: 2.961993622979067 | Val: 2.2616049535443308
3-th component log probs | Train: 2.880118650880446 | Val: 2.4467350891616846
4-th component log probs | Train: 3.0173537388090597 | Val: 2.4167435340627983
5-th component log probs | Train: 3.0421819901403135 | Val: 2.1670049012777106
6-th component log probs | Train: 3.1603679787372925 | Val: 2.129491805791336
7-th component log probs | Train: 3.0283093165169674 | Val: 2.4187429839411974
8-th component log probs | Train: 3.0979832880349982 | Val: 2.430278674542091
9-th component log probs | Train: 3.0110706159999165 | Val: 2.5695201167431256
KEYWORD NR_SAMPLES:8000 DIM:450 AVG_DIFF:0.5010
Fitting PCA...
0-th component log probs | Train: 3.0745669384943803 | Val: 2.5953777476889557
1-th component log probs | Train: 3.3501504753408367 | Val: 2.0897662440754483
2-th component log probs | Train: 3.075200484902116 | Val: 2.1689539097124104
3-th component log probs | Train: 2.9902233616704086 | Val: 2.428598802514433
4-th component log probs | Train: 3.1267911624361977 | Val: 2.3678912160047463
5-th component log probs | Train: 3.165415172373198 | Val: 1.9669114999293145
6-th component log probs | Train: 3.281301251459146 | Val: 1.9050727897252713
7-th component log probs | Train: 3.1371249013584457 | Val: 2.365088905979199
8-th component log probs | Train: 3.2073392145385307 | Val: 2.3568640778586105
9-th component log probs | Train: 3.117132473862232 | Val: 2.543201286450926
KEYWORD NR_SAMPLES:8000 DIM:500 AVG_DIFF:0.8510
0-th component log probs | Train: 3.0994485563885745 | Val: 2.5910384033719676
1-th component log probs | Train: 3.3780010960638163 | Val: 2.0420163730427165
2-th component log probs | Train: 3.1029330454489426 | Val: 2.136714789918683
3-th component log probs | Train: 3.017219877970116 | Val: 2.423808462412053
4-th component log probs | Train: 3.1535204047368155 | Val: 2.351890007024664
5-th component log probs | Train: 3.196537551602005 | Val: 1.9033644638099223
6-th component log probs | Train: 3.311035005914514 | Val: 1.8378692281750773
7-th component log probs | Train: 3.1636358950448593 | Val: 2.352404133342096
8-th component log probs | Train: 3.2335692787798855 | Val: 2.3372666741547454
9-th component log probs | Train: 3.1424818087296837 | Val: 2.5282651651224786
KEYWORD NR_SAMPLES:8000 DIM:512 AVG_DIFF:0.9653
best average differences at 100 dimensions: 0.0008298163755165778
2022-01-09 01:42.37 [info     ] Training complete              train_loss=1.0983275175094604
2022-01-09 01:42.37 [info     ] Starting evaluating            dataset=10000
2022-01-09 01:42.38 [info     ] Testing complete               test_loss=0.8432900905609131
{'dataset_size': 8000,
 'end_test_accuracy': 0.7235270738601685,
 'end_test_loss': 0.8432900905609131,
 'end_train_accuracy': 0.7636250257492065,
 'end_train_loss': 1.0983275175094604,
 'end_val_accuracy': 0.71875,
 'end_val_loss': 0.8667669892311096}
2022-01-09 01:42.39 [info     ] Start Predict                  dataset=32000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 01:43.03 [info     ] Starting training              dataset=10000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
10000
Fitting PCA...
0-th component log probs | Train: 1.3487003372699893 | Val: 1.3939564957019797
1-th component log probs | Train: 1.5128402747850715 | Val: 1.4935867786777473
2-th component log probs | Train: 1.303491387289846 | Val: 1.3427043450500853
3-th component log probs | Train: 1.307154707618384 | Val: 1.2971857432678613
4-th component log probs | Train: 1.3608620271289893 | Val: 1.3663009086736655
5-th component log probs | Train: 1.374562568771412 | Val: 1.4023248005392195
6-th component log probs | Train: 1.4494024839303241 | Val: 1.462248490842198
7-th component log probs | Train: 1.400153175266208 | Val: 1.4069017752714463
8-th component log probs | Train: 1.5085224316127144 | Val: 1.639644454791062
9-th component log probs | Train: 1.4193950321650792 | Val: 1.4350407327409374
KEYWORD NR_SAMPLES:10000 DIM:50 AVG_DIFF:0.0023
Fitting PCA...
0-th component log probs | Train: 1.8005217553683333 | Val: 1.8585851147480812
1-th component log probs | Train: 1.9790352846210104 | Val: 1.9598602591504652
2-th component log probs | Train: 1.7514428362875387 | Val: 1.7952339728437512
3-th component log probs | Train: 1.726168487283835 | Val: 1.7336716511425168
4-th component log probs | Train: 1.812029094112686 | Val: 1.8242807202728395
5-th component log probs | Train: 1.8162400901256857 | Val: 1.8300221641061634
6-th component log probs | Train: 1.907058054016997 | Val: 1.9040995925153494
7-th component log probs | Train: 1.8437872623725204 | Val: 1.852714513895837
8-th component log probs | Train: 1.9656275745348875 | Val: 2.076102214865297
9-th component log probs | Train: 1.865517741265787 | Val: 1.8907468915922498
KEYWORD NR_SAMPLES:10000 DIM:100 AVG_DIFF:0.0019
Fitting PCA...
0-th component log probs | Train: 2.050307152544225 | Val: 2.089762236047159
1-th component log probs | Train: 2.2277382116541546 | Val: 2.162562073297155
2-th component log probs | Train: 1.9987436656189792 | Val: 2.0199880759637607
3-th component log probs | Train: 1.9618950143649474 | Val: 1.9515381975616641
4-th component log probs | Train: 2.063067879904252 | Val: 2.045974718245812
5-th component log probs | Train: 2.059489533126353 | Val: 2.037699540171455
6-th component log probs | Train: 2.1601420530722946 | Val: 2.1144330320230247
7-th component log probs | Train: 2.0904576875823935 | Val: 2.065749153644571
8-th component log probs | Train: 2.211528413769803 | Val: 2.2856778868722545
9-th component log probs | Train: 2.1053159131418355 | Val: 2.1057027512263047
KEYWORD NR_SAMPLES:10000 DIM:150 AVG_DIFF:0.0015
Fitting PCA...
0-th component log probs | Train: 2.241724614229293 | Val: 2.246103477059639
1-th component log probs | Train: 2.4129066368038297 | Val: 2.2962734784698466
2-th component log probs | Train: 2.190293993071738 | Val: 2.176599435785565
3-th component log probs | Train: 2.1401696682176463 | Val: 2.1026859973668635
4-th component log probs | Train: 2.253839112541237 | Val: 2.194351117656743
5-th component log probs | Train: 2.246249754868027 | Val: 2.1778159308902154
6-th component log probs | Train: 2.358588648263035 | Val: 2.2556826990502006
7-th component log probs | Train: 2.2757962998887624 | Val: 2.2087129549870057
8-th component log probs | Train: 2.4002257694445626 | Val: 2.4244790025977783
9-th component log probs | Train: 2.2874846795021657 | Val: 2.24808729445659
KEYWORD NR_SAMPLES:10000 DIM:200 AVG_DIFF:0.0041
Fitting PCA...
0-th component log probs | Train: 2.407133622276137 | Val: 2.374555089272797
1-th component log probs | Train: 2.5763666504251534 | Val: 2.399801426359481
2-th component log probs | Train: 2.354615804391859 | Val: 2.3020246892994134
3-th component log probs | Train: 2.2972732016327666 | Val: 2.23128708298318
4-th component log probs | Train: 2.418485184059249 | Val: 2.3141145650540125
5-th component log probs | Train: 2.409195543382904 | Val: 2.2894863394898914
6-th component log probs | Train: 2.528638140877161 | Val: 2.3619272971062553
7-th component log probs | Train: 2.4364225710632907 | Val: 2.322782780139179
8-th component log probs | Train: 2.563696167549645 | Val: 2.535846828244243
9-th component log probs | Train: 2.44727030170295 | Val: 2.3676182358581985
KEYWORD NR_SAMPLES:10000 DIM:250 AVG_DIFF:0.0112
Fitting PCA...
0-th component log probs | Train: 2.5541106670173437 | Val: 2.4775163216287557
1-th component log probs | Train: 2.724253367449016 | Val: 2.4753972951178826
2-th component log probs | Train: 2.503209766001497 | Val: 2.406268333915465
3-th component log probs | Train: 2.4416429518764606 | Val: 2.335624245638007
4-th component log probs | Train: 2.5678107408342363 | Val: 2.41105491862432
5-th component log probs | Train: 2.559449456377591 | Val: 2.380542547982055
6-th component log probs | Train: 2.682358865241983 | Val: 2.4333717926179568
7-th component log probs | Train: 2.5811910472132107 | Val: 2.424029820292347
8-th component log probs | Train: 2.7117733057631175 | Val: 2.6258004864602524
9-th component log probs | Train: 2.5899968970623846 | Val: 2.4617835387024005
KEYWORD NR_SAMPLES:10000 DIM:300 AVG_DIFF:0.0256
Fitting PCA...
0-th component log probs | Train: 2.6866993200791773 | Val: 2.5668721076402696
1-th component log probs | Train: 2.8573002614527185 | Val: 2.5337546569817566
2-th component log probs | Train: 2.6364456080500775 | Val: 2.490276706259412
3-th component log probs | Train: 2.5713172558197734 | Val: 2.4253039335946363
4-th component log probs | Train: 2.701300872224345 | Val: 2.4905447589507084
5-th component log probs | Train: 2.6942893568738318 | Val: 2.4423396059683626
6-th component log probs | Train: 2.820132071744063 | Val: 2.4783122795383825
7-th component log probs | Train: 2.71252578499913 | Val: 2.503996478303447
8-th component log probs | Train: 2.846478508763237 | Val: 2.6986623373673426
9-th component log probs | Train: 2.7207901306019417 | Val: 2.5443955115934336
KEYWORD NR_SAMPLES:10000 DIM:350 AVG_DIFF:0.0483
Fitting PCA...
0-th component log probs | Train: 2.8042036239246753 | Val: 2.641327972874089
1-th component log probs | Train: 2.9785605570542018 | Val: 2.5621985394070834
2-th component log probs | Train: 2.75583123258668 | Val: 2.5539731176407994
3-th component log probs | Train: 2.6886445022624677 | Val: 2.502046711870696
4-th component log probs | Train: 2.8215915970914422 | Val: 2.546655286261429
5-th component log probs | Train: 2.8168222212611855 | Val: 2.483564087167208
6-th component log probs | Train: 2.9440688366071477 | Val: 2.5015850011959713
7-th component log probs | Train: 2.829907974131003 | Val: 2.5663767973227736
8-th component log probs | Train: 2.969443681915778 | Val: 2.745672100999156
9-th component log probs | Train: 2.8391268237676313 | Val: 2.6082370364764813
KEYWORD NR_SAMPLES:10000 DIM:400 AVG_DIFF:0.0831
Fitting PCA...
0-th component log probs | Train: 2.9102082168764505 | Val: 2.695465361348765
1-th component log probs | Train: 3.087175021743048 | Val: 2.5682827587950983
2-th component log probs | Train: 2.863050795713134 | Val: 2.601447610609381
3-th component log probs | Train: 2.7945559522847665 | Val: 2.557915971979654
4-th component log probs | Train: 2.9293214853719274 | Val: 2.5770172406246075
5-th component log probs | Train: 2.9279787266897017 | Val: 2.502175189784275
6-th component log probs | Train: 3.05732390127643 | Val: 2.4871721524501864
7-th component log probs | Train: 2.935471987509869 | Val: 2.607788981689135
8-th component log probs | Train: 3.080045412141838 | Val: 2.768694364538511
9-th component log probs | Train: 2.944740396074954 | Val: 2.650265602616907
KEYWORD NR_SAMPLES:10000 DIM:450 AVG_DIFF:0.1361
Fitting PCA...
0-th component log probs | Train: 3.0110126515006383 | Val: 2.7361824935118335
1-th component log probs | Train: 3.1916314136212467 | Val: 2.545819746867566
2-th component log probs | Train: 2.967008862456435 | Val: 2.6249363046961482
3-th component log probs | Train: 2.8942510289201837 | Val: 2.5984663321576544
4-th component log probs | Train: 3.0322215636419982 | Val: 2.590010744060782
5-th component log probs | Train: 3.034827652865468 | Val: 2.4975906495651623
6-th component log probs | Train: 3.1653025933579624 | Val: 2.439102750537999
7-th component log probs | Train: 3.0358974266815775 | Val: 2.630959185314589
8-th component log probs | Train: 3.186613215322535 | Val: 2.774516692976374
9-th component log probs | Train: 3.0442075548580982 | Val: 2.67468473754915
KEYWORD NR_SAMPLES:10000 DIM:500 AVG_DIFF:0.2179
0-th component log probs | Train: 3.0349233719871465 | Val: 2.744776202724507
1-th component log probs | Train: 3.217037100394654 | Val: 2.536669737716515
2-th component log probs | Train: 2.991836544362432 | Val: 2.6278251117138955
3-th component log probs | Train: 2.9185705190367774 | Val: 2.6070896535139183
4-th component log probs | Train: 3.0574854305620662 | Val: 2.5900338056191137
5-th component log probs | Train: 3.0613630558419063 | Val: 2.492763103281763
6-th component log probs | Train: 3.1912793720300265 | Val: 2.4268579952745046
7-th component log probs | Train: 3.0604648229735103 | Val: 2.6358503263467594
8-th component log probs | Train: 3.2121085922488612 | Val: 2.772083745360713
9-th component log probs | Train: 3.068063647268413 | Val: 2.676460016831891
KEYWORD NR_SAMPLES:10000 DIM:512 AVG_DIFF:0.2430
best average differences at 150 dimensions: 0.001532832147871851
2022-01-09 02:03.25 [info     ] Training complete              train_loss=1.1235699653625488
2022-01-09 02:03.25 [info     ] Starting evaluating            dataset=10000
2022-01-09 02:03.27 [info     ] Testing complete               test_loss=0.7349526882171631
{'dataset_size': 10000,
 'end_test_accuracy': 0.7506966590881348,
 'end_test_loss': 0.7349526882171631,
 'end_train_accuracy': 0.7449243664741516,
 'end_train_loss': 1.1235699653625488,
 'end_val_accuracy': 0.7490047812461853,
 'end_val_loss': 0.747791051864624}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 02:03.27 [info     ] Start Predict                  dataset=30000
2022-01-09 02:04.01 [info     ] Starting training              dataset=20000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
20000
Fitting PCA...
0-th component log probs | Train: 1.3842567091011 | Val: 1.35894785510219
1-th component log probs | Train: 1.5140423007977257 | Val: 1.5617460406121155
2-th component log probs | Train: 1.3169535787412712 | Val: 1.3350986560965847
3-th component log probs | Train: 1.3018427244172224 | Val: 1.2847607536387384
4-th component log probs | Train: 1.3539150711271422 | Val: 1.3879813544373696
5-th component log probs | Train: 1.3712894798846518 | Val: 1.3753844501428507
6-th component log probs | Train: 1.4211711025551923 | Val: 1.454979976899197
7-th component log probs | Train: 1.3947943457582326 | Val: 1.4516411745998357
8-th component log probs | Train: 1.5216936182674767 | Val: 1.6776169870665016
9-th component log probs | Train: 1.4270810006795487 | Val: 1.4763207750410603
KEYWORD NR_SAMPLES:20000 DIM:50 AVG_DIFF:0.0036
Fitting PCA...
0-th component log probs | Train: 1.8540634551057988 | Val: 1.8610007823755599
1-th component log probs | Train: 1.999035253146654 | Val: 2.0540215235931867
2-th component log probs | Train: 1.7951191946635083 | Val: 1.8358637437696537
3-th component log probs | Train: 1.764756127655313 | Val: 1.7621377273454135
4-th component log probs | Train: 1.8283418197173615 | Val: 1.8746850100232464
5-th component log probs | Train: 1.8448309732862147 | Val: 1.866874068675436
6-th component log probs | Train: 1.900357907591631 | Val: 1.941179880202594
7-th component log probs | Train: 1.870643524171931 | Val: 1.9370100665196621
8-th component log probs | Train: 2.0067987633535807 | Val: 2.1520130213076065
9-th component log probs | Train: 1.9102787300632287 | Val: 1.9835996082399794
KEYWORD NR_SAMPLES:20000 DIM:100 AVG_DIFF:0.0040
Fitting PCA...
0-th component log probs | Train: 2.106292309552804 | Val: 2.113045321037053
1-th component log probs | Train: 2.235747656803645 | Val: 2.274788965473892
2-th component log probs | Train: 2.0451364301264117 | Val: 2.080915975677527
3-th component log probs | Train: 1.9995038004245482 | Val: 1.9937393676401345
4-th component log probs | Train: 2.0792027757702565 | Val: 2.1182681600302202
5-th component log probs | Train: 2.0861075111838243 | Val: 2.103908736702077
6-th component log probs | Train: 2.153916445161016 | Val: 2.1853992017667796
7-th component log probs | Train: 2.112584454955913 | Val: 2.1713002256916716
8-th component log probs | Train: 2.249875461499559 | Val: 2.3714338502886676
9-th component log probs | Train: 2.146516783728278 | Val: 2.213626177548427
KEYWORD NR_SAMPLES:20000 DIM:150 AVG_DIFF:0.0028
Fitting PCA...
0-th component log probs | Train: 2.290382718965359 | Val: 2.2824726786199054
1-th component log probs | Train: 2.406203223993017 | Val: 2.4232890710226505
2-th component log probs | Train: 2.227449189175569 | Val: 2.2450468561012764
3-th component log probs | Train: 2.171336738444305 | Val: 2.1508474301260287
4-th component log probs | Train: 2.262699028935414 | Val: 2.285566298448506
5-th component log probs | Train: 2.2612224047492018 | Val: 2.262062756480661
6-th component log probs | Train: 2.339833485479692 | Val: 2.3519729254764306
7-th component log probs | Train: 2.2870122618464 | Val: 2.329907702834403
8-th component log probs | Train: 2.429052382540294 | Val: 2.5301159209572885
9-th component log probs | Train: 2.3185027326682253 | Val: 2.3688967826853973
KEYWORD NR_SAMPLES:20000 DIM:200 AVG_DIFF:0.0016
Fitting PCA...
0-th component log probs | Train: 2.441321926942557 | Val: 2.423130577482136
1-th component log probs | Train: 2.5520766754490687 | Val: 2.54667289140397
2-th component log probs | Train: 2.3796016641339306 | Val: 2.383939974182896
3-th component log probs | Train: 2.316349555464734 | Val: 2.2870921596553564
4-th component log probs | Train: 2.4147433340254505 | Val: 2.425674607190654
5-th component log probs | Train: 2.407141691158091 | Val: 2.3957451860403443
6-th component log probs | Train: 2.496133117689409 | Val: 2.4898042552639774
7-th component log probs | Train: 2.4334885814605225 | Val: 2.463400901774035
8-th component log probs | Train: 2.580049633308639 | Val: 2.658838475698301
9-th component log probs | Train: 2.4625086293432177 | Val: 2.4953100039482243
KEYWORD NR_SAMPLES:20000 DIM:250 AVG_DIFF:0.0010
Fitting PCA...
0-th component log probs | Train: 2.5763653763311627 | Val: 2.54101775658475
1-th component log probs | Train: 2.6841049826937895 | Val: 2.6533056311528043
2-th component log probs | Train: 2.513297045232987 | Val: 2.5011175344689325
3-th component log probs | Train: 2.444532983492569 | Val: 2.402850869147061
4-th component log probs | Train: 2.550846388758325 | Val: 2.5435923398526166
5-th component log probs | Train: 2.5371687522545345 | Val: 2.5080521212033196
6-th component log probs | Train: 2.6318292105173167 | Val: 2.5999944904815804
7-th component log probs | Train: 2.565540828692666 | Val: 2.576020588180166
8-th component log probs | Train: 2.7153255326417303 | Val: 2.764198137374846
9-th component log probs | Train: 2.5926739626521043 | Val: 2.599079293356174
KEYWORD NR_SAMPLES:20000 DIM:300 AVG_DIFF:0.0009
Fitting PCA...
0-th component log probs | Train: 2.6964550618235865 | Val: 2.6423498273143147
1-th component log probs | Train: 2.805198854305681 | Val: 2.7469319067904676
2-th component log probs | Train: 2.6336920608514975 | Val: 2.603247525700145
3-th component log probs | Train: 2.5628084677704437 | Val: 2.5082102255987824
4-th component log probs | Train: 2.6713426568835144 | Val: 2.644587139581055
5-th component log probs | Train: 2.656338285437132 | Val: 2.6081819922814233
6-th component log probs | Train: 2.755458817562659 | Val: 2.694476692486614
7-th component log probs | Train: 2.6852931568245073 | Val: 2.6757392154122606
8-th component log probs | Train: 2.837719335359024 | Val: 2.8607851030125926
9-th component log probs | Train: 2.712665257361921 | Val: 2.6921622454400453
KEYWORD NR_SAMPLES:20000 DIM:350 AVG_DIFF:0.0018
Fitting PCA...
0-th component log probs | Train: 2.8047838107094765 | Val: 2.7330242459658263
1-th component log probs | Train: 2.9152574760359715 | Val: 2.827371995608622
2-th component log probs | Train: 2.7437869668172232 | Val: 2.6955716637325726
3-th component log probs | Train: 2.6714747017172416 | Val: 2.605165219615684
4-th component log probs | Train: 2.781828932081213 | Val: 2.734560293512333
5-th component log probs | Train: 2.7653986756443754 | Val: 2.6988588827875786
6-th component log probs | Train: 2.8652137842172114 | Val: 2.7762268402755645
7-th component log probs | Train: 2.7942240914272287 | Val: 2.7653179322335397
8-th component log probs | Train: 2.9503637019230493 | Val: 2.9461776360931142
9-th component log probs | Train: 2.821823300834488 | Val: 2.7778159662164272
KEYWORD NR_SAMPLES:20000 DIM:400 AVG_DIFF:0.0037
Fitting PCA...
0-th component log probs | Train: 2.902661805669234 | Val: 2.8118210720204697
1-th component log probs | Train: 3.0151055546425756 | Val: 2.897137616673397
2-th component log probs | Train: 2.8421584213081488 | Val: 2.7755979969869795
3-th component log probs | Train: 2.768669977696347 | Val: 2.690963788222762
4-th component log probs | Train: 2.8803762566595608 | Val: 2.81193615197701
5-th component log probs | Train: 2.863432672239957 | Val: 2.7778472498320883
6-th component log probs | Train: 2.9635921829176857 | Val: 2.846144187925594
7-th component log probs | Train: 2.892396490321982 | Val: 2.842005003956953
8-th component log probs | Train: 3.0516147858367693 | Val: 3.0181841727993657
9-th component log probs | Train: 2.9208983178064254 | Val: 2.850599148348863
KEYWORD NR_SAMPLES:20000 DIM:450 AVG_DIFF:0.0067
Fitting PCA...
0-th component log probs | Train: 2.995961385876784 | Val: 2.8828885632746215
1-th component log probs | Train: 3.109200497966656 | Val: 2.9575873110229827
2-th component log probs | Train: 2.9359006401856633 | Val: 2.8494493337861364
3-th component log probs | Train: 2.862606980807944 | Val: 2.769347715769139
4-th component log probs | Train: 2.9732703853639424 | Val: 2.882894688682065
5-th component log probs | Train: 2.9579507319299645 | Val: 2.8520927588486376
6-th component log probs | Train: 3.0568002692749205 | Val: 2.907366887187433
7-th component log probs | Train: 2.984746637050626 | Val: 2.9133792155294445
8-th component log probs | Train: 3.147727192271884 | Val: 3.082579487050592
9-th component log probs | Train: 3.014301712423886 | Val: 2.9186133864443913
KEYWORD NR_SAMPLES:20000 DIM:500 AVG_DIFF:0.0112
0-th component log probs | Train: 3.0188796132990197 | Val: 2.9002212041857938
1-th component log probs | Train: 3.131456162500695 | Val: 2.9716959608630447
2-th component log probs | Train: 2.959006170906263 | Val: 2.8678426041694536
3-th component log probs | Train: 2.8854905246457605 | Val: 2.7882316047740203
4-th component log probs | Train: 2.9961664691806877 | Val: 2.8994911928024876
5-th component log probs | Train: 2.9806976771552143 | Val: 2.869605283918744
6-th component log probs | Train: 3.0794950821718783 | Val: 2.922300852636153
7-th component log probs | Train: 3.00685027479548 | Val: 2.929300483779126
8-th component log probs | Train: 3.1711887835185513 | Val: 3.0984758238465977
9-th component log probs | Train: 3.036677774175005 | Val: 2.933921455539833
KEYWORD NR_SAMPLES:20000 DIM:512 AVG_DIFF:0.0126
best average differences at 300 dimensions: 0.0008537027358642305
2022-01-09 02:42.16 [info     ] Training complete              train_loss=0.9760728478431702
2022-01-09 02:42.16 [info     ] Starting evaluating            dataset=10000
2022-01-09 02:42.17 [info     ] Testing complete               test_loss=0.5632520318031311
{'dataset_size': 20000,
 'end_test_accuracy': 0.8141918778419495,
 'end_test_loss': 0.5632520318031311,
 'end_train_accuracy': 0.7807508111000061,
 'end_train_loss': 0.9760728478431702,
 'end_val_accuracy': 0.8200637102127075,
 'end_val_loss': 0.5235471129417419}
2022-01-09 02:42.18 [info     ] Start Predict                  dataset=20000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 02:42.55 [info     ] Starting training              dataset=30000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
30000
Fitting PCA...
0-th component log probs | Train: 1.4989733022554588 | Val: 1.5045461852881423
1-th component log probs | Train: 1.5671371740988835 | Val: 1.5764485929725465
2-th component log probs | Train: 1.3585574993543819 | Val: 1.3560729031119634
3-th component log probs | Train: 1.3361543839959713 | Val: 1.307046695774969
4-th component log probs | Train: 1.4507326828577571 | Val: 1.4610909603248878
5-th component log probs | Train: 1.3950391989729454 | Val: 1.3725706990754527
6-th component log probs | Train: 1.4716412646597452 | Val: 1.4950260575453738
7-th component log probs | Train: 1.462194744770423 | Val: 1.4612022839586443
8-th component log probs | Train: 1.48818150521018 | Val: 1.5621171643538676
9-th component log probs | Train: 1.4858669892935172 | Val: 1.4942006235234913
KEYWORD NR_SAMPLES:30000 DIM:50 AVG_DIFF:0.0008
Fitting PCA...
0-th component log probs | Train: 2.0105212797627905 | Val: 2.009168063039926
1-th component log probs | Train: 2.1022761932837857 | Val: 2.105768071467625
2-th component log probs | Train: 1.8733250564952173 | Val: 1.8692901618677513
3-th component log probs | Train: 1.8250367313117715 | Val: 1.8018151874431843
4-th component log probs | Train: 1.9759427276621158 | Val: 1.984421812892294
5-th component log probs | Train: 1.898218805460793 | Val: 1.8735464465091818
6-th component log probs | Train: 2.001557776466636 | Val: 2.0241404833971113
7-th component log probs | Train: 1.985286028195707 | Val: 1.981617047622029
8-th component log probs | Train: 2.011317718589204 | Val: 2.0897914003532474
9-th component log probs | Train: 2.0122040401736148 | Val: 2.0214206622349993
KEYWORD NR_SAMPLES:30000 DIM:100 AVG_DIFF:0.0008
Fitting PCA...
0-th component log probs | Train: 2.2687489694389744 | Val: 2.257296342401797
1-th component log probs | Train: 2.358461098686768 | Val: 2.3484721424241153
2-th component log probs | Train: 2.138453221262476 | Val: 2.128568033661637
3-th component log probs | Train: 2.0758142826399877 | Val: 2.050912047531712
4-th component log probs | Train: 2.2425671201498436 | Val: 2.234333112420797
5-th component log probs | Train: 2.152367589038872 | Val: 2.127507757791694
6-th component log probs | Train: 2.267473376902098 | Val: 2.275155324216697
7-th component log probs | Train: 2.2433068991491933 | Val: 2.2314474578799413
8-th component log probs | Train: 2.2721312099731037 | Val: 2.3411140033610303
9-th component log probs | Train: 2.2648935990825287 | Val: 2.269136147481995
KEYWORD NR_SAMPLES:30000 DIM:150 AVG_DIFF:0.0007
Fitting PCA...
0-th component log probs | Train: 2.4529525777581833 | Val: 2.42995161281084
1-th component log probs | Train: 2.533257557671867 | Val: 2.498567551280328
2-th component log probs | Train: 2.3275390077107807 | Val: 2.313329519123353
3-th component log probs | Train: 2.2563545705100427 | Val: 2.225871016629167
4-th component log probs | Train: 2.430105257646529 | Val: 2.414136928574383
5-th component log probs | Train: 2.333708109685939 | Val: 2.3019271487747144
6-th component log probs | Train: 2.4548824996414984 | Val: 2.448846839259111
7-th component log probs | Train: 2.423741676857453 | Val: 2.4023620626242415
8-th component log probs | Train: 2.4551600922040433 | Val: 2.507686556043923
9-th component log probs | Train: 2.436121256083809 | Val: 2.43117390532697
KEYWORD NR_SAMPLES:30000 DIM:200 AVG_DIFF:0.0007
Fitting PCA...
0-th component log probs | Train: 2.6011224913146034 | Val: 2.5707103470284913
1-th component log probs | Train: 2.6748999682778063 | Val: 2.630894733632558
2-th component log probs | Train: 2.4788669559103673 | Val: 2.4519074157879976
3-th component log probs | Train: 2.401422675787791 | Val: 2.3661592181034035
4-th component log probs | Train: 2.580548053149861 | Val: 2.5529573316460565
5-th component log probs | Train: 2.4786103928650696 | Val: 2.4380187401515143
6-th component log probs | Train: 2.604189745099996 | Val: 2.5848415370570197
7-th component log probs | Train: 2.5663442277164905 | Val: 2.5355216762926025
8-th component log probs | Train: 2.602384745607029 | Val: 2.643878981844368
9-th component log probs | Train: 2.574993364115521 | Val: 2.5608049608040537
KEYWORD NR_SAMPLES:30000 DIM:250 AVG_DIFF:0.0010
Fitting PCA...
0-th component log probs | Train: 2.7308192653493277 | Val: 2.6888988365058695
1-th component log probs | Train: 2.8000821875509887 | Val: 2.7384123515839756
2-th component log probs | Train: 2.6098967229048085 | Val: 2.5753061389763916
3-th component log probs | Train: 2.531011800227939 | Val: 2.488301263794468
4-th component log probs | Train: 2.711326386844764 | Val: 2.6715979663916407
5-th component log probs | Train: 2.6072450312635134 | Val: 2.5562451472492085
6-th component log probs | Train: 2.7368492066898416 | Val: 2.7014133173808914
7-th component log probs | Train: 2.6933129322291745 | Val: 2.653306241122782
8-th component log probs | Train: 2.7321164141804157 | Val: 2.7590931020944853
9-th component log probs | Train: 2.6983826328327627 | Val: 2.670447521199866
KEYWORD NR_SAMPLES:30000 DIM:300 AVG_DIFF:0.0017
Fitting PCA...
0-th component log probs | Train: 2.8469288877228762 | Val: 2.794545359178846
1-th component log probs | Train: 2.9133119528326934 | Val: 2.833501527790001
2-th component log probs | Train: 2.7268101562469216 | Val: 2.680805489209005
3-th component log probs | Train: 2.646923207144535 | Val: 2.5971851742273597
4-th component log probs | Train: 2.828917826362686 | Val: 2.7768643157890294
5-th component log probs | Train: 2.723370486428663 | Val: 2.6618316121052525
6-th component log probs | Train: 2.853929623385639 | Val: 2.8020759221620644
7-th component log probs | Train: 2.8083051859346364 | Val: 2.7547113489873545
8-th component log probs | Train: 2.8479458919700296 | Val: 2.858121551961337
9-th component log probs | Train: 2.8103070981026197 | Val: 2.767827681315741
KEYWORD NR_SAMPLES:30000 DIM:350 AVG_DIFF:0.0028
Fitting PCA...
0-th component log probs | Train: 2.951260830580637 | Val: 2.8876752728822184
1-th component log probs | Train: 3.017396738902973 | Val: 2.9173456271838796
2-th component log probs | Train: 2.832109683592651 | Val: 2.774807642491711
3-th component log probs | Train: 2.7539057251447003 | Val: 2.694917626821595
4-th component log probs | Train: 2.9335226368213685 | Val: 2.8707588141833966
5-th component log probs | Train: 2.8298503554846097 | Val: 2.754350724509298
6-th component log probs | Train: 2.961017213947507 | Val: 2.8933678598514536
7-th component log probs | Train: 2.912716163066542 | Val: 2.846301522575562
8-th component log probs | Train: 2.9520513907284096 | Val: 2.9461805464140065
9-th component log probs | Train: 2.914329893829873 | Val: 2.857220982943227
KEYWORD NR_SAMPLES:30000 DIM:400 AVG_DIFF:0.0043
Fitting PCA...
0-th component log probs | Train: 3.0458841946398323 | Val: 2.970826371445467
1-th component log probs | Train: 3.1106076625429133 | Val: 2.993237364379861
2-th component log probs | Train: 2.927565799563904 | Val: 2.859251266990217
3-th component log probs | Train: 2.8497200854386016 | Val: 2.7824615092830167
4-th component log probs | Train: 3.028196331776484 | Val: 2.952714314198881
5-th component log probs | Train: 2.9261187151068904 | Val: 2.8382251503451434
6-th component log probs | Train: 3.057132142626073 | Val: 2.970817510637412
7-th component log probs | Train: 3.007866800271714 | Val: 2.927835977250867
8-th component log probs | Train: 3.0465352065684366 | Val: 3.022048866729475
9-th component log probs | Train: 3.0070990656749816 | Val: 2.93676495751721
KEYWORD NR_SAMPLES:30000 DIM:450 AVG_DIFF:0.0061
Fitting PCA...
0-th component log probs | Train: 3.1383887280542355 | Val: 3.0512807080839273
1-th component log probs | Train: 3.198460644184384 | Val: 3.0617629595735836
2-th component log probs | Train: 3.020271661360105 | Val: 2.9413416514250237
3-th component log probs | Train: 2.942579617709861 | Val: 2.8653033430555728
4-th component log probs | Train: 3.117694148646876 | Val: 3.0301712662686304
5-th component log probs | Train: 3.018240558296267 | Val: 2.9178323228252663
6-th component log probs | Train: 3.148105156547453 | Val: 3.0436681622109902
7-th component log probs | Train: 3.09777441734649 | Val: 3.0018956836000004
8-th component log probs | Train: 3.1375035265669085 | Val: 3.0915447183214373
9-th component log probs | Train: 3.0952411026321363 | Val: 3.011326477156649
KEYWORD NR_SAMPLES:30000 DIM:500 AVG_DIFF:0.0085
0-th component log probs | Train: 3.162582861063772 | Val: 3.072562061826665
1-th component log probs | Train: 3.2207542750427383 | Val: 3.0785136197833882
2-th component log probs | Train: 3.0442898261941678 | Val: 2.962184094479308
3-th component log probs | Train: 2.9659481102385783 | Val: 2.8856212129318446
4-th component log probs | Train: 3.1405929502907854 | Val: 3.04848071788431
5-th component log probs | Train: 3.0412318107415057 | Val: 2.938013877207287
6-th component log probs | Train: 3.1710105859372764 | Val: 3.061729084563482
7-th component log probs | Train: 3.120213647377511 | Val: 3.02090672233128
8-th component log probs | Train: 3.16088174055572 | Val: 3.110332029007482
9-th component log probs | Train: 3.1178560616154107 | Val: 3.0307476141810694
KEYWORD NR_SAMPLES:30000 DIM:512 AVG_DIFF:0.0093
best average differences at 150 dimensions: 0.0006610873915767716
2022-01-09 03:37.36 [info     ] Training complete              train_loss=0.8204187154769897
2022-01-09 03:37.36 [info     ] Starting evaluating            dataset=10000
2022-01-09 03:37.37 [info     ] Testing complete               test_loss=0.49813494086265564
{'dataset_size': 30000,
 'end_test_accuracy': 0.8356887102127075,
 'end_test_loss': 0.49813494086265564,
 'end_train_accuracy': 0.8243492841720581,
 'end_train_loss': 0.8204187154769897,
 'end_val_accuracy': 0.8464370965957642,
 'end_val_loss': 0.4691305458545685}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 03:37.38 [info     ] Start Predict                  dataset=10000
2022-01-09 03:38.13 [info     ] Starting training              dataset=40000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
40000
Fitting PCA...
0-th component log probs | Train: 1.521921625105004 | Val: 1.45237392315762
1-th component log probs | Train: 1.6075490269439758 | Val: 1.5409313312749824
2-th component log probs | Train: 1.4445867018584744 | Val: 1.4159820071390858
3-th component log probs | Train: 1.3786365723827625 | Val: 1.361328016879339
4-th component log probs | Train: 1.5162706238648567 | Val: 1.49128750725381
5-th component log probs | Train: 1.4648046262326495 | Val: 1.4124713518886973
6-th component log probs | Train: 1.592491513209383 | Val: 1.5260113725360842
7-th component log probs | Train: 1.4997588514659606 | Val: 1.4460913498158052
8-th component log probs | Train: 1.6124172299897435 | Val: 1.5537596398465288
9-th component log probs | Train: 1.5338558777754294 | Val: 1.4892756527530036
KEYWORD NR_SAMPLES:40000 DIM:50 AVG_DIFF:0.0026
Fitting PCA...
0-th component log probs | Train: 2.0651161568880423 | Val: 1.9923173682975608
1-th component log probs | Train: 2.173838142350451 | Val: 2.100043050143266
2-th component log probs | Train: 1.9891845095305463 | Val: 1.96787395495706
3-th component log probs | Train: 1.888527050112439 | Val: 1.869085176377851
4-th component log probs | Train: 2.083247974247823 | Val: 2.052963494874293
5-th component log probs | Train: 1.9829829020755798 | Val: 1.9393243055823925
6-th component log probs | Train: 2.142341112254955 | Val: 2.064986786804926
7-th component log probs | Train: 2.0580212581973907 | Val: 1.9968279247173577
8-th component log probs | Train: 2.1628783232634468 | Val: 2.097065224621363
9-th component log probs | Train: 2.093642690715419 | Val: 2.043572160045079
KEYWORD NR_SAMPLES:40000 DIM:100 AVG_DIFF:0.0031
Fitting PCA...
0-th component log probs | Train: 2.3444718943038976 | Val: 2.254986547990313
1-th component log probs | Train: 2.4454003069149786 | Val: 2.3468132019893266
2-th component log probs | Train: 2.272310005673983 | Val: 2.237990125070244
3-th component log probs | Train: 2.1581511462175405 | Val: 2.134156594396951
4-th component log probs | Train: 2.3729348785789592 | Val: 2.3169761816062144
5-th component log probs | Train: 2.2545389220323324 | Val: 2.2024388451042687
6-th component log probs | Train: 2.4259104237512634 | Val: 2.335703555534102
7-th component log probs | Train: 2.333116317394833 | Val: 2.2569193630767823
8-th component log probs | Train: 2.4352547749723144 | Val: 2.3525110093470305
9-th component log probs | Train: 2.3646316813576274 | Val: 2.297724314104902
KEYWORD NR_SAMPLES:40000 DIM:150 AVG_DIFF:0.0051
Fitting PCA...
0-th component log probs | Train: 2.535929414654062 | Val: 2.430396826974426
1-th component log probs | Train: 2.62171454966592 | Val: 2.506502768196201
2-th component log probs | Train: 2.467387281882615 | Val: 2.4088553418976946
3-th component log probs | Train: 2.343384932517887 | Val: 2.300727300306856
4-th component log probs | Train: 2.569622443508453 | Val: 2.4891200518179635
5-th component log probs | Train: 2.440124183381267 | Val: 2.3681030077269067
6-th component log probs | Train: 2.617198968214291 | Val: 2.5012951589063723
7-th component log probs | Train: 2.5167158908481015 | Val: 2.4186185329802243
8-th component log probs | Train: 2.6193746381317426 | Val: 2.5120968926821203
9-th component log probs | Train: 2.5424443686907887 | Val: 2.458538285474451
KEYWORD NR_SAMPLES:40000 DIM:200 AVG_DIFF:0.0083
Fitting PCA...
0-th component log probs | Train: 2.6881489046608187 | Val: 2.5774379423226637
1-th component log probs | Train: 2.763695106961209 | Val: 2.64249355556779
2-th component log probs | Train: 2.624009087370342 | Val: 2.556028762796665
3-th component log probs | Train: 2.494439493341807 | Val: 2.449087506443737
4-th component log probs | Train: 2.7236253213832593 | Val: 2.6346696959560876
5-th component log probs | Train: 2.589964039577591 | Val: 2.5107363743620694
6-th component log probs | Train: 2.7693120735958394 | Val: 2.6451252204475844
7-th component log probs | Train: 2.6617136166244157 | Val: 2.557176272740851
8-th component log probs | Train: 2.7689400788677947 | Val: 2.652839638262983
9-th component log probs | Train: 2.6844565107441056 | Val: 2.5896119874814554
KEYWORD NR_SAMPLES:40000 DIM:250 AVG_DIFF:0.0097
Fitting PCA...
0-th component log probs | Train: 2.8182961084951956 | Val: 2.6996353461330083
1-th component log probs | Train: 2.885921096888761 | Val: 2.7563444726595128
2-th component log probs | Train: 2.7558291644820976 | Val: 2.6796497993912216
3-th component log probs | Train: 2.623940553821147 | Val: 2.56967480228029
4-th component log probs | Train: 2.855423265392207 | Val: 2.7601308272241236
5-th component log probs | Train: 2.7188718722045873 | Val: 2.631429695146971
6-th component log probs | Train: 2.900397950507624 | Val: 2.768494329143146
7-th component log probs | Train: 2.7873776017709284 | Val: 2.674341648168339
8-th component log probs | Train: 2.8959110516577997 | Val: 2.768856994483775
9-th component log probs | Train: 2.808163632432142 | Val: 2.7007344020479853
KEYWORD NR_SAMPLES:40000 DIM:300 AVG_DIFF:0.0114
Fitting PCA...
0-th component log probs | Train: 2.9340039280798877 | Val: 2.809197020515627
1-th component log probs | Train: 2.997325130359818 | Val: 2.859647964095124
2-th component log probs | Train: 2.871734695932528 | Val: 2.7859233291107626
3-th component log probs | Train: 2.740193617014632 | Val: 2.679764622869951
4-th component log probs | Train: 2.9707545776791267 | Val: 2.870728105461925
5-th component log probs | Train: 2.8338870022793525 | Val: 2.7399536665768016
6-th component log probs | Train: 3.014865767205596 | Val: 2.8736101069143065
7-th component log probs | Train: 2.8992873103734675 | Val: 2.777287218211345
8-th component log probs | Train: 3.0088375572407675 | Val: 2.8757839272476473
9-th component log probs | Train: 2.918907655955252 | Val: 2.801415125105099
KEYWORD NR_SAMPLES:40000 DIM:350 AVG_DIFF:0.0131
Fitting PCA...
0-th component log probs | Train: 3.037791139943521 | Val: 2.9059891133477747
1-th component log probs | Train: 3.0964349632417347 | Val: 2.9494045877919683
2-th component log probs | Train: 2.9762966931321184 | Val: 2.8801346540747286
3-th component log probs | Train: 2.844387211404084 | Val: 2.776279211472541
4-th component log probs | Train: 3.073946374792943 | Val: 2.9646249161729816
5-th component log probs | Train: 2.9380144760553484 | Val: 2.8348597936755406
6-th component log probs | Train: 3.1164417086338565 | Val: 2.964070272534588
7-th component log probs | Train: 2.99985426056754 | Val: 2.8695037952964126
8-th component log probs | Train: 3.1100037042773954 | Val: 2.968641033360477
9-th component log probs | Train: 3.0199047624866986 | Val: 2.891197289910662
KEYWORD NR_SAMPLES:40000 DIM:400 AVG_DIFF:0.0152
Fitting PCA...
0-th component log probs | Train: 3.13135614929134 | Val: 2.9912250199597223
1-th component log probs | Train: 3.1851877145861183 | Val: 3.029717314855647
2-th component log probs | Train: 3.0707352836597352 | Val: 2.9649082124674786
3-th component log probs | Train: 2.9394242260535934 | Val: 2.8616437128206944
4-th component log probs | Train: 3.1665989165948014 | Val: 3.0484797335847222
5-th component log probs | Train: 3.03173574432734 | Val: 2.9204503817958773
6-th component log probs | Train: 3.207852832949034 | Val: 3.046458558180208
7-th component log probs | Train: 3.091076011581408 | Val: 2.952275070526695
8-th component log probs | Train: 3.2018052908732746 | Val: 3.052674273819662
9-th component log probs | Train: 3.110189158969867 | Val: 2.9715822693908986
KEYWORD NR_SAMPLES:40000 DIM:450 AVG_DIFF:0.0174
Fitting PCA...
0-th component log probs | Train: 3.2251339084759736 | Val: 3.079008996545696
1-th component log probs | Train: 3.270881068643621 | Val: 3.111417548515494
2-th component log probs | Train: 3.1652340760522053 | Val: 3.050744245978211
3-th component log probs | Train: 3.035277623492832 | Val: 2.9499628282131134
4-th component log probs | Train: 3.257913814901378 | Val: 3.1298741980081073
5-th component log probs | Train: 3.1248197299774523 | Val: 3.004396200018603
6-th component log probs | Train: 3.2971717544314294 | Val: 3.125368418090379
7-th component log probs | Train: 3.1806306796357546 | Val: 3.034246159985703
8-th component log probs | Train: 3.2919469330033433 | Val: 3.1370180982005134
9-th component log probs | Train: 3.197851298575187 | Val: 3.0549841607289943
KEYWORD NR_SAMPLES:40000 DIM:500 AVG_DIFF:0.0193
0-th component log probs | Train: 3.2509007152717935 | Val: 3.1028299473207444
1-th component log probs | Train: 3.2942840207347706 | Val: 3.1337660823132545
2-th component log probs | Train: 3.191060710912974 | Val: 3.074852089667342
3-th component log probs | Train: 3.0612781424506488 | Val: 2.9735217260779976
4-th component log probs | Train: 3.282661310221047 | Val: 3.152626136255473
5-th component log probs | Train: 3.1501337955147535 | Val: 3.0278470551828014
6-th component log probs | Train: 3.3214256123453327 | Val: 3.147892316237159
7-th component log probs | Train: 3.2050560371523975 | Val: 3.0572695945022517
8-th component log probs | Train: 3.3168264463653943 | Val: 3.159396456796816
9-th component log probs | Train: 3.221860545135473 | Val: 3.078635053035088
KEYWORD NR_SAMPLES:40000 DIM:512 AVG_DIFF:0.0198
best average differences at 50 dimensions: 0.0026483461776944566
2022-01-09 05:03.21 [info     ] Training complete              train_loss=0.6760757565498352
2022-01-09 05:03.21 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:03.23 [info     ] Testing complete               test_loss=0.4729642868041992
{'dataset_size': 40000,
 'end_test_accuracy': 0.8463375568389893,
 'end_test_loss': 0.4729642868041992,
 'end_train_accuracy': 0.868399977684021,
 'end_train_loss': 0.6760757565498352,
 'end_val_accuracy': 0.8540008068084717,
 'end_val_loss': 0.44440728425979614}

wandb: Waiting for W&B process to finish, PID 674... (success).
wandb: - 0.57MB of 0.57MB uploaded (0.00MB deduped)wandb: \ 0.57MB of 0.57MB uploaded (0.00MB deduped)wandb: | 0.57MB of 0.57MB uploaded (0.00MB deduped)wandb: / 0.57MB of 0.57MB uploaded (0.00MB deduped)wandb: - 0.57MB of 0.97MB uploaded (0.00MB deduped)wandb: \ 0.57MB of 0.97MB uploaded (0.00MB deduped)wandb: | 0.57MB of 0.97MB uploaded (0.00MB deduped)wandb: / 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: - 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: \ 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: | 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: / 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: - 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: \ 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:           accuracy_0 
wandb:           accuracy_1 
wandb:          accuracy_10 
wandb:          accuracy_11 
wandb:          accuracy_12 
wandb:          accuracy_13 
wandb:           accuracy_2 
wandb:           accuracy_3 
wandb:           accuracy_4 
wandb:           accuracy_5 
wandb:           accuracy_6 
wandb:           accuracy_7 
wandb:           accuracy_8 
wandb:           accuracy_9 
wandb:              class_0 
wandb:              class_1 
wandb:              class_2 
wandb:              class_3 
wandb:              class_4 
wandb:              class_5 
wandb:              class_6 
wandb:              class_7 
wandb:              class_8 
wandb:              class_9 
wandb:         dataset_size 
wandb:    end_test_accuracy 
wandb:        end_test_loss 
wandb:   end_train_accuracy 
wandb:       end_train_loss 
wandb:     end_val_accuracy 
wandb:         end_val_loss 
wandb:                epoch 
wandb:               loss_0 
wandb:               loss_1 
wandb:              loss_10 
wandb:              loss_11 
wandb:              loss_12 
wandb:              loss_13 
wandb:               loss_2 
wandb:               loss_3 
wandb:               loss_4 
wandb:               loss_5 
wandb:               loss_6 
wandb:               loss_7 
wandb:               loss_8 
wandb:               loss_9 
wandb:                 lr_0 
wandb:                 lr_1 
wandb:                lr_10 
wandb:                lr_11 
wandb:                lr_12 
wandb:                lr_13 
wandb:                 lr_2 
wandb:                 lr_3 
wandb:                 lr_4 
wandb:                 lr_5 
wandb:                 lr_6 
wandb:                 lr_7 
wandb:                 lr_8 
wandb:                 lr_9 
wandb:       val_accuracy_0 
wandb:       val_accuracy_1 
wandb:      val_accuracy_10 
wandb:      val_accuracy_11 
wandb:      val_accuracy_12 
wandb:      val_accuracy_13 
wandb:       val_accuracy_2 
wandb:       val_accuracy_3 
wandb:       val_accuracy_4 
wandb:       val_accuracy_5 
wandb:       val_accuracy_6 
wandb:       val_accuracy_7 
wandb:       val_accuracy_8 
wandb:       val_accuracy_9 
wandb:           val_loss_0 
wandb:           val_loss_1 
wandb:          val_loss_10 
wandb:          val_loss_11 
wandb:          val_loss_12 
wandb:          val_loss_13 
wandb:           val_loss_2 
wandb:           val_loss_3 
wandb:           val_loss_4 
wandb:           val_loss_5 
wandb:           val_loss_6 
wandb:           val_loss_7 
wandb:           val_loss_8 
wandb:           val_loss_9 
wandb: 
wandb: Run summary:
wandb:           accuracy_0 0.75781
wandb:           accuracy_1 0.37891
wandb:          accuracy_10 0.74492
wandb:          accuracy_11 0.78075
wandb:          accuracy_12 0.82435
wandb:          accuracy_13 0.8684
wandb:           accuracy_2 0.67411
wandb:           accuracy_3 0.79062
wandb:           accuracy_4 0.62861
wandb:           accuracy_5 0.76934
wandb:           accuracy_6 0.73535
wandb:           accuracy_7 0.74033
wandb:           accuracy_8 0.76313
wandb:           accuracy_9 0.76363
wandb:              class_0 0.0992
wandb:              class_1 0.10122
wandb:              class_2 0.09917
wandb:              class_3 0.10015
wandb:              class_4 0.10205
wandb:              class_5 0.09985
wandb:              class_6 0.09892
wandb:              class_7 0.099
wandb:              class_8 0.10075
wandb:              class_9 0.09967
wandb:         dataset_size 40000
wandb:    end_test_accuracy 0.84634
wandb:        end_test_loss 0.47296
wandb:   end_train_accuracy 0.8684
wandb:       end_train_loss 0.67608
wandb:     end_val_accuracy 0.854
wandb:         end_val_loss 0.44441
wandb:                epoch 100
wandb:               loss_0 1.66909
wandb:               loss_1 2.79655
wandb:              loss_10 1.12357
wandb:              loss_11 0.97607
wandb:              loss_12 0.82042
wandb:              loss_13 0.67608
wandb:               loss_2 1.70288
wandb:               loss_3 1.35819
wandb:               loss_4 1.66873
wandb:               loss_5 1.24357
wandb:               loss_6 1.25691
wandb:               loss_7 1.22041
wandb:               loss_8 1.11551
wandb:               loss_9 1.09833
wandb:                 lr_0 0.001
wandb:                 lr_1 0.001
wandb:                lr_10 1e-05
wandb:                lr_11 1e-05
wandb:                lr_12 1e-05
wandb:                lr_13 0.0
wandb:                 lr_2 0.0001
wandb:                 lr_3 0.0001
wandb:                 lr_4 0.0001
wandb:                 lr_5 0.0001
wandb:                 lr_6 0.0001
wandb:                 lr_7 0.0001
wandb:                 lr_8 1e-05
wandb:                 lr_9 1e-05
wandb:       val_accuracy_0 0.24323
wandb:       val_accuracy_1 0.22731
wandb:      val_accuracy_10 0.749
wandb:      val_accuracy_11 0.82006
wandb:      val_accuracy_12 0.84644
wandb:      val_accuracy_13 0.854
wandb:       val_accuracy_2 0.33539
wandb:       val_accuracy_3 0.39132
wandb:       val_accuracy_4 0.40137
wandb:       val_accuracy_5 0.44735
wandb:       val_accuracy_6 0.5421
wandb:       val_accuracy_7 0.63625
wandb:       val_accuracy_8 0.68899
wandb:       val_accuracy_9 0.71875
wandb:           val_loss_0 3.43194
wandb:           val_loss_1 2.49778
wandb:          val_loss_10 0.74779
wandb:          val_loss_11 0.52355
wandb:          val_loss_12 0.46913
wandb:          val_loss_13 0.44441
wandb:           val_loss_2 2.10614
wandb:           val_loss_3 2.03833
wandb:           val_loss_4 1.86542
wandb:           val_loss_5 1.95957
wandb:           val_loss_6 1.50079
wandb:           val_loss_7 1.13844
wandb:           val_loss_8 0.97641
wandb:           val_loss_9 0.86677
wandb: 
wandb: Synced 6 W&B file(s), 28 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced cifar10_hu_greedy_l2_run1: https://wandb.ai/fanconic/hidden_uncertainty/runs/2ycu6x8l
wandb: Find logs at: ./wandb/run-20220109_004820-2ycu6x8l/logs/debug.log
wandb: 
wandb: Tracking run with wandb version 0.12.7
wandb: Syncing run cifar10_hu_greedy_l2_run2
wandb:  View project at https://wandb.ai/fanconic/hidden_uncertainty
wandb:  View run at https://wandb.ai/fanconic/hidden_uncertainty/runs/17v60iqm
wandb: Run data is saved locally in /scratch_net/airfox/fanconic/semproj2/hidden_uncertainty_active_learning/wandb/run-20220109_050323-17v60iqm
wandb: Run `wandb offline` to turn off syncing.

Cuda is available:  True
Files already downloaded and verified
Files already downloaded and verified
2022-01-09 05:03.46 [info     ] Starting training              dataset=100 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
100
Fitting PCA...
0-th component log probs | Train: 5.076709820339022 | Val: -1645.4727883667895
1-th component log probs | Train: 4.970603413952655 | Val: -2440.591757564267
2-th component log probs | Train: 4.968752672126927 | Val: -1784.3883824427564
3-th component log probs | Train: 5.008981361166354 | Val: -2260.691818204868
4-th component log probs | Train: 5.005110930215947 | Val: -1538.9568051177434
5-th component log probs | Train: 4.984477777497945 | Val: -2366.0412675956254
6-th component log probs | Train: 5.043897946488076 | Val: -1483.8197240063091
7-th component log probs | Train: 4.98801928246926 | Val: -2813.0523178038206
8-th component log probs | Train: 5.059718705448705 | Val: -1522.628743573959
9-th component log probs | Train: 5.048886125879468 | Val: -3587.669136047657
KEYWORD NR_SAMPLES:100 DIM:50 AVG_DIFF:5044539.0512
0-th component log probs | Train: 30.19211116845537 | Val: -1137.2894576632702
1-th component log probs | Train: 30.149800057712348 | Val: -1632.1977941689734
2-th component log probs | Train: 30.149336669292882 | Val: -1184.769944253779
3-th component log probs | Train: 30.16425489561386 | Val: -1555.8484819394803
4-th component log probs | Train: 30.16255843782896 | Val: -1093.787282334025
5-th component log probs | Train: 30.156077657467744 | Val: -1565.485713760202
6-th component log probs | Train: 30.180024523121734 | Val: -1109.1309970231534
7-th component log probs | Train: 30.156607285665114 | Val: -1839.308553387441
8-th component log probs | Train: 30.184155075196163 | Val: -1171.8081514196274
9-th component log probs | Train: 30.18135667733892 | Val: -2307.666105182379
KEYWORD NR_SAMPLES:100 DIM:100 AVG_DIFF:2363045.9820
best average differences at 100 dimensions: 2363045.98198285
2022-01-09 05:04.53 [info     ] Training complete              train_loss=1.9036023616790771
2022-01-09 05:04.53 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:04.55 [info     ] Testing complete               test_loss=2.204606294631958
{'dataset_size': 100,
 'end_test_accuracy': 0.19914411008358002,
 'end_test_loss': 2.204606294631958,
 'end_train_accuracy': 0.6328125,
 'end_train_loss': 1.9036023616790771,
 'end_val_accuracy': 0.2063097059726715,
 'end_val_loss': 4.142035007476807}
2022-01-09 05:04.55 [info     ] Start Predict                  dataset=39900
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:05.23 [info     ] Starting training              dataset=200 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
200
Fitting PCA...
0-th component log probs | Train: 4.346492040132136 | Val: -1062.9442419778782
1-th component log probs | Train: 3.2218669590916704 | Val: -323.6073984604573
2-th component log probs | Train: 4.823149507192163 | Val: -705.6295686891203
3-th component log probs | Train: 4.595996264821324 | Val: -845.5859328608467
4-th component log probs | Train: 4.670995584431701 | Val: -589.1367053955162
5-th component log probs | Train: 4.362594845041566 | Val: -441.41693842176244
6-th component log probs | Train: 4.895633801007229 | Val: -824.0191160728282
7-th component log probs | Train: 4.007759759156072 | Val: -937.139654898365
8-th component log probs | Train: 3.510560779383697 | Val: -392.27687630131476
9-th component log probs | Train: 3.3699427872452494 | Val: -625.6273332440483
KEYWORD NR_SAMPLES:200 DIM:50 AVG_DIFF:514994.9622
Fitting PCA...
0-th component log probs | Train: 5.152643333322742 | Val: -645.301835607525
1-th component log probs | Train: 4.546618358976321 | Val: -315.76241005890637
2-th component log probs | Train: 5.398324488389598 | Val: -434.03519071682365
3-th component log probs | Train: 5.276927046832383 | Val: -535.8020272588822
4-th component log probs | Train: 5.320048025914296 | Val: -373.3406957316312
5-th component log probs | Train: 5.16029351410489 | Val: -311.1389957017358
6-th component log probs | Train: 5.43111503612602 | Val: -524.6145082167939
7-th component log probs | Train: 4.9566174316236 | Val: -652.994067546166
8-th component log probs | Train: 4.6986097336907635 | Val: -324.9860626854614
9-th component log probs | Train: 4.633844793493287 | Val: -482.6682334539027
KEYWORD NR_SAMPLES:200 DIM:100 AVG_DIFF:231498.9116
Fitting PCA...
0-th component log probs | Train: 5.42812656426475 | Val: -465.8760836672629
1-th component log probs | Train: 5.014294846920304 | Val: -252.99240521772265
2-th component log probs | Train: 5.593181989087999 | Val: -316.1842897278641
3-th component log probs | Train: 5.509872300557337 | Val: -394.0354612819451
4-th component log probs | Train: 5.539464992204961 | Val: -277.95591030087604
5-th component log probs | Train: 5.43254925140389 | Val: -239.99832734800174
6-th component log probs | Train: 5.613809802710637 | Val: -383.35215078768846
7-th component log probs | Train: 5.289976753521063 | Val: -488.30939313289423
8-th component log probs | Train: 5.1129531690984775 | Val: -268.37916449309154
9-th component log probs | Train: 5.077681154620999 | Val: -369.691511380019
KEYWORD NR_SAMPLES:200 DIM:150 AVG_DIFF:130266.3016
0-th component log probs | Train: 14.910171759598242 | Val: -406.3796462974764
1-th component log probs | Train: 14.597408235702714 | Val: -257.9368838446619
2-th component log probs | Train: 15.033924607883085 | Val: -272.61023895804294
3-th component log probs | Train: 14.970363016899087 | Val: -344.85700007761716
4-th component log probs | Train: 14.99219476377163 | Val: -242.32762935638576
5-th component log probs | Train: 14.913221832561076 | Val: -225.01066285639962
6-th component log probs | Train: 15.048734087434527 | Val: -321.61068918234923
7-th component log probs | Train: 14.804085494032746 | Val: -420.73905923750016
8-th component log probs | Train: 14.670699070239513 | Val: -264.36866898408147
9-th component log probs | Train: 14.646652250845294 | Val: -349.5629293225305
KEYWORD NR_SAMPLES:200 DIM:200 AVG_DIFF:110130.0896
best average differences at 200 dimensions: 110130.08959858576
2022-01-09 05:06.29 [info     ] Training complete              train_loss=2.566394805908203
2022-01-09 05:06.29 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:06.31 [info     ] Testing complete               test_loss=2.2710797786712646
{'dataset_size': 200,
 'end_test_accuracy': 0.15963375568389893,
 'end_test_loss': 2.2710797786712646,
 'end_train_accuracy': 0.4296875,
 'end_train_loss': 2.566394805908203,
 'end_val_accuracy': 0.23835588991641998,
 'end_val_loss': 2.4565141201019287}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:06.31 [info     ] Start Predict                  dataset=39800
2022-01-09 05:07.00 [info     ] Starting training              dataset=400 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
400
Fitting PCA...
0-th component log probs | Train: 2.8143486284709396 | Val: -242.38412676025365
1-th component log probs | Train: 2.197992102892927 | Val: -23.835825412770934
2-th component log probs | Train: 3.5459703123576136 | Val: -466.36949310718114
3-th component log probs | Train: 2.5062635136466627 | Val: -115.02497646753012
4-th component log probs | Train: 3.7108828929601594 | Val: -463.18295558363616
5-th component log probs | Train: 2.8824743449597543 | Val: -194.80879531149156
6-th component log probs | Train: 3.4545515011695915 | Val: -335.9131249145505
7-th component log probs | Train: 2.7854327776157644 | Val: -265.43249109338944
8-th component log probs | Train: 2.7788768693797516 | Val: -129.6923796545773
9-th component log probs | Train: 2.451328883681898 | Val: -245.5116117979093
KEYWORD NR_SAMPLES:400 DIM:50 AVG_DIFF:81865.1410
Fitting PCA...
0-th component log probs | Train: 4.293798856055013 | Val: -377.71281811405095
1-th component log probs | Train: 3.7884810899327683 | Val: -276.89708551650006
2-th component log probs | Train: 4.728531976885073 | Val: -412.082424608298
3-th component log probs | Train: 4.088882201407975 | Val: -282.3354935602743
4-th component log probs | Train: 4.809828585724134 | Val: -375.94418476691135
5-th component log probs | Train: 4.322751720747773 | Val: -312.69249730576496
6-th component log probs | Train: 4.6512818459316305 | Val: -347.6044724938383
7-th component log probs | Train: 4.259743834426084 | Val: -395.73225432946754
8-th component log probs | Train: 4.208512787466555 | Val: -276.2834829931309
9-th component log probs | Train: 4.003666158252558 | Val: -495.1959861546594
KEYWORD NR_SAMPLES:400 DIM:100 AVG_DIFF:133790.9794
Fitting PCA...
0-th component log probs | Train: 4.835861948652422 | Val: -309.33192830741035
1-th component log probs | Train: 4.477824774751206 | Val: -257.6903914588809
2-th component log probs | Train: 5.1391006163331765 | Val: -317.8102482203024
3-th component log probs | Train: 4.690888607860453 | Val: -248.0844135860268
4-th component log probs | Train: 5.1940017160390495 | Val: -293.7527846433149
5-th component log probs | Train: 4.850903959960283 | Val: -271.05009160604436
6-th component log probs | Train: 5.080491514156477 | Val: -287.6923613390964
7-th component log probs | Train: 4.807019088492331 | Val: -331.35963608305946
8-th component log probs | Train: 4.766354359148687 | Val: -244.9514064113592
9-th component log probs | Train: 4.6253546995686 | Val: -414.98277438320736
KEYWORD NR_SAMPLES:400 DIM:150 AVG_DIFF:93826.9655
Fitting PCA...
0-th component log probs | Train: 5.114391410748392 | Val: -261.2040467021593
1-th component log probs | Train: 4.838619960791171 | Val: -223.7308571887204
2-th component log probs | Train: 5.348289464287678 | Val: -256.1342632492549
3-th component log probs | Train: 5.00294338853327 | Val: -211.89041919095132
4-th component log probs | Train: 5.388229402249833 | Val: -241.4266045094034
5-th component log probs | Train: 5.124230043181567 | Val: -229.90367271539395
6-th component log probs | Train: 5.300859495149081 | Val: -238.3073156989154
7-th component log probs | Train: 5.090762639768478 | Val: -279.24132661491404
8-th component log probs | Train: 5.058022922014195 | Val: -209.9663346242809
9-th component log probs | Train: 4.953216628436945 | Val: -344.15130693518614
KEYWORD NR_SAMPLES:400 DIM:200 AVG_DIFF:66304.0172
Fitting PCA...
0-th component log probs | Train: 5.284910351717981 | Val: -223.38527480088814
1-th component log probs | Train: 5.061111166575926 | Val: -194.37357110585074
2-th component log probs | Train: 5.474860150319129 | Val: -215.5395986136122
3-th component log probs | Train: 5.19505896866914 | Val: -183.24836489752036
4-th component log probs | Train: 5.506235245315053 | Val: -204.59928920853477
5-th component log probs | Train: 5.291933761954762 | Val: -197.9275684760251
6-th component log probs | Train: 5.434967960074633 | Val: -202.9698315562873
7-th component log probs | Train: 5.265217172626217 | Val: -237.80656129812223
8-th component log probs | Train: 5.237449812054554 | Val: -182.0792328883287
9-th component log probs | Train: 5.155245478325932 | Val: -292.6704386662603
KEYWORD NR_SAMPLES:400 DIM:250 AVG_DIFF:48816.9186
Fitting PCA...
0-th component log probs | Train: 5.400198460228511 | Val: -194.12408877158092
1-th component log probs | Train: 5.212581774472581 | Val: -171.06592541160515
2-th component log probs | Train: 5.559853355095964 | Val: -185.97064483917612
3-th component log probs | Train: 5.324999038249518 | Val: -160.92922529185415
4-th component log probs | Train: 5.585624043475002 | Val: -177.568355334374
5-th component log probs | Train: 5.405733428237651 | Val: -172.79104791886422
6-th component log probs | Train: 5.525622234373881 | Val: -176.35251799765862
7-th component log probs | Train: 5.383398726517685 | Val: -206.43273136806602
8-th component log probs | Train: 5.35901626055112 | Val: -160.5403503451114
9-th component log probs | Train: 5.292187654395479 | Val: -253.488840444003
KEYWORD NR_SAMPLES:400 DIM:300 AVG_DIFF:37294.3876
Fitting PCA...
0-th component log probs | Train: 5.483304651711161 | Val: -172.04926230312665
1-th component log probs | Train: 5.322197541430432 | Val: -152.65254140101192
2-th component log probs | Train: 5.620861282533373 | Val: -163.69266407031722
3-th component log probs | Train: 5.418900954609185 | Val: -142.91743600261225
4-th component log probs | Train: 5.642721743501037 | Val: -156.87817374342995
5-th component log probs | Train: 5.488213211951721 | Val: -152.86295527924602
6-th component log probs | Train: 5.591028629494628 | Val: -155.7406389344429
7-th component log probs | Train: 5.468828396727868 | Val: -182.33311882952006
8-th component log probs | Train: 5.447463205262979 | Val: -143.38127245645578
9-th component log probs | Train: 5.390940176082989 | Val: -223.9145927600258
KEYWORD NR_SAMPLES:400 DIM:350 AVG_DIFF:29466.1202
0-th component log probs | Train: 7.223057594608255 | Val: -161.52363499047922
1-th component log probs | Train: 7.082031478669515 | Val: -146.7644694122623
2-th component log probs | Train: 7.3436450902275245 | Val: -151.9279466505906
3-th component log probs | Train: 7.166742161566492 | Val: -134.81795989026702
4-th component log probs | Train: 7.362662975438149 | Val: -145.300564678843
5-th component log probs | Train: 7.2274345058055784 | Val: -142.91753743365368
6-th component log probs | Train: 7.317368380099256 | Val: -144.38656304193879
7-th component log probs | Train: 7.210444393638524 | Val: -169.42261824756585
8-th component log probs | Train: 7.191596370766955 | Val: -136.3103798531565
9-th component log probs | Train: 7.142384926691385 | Val: -210.53225940755436
KEYWORD NR_SAMPLES:400 DIM:400 AVG_DIFF:26570.9251
best average differences at 400 dimensions: 26570.92509168411
2022-01-09 05:08.49 [info     ] Training complete              train_loss=1.6296604871749878
2022-01-09 05:08.49 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:08.51 [info     ] Testing complete               test_loss=1.993865728378296
{'dataset_size': 400,
 'end_test_accuracy': 0.3269307315349579,
 'end_test_loss': 1.993865728378296,
 'end_train_accuracy': 0.7276785969734192,
 'end_train_loss': 1.6296604871749878,
 'end_val_accuracy': 0.3398686349391937,
 'end_val_loss': 2.245600938796997}
2022-01-09 05:08.51 [info     ] Start Predict                  dataset=39600
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:09.19 [info     ] Starting training              dataset=600 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
600
Fitting PCA...
0-th component log probs | Train: 1.7713187082693607 | Val: 0.30184997398471436
1-th component log probs | Train: 1.9983713432210852 | Val: -0.41201086974073975
2-th component log probs | Train: 2.5373440011842954 | Val: -120.82296677241881
3-th component log probs | Train: 1.8986777544203586 | Val: -2.4994940029515544
4-th component log probs | Train: 3.0606079613920047 | Val: -223.6799799693893
5-th component log probs | Train: 2.254472976997945 | Val: -22.655275951082494
6-th component log probs | Train: 2.9650005220482827 | Val: -157.61133889484364
7-th component log probs | Train: 2.0528872402693934 | Val: -4.40779784761734
8-th component log probs | Train: 2.2001786193674815 | Val: -5.951949332012163
9-th component log probs | Train: 1.8137753080422236 | Val: -0.09769386142974451
KEYWORD NR_SAMPLES:600 DIM:50 AVG_DIFF:9317.3481
Fitting PCA...
0-th component log probs | Train: 3.085030633454026 | Val: -68.78659397202469
1-th component log probs | Train: 3.1544238417974126 | Val: -60.72490117954784
2-th component log probs | Train: 4.149855004793839 | Val: -226.03148625934176
3-th component log probs | Train: 3.4815511750308135 | Val: -138.37675766921018
4-th component log probs | Train: 4.44017759042257 | Val: -250.6536452893062
5-th component log probs | Train: 3.825482106379895 | Val: -174.6913375190494
6-th component log probs | Train: 4.360555251352145 | Val: -238.30963472560921
7-th component log probs | Train: 3.385707583330917 | Val: -105.23669008367355
8-th component log probs | Train: 3.699412981094203 | Val: -119.72709270071722
9-th component log probs | Train: 3.160287828979895 | Val: -106.67625115056195
KEYWORD NR_SAMPLES:600 DIM:100 AVG_DIFF:27728.0256
Fitting PCA...
0-th component log probs | Train: 3.9684999654687543 | Val: -91.31265221038704
1-th component log probs | Train: 3.9881035356590386 | Val: -92.39054450468434
2-th component log probs | Train: 4.743530969540102 | Val: -190.63467997869483
3-th component log probs | Train: 4.2642967640616956 | Val: -151.88303419305728
4-th component log probs | Train: 4.939391923385589 | Val: -203.94687423082536
5-th component log probs | Train: 4.504447726295867 | Val: -166.2655876225777
6-th component log probs | Train: 4.877631287044427 | Val: -199.69375359075892
7-th component log probs | Train: 4.170627413557104 | Val: -122.71930821717723
8-th component log probs | Train: 4.402451978481593 | Val: -125.64168749028516
9-th component log probs | Train: 4.0282566970905815 | Val: -136.34817285691906
KEYWORD NR_SAMPLES:600 DIM:150 AVG_DIFF:24828.5381
Fitting PCA...
0-th component log probs | Train: 4.443677788619855 | Val: -89.13285602436504
1-th component log probs | Train: 4.451522632960877 | Val: -92.06712215126889
2-th component log probs | Train: 5.0475241436728115 | Val: -160.8362617360064
3-th component log probs | Train: 4.6765655222546565 | Val: -138.34187874327972
4-th component log probs | Train: 5.194466455349436 | Val: -170.71883101432104
5-th component log probs | Train: 4.859160880856089 | Val: -146.28472252333142
6-th component log probs | Train: 5.144270895967874 | Val: -167.9450645108201
7-th component log probs | Train: 4.5964794861051725 | Val: -114.34593104891717
8-th component log probs | Train: 4.776521043336313 | Val: -116.98665401819459
9-th component log probs | Train: 4.494592852476084 | Val: -129.6817544619464
KEYWORD NR_SAMPLES:600 DIM:200 AVG_DIFF:19677.0862
Fitting PCA...
0-th component log probs | Train: 4.73936806177274 | Val: -83.11632568266687
1-th component log probs | Train: 4.742240516456274 | Val: -86.79535155677576
2-th component log probs | Train: 5.232204810954806 | Val: -139.33720563162157
3-th component log probs | Train: 4.930909345169494 | Val: -123.34020570798515
4-th component log probs | Train: 5.349766568505796 | Val: -145.7817964784341
5-th component log probs | Train: 5.076795636605862 | Val: -129.33836905633163
6-th component log probs | Train: 5.30795142184145 | Val: -144.24047448385582
7-th component log probs | Train: 4.861887455562044 | Val: -103.42274086856206
8-th component log probs | Train: 5.008654784578867 | Val: -105.38112510597013
9-th component log probs | Train: 4.782163094825848 | Val: -118.11927823074447
KEYWORD NR_SAMPLES:600 DIM:250 AVG_DIFF:15574.0693
Fitting PCA...
0-th component log probs | Train: 4.940253721386972 | Val: -76.39636805793705
1-th component log probs | Train: 4.941156099788054 | Val: -80.8034394935923
2-th component log probs | Train: 5.356587919756494 | Val: -122.45720920669733
3-th component log probs | Train: 5.103066633067553 | Val: -110.78684166643711
4-th component log probs | Train: 5.454335569865459 | Val: -127.19037085347712
5-th component log probs | Train: 5.224492395426709 | Val: -115.23421358456399
6-th component log probs | Train: 5.418782219447488 | Val: -126.04924396808131
7-th component log probs | Train: 5.0432970652770965 | Val: -93.3933176014565
8-th component log probs | Train: 5.16653249382397 | Val: -95.18088560617453
9-th component log probs | Train: 4.978031440253547 | Val: -106.92395319233964
KEYWORD NR_SAMPLES:600 DIM:300 AVG_DIFF:12540.4805
Fitting PCA...
0-th component log probs | Train: 5.086252614759574 | Val: -70.06578273942561
1-th component log probs | Train: 5.086176305104735 | Val: -74.55087443359106
2-th component log probs | Train: 5.445990998964279 | Val: -109.08996520163635
3-th component log probs | Train: 5.227354293764897 | Val: -100.1011270254008
4-th component log probs | Train: 5.529548680998982 | Val: -112.84364045287623
5-th component log probs | Train: 5.3315090896278035 | Val: -103.59031092076964
6-th component log probs | Train: 5.498559281200913 | Val: -111.7798572093145
7-th component log probs | Train: 5.174454148208071 | Val: -85.2077463343261
8-th component log probs | Train: 5.2807660537169046 | Val: -86.55115210358335
9-th component log probs | Train: 5.119749745974158 | Val: -97.10001317522432
KEYWORD NR_SAMPLES:600 DIM:350 AVG_DIFF:10288.3788
Fitting PCA...
0-th component log probs | Train: 5.197186090246234 | Val: -64.61848075216892
1-th component log probs | Train: 5.196728065137866 | Val: -68.95331827572629
2-th component log probs | Train: 5.513336163520988 | Val: -98.30826651993188
3-th component log probs | Train: 5.32144859199154 | Val: -91.03372020231753
4-th component log probs | Train: 5.586438616527054 | Val: -101.04751484341932
5-th component log probs | Train: 5.41254994672275 | Val: -93.90114022903883
6-th component log probs | Train: 5.558953032617898 | Val: -100.36151412110529
7-th component log probs | Train: 5.27454806642484 | Val: -77.76137316105229
8-th component log probs | Train: 5.36769950381607 | Val: -78.95463983092792
9-th component log probs | Train: 5.227251783327722 | Val: -88.73867969834345
KEYWORD NR_SAMPLES:600 DIM:400 AVG_DIFF:8572.3672
Fitting PCA...
0-th component log probs | Train: 5.284218043258748 | Val: -59.88485309236076
1-th component log probs | Train: 5.283642818018512 | Val: -63.86248060889811
2-th component log probs | Train: 5.5659447679066405 | Val: -89.46633177883419
3-th component log probs | Train: 5.3951683851626795 | Val: -83.33794512386774
4-th component log probs | Train: 5.630815584778102 | Val: -91.63363374559161
5-th component log probs | Train: 5.4760754727067225 | Val: -85.77778429296879
6-th component log probs | Train: 5.606256613789614 | Val: -91.01029019763843
7-th component log probs | Train: 5.353061254981045 | Val: -71.37124628068231
8-th component log probs | Train: 5.435960729999613 | Val: -72.60049835992426
9-th component log probs | Train: 5.3114448633821 | Val: -81.5686633614059
KEYWORD NR_SAMPLES:600 DIM:450 AVG_DIFF:7257.9752
Fitting PCA...
0-th component log probs | Train: 5.354396309452514 | Val: -55.81497751882471
1-th component log probs | Train: 5.353810298427356 | Val: -59.483878609121284
2-th component log probs | Train: 5.60815000850673 | Val: -82.11258352127388
3-th component log probs | Train: 5.45438906465589 | Val: -76.94980589691305
4-th component log probs | Train: 5.666487415732672 | Val: -83.82973729877024
5-th component log probs | Train: 5.527192423645911 | Val: -78.98266566170571
6-th component log probs | Train: 5.644360386780501 | Val: -83.09530463899026
7-th component log probs | Train: 5.416369141942951 | Val: -65.93979214096119
8-th component log probs | Train: 5.491005830237099 | Val: -67.3472551174698
9-th component log probs | Train: 5.379068465487226 | Val: -75.645274267986
KEYWORD NR_SAMPLES:600 DIM:500 AVG_DIFF:6241.9273
0-th component log probs | Train: 5.369247679091274 | Val: -54.9275594396635
1-th component log probs | Train: 5.36867285088715 | Val: -58.51858740720914
2-th component log probs | Train: 5.617065731971762 | Val: -80.51002181219083
3-th component log probs | Train: 5.466907916797018 | Val: -75.55612410522606
4-th component log probs | Train: 5.674032740588968 | Val: -82.1448500897462
5-th component log probs | Train: 5.538002657592845 | Val: -77.48814685975253
6-th component log probs | Train: 5.652425256518345 | Val: -81.38190449606518
7-th component log probs | Train: 5.429771246058831 | Val: -64.74269722635162
8-th component log probs | Train: 5.502658585188778 | Val: -66.16055937469953
9-th component log probs | Train: 5.393352999198729 | Val: -74.32978890525035
KEYWORD NR_SAMPLES:600 DIM:512 AVG_DIFF:6029.5938
best average differences at 512 dimensions: 6029.593763460466
2022-01-09 05:11.00 [info     ] Training complete              train_loss=2.076538324356079
2022-01-09 05:11.00 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:11.02 [info     ] Testing complete               test_loss=1.8280421495437622
{'dataset_size': 600,
 'end_test_accuracy': 0.33608677983283997,
 'end_test_loss': 1.8280421495437622,
 'end_train_accuracy': 0.5718749761581421,
 'end_train_loss': 2.076538324356079,
 'end_val_accuracy': 0.35997211933135986,
 'end_val_loss': 2.1228232383728027}
2022-01-09 05:11.02 [info     ] Start Predict                  dataset=39400
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:11.31 [info     ] Starting training              dataset=800 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
800
Fitting PCA...
0-th component log probs | Train: 1.8259347458712825 | Val: -1.1674620495924608
1-th component log probs | Train: 2.0734185305041044 | Val: -1.415109578294868
2-th component log probs | Train: 2.03670561316471 | Val: -23.74519441145415
3-th component log probs | Train: 1.6409200302100546 | Val: 0.6574090569797739
4-th component log probs | Train: 2.0633282971218487 | Val: -10.382622255346163
5-th component log probs | Train: 1.8392532476038004 | Val: -0.3403800827030112
6-th component log probs | Train: 2.160166214882355 | Val: -5.372768017855053
7-th component log probs | Train: 1.8334720748449695 | Val: -1.4366046350732722
8-th component log probs | Train: 2.1661110327150346 | Val: -3.5878296492086723
9-th component log probs | Train: 1.8626589074265185 | Val: 0.07021078445986369
KEYWORD NR_SAMPLES:800 DIM:50 AVG_DIFF:95.0216
Fitting PCA...
0-th component log probs | Train: 2.802458161427062 | Val: -52.38263667322125
1-th component log probs | Train: 3.04718604754437 | Val: -46.16140587804247
2-th component log probs | Train: 3.734060968708633 | Val: -228.66211181844972
3-th component log probs | Train: 2.361884877674524 | Val: -6.015283819090476
4-th component log probs | Train: 3.6671276296936894 | Val: -136.8149758420713
5-th component log probs | Train: 3.090932188450688 | Val: -94.67529211777446
6-th component log probs | Train: 3.6212933730862433 | Val: -166.42375819808396
7-th component log probs | Train: 2.6934224457325753 | Val: -34.73387231864308
8-th component log probs | Train: 3.4620011536714594 | Val: -102.33068997773364
9-th component log probs | Train: 2.873837091226309 | Val: -50.28952246702913
KEYWORD NR_SAMPLES:800 DIM:100 AVG_DIFF:13317.3053
Fitting PCA...
0-th component log probs | Train: 3.7161422968128606 | Val: -113.07257035641778
1-th component log probs | Train: 3.864220426950055 | Val: -92.12560850141054
2-th component log probs | Train: 4.4476074588282 | Val: -218.425299677752
3-th component log probs | Train: 3.2167182689136946 | Val: -70.80929901872447
4-th component log probs | Train: 4.392463898548906 | Val: -147.54082453421285
5-th component log probs | Train: 3.9708043828524078 | Val: -129.69322775710828
6-th component log probs | Train: 4.348267604362501 | Val: -179.4885041978411
7-th component log probs | Train: 3.603230853935465 | Val: -110.20317506082921
8-th component log probs | Train: 4.221490361738781 | Val: -126.90930847836187
9-th component log probs | Train: 3.7736558272010514 | Val: -104.12208584512402
KEYWORD NR_SAMPLES:800 DIM:150 AVG_DIFF:19454.0266
Fitting PCA...
0-th component log probs | Train: 4.240817427185709 | Val: -119.04652583642692
1-th component log probs | Train: 4.34492849896503 | Val: -99.21756470979666
2-th component log probs | Train: 4.819186118374897 | Val: -191.2578828256301
3-th component log probs | Train: 3.839572432884053 | Val: -91.56040552745178
4-th component log probs | Train: 4.774422125341763 | Val: -135.61852072429343
5-th component log probs | Train: 4.446340969658055 | Val: -125.26038418845147
6-th component log probs | Train: 4.735456668790917 | Val: -166.9710355327532
7-th component log probs | Train: 4.143508261648953 | Val: -119.7743231135456
8-th component log probs | Train: 4.633659298142586 | Val: -120.06843854506023
9-th component log probs | Train: 4.286251861787014 | Val: -108.08616829106042
KEYWORD NR_SAMPLES:800 DIM:200 AVG_DIFF:18302.3267
Fitting PCA...
0-th component log probs | Train: 4.5680382179180254 | Val: -112.5641886405216
1-th component log probs | Train: 4.649625135290577 | Val: -96.10759828491585
2-th component log probs | Train: 5.0469732277486585 | Val: -167.35619782641308
3-th component log probs | Train: 4.239832910569274 | Val: -92.35593320749526
4-th component log probs | Train: 5.00907477647953 | Val: -122.7311731677087
5-th component log probs | Train: 4.741072451080219 | Val: -115.86021282131192
6-th component log probs | Train: 4.97583330152738 | Val: -149.15991368459922
7-th component log probs | Train: 4.488507430968911 | Val: -112.96058215230039
8-th component log probs | Train: 4.8900036719703035 | Val: -110.02809131558469
9-th component log probs | Train: 4.607895768834669 | Val: -102.5243474162979
KEYWORD NR_SAMPLES:800 DIM:250 AVG_DIFF:15602.3416
Fitting PCA...
0-th component log probs | Train: 4.793969547498667 | Val: -104.00308729620566
1-th component log probs | Train: 4.859846222171096 | Val: -90.3351457521321
2-th component log probs | Train: 5.200594452502736 | Val: -149.46425139240898
3-th component log probs | Train: 4.516723894392601 | Val: -88.27288729073919
4-th component log probs | Train: 5.1675128902731124 | Val: -111.48638168283978
5-th component log probs | Train: 4.9422086612053535 | Val: -106.03428341177283
6-th component log probs | Train: 5.138896317523828 | Val: -134.6010951042618
7-th component log probs | Train: 4.725135295543986 | Val: -104.88455410182851
8-th component log probs | Train: 5.064863817319169 | Val: -101.02675389732065
9-th component log probs | Train: 4.827597134968119 | Val: -96.38683706298414
KEYWORD NR_SAMPLES:800 DIM:300 AVG_DIFF:13239.5268
Fitting PCA...
0-th component log probs | Train: 4.957927978331099 | Val: -95.5665491144239
1-th component log probs | Train: 5.013565473065516 | Val: -84.44517230391527
2-th component log probs | Train: 5.311470410061615 | Val: -134.20414926896942
3-th component log probs | Train: 4.719324935054279 | Val: -82.73362825198785
4-th component log probs | Train: 5.282302450571535 | Val: -101.59155696331565
5-th component log probs | Train: 5.087753482482596 | Val: -97.08674359323491
6-th component log probs | Train: 5.257159019295735 | Val: -121.94650735872804
7-th component log probs | Train: 4.898339902355802 | Val: -97.33954465424063
8-th component log probs | Train: 5.191883647583526 | Val: -92.76430502192723
9-th component log probs | Train: 4.987722265031365 | Val: -89.23480504557396
KEYWORD NR_SAMPLES:800 DIM:350 AVG_DIFF:11218.8970
Fitting PCA...
0-th component log probs | Train: 5.082870892331591 | Val: -88.21785787155449
1-th component log probs | Train: 5.131204056190699 | Val: -78.81018850694223
2-th component log probs | Train: 5.395256562262931 | Val: -121.86615037982503
3-th component log probs | Train: 4.873824738587508 | Val: -77.4854393514361
4-th component log probs | Train: 5.369029678973587 | Val: -93.3934281471729
5-th component log probs | Train: 5.198269261844288 | Val: -89.12903435238609
6-th component log probs | Train: 5.346683551331334 | Val: -111.4016021896674
7-th component log probs | Train: 5.030487461053311 | Val: -89.82014883643537
8-th component log probs | Train: 5.288656724730545 | Val: -85.5644970138613
9-th component log probs | Train: 5.109590269108495 | Val: -82.99281139881435
KEYWORD NR_SAMPLES:800 DIM:400 AVG_DIFF:9602.4495
Fitting PCA...
0-th component log probs | Train: 5.181431893668519 | Val: -81.75386553136883
1-th component log probs | Train: 5.2238900597798335 | Val: -73.43168233699528
2-th component log probs | Train: 5.460708676661385 | Val: -111.34670876328713
3-th component log probs | Train: 4.995549693322576 | Val: -72.37270835663536
4-th component log probs | Train: 5.4369272891269045 | Val: -86.28983577068546
5-th component log probs | Train: 5.284956701837825 | Val: -82.2756333502013
6-th component log probs | Train: 5.416996258255421 | Val: -102.1688684470809
7-th component log probs | Train: 5.13491948525014 | Val: -83.18456315107129
8-th component log probs | Train: 5.364685278017493 | Val: -79.27908542239828
9-th component log probs | Train: 5.2055164921169075 | Val: -77.27527917962105
KEYWORD NR_SAMPLES:800 DIM:450 AVG_DIFF:8279.7620
Fitting PCA...
0-th component log probs | Train: 5.261168060195608 | Val: -76.24466040560165
1-th component log probs | Train: 5.299104691340721 | Val: -68.58521547306113
2-th component log probs | Train: 5.5132975799259984 | Val: -102.66642157590164
3-th component log probs | Train: 5.093925710204109 | Val: -67.74304660036985
4-th component log probs | Train: 5.491707813824531 | Val: -79.94826333448907
5-th component log probs | Train: 5.354853263246795 | Val: -76.51751526872675
6-th component log probs | Train: 5.473703766977329 | Val: -94.30911045867971
7-th component log probs | Train: 5.2192879976586015 | Val: -77.43071750575966
8-th component log probs | Train: 5.4263022497168025 | Val: -73.68464527692461
9-th component log probs | Train: 5.283085887860883 | Val: -72.2624263129224
KEYWORD NR_SAMPLES:800 DIM:500 AVG_DIFF:7217.2724
0-th component log probs | Train: 5.278112493478052 | Val: -74.96558170730914
1-th component log probs | Train: 5.315110262059463 | Val: -67.4617768807959
2-th component log probs | Train: 5.524415075497463 | Val: -100.77790869062339
3-th component log probs | Train: 5.114793701042757 | Val: -66.70833814825063
4-th component log probs | Train: 5.503312195698831 | Val: -78.53748625590556
5-th component log probs | Train: 5.369653529698129 | Val: -75.25013054245142
6-th component log probs | Train: 5.485724338467998 | Val: -92.58444571198311
7-th component log probs | Train: 5.2372134609952345 | Val: -76.12725366497716
8-th component log probs | Train: 5.43939308430328 | Val: -72.44770787350349
9-th component log probs | Train: 5.299542061685164 | Val: -71.11538195601368
KEYWORD NR_SAMPLES:800 DIM:512 AVG_DIFF:6990.0253
best average differences at 50 dimensions: 95.0215605552063
2022-01-09 05:14.02 [info     ] Training complete              train_loss=1.5029025077819824
2022-01-09 05:14.02 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:14.04 [info     ] Testing complete               test_loss=1.718459963798523
{'dataset_size': 800,
 'end_test_accuracy': 0.3956011235713959,
 'end_test_loss': 1.718459963798523,
 'end_train_accuracy': 0.760817289352417,
 'end_train_loss': 1.5029025077819824,
 'end_val_accuracy': 0.412619411945343,
 'end_val_loss': 1.8818312883377075}
2022-01-09 05:14.04 [info     ] Start Predict                  dataset=39200
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:14.23 [info     ] Starting training              dataset=1000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
1000
Fitting PCA...
0-th component log probs | Train: 1.8142552683252156 | Val: 0.24442258013262838
1-th component log probs | Train: 2.0951774997364243 | Val: -0.4959150006782954
2-th component log probs | Train: 1.7635489115415353 | Val: -0.27884698896700866
3-th component log probs | Train: 1.6100054471454193 | Val: 0.6945820486544309
4-th component log probs | Train: 1.8202330611093758 | Val: 0.17172590666167284
5-th component log probs | Train: 1.8807227478005375 | Val: -0.7370921999805575
6-th component log probs | Train: 2.02090151823205 | Val: -0.9150241432740986
7-th component log probs | Train: 1.9489241110302469 | Val: -1.7256424870733866
8-th component log probs | Train: 2.1152364532742025 | Val: -2.276864328359054
9-th component log probs | Train: 1.866209303604974 | Val: -0.03959600527402041
KEYWORD NR_SAMPLES:1000 DIM:50 AVG_DIFF:6.8803
Fitting PCA...
0-th component log probs | Train: 2.5485930434850133 | Val: -6.656952201251133
1-th component log probs | Train: 3.0273399174223212 | Val: -28.550871671617646
2-th component log probs | Train: 2.8612898182716706 | Val: -70.59468691882547
3-th component log probs | Train: 2.2394035297652346 | Val: -1.2158731361508335
4-th component log probs | Train: 2.645281753953946 | Val: -9.072559714706385
5-th component log probs | Train: 2.9906340973377445 | Val: -70.81689696797996
6-th component log probs | Train: 2.9196822190454053 | Val: -27.901966862511447
7-th component log probs | Train: 2.7735378633260894 | Val: -29.189123518245783
8-th component log probs | Train: 3.2267753703970214 | Val: -78.1369500998602
9-th component log probs | Train: 2.7737634233562263 | Val: -37.63916428139466
KEYWORD NR_SAMPLES:1000 DIM:100 AVG_DIFF:2229.9351
Fitting PCA...
0-th component log probs | Train: 3.358602304753704 | Val: -58.11901340369985
1-th component log probs | Train: 3.8374897980301594 | Val: -79.32959677345096
2-th component log probs | Train: 3.7847579611730313 | Val: -130.69506571060649
3-th component log probs | Train: 2.961822002184622 | Val: -37.19537429991735
4-th component log probs | Train: 3.448023196428813 | Val: -56.28542306717351
5-th component log probs | Train: 3.887302620702819 | Val: -114.85227378063853
6-th component log probs | Train: 3.7251264344974784 | Val: -87.93560582013065
7-th component log probs | Train: 3.6128365556653006 | Val: -112.06065991496592
8-th component log probs | Train: 4.034278709227975 | Val: -117.35158762436377
9-th component log probs | Train: 3.686125574339071 | Val: -106.68379875287421
KEYWORD NR_SAMPLES:1000 DIM:150 AVG_DIFF:9675.8953
Fitting PCA...
0-th component log probs | Train: 3.931634761732655 | Val: -78.51383573524863
1-th component log probs | Train: 4.315771250899676 | Val: -87.93426232412662
2-th component log probs | Train: 4.300094497283099 | Val: -131.57122017767804
3-th component log probs | Train: 3.605209318899967 | Val: -66.44254813291136
4-th component log probs | Train: 4.0023675755676775 | Val: -77.30174449639601
5-th component log probs | Train: 4.378065924915491 | Val: -115.13307730834038
6-th component log probs | Train: 4.227864387487174 | Val: -101.69343989187958
7-th component log probs | Train: 4.1404018275374295 | Val: -130.53168400122183
8-th component log probs | Train: 4.480456550304103 | Val: -117.23769987808194
9-th component log probs | Train: 4.211932470971288 | Val: -113.9943468343894
KEYWORD NR_SAMPLES:1000 DIM:200 AVG_DIFF:11771.2226
Fitting PCA...
0-th component log probs | Train: 4.3062300159107085 | Val: -82.02394161473005
1-th component log probs | Train: 4.623895323137747 | Val: -85.71552729292519
2-th component log probs | Train: 4.620570924072949 | Val: -123.96412411274409
3-th component log probs | Train: 4.040342648870287 | Val: -74.82516145647314
4-th component log probs | Train: 4.36274608703817 | Val: -80.64412297467328
5-th component log probs | Train: 4.684299221774339 | Val: -108.19877009084895
6-th component log probs | Train: 4.549329215040982 | Val: -99.68871560866262
7-th component log probs | Train: 4.481322649195058 | Val: -125.48779346574072
8-th component log probs | Train: 4.762429597244909 | Val: -109.63902995270195
9-th component log probs | Train: 4.544274701029158 | Val: -110.84185337404364
KEYWORD NR_SAMPLES:1000 DIM:250 AVG_DIFF:11249.5850
Fitting PCA...
0-th component log probs | Train: 4.567312552046853 | Val: -80.32741142900555
1-th component log probs | Train: 4.836584673677267 | Val: -80.87205809930754
2-th component log probs | Train: 4.839263290449975 | Val: -113.932793538758
3-th component log probs | Train: 4.345034231334099 | Val: -74.45783796672733
4-th component log probs | Train: 4.613579199916626 | Val: -78.87215407078504
5-th component log probs | Train: 4.893225027499727 | Val: -100.2798803424033
6-th component log probs | Train: 4.772778829848007 | Val: -94.19757076314295
7-th component log probs | Train: 4.716888620632857 | Val: -117.86257522257145
8-th component log probs | Train: 4.955462333306988 | Val: -101.72481770573454
9-th component log probs | Train: 4.772943291966857 | Val: -103.92356879534047
KEYWORD NR_SAMPLES:1000 DIM:300 AVG_DIFF:10091.7498
Fitting PCA...
0-th component log probs | Train: 4.759037888053717 | Val: -76.42158674379189
1-th component log probs | Train: 4.9920607841706515 | Val: -76.36056048717843
2-th component log probs | Train: 4.9984211613057 | Val: -104.66602497661552
3-th component log probs | Train: 4.5684362250150965 | Val: -71.94752011995462
4-th component log probs | Train: 4.79843556960231 | Val: -74.78731742560966
5-th component log probs | Train: 5.044756540269169 | Val: -92.59465916967513
6-th component log probs | Train: 4.936499019324095 | Val: -88.31069397814957
7-th component log probs | Train: 4.889109829547536 | Val: -109.45028999256553
8-th component log probs | Train: 5.0966135465935 | Val: -94.21410721252283
9-th component log probs | Train: 4.939919109086046 | Val: -96.61435787376578
KEYWORD NR_SAMPLES:1000 DIM:350 AVG_DIFF:8890.1300
Fitting PCA...
0-th component log probs | Train: 4.905884131891528 | Val: -72.32502472748257
1-th component log probs | Train: 5.1110715743748765 | Val: -71.49336132273454
2-th component log probs | Train: 5.119091800716949 | Val: -96.76667641536498
3-th component log probs | Train: 4.739506007914904 | Val: -68.48323463875391
4-th component log probs | Train: 4.940302081994498 | Val: -70.34847435237232
5-th component log probs | Train: 5.1600740274861545 | Val: -85.83311240945397
6-th component log probs | Train: 5.062260037939724 | Val: -82.32065946618854
7-th component log probs | Train: 5.020950129128339 | Val: -101.76221808588865
8-th component log probs | Train: 5.204172080167761 | Val: -87.43471534530507
9-th component log probs | Train: 5.067157018268534 | Val: -90.00259416404515
KEYWORD NR_SAMPLES:1000 DIM:400 AVG_DIFF:7818.1932
Fitting PCA...
0-th component log probs | Train: 5.022418395630234 | Val: -68.20741785940848
1-th component log probs | Train: 5.205393198833145 | Val: -66.98891346207648
2-th component log probs | Train: 5.213744618496728 | Val: -89.76217816434875
3-th component log probs | Train: 4.874692880731987 | Val: -64.7209878476286
4-th component log probs | Train: 5.052275482289629 | Val: -66.30349726303365
5-th component log probs | Train: 5.250536210259149 | Val: -79.80716623851079
6-th component log probs | Train: 5.161625479942486 | Val: -76.74879894711533
7-th component log probs | Train: 5.125356488847872 | Val: -94.66965913765665
8-th component log probs | Train: 5.289053527569076 | Val: -81.46385432075103
9-th component log probs | Train: 5.167201737332106 | Val: -83.82589189201987
KEYWORD NR_SAMPLES:1000 DIM:450 AVG_DIFF:6887.9271
Fitting PCA...
0-th component log probs | Train: 5.116877001805743 | Val: -64.36088377299296
1-th component log probs | Train: 5.2818979956426215 | Val: -62.905187584336616
2-th component log probs | Train: 5.290368316708141 | Val: -83.4743545197011
3-th component log probs | Train: 4.984284675796604 | Val: -61.131360320751924
4-th component log probs | Train: 5.143574420224951 | Val: -62.295455574498305
5-th component log probs | Train: 5.32356287505694 | Val: -74.39866906807912
6-th component log probs | Train: 5.242387268328889 | Val: -71.65408251934119
7-th component log probs | Train: 5.2100885893832265 | Val: -88.14567046095631
8-th component log probs | Train: 5.357808148230965 | Val: -75.93871468392975
9-th component log probs | Train: 5.24825004727759 | Val: -78.3648778305696
KEYWORD NR_SAMPLES:1000 DIM:500 AVG_DIFF:6085.9394
0-th component log probs | Train: 5.136993643396689 | Val: -63.47410220481643
1-th component log probs | Train: 5.298211999694145 | Val: -61.98905020205039
2-th component log probs | Train: 5.306617040533469 | Val: -82.0421035717502
3-th component log probs | Train: 5.007598938735856 | Val: -60.27811979252982
4-th component log probs | Train: 5.163024936673108 | Val: -61.35208721509265
5-th component log probs | Train: 5.339059178560317 | Val: -73.18706958147916
6-th component log probs | Train: 5.259615478757727 | Val: -70.42552855707551
7-th component log probs | Train: 5.228101720267436 | Val: -86.65712319906521
8-th component log probs | Train: 5.372431874480999 | Val: -74.68400577231947
9-th component log probs | Train: 5.265474668119421 | Val: -77.13944457489865
KEYWORD NR_SAMPLES:1000 DIM:512 AVG_DIFF:5908.8435
best average differences at 50 dimensions: 6.880278929179772
2022-01-09 05:17.49 [info     ] Training complete              train_loss=1.3393807411193848
2022-01-09 05:17.49 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:17.51 [info     ] Testing complete               test_loss=1.6761687994003296
{'dataset_size': 1000,
 'end_test_accuracy': 0.42555731534957886,
 'end_test_loss': 1.6761687994003296,
 'end_train_accuracy': 0.7816406488418579,
 'end_train_loss': 1.3393807411193848,
 'end_val_accuracy': 0.4334195852279663,
 'end_val_loss': 1.9767372608184814}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:17.51 [info     ] Start Predict                  dataset=39000
2022-01-09 05:18.10 [info     ] Starting training              dataset=2000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
2000
Fitting PCA...
0-th component log probs | Train: 1.5709731414969517 | Val: 1.396306432536753
1-th component log probs | Train: 1.8083345618662259 | Val: 0.7689409739488023
2-th component log probs | Train: 1.5340343902748217 | Val: 1.1653798370201
3-th component log probs | Train: 1.4788727337828955 | Val: 1.2614451521112464
4-th component log probs | Train: 1.5534316716281003 | Val: 1.2196498811869327
5-th component log probs | Train: 1.6330772042267434 | Val: 1.1241115261160208
6-th component log probs | Train: 1.7206221968494724 | Val: 1.0310007518800173
7-th component log probs | Train: 1.6714798259703283 | Val: 0.9356658647476654
8-th component log probs | Train: 1.699754608796179 | Val: 1.3257710649048982
9-th component log probs | Train: 1.6441881661670261 | Val: 1.0153737288475129
KEYWORD NR_SAMPLES:2000 DIM:50 AVG_DIFF:0.3217
Fitting PCA...
0-th component log probs | Train: 2.10466348576453 | Val: 1.5930973079766015
1-th component log probs | Train: 2.382495293970198 | Val: 0.28680331572627
2-th component log probs | Train: 2.0884712544238098 | Val: 1.2249199725695226
3-th component log probs | Train: 1.9813510502816047 | Val: 1.462377150503374
4-th component log probs | Train: 2.1108206866832564 | Val: 1.3123687591936577
5-th component log probs | Train: 2.2789333558582694 | Val: -0.7301071437842706
6-th component log probs | Train: 2.2737588858421987 | Val: 0.8800441707943577
7-th component log probs | Train: 2.2034117250583707 | Val: 0.9444087150230263
8-th component log probs | Train: 2.2736618995533036 | Val: 0.9673194667171413
9-th component log probs | Train: 2.1581662430369404 | Val: 1.2027027078929027
KEYWORD NR_SAMPLES:2000 DIM:100 AVG_DIFF:2.1508
Fitting PCA...
0-th component log probs | Train: 2.508270699684927 | Val: 0.9845647374230038
1-th component log probs | Train: 2.814909805186921 | Val: -3.4315114661583985
2-th component log probs | Train: 2.5067761834647477 | Val: -0.13204501573176827
3-th component log probs | Train: 2.3617579535192825 | Val: 0.9165785833131913
4-th component log probs | Train: 2.5279766890704356 | Val: -0.06442287166327422
5-th component log probs | Train: 2.9945303650117894 | Val: -38.481272612773836
6-th component log probs | Train: 2.685608720873702 | Val: -1.0630705779718663
7-th component log probs | Train: 2.571941567173771 | Val: 0.12973735901773054
8-th component log probs | Train: 2.7538419357014665 | Val: -2.4038659496956156
9-th component log probs | Train: 2.5114189798187403 | Val: 0.7428018508456193
KEYWORD NR_SAMPLES:2000 DIM:150 AVG_DIFF:182.7101
Fitting PCA...
0-th component log probs | Train: 2.8987416077537573 | Val: -2.42789935683244
1-th component log probs | Train: 3.2688102685178846 | Val: -17.874274259592195
2-th component log probs | Train: 2.9740672562861943 | Val: -11.496103989542549
3-th component log probs | Train: 2.748113884679858 | Val: -3.84320073982654
4-th component log probs | Train: 2.951851688202587 | Val: -7.789716594311648
5-th component log probs | Train: 3.6437728717104205 | Val: -65.11720346396426
6-th component log probs | Train: 3.1097831222363204 | Val: -10.49370134898161
7-th component log probs | Train: 2.90712894861751 | Val: -2.9251683017419765
8-th component log probs | Train: 3.2788710938738057 | Val: -18.02961476912338
9-th component log probs | Train: 2.8230903920461583 | Val: -1.193968576606112
KEYWORD NR_SAMPLES:2000 DIM:200 AVG_DIFF:626.0946
Fitting PCA...
0-th component log probs | Train: 3.32871280620499 | Val: -11.681558987543141
1-th component log probs | Train: 3.6928203509245665 | Val: -33.9759412014675
2-th component log probs | Train: 3.454980971774207 | Val: -29.21182807386677
3-th component log probs | Train: 3.1942190890828552 | Val: -18.475835487136454
4-th component log probs | Train: 3.404792477889335 | Val: -22.800640374788422
5-th component log probs | Train: 4.074654081573761 | Val: -70.85611926857477
6-th component log probs | Train: 3.5299696221987817 | Val: -22.968984596911373
7-th component log probs | Train: 3.2519122684774047 | Val: -11.057452515620417
8-th component log probs | Train: 3.7238782731189812 | Val: -29.500901653883297
9-th component log probs | Train: 3.150603523796967 | Val: -7.4426565562983225
KEYWORD NR_SAMPLES:2000 DIM:250 AVG_DIFF:1160.5357
Fitting PCA...
0-th component log probs | Train: 3.693872857848578 | Val: -19.069019601223346
1-th component log probs | Train: 4.019654133306614 | Val: -40.99054887375329
2-th component log probs | Train: 3.823977561203316 | Val: -37.771227156115486
3-th component log probs | Train: 3.5887853281614484 | Val: -29.45261165376576
4-th component log probs | Train: 3.7709413146382897 | Val: -31.15802408856962
5-th component log probs | Train: 4.374621037867127 | Val: -70.25195524803033
6-th component log probs | Train: 3.8705591803607873 | Val: -30.446891878601225
7-th component log probs | Train: 3.594744398895464 | Val: -20.39168455989733
8-th component log probs | Train: 4.055343737503587 | Val: -34.991758737685934
9-th component log probs | Train: 3.4838079834429028 | Val: -15.988366498055184
KEYWORD NR_SAMPLES:2000 DIM:300 AVG_DIFF:1581.1999
Fitting PCA...
0-th component log probs | Train: 3.9798672508019837 | Val: -22.824946238115547
1-th component log probs | Train: 4.2697434490223145 | Val: -44.16387003548297
2-th component log probs | Train: 4.1057955720672155 | Val: -40.944221561792126
3-th component log probs | Train: 3.8959000203194964 | Val: -34.621391518147334
4-th component log probs | Train: 4.053092894340773 | Val: -35.14568712913625
5-th component log probs | Train: 4.5933581066592355 | Val: -67.47807642667873
6-th component log probs | Train: 4.135320969160563 | Val: -34.30429539781531
7-th component log probs | Train: 3.8780056487845296 | Val: -25.955416401426202
8-th component log probs | Train: 4.305282057946521 | Val: -36.6898738349297
9-th component log probs | Train: 3.7775806755027674 | Val: -22.40468832868767
KEYWORD NR_SAMPLES:2000 DIM:350 AVG_DIFF:1804.1986
Fitting PCA...
0-th component log probs | Train: 4.2060974225142935 | Val: -24.475364127573595
1-th component log probs | Train: 4.464478550919652 | Val: -44.585065230950335
2-th component log probs | Train: 4.324922080610522 | Val: -41.83846924357927
3-th component log probs | Train: 4.137710267093601 | Val: -36.69310304988484
4-th component log probs | Train: 4.274978330013342 | Val: -36.27665126997894
5-th component log probs | Train: 4.760768354702615 | Val: -64.35507968521878
6-th component log probs | Train: 4.3442579282471705 | Val: -35.449306721490196
7-th component log probs | Train: 4.107355652842902 | Val: -28.84268994020547
8-th component log probs | Train: 4.499402596426046 | Val: -36.774973985550055
9-th component log probs | Train: 4.017386917698258 | Val: -25.97836345461378
KEYWORD NR_SAMPLES:2000 DIM:400 AVG_DIFF:1872.0686
Fitting PCA...
0-th component log probs | Train: 4.387763660908382 | Val: -25.0866483270557
1-th component log probs | Train: 4.62126001549355 | Val: -44.14787707866565
2-th component log probs | Train: 4.4995736729837095 | Val: -41.4127968197785
3-th component log probs | Train: 4.3304539411544685 | Val: -37.38699750989085
4-th component log probs | Train: 4.452613465789935 | Val: -36.3903669430853
5-th component log probs | Train: 4.892546643767519 | Val: -61.058372149789356
6-th component log probs | Train: 4.51187446652641 | Val: -35.52888475027809
7-th component log probs | Train: 4.295295884415481 | Val: -30.269963515156917
8-th component log probs | Train: 4.654230507039698 | Val: -36.24010359852973
9-th component log probs | Train: 4.213948201460971 | Val: -27.909956474799525
KEYWORD NR_SAMPLES:2000 DIM:450 AVG_DIFF:1861.5445
Fitting PCA...
0-th component log probs | Train: 4.537962687344093 | Val: -25.034532012695053
1-th component log probs | Train: 4.74982222843278 | Val: -43.20903002530406
2-th component log probs | Train: 4.642426900447932 | Val: -40.343233265295
3-th component log probs | Train: 4.488887886157628 | Val: -37.10097699816697
4-th component log probs | Train: 4.598367929609459 | Val: -35.57230549474357
5-th component log probs | Train: 4.999283097982953 | Val: -57.75528887212678
6-th component log probs | Train: 4.6506068217422385 | Val: -34.78984908253269
7-th component log probs | Train: 4.451610487565292 | Val: -30.440822956592122
8-th component log probs | Train: 4.780912277670856 | Val: -35.212033594660674
9-th component log probs | Train: 4.377465069698564 | Val: -28.68669694926328
KEYWORD NR_SAMPLES:2000 DIM:500 AVG_DIFF:1794.5536
0-th component log probs | Train: 4.570108059720606 | Val: -24.918219040162242
1-th component log probs | Train: 4.777493613507055 | Val: -42.893851736405516
2-th component log probs | Train: 4.672881815289397 | Val: -40.03089026975488
3-th component log probs | Train: 4.52286700732417 | Val: -36.83967352647811
4-th component log probs | Train: 4.6296435280641095 | Val: -35.27978040642902
5-th component log probs | Train: 5.021998153531289 | Val: -56.94111915984169
6-th component log probs | Train: 4.68038308193876 | Val: -34.50238319299263
7-th component log probs | Train: 4.485434621135543 | Val: -30.409902211892874
8-th component log probs | Train: 4.807989540117527 | Val: -34.90662561306965
9-th component log probs | Train: 4.412619927017063 | Val: -28.702631235594087
KEYWORD NR_SAMPLES:2000 DIM:512 AVG_DIFF:1771.0440
best average differences at 50 dimensions: 0.3216755978429562
2022-01-09 05:22.45 [info     ] Training complete              train_loss=1.3359575271606445
2022-01-09 05:22.45 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:22.47 [info     ] Testing complete               test_loss=1.4101810455322266
{'dataset_size': 2000,
 'end_test_accuracy': 0.5077627301216125,
 'end_test_loss': 1.4101810455322266,
 'end_train_accuracy': 0.712890625,
 'end_train_loss': 1.3359575271606445,
 'end_val_accuracy': 0.5109474658966064,
 'end_val_loss': 1.560136079788208}
2022-01-09 05:22.47 [info     ] Start Predict                  dataset=38000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:23.07 [info     ] Starting training              dataset=4000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
4000
Fitting PCA...
0-th component log probs | Train: 1.4479465693136362 | Val: 1.4429387016277169
1-th component log probs | Train: 1.6261765046096974 | Val: 1.418095437723572
2-th component log probs | Train: 1.4297915782398962 | Val: 1.3003341448866608
3-th component log probs | Train: 1.3866442526121259 | Val: 1.287238956473584
4-th component log probs | Train: 1.496462222702292 | Val: 1.2805947672304065
5-th component log probs | Train: 1.4772743694671377 | Val: 1.3342491938378653
6-th component log probs | Train: 1.5906497228531007 | Val: 1.3865740510254667
7-th component log probs | Train: 1.5533014685834612 | Val: 1.3240604351919116
8-th component log probs | Train: 1.6297428214531342 | Val: 1.543289273364944
9-th component log probs | Train: 1.5224718683330267 | Val: 1.4167160437609185
KEYWORD NR_SAMPLES:4000 DIM:50 AVG_DIFF:0.0250
Fitting PCA...
0-th component log probs | Train: 1.9373876303654467 | Val: 1.8528145985284106
1-th component log probs | Train: 2.0951797346470094 | Val: 1.8087835092691
2-th component log probs | Train: 1.9145273617093954 | Val: 1.68979234241253
3-th component log probs | Train: 1.831162413385278 | Val: 1.6726704294942236
4-th component log probs | Train: 1.984140293815706 | Val: 1.6716356392656406
5-th component log probs | Train: 1.9489537923454208 | Val: 1.678348236644255
6-th component log probs | Train: 2.074127848756368 | Val: 1.7423661529737042
7-th component log probs | Train: 2.038146290849668 | Val: 1.6907323479192264
8-th component log probs | Train: 2.1226947165588004 | Val: 1.9095814924252352
9-th component log probs | Train: 1.9840665748464898 | Val: 1.8377508736420163
KEYWORD NR_SAMPLES:4000 DIM:100 AVG_DIFF:0.0633
Fitting PCA...
0-th component log probs | Train: 2.246291560999762 | Val: 1.989089646179905
1-th component log probs | Train: 2.3838353947867 | Val: 1.9347911474186077
2-th component log probs | Train: 2.222023559952578 | Val: 1.7444264009342676
3-th component log probs | Train: 2.1034005015784323 | Val: 1.8230901677129405
4-th component log probs | Train: 2.304093120629998 | Val: 1.703269675014897
5-th component log probs | Train: 2.2497249990136114 | Val: 1.6747038374036423
6-th component log probs | Train: 2.390863561074821 | Val: 1.7731271415920413
7-th component log probs | Train: 2.336720453678731 | Val: 1.7650447998154286
8-th component log probs | Train: 2.426769425218967 | Val: 1.9946373596835902
9-th component log probs | Train: 2.259757358878806 | Val: 2.0139500406880684
KEYWORD NR_SAMPLES:4000 DIM:150 AVG_DIFF:0.2222
Fitting PCA...
0-th component log probs | Train: 2.488739966810128 | Val: 2.0343747444196416
1-th component log probs | Train: 2.6143992864611327 | Val: 1.9572375508595914
2-th component log probs | Train: 2.4817155124014953 | Val: 1.621022009333259
3-th component log probs | Train: 2.334126460518693 | Val: 1.8713894505558493
4-th component log probs | Train: 2.5734273672881876 | Val: 1.4822271788951538
5-th component log probs | Train: 2.5271933947470706 | Val: 1.2544916151185965
6-th component log probs | Train: 2.6523386137610245 | Val: 1.553051549162552
7-th component log probs | Train: 2.58322210520393 | Val: 1.6716131079180372
8-th component log probs | Train: 2.6830778371458535 | Val: 1.8925272233773511
9-th component log probs | Train: 2.4815484622214163 | Val: 2.104505872801136
KEYWORD NR_SAMPLES:4000 DIM:200 AVG_DIFF:0.7210
Fitting PCA...
0-th component log probs | Train: 2.7064976270578547 | Val: 1.906313625502685
1-th component log probs | Train: 2.819146951500921 | Val: 1.8356648875830357
2-th component log probs | Train: 2.716450778827136 | Val: 1.150421962892378
3-th component log probs | Train: 2.5396324742178216 | Val: 1.7909562430874426
4-th component log probs | Train: 2.8166560812600285 | Val: 0.7003422694582669
5-th component log probs | Train: 2.798362594525537 | Val: -0.5233375061132358
6-th component log probs | Train: 2.891463254816399 | Val: 0.928563697947361
7-th component log probs | Train: 2.8024295068673415 | Val: 1.3670796912971057
8-th component log probs | Train: 2.9114541341888494 | Val: 1.5346324322600853
9-th component log probs | Train: 2.6762805525662157 | Val: 2.104321442471217
KEYWORD NR_SAMPLES:4000 DIM:250 AVG_DIFF:2.8269
Fitting PCA...
0-th component log probs | Train: 2.906889925906753 | Val: 1.53334522758064
1-th component log probs | Train: 2.9982161880401175 | Val: 1.61926757458722
2-th component log probs | Train: 2.9465438018211327 | Val: -0.2375291195374121
3-th component log probs | Train: 2.727972218435495 | Val: 1.5503806567854868
4-th component log probs | Train: 3.0587175205068915 | Val: -1.3276265614915477
5-th component log probs | Train: 3.1045199029641197 | Val: -6.677557429531763
6-th component log probs | Train: 3.117575920988523 | Val: -0.45745388633468925
7-th component log probs | Train: 3.0025904381198947 | Val: 0.7289355391873339
8-th component log probs | Train: 3.130113114634858 | Val: 0.7893488209891659
9-th component log probs | Train: 2.8480244343174363 | Val: 2.0475744902713053
KEYWORD NR_SAMPLES:4000 DIM:300 AVG_DIFF:15.4312
Fitting PCA...
0-th component log probs | Train: 3.0993293628604417 | Val: 0.7108057281959167
1-th component log probs | Train: 3.1663369045479106 | Val: 1.146174643040644
2-th component log probs | Train: 3.1914027803443075 | Val: -3.544811382736248
3-th component log probs | Train: 2.911638377845871 | Val: 0.9133186355955567
4-th component log probs | Train: 3.312164015118044 | Val: -5.34114600675512
5-th component log probs | Train: 3.418593012800605 | Val: -14.268934704614972
6-th component log probs | Train: 3.3473312092049996 | Val: -2.9844335171368406
7-th component log probs | Train: 3.1976155039144505 | Val: -0.5469698422756389
8-th component log probs | Train: 3.3401716541753186 | Val: -0.5201891737481459
9-th component log probs | Train: 3.004875557667704 | Val: 1.8688478404647617
KEYWORD NR_SAMPLES:4000 DIM:350 AVG_DIFF:51.7190
Fitting PCA...
0-th component log probs | Train: 3.2951402639230283 | Val: -0.7458974839892122
1-th component log probs | Train: 3.3278279788127776 | Val: 0.4174530133182607
2-th component log probs | Train: 3.4450591837608253 | Val: -8.12427914003208
3-th component log probs | Train: 3.0982048663497905 | Val: -0.5338730112395089
4-th component log probs | Train: 3.5555256339618935 | Val: -9.52821682946576
5-th component log probs | Train: 3.691147177523157 | Val: -18.97165440150245
6-th component log probs | Train: 3.5749642042482668 | Val: -6.407592107073767
7-th component log probs | Train: 3.3968191462850155 | Val: -2.7515860740721125
8-th component log probs | Train: 3.542044863303523 | Val: -2.1789830727413224
9-th component log probs | Train: 3.153360578776926 | Val: 1.5033537442973164
KEYWORD NR_SAMPLES:4000 DIM:400 AVG_DIFF:102.9536
Fitting PCA...
0-th component log probs | Train: 3.492351107827289 | Val: -2.7478278874375355
1-th component log probs | Train: 3.4850419274343256 | Val: -0.6401227293044743
2-th component log probs | Train: 3.673585518451327 | Val: -11.840912796773669
3-th component log probs | Train: 3.2948089299376675 | Val: -3.1845933357164937
4-th component log probs | Train: 3.7738091295996887 | Val: -12.684855131488627
5-th component log probs | Train: 3.9159185633159357 | Val: -22.01371848072779
6-th component log probs | Train: 3.782672041241276 | Val: -9.022132182195685
7-th component log probs | Train: 3.5874820774561806 | Val: -5.22565100981924
8-th component log probs | Train: 3.7323358102305506 | Val: -3.867960123039766
9-th component log probs | Train: 3.3012598015032597 | Val: 0.8785468451596197
KEYWORD NR_SAMPLES:4000 DIM:450 AVG_DIFF:158.7141
Fitting PCA...
0-th component log probs | Train: 3.682093501021125 | Val: -4.692649851567086
1-th component log probs | Train: 3.642997260935732 | Val: -1.9481641140502433
2-th component log probs | Train: 3.874043330397664 | Val: -14.167099532939487
3-th component log probs | Train: 3.492553964724939 | Val: -6.056307512737292
4-th component log probs | Train: 3.963776763440631 | Val: -14.746226303338615
5-th component log probs | Train: 4.104563535411279 | Val: -23.719255863224838
6-th component log probs | Train: 3.966221894648492 | Val: -10.887996356757958
7-th component log probs | Train: 3.767992226833544 | Val: -7.329675488032386
8-th component log probs | Train: 3.906836668060727 | Val: -5.211442075501745
9-th component log probs | Train: 3.449661321937702 | Val: -0.002422184968790563
KEYWORD NR_SAMPLES:4000 DIM:500 AVG_DIFF:208.1156
0-th component log probs | Train: 3.725380881712576 | Val: -5.06929659874405
1-th component log probs | Train: 3.6811847468952066 | Val: -2.2645376635256604
2-th component log probs | Train: 3.918483773753123 | Val: -14.517309499587126
3-th component log probs | Train: 3.539752800648942 | Val: -6.647206650318793
4-th component log probs | Train: 4.005879895965355 | Val: -15.018326360212127
5-th component log probs | Train: 4.145441687764436 | Val: -23.89208750193965
6-th component log probs | Train: 4.007014802207787 | Val: -11.182168139308668
7-th component log probs | Train: 3.810333883025831 | Val: -7.782281754815519
8-th component log probs | Train: 3.945587192482579 | Val: -5.488218624161256
9-th component log probs | Train: 3.4869111826940182 | Val: -0.26042679272004865
KEYWORD NR_SAMPLES:4000 DIM:512 AVG_DIFF:217.2513
best average differences at 50 dimensions: 0.02498752499120065
2022-01-09 05:29.42 [info     ] Training complete              train_loss=1.2345694303512573
2022-01-09 05:29.42 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:29.44 [info     ] Testing complete               test_loss=1.087516188621521
{'dataset_size': 4000,
 'end_test_accuracy': 0.6238057613372803,
 'end_test_loss': 1.087516188621521,
 'end_train_accuracy': 0.7309027910232544,
 'end_train_loss': 1.2345694303512573,
 'end_val_accuracy': 0.6315684914588928,
 'end_val_loss': 1.1394625902175903}
2022-01-09 05:29.45 [info     ] Start Predict                  dataset=36000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:30.06 [info     ] Starting training              dataset=6000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
6000
Fitting PCA...
0-th component log probs | Train: 1.389161675487756 | Val: 1.356767464832291
1-th component log probs | Train: 1.6253676829098345 | Val: 1.5894204667104515
2-th component log probs | Train: 1.372570306723119 | Val: 1.3315168762599257
3-th component log probs | Train: 1.3355621046913044 | Val: 1.2779391632136285
4-th component log probs | Train: 1.4333166864448168 | Val: 1.3562089222625984
5-th component log probs | Train: 1.4088201406728913 | Val: 1.3877663700942808
6-th component log probs | Train: 1.5129699919750632 | Val: 1.4876128236619603
7-th component log probs | Train: 1.4727714286841638 | Val: 1.3146385971059755
8-th component log probs | Train: 1.458075156125631 | Val: 1.4448251721701388
9-th component log probs | Train: 1.4460230898321682 | Val: 1.4199216844619125
KEYWORD NR_SAMPLES:6000 DIM:50 AVG_DIFF:0.0040
Fitting PCA...
0-th component log probs | Train: 1.8460799566205945 | Val: 1.8282122827313492
1-th component log probs | Train: 2.1035018975554385 | Val: 2.0133156283446385
2-th component log probs | Train: 1.8371070465458381 | Val: 1.7720793376204396
3-th component log probs | Train: 1.7676641721127384 | Val: 1.706003103559998
4-th component log probs | Train: 1.8982536742373488 | Val: 1.7736794870389814
5-th component log probs | Train: 1.8703268293612607 | Val: 1.8030787477728996
6-th component log probs | Train: 1.9757238515288114 | Val: 1.901346384611689
7-th component log probs | Train: 1.9396280640569412 | Val: 1.7456588855441566
8-th component log probs | Train: 1.91906562891967 | Val: 1.8905674999068245
9-th component log probs | Train: 1.8953610483952024 | Val: 1.8713639141225
KEYWORD NR_SAMPLES:6000 DIM:100 AVG_DIFF:0.0081
Fitting PCA...
0-th component log probs | Train: 2.118518306062242 | Val: 2.0426438734959396
1-th component log probs | Train: 2.3697498299548863 | Val: 2.19687547049194
2-th component log probs | Train: 2.112440585495115 | Val: 1.9636823734601903
3-th component log probs | Train: 2.0229148827200696 | Val: 1.8995110137242115
4-th component log probs | Train: 2.1822423343258346 | Val: 1.947593500796495
5-th component log probs | Train: 2.1500399661166587 | Val: 1.9667823281556507
6-th component log probs | Train: 2.259367016993531 | Val: 2.087040157911789
7-th component log probs | Train: 2.2107096989991586 | Val: 1.912678896130792
8-th component log probs | Train: 2.1860851069657756 | Val: 2.0883827975607074
9-th component log probs | Train: 2.1538524414759275 | Val: 2.075890715985829
KEYWORD NR_SAMPLES:6000 DIM:150 AVG_DIFF:0.0296
Fitting PCA...
0-th component log probs | Train: 2.332017306188129 | Val: 2.1861714275640676
1-th component log probs | Train: 2.5819242787701615 | Val: 2.2814253509258946
2-th component log probs | Train: 2.3348975589552294 | Val: 2.0658266310220736
3-th component log probs | Train: 2.2244276236424403 | Val: 2.036961507883974
4-th component log probs | Train: 2.408149642973789 | Val: 2.020846918376504
5-th component log probs | Train: 2.3770773475645295 | Val: 2.030991832914578
6-th component log probs | Train: 2.484733896954012 | Val: 2.1726191333217235
7-th component log probs | Train: 2.425471982372284 | Val: 1.992208034777005
8-th component log probs | Train: 2.395258429562189 | Val: 2.2042229014972037
9-th component log probs | Train: 2.354331196777853 | Val: 2.213432266046028
KEYWORD NR_SAMPLES:6000 DIM:200 AVG_DIFF:0.0830
Fitting PCA...
0-th component log probs | Train: 2.513554097835986 | Val: 2.2770496111186547
1-th component log probs | Train: 2.7631309124074805 | Val: 2.326366328948322
2-th component log probs | Train: 2.5259671410164266 | Val: 2.1061131588501407
3-th component log probs | Train: 2.4022271059980547 | Val: 2.1321454671085407
4-th component log probs | Train: 2.608452331243528 | Val: 1.986338530075409
5-th component log probs | Train: 2.58415932754364 | Val: 1.9759682808675667
6-th component log probs | Train: 2.685074365524077 | Val: 2.169468468065887
7-th component log probs | Train: 2.6112616278660465 | Val: 2.0111771967095255
8-th component log probs | Train: 2.5789108768446822 | Val: 2.2727034687312115
9-th component log probs | Train: 2.527034841921538 | Val: 2.3190540090302187
KEYWORD NR_SAMPLES:6000 DIM:250 AVG_DIFF:0.2016
Fitting PCA...
0-th component log probs | Train: 2.675006185880312 | Val: 2.3468850702560946
1-th component log probs | Train: 2.927343880737341 | Val: 2.3366847778792588
2-th component log probs | Train: 2.697592447834944 | Val: 2.077508791714937
3-th component log probs | Train: 2.5631334841735045 | Val: 2.1742593023382555
4-th component log probs | Train: 2.7876716543255338 | Val: 1.8533997111395368
5-th component log probs | Train: 2.7759260717064365 | Val: 1.7229707003971353
6-th component log probs | Train: 2.8649804828820535 | Val: 2.063073763617543
7-th component log probs | Train: 2.780023057290084 | Val: 1.9703773991732005
8-th component log probs | Train: 2.7442843349110904 | Val: 2.301124842439429
9-th component log probs | Train: 2.683462211094974 | Val: 2.389982173188646
KEYWORD NR_SAMPLES:6000 DIM:300 AVG_DIFF:0.4555
Fitting PCA...
0-th component log probs | Train: 2.820567524772669 | Val: 2.3543182321877874
1-th component log probs | Train: 3.0743849368809277 | Val: 2.2918203936672823
2-th component log probs | Train: 2.8552504938529597 | Val: 1.9553741512008023
3-th component log probs | Train: 2.7093509766232065 | Val: 2.1717392168347094
4-th component log probs | Train: 2.9508555076622427 | Val: 1.6167908435045792
5-th component log probs | Train: 2.960380053371006 | Val: 1.0918794961971472
6-th component log probs | Train: 3.031062472515253 | Val: 1.8288035894955892
7-th component log probs | Train: 2.934662730702974 | Val: 1.8111446332126278
8-th component log probs | Train: 2.892858749508765 | Val: 2.268840568172604
9-th component log probs | Train: 2.822541060075827 | Val: 2.4254450566167
KEYWORD NR_SAMPLES:6000 DIM:350 AVG_DIFF:1.0454
Fitting PCA...
0-th component log probs | Train: 2.95156209001027 | Val: 2.3334262877621947
1-th component log probs | Train: 3.2103368565415895 | Val: 2.191556174884066
2-th component log probs | Train: 3.0043165212175325 | Val: 1.692469530518565
3-th component log probs | Train: 2.8448674070423405 | Val: 2.1094056993870764
4-th component log probs | Train: 3.11022205091902 | Val: 1.0890900849700504
5-th component log probs | Train: 3.1509949870552827 | Val: -0.4221492823882258
6-th component log probs | Train: 3.1904406136923273 | Val: 1.3576380483407777
7-th component log probs | Train: 3.0792250764200637 | Val: 1.5607015822377643
8-th component log probs | Train: 3.0302311219353166 | Val: 2.1589261748587423
9-th component log probs | Train: 2.9487442040895004 | Val: 2.4231927074543513
KEYWORD NR_SAMPLES:6000 DIM:400 AVG_DIFF:2.7235
Fitting PCA...
0-th component log probs | Train: 3.072561277340106 | Val: 2.238136221736577
1-th component log probs | Train: 3.336380639536501 | Val: 2.0154880552471863
2-th component log probs | Train: 3.150255919661002 | Val: 1.1899951009564336
3-th component log probs | Train: 2.9704835377233163 | Val: 1.9482490179696725
4-th component log probs | Train: 3.265258560027514 | Val: 0.1888129423802474
5-th component log probs | Train: 3.350765271659781 | Val: -2.832346740383583
6-th component log probs | Train: 3.3466071174492744 | Val: 0.51395778624572
7-th component log probs | Train: 3.215038367377127 | Val: 1.1370906807896377
8-th component log probs | Train: 3.157023070024355 | Val: 1.955377317713279
9-th component log probs | Train: 3.0644881115131564 | Val: 2.3782853128956587
KEYWORD NR_SAMPLES:6000 DIM:450 AVG_DIFF:6.9281
Fitting PCA...
0-th component log probs | Train: 3.1928793801540305 | Val: 2.062347842652764
1-th component log probs | Train: 3.4575705934419885 | Val: 1.7797317023081174
2-th component log probs | Train: 3.301052006887516 | Val: 0.29924770582035093
3-th component log probs | Train: 3.09701081730399 | Val: 1.6738266181603751
4-th component log probs | Train: 3.4235673157980555 | Val: -1.0888110272940927
5-th component log probs | Train: 3.550233554602544 | Val: -5.350189920711642
6-th component log probs | Train: 3.507303292913399 | Val: -0.6221646594505024
7-th component log probs | Train: 3.353802826842768 | Val: 0.4669112992653477
8-th component log probs | Train: 3.2844414294171127 | Val: 1.6289329234261836
9-th component log probs | Train: 3.1755314869717877 | Val: 2.300657882258583
KEYWORD NR_SAMPLES:6000 DIM:500 AVG_DIFF:14.3601
0-th component log probs | Train: 3.2219994878061105 | Val: 2.0158230960354158
1-th component log probs | Train: 3.4869641151125292 | Val: 1.7183977987524464
2-th component log probs | Train: 3.3392130204799284 | Val: 0.0024213114488813767
3-th component log probs | Train: 3.1282739795648142 | Val: 1.5785067726124111
4-th component log probs | Train: 3.4629770982789685 | Val: -1.3889088400507947
5-th component log probs | Train: 3.596259635033229 | Val: -5.8585816756215054
6-th component log probs | Train: 3.5461258244111207 | Val: -0.8913656680924641
7-th component log probs | Train: 3.387714486185137 | Val: 0.26611744417357086
8-th component log probs | Train: 3.31565530358526 | Val: 1.5163875264191107
9-th component log probs | Train: 3.2026499367786476 | Val: 2.274351139352115
KEYWORD NR_SAMPLES:6000 DIM:512 AVG_DIFF:16.4588
best average differences at 50 dimensions: 0.004024206717148681
2022-01-09 05:39.50 [info     ] Training complete              train_loss=1.164874792098999
2022-01-09 05:39.50 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:39.52 [info     ] Testing complete               test_loss=0.9163644313812256
{'dataset_size': 6000,
 'end_test_accuracy': 0.6848129034042358,
 'end_test_loss': 0.9163644313812256,
 'end_train_accuracy': 0.7477282881736755,
 'end_train_loss': 1.164874792098999,
 'end_val_accuracy': 0.6807324886322021,
 'end_val_loss': 0.9971702098846436}
2022-01-09 05:39.52 [info     ] Start Predict                  dataset=34000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:40.14 [info     ] Starting training              dataset=8000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
8000
Fitting PCA...
0-th component log probs | Train: 1.3534320261091932 | Val: 1.4364020945340497
1-th component log probs | Train: 1.5092290371586061 | Val: 1.460891637158246
2-th component log probs | Train: 1.3529426115505006 | Val: 1.1862532062152895
3-th component log probs | Train: 1.3054866933195564 | Val: 1.2810268803500988
4-th component log probs | Train: 1.3952566575247143 | Val: 1.351215200734436
5-th component log probs | Train: 1.3658985545235518 | Val: 1.3820710412954065
6-th component log probs | Train: 1.4592691836285463 | Val: 1.4864166766671794
7-th component log probs | Train: 1.4230648715771623 | Val: 1.3719158378697263
8-th component log probs | Train: 1.5198629833634565 | Val: 1.6236099032670677
9-th component log probs | Train: 1.449902750167193 | Val: 1.4460696326580664
KEYWORD NR_SAMPLES:8000 DIM:50 AVG_DIFF:0.0054
Fitting PCA...
0-th component log probs | Train: 1.820248429177974 | Val: 1.8920204692034461
1-th component log probs | Train: 1.9742732100749214 | Val: 1.9126637077740212
2-th component log probs | Train: 1.7936112750456055 | Val: 1.681328554497076
3-th component log probs | Train: 1.7252578323029348 | Val: 1.6954984267303408
4-th component log probs | Train: 1.845258001313768 | Val: 1.788010717395415
5-th component log probs | Train: 1.8092563453099297 | Val: 1.7953298957083945
6-th component log probs | Train: 1.9174406707617513 | Val: 1.918555644734658
7-th component log probs | Train: 1.8667106748773015 | Val: 1.7880332192904658
8-th component log probs | Train: 1.9902596181079764 | Val: 2.048777650480691
9-th component log probs | Train: 1.9027491406349026 | Val: 1.9039719694468646
KEYWORD NR_SAMPLES:8000 DIM:100 AVG_DIFF:0.0036
Fitting PCA...
0-th component log probs | Train: 2.0810331343011854 | Val: 2.113767441275194
1-th component log probs | Train: 2.227553001971094 | Val: 2.1086640740164113
2-th component log probs | Train: 2.050579053816804 | Val: 1.899175492173636
3-th component log probs | Train: 1.9670822577869722 | Val: 1.890663286626705
4-th component log probs | Train: 2.106317755992307 | Val: 1.9961434643688947
5-th component log probs | Train: 2.0673558612665937 | Val: 1.989654305219651
6-th component log probs | Train: 2.1858220722993096 | Val: 2.1312648007474815
7-th component log probs | Train: 2.1255169832055225 | Val: 1.9811131819541876
8-th component log probs | Train: 2.2550961567867622 | Val: 2.2511666023963124
9-th component log probs | Train: 2.1534218919907797 | Val: 2.127094930936629
KEYWORD NR_SAMPLES:8000 DIM:150 AVG_DIFF:0.0087
Fitting PCA...
0-th component log probs | Train: 2.280099614174448 | Val: 2.269157293666802
1-th component log probs | Train: 2.4225194047733303 | Val: 2.2357683315172014
2-th component log probs | Train: 2.2539080493044708 | Val: 2.0407506288436035
3-th component log probs | Train: 2.1559706598273207 | Val: 2.0312692408976374
4-th component log probs | Train: 2.310627197269649 | Val: 2.1234631782530298
5-th component log probs | Train: 2.2684003806912085 | Val: 2.0974356088327415
6-th component log probs | Train: 2.3987109866412504 | Val: 2.261630462255218
7-th component log probs | Train: 2.3227118337201715 | Val: 2.106756834878745
8-th component log probs | Train: 2.455967393812432 | Val: 2.3832649413049
9-th component log probs | Train: 2.346890490763137 | Val: 2.275501649707349
KEYWORD NR_SAMPLES:8000 DIM:200 AVG_DIFF:0.0236
Fitting PCA...
0-th component log probs | Train: 2.4488578059327537 | Val: 2.388649235345544
1-th component log probs | Train: 2.5895449626372855 | Val: 2.335707620734847
2-th component log probs | Train: 2.4308096915612825 | Val: 2.1340559727600246
3-th component log probs | Train: 2.319840346431182 | Val: 2.14005086756207
4-th component log probs | Train: 2.4834341250233685 | Val: 2.2180964168627626
5-th component log probs | Train: 2.4466377821423797 | Val: 2.1666588209765343
6-th component log probs | Train: 2.578795245633354 | Val: 2.3558345621543757
7-th component log probs | Train: 2.493461767197044 | Val: 2.195184376781378
8-th component log probs | Train: 2.6349855533884767 | Val: 2.4548252446185845
9-th component log probs | Train: 2.513878007787608 | Val: 2.3882472455361383
KEYWORD NR_SAMPLES:8000 DIM:250 AVG_DIFF:0.0524
Fitting PCA...
0-th component log probs | Train: 2.599383585917912 | Val: 2.4822404696660665
1-th component log probs | Train: 2.740841662906828 | Val: 2.4046393538317834
2-th component log probs | Train: 2.585615444801631 | Val: 2.21537969108705
3-th component log probs | Train: 2.47172264882718 | Val: 2.22749457905993
4-th component log probs | Train: 2.6369851222287615 | Val: 2.294185038575219
5-th component log probs | Train: 2.610323851542143 | Val: 2.1956593488543352
6-th component log probs | Train: 2.7424103227693033 | Val: 2.400364658117731
7-th component log probs | Train: 2.6493124430745016 | Val: 2.249111462754402
8-th component log probs | Train: 2.7929744279263358 | Val: 2.5060982024091794
9-th component log probs | Train: 2.6636313525967035 | Val: 2.472680449576808
KEYWORD NR_SAMPLES:8000 DIM:300 AVG_DIFF:0.1009
Fitting PCA...
0-th component log probs | Train: 2.734148202027501 | Val: 2.5578099840510147
1-th component log probs | Train: 2.8769677045745774 | Val: 2.4452859400639695
2-th component log probs | Train: 2.7265215899805435 | Val: 2.257328712650798
3-th component log probs | Train: 2.6076275636417137 | Val: 2.293943263978082
4-th component log probs | Train: 2.773735132468906 | Val: 2.342380613042753
5-th component log probs | Train: 2.7602399478980777 | Val: 2.167236343996956
6-th component log probs | Train: 2.889775269433561 | Val: 2.3991134652311397
7-th component log probs | Train: 2.790459211480439 | Val: 2.2768166675876635
8-th component log probs | Train: 2.9377348441306705 | Val: 2.509406303905113
9-th component log probs | Train: 2.798378226681837 | Val: 2.5364219660014538
KEYWORD NR_SAMPLES:8000 DIM:350 AVG_DIFF:0.1830
Fitting PCA...
0-th component log probs | Train: 2.8574392533557615 | Val: 2.6081968743729353
1-th component log probs | Train: 2.9985586371007207 | Val: 2.4663146316786313
2-th component log probs | Train: 2.8535371312528146 | Val: 2.2688553239497518
3-th component log probs | Train: 2.7297456609687893 | Val: 2.3399387109966474
4-th component log probs | Train: 2.8987721565380493 | Val: 2.357278987118322
5-th component log probs | Train: 2.9003281708441184 | Val: 2.054936504343097
6-th component log probs | Train: 3.0240270942059815 | Val: 2.341488752094236
7-th component log probs | Train: 2.9177709106802165 | Val: 2.2701771170465563
8-th component log probs | Train: 3.0720143447830215 | Val: 2.470390338955014
9-th component log probs | Train: 2.9193896755829387 | Val: 2.5842409068912837
KEYWORD NR_SAMPLES:8000 DIM:400 AVG_DIFF:0.3207
Fitting PCA...
0-th component log probs | Train: 2.9675105923151217 | Val: 2.639492636155081
1-th component log probs | Train: 3.1090811965460716 | Val: 2.451628287256507
2-th component log probs | Train: 2.970995047570179 | Val: 2.228758505206166
3-th component log probs | Train: 2.8391926965881606 | Val: 2.356524584075356
4-th component log probs | Train: 3.012539115505543 | Val: 2.3295733268681578
5-th component log probs | Train: 3.0319322385737797 | Val: 1.8369060622339728
6-th component log probs | Train: 3.1491576604170155 | Val: 2.218286842422483
7-th component log probs | Train: 3.033313032377933 | Val: 2.2147338546938755
8-th component log probs | Train: 3.197622255187186 | Val: 2.385806216532146
9-th component log probs | Train: 3.0278322070844768 | Val: 2.598679175727151
KEYWORD NR_SAMPLES:8000 DIM:450 AVG_DIFF:0.5598
Fitting PCA...
0-th component log probs | Train: 3.0734165661420025 | Val: 2.6499316600584693
1-th component log probs | Train: 3.214516608615462 | Val: 2.401510460302824
2-th component log probs | Train: 3.082842383183534 | Val: 2.143931376215583
3-th component log probs | Train: 2.9474860795577933 | Val: 2.341199860247762
4-th component log probs | Train: 3.122678126735583 | Val: 2.2618534687781393
5-th component log probs | Train: 3.164789908350186 | Val: 1.4295229243985594
6-th component log probs | Train: 3.272947152874798 | Val: 2.0136115665411354
7-th component log probs | Train: 3.1458147478129668 | Val: 2.104281106146982
8-th component log probs | Train: 3.3196401947871745 | Val: 2.22350440790068
9-th component log probs | Train: 3.1307707633623663 | Val: 2.5910660467189066
KEYWORD NR_SAMPLES:8000 DIM:500 AVG_DIFF:1.0005
0-th component log probs | Train: 3.0986692148394734 | Val: 2.649629393167412
1-th component log probs | Train: 3.240457703719631 | Val: 2.38294729376539
2-th component log probs | Train: 3.1103250786381715 | Val: 2.1157287277972006
3-th component log probs | Train: 2.973691919891586 | Val: 2.3330672702520405
4-th component log probs | Train: 3.1488130573857878 | Val: 2.243057604581642
5-th component log probs | Train: 3.197758067523364 | Val: 1.3095663486913016
6-th component log probs | Train: 3.303162656721511 | Val: 1.950738311892275
7-th component log probs | Train: 3.1719794622134763 | Val: 2.074901290692847
8-th component log probs | Train: 3.3487849191171057 | Val: 2.179750136189178
9-th component log probs | Train: 3.1553506417134076 | Val: 2.5838533360460656
KEYWORD NR_SAMPLES:8000 DIM:512 AVG_DIFF:1.1448
best average differences at 100 dimensions: 0.0035528426179184747
2022-01-09 05:52.01 [info     ] Training complete              train_loss=1.192284345626831
2022-01-09 05:52.01 [info     ] Starting evaluating            dataset=10000
2022-01-09 05:52.03 [info     ] Testing complete               test_loss=0.8293319940567017
{'dataset_size': 8000,
 'end_test_accuracy': 0.7147691249847412,
 'end_test_loss': 0.8293319940567017,
 'end_train_accuracy': 0.7366250157356262,
 'end_train_loss': 1.192284345626831,
 'end_val_accuracy': 0.715465784072876,
 'end_val_loss': 0.868969202041626}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 05:52.03 [info     ] Start Predict                  dataset=32000
2022-01-09 05:52.30 [info     ] Starting training              dataset=10000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
10000
Fitting PCA...
0-th component log probs | Train: 1.3488166874271699 | Val: 1.469046620489915
1-th component log probs | Train: 1.4778900641612545 | Val: 1.5275562827593945
2-th component log probs | Train: 1.3022100580589007 | Val: 1.270557037217281
3-th component log probs | Train: 1.2886070256632967 | Val: 1.2847307079271073
4-th component log probs | Train: 1.3861802155586775 | Val: 1.3820987578677888
5-th component log probs | Train: 1.3476284129768559 | Val: 1.3647928109474594
6-th component log probs | Train: 1.4245706599259749 | Val: 1.4754482426367208
7-th component log probs | Train: 1.4349557370921964 | Val: 1.4012546083232689
8-th component log probs | Train: 1.4339507913802365 | Val: 1.5213788179173118
9-th component log probs | Train: 1.3946884160561568 | Val: 1.4081620300620528
KEYWORD NR_SAMPLES:10000 DIM:50 AVG_DIFF:0.0030
Fitting PCA...
0-th component log probs | Train: 1.7985598570412804 | Val: 1.9342144558392553
1-th component log probs | Train: 1.9486755773306146 | Val: 1.9976585877099857
2-th component log probs | Train: 1.7449013055144182 | Val: 1.7342443352025783
3-th component log probs | Train: 1.711584433246117 | Val: 1.7181434425766022
4-th component log probs | Train: 1.8380917043087535 | Val: 1.8364768264881943
5-th component log probs | Train: 1.7876322700748684 | Val: 1.8019999887255318
6-th component log probs | Train: 1.874118506258357 | Val: 1.9204183981989518
7-th component log probs | Train: 1.887968197956795 | Val: 1.8561557199183871
8-th component log probs | Train: 1.8925937684433347 | Val: 1.9871329131237232
9-th component log probs | Train: 1.8498055219402143 | Val: 1.9097007222423246
KEYWORD NR_SAMPLES:10000 DIM:100 AVG_DIFF:0.0037
Fitting PCA...
0-th component log probs | Train: 2.0541338492582217 | Val: 2.161956916818018
1-th component log probs | Train: 2.1988274230028275 | Val: 2.2031027465086015
2-th component log probs | Train: 1.997527808120416 | Val: 1.967398790448597
3-th component log probs | Train: 1.9497948831443035 | Val: 1.9311856840164663
4-th component log probs | Train: 2.0895263708005984 | Val: 2.0612528905011205
5-th component log probs | Train: 2.03702732042392 | Val: 2.014876623837448
6-th component log probs | Train: 2.131841069993684 | Val: 2.1386181699497575
7-th component log probs | Train: 2.1356334779125588 | Val: 2.0708141022890003
8-th component log probs | Train: 2.1488780582606735 | Val: 2.214192454033663
9-th component log probs | Train: 2.096773952723725 | Val: 2.1441733094688433
KEYWORD NR_SAMPLES:10000 DIM:150 AVG_DIFF:0.0025
Fitting PCA...
0-th component log probs | Train: 2.248779607554874 | Val: 2.3188113097256764
1-th component log probs | Train: 2.39016329539937 | Val: 2.3351626927468154
2-th component log probs | Train: 2.1889199285306336 | Val: 2.11814633454325
3-th component log probs | Train: 2.133902140003025 | Val: 2.07810453357774
4-th component log probs | Train: 2.2822591559132626 | Val: 2.211390861994523
5-th component log probs | Train: 2.2288509563143895 | Val: 2.1558153783556504
6-th component log probs | Train: 2.3276887888539783 | Val: 2.2760223725326045
7-th component log probs | Train: 2.3274123889537446 | Val: 2.21077784345515
8-th component log probs | Train: 2.3438015319215024 | Val: 2.3610790140880025
9-th component log probs | Train: 2.2852571393486922 | Val: 2.300958883937065
KEYWORD NR_SAMPLES:10000 DIM:200 AVG_DIFF:0.0043
Fitting PCA...
0-th component log probs | Train: 2.413532206817577 | Val: 2.450867421682869
1-th component log probs | Train: 2.554280814193768 | Val: 2.4379395481810633
2-th component log probs | Train: 2.353612366770881 | Val: 2.246313196673308
3-th component log probs | Train: 2.294493578917683 | Val: 2.1994049394940163
4-th component log probs | Train: 2.4463607063848394 | Val: 2.3289876525886872
5-th component log probs | Train: 2.396850028964312 | Val: 2.2661032969949266
6-th component log probs | Train: 2.499996470110073 | Val: 2.3852824438926974
7-th component log probs | Train: 2.494761801040021 | Val: 2.3190809563904224
8-th component log probs | Train: 2.51276830708942 | Val: 2.473309514894782
9-th component log probs | Train: 2.44687072474933 | Val: 2.425665331241436
KEYWORD NR_SAMPLES:10000 DIM:250 AVG_DIFF:0.0112
Fitting PCA...
0-th component log probs | Train: 2.5603299190244058 | Val: 2.5629981713289007
1-th component log probs | Train: 2.702564976852182 | Val: 2.5206633005063823
2-th component log probs | Train: 2.5010663118672487 | Val: 2.344082543353592
3-th component log probs | Train: 2.439778796738352 | Val: 2.305679802857096
4-th component log probs | Train: 2.5957480844983376 | Val: 2.4226901219148655
5-th component log probs | Train: 2.5496573807231875 | Val: 2.3446648498770246
6-th component log probs | Train: 2.6555211325469945 | Val: 2.45697362933577
7-th component log probs | Train: 2.6435791586759847 | Val: 2.4077750967307434
8-th component log probs | Train: 2.6661302443524373 | Val: 2.5717729547043957
9-th component log probs | Train: 2.593078530681393 | Val: 2.5311482341969356
KEYWORD NR_SAMPLES:10000 DIM:300 AVG_DIFF:0.0255
Fitting PCA...
0-th component log probs | Train: 2.692036057613613 | Val: 2.6583380888757047
1-th component log probs | Train: 2.836814453296952 | Val: 2.585678543124788
2-th component log probs | Train: 2.636161509994624 | Val: 2.4229771425132873
3-th component log probs | Train: 2.5713310602853676 | Val: 2.401138918239185
4-th component log probs | Train: 2.7297941432772483 | Val: 2.5015959362042257
5-th component log probs | Train: 2.688249187922657 | Val: 2.402053895706615
6-th component log probs | Train: 2.7951574314723704 | Val: 2.5190631402772183
7-th component log probs | Train: 2.7758448161076865 | Val: 2.4764942996655357
8-th component log probs | Train: 2.803623470545086 | Val: 2.6385615640664644
9-th component log probs | Train: 2.725118717933915 | Val: 2.616112583815824
KEYWORD NR_SAMPLES:10000 DIM:350 AVG_DIFF:0.0478
Fitting PCA...
0-th component log probs | Train: 2.8106128257276226 | Val: 2.735889390171702
1-th component log probs | Train: 2.957516377646243 | Val: 2.627602894134397
2-th component log probs | Train: 2.7569938284981186 | Val: 2.484880631459023
3-th component log probs | Train: 2.689208044203609 | Val: 2.477594563082504
4-th component log probs | Train: 2.8498356774686635 | Val: 2.5597914955392356
5-th component log probs | Train: 2.81377800312992 | Val: 2.42784718020762
6-th component log probs | Train: 2.922185260154663 | Val: 2.5459437204696704
7-th component log probs | Train: 2.895955221297651 | Val: 2.5186099257062673
8-th component log probs | Train: 2.9279907637761893 | Val: 2.684867919664702
9-th component log probs | Train: 2.8446176479429544 | Val: 2.68735166908607
KEYWORD NR_SAMPLES:10000 DIM:400 AVG_DIFF:0.0834
Fitting PCA...
0-th component log probs | Train: 2.916965088098877 | Val: 2.795399342256142
1-th component log probs | Train: 3.067470083638911 | Val: 2.647116053374013
2-th component log probs | Train: 2.864358701075498 | Val: 2.525213407665763
3-th component log probs | Train: 2.7950341568716137 | Val: 2.5333383605117628
4-th component log probs | Train: 2.9554591784695154 | Val: 2.5969049335004115
5-th component log probs | Train: 2.927788615400194 | Val: 2.429573262209797
6-th component log probs | Train: 3.0354845158901598 | Val: 2.540978586396905
7-th component log probs | Train: 3.0034020354513964 | Val: 2.5437974119089097
8-th component log probs | Train: 3.03856585506073 | Val: 2.7055381904409317
9-th component log probs | Train: 2.9508566662893503 | Val: 2.737702108245041
KEYWORD NR_SAMPLES:10000 DIM:450 AVG_DIFF:0.1364
Fitting PCA...
0-th component log probs | Train: 3.018516189430143 | Val: 2.8419858034733356
1-th component log probs | Train: 3.173925645167004 | Val: 2.638125883053711
2-th component log probs | Train: 2.9672854715027976 | Val: 2.545315934501822
3-th component log probs | Train: 2.89653871839578 | Val: 2.5710119717187045
4-th component log probs | Train: 3.0568501050460135 | Val: 2.6135218959461866
5-th component log probs | Train: 3.039832463164393 | Val: 2.384262563559438
6-th component log probs | Train: 3.145852328547404 | Val: 2.495671985772353
7-th component log probs | Train: 3.105386611119514 | Val: 2.5498056527423105
8-th component log probs | Train: 3.1459828897024478 | Val: 2.7045637651720607
9-th component log probs | Train: 3.0535385175202463 | Val: 2.766705936055575
KEYWORD NR_SAMPLES:10000 DIM:500 AVG_DIFF:0.2237
0-th component log probs | Train: 3.0426834117181505 | Val: 2.8515241457832725
1-th component log probs | Train: 3.1993912143445637 | Val: 2.6360984950780315
2-th component log probs | Train: 2.992037720573372 | Val: 2.54848918598265
3-th component log probs | Train: 2.9211886681151467 | Val: 2.578602183714653
4-th component log probs | Train: 3.0808330827443746 | Val: 2.617549719275035
5-th component log probs | Train: 3.0671091435016344 | Val: 2.371227314589063
6-th component log probs | Train: 3.172650824533762 | Val: 2.4850734918812836
7-th component log probs | Train: 3.1301281541007606 | Val: 2.5507812400065015
8-th component log probs | Train: 3.1712854588301034 | Val: 2.699279151309007
9-th component log probs | Train: 3.0780347902235454 | Val: 2.7726443997015418
KEYWORD NR_SAMPLES:10000 DIM:512 AVG_DIFF:0.2491
best average differences at 150 dimensions: 0.002494834518972684
2022-01-09 06:09.02 [info     ] Training complete              train_loss=1.1556509733200073
2022-01-09 06:09.02 [info     ] Starting evaluating            dataset=10000
2022-01-09 06:09.04 [info     ] Testing complete               test_loss=0.7679502367973328
{'dataset_size': 10000,
 'end_test_accuracy': 0.7416401505470276,
 'end_test_loss': 0.7679502367973328,
 'end_train_accuracy': 0.7362658977508545,
 'end_train_loss': 1.1556509733200073,
 'end_val_accuracy': 0.7428343892097473,
 'end_val_loss': 0.7710167169570923}
2022-01-09 06:09.05 [info     ] Start Predict                  dataset=30000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 06:09.40 [info     ] Starting training              dataset=20000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
20000
Fitting PCA...
0-th component log probs | Train: 1.3769857331719992 | Val: 1.4000313983311443
1-th component log probs | Train: 1.5605657544474825 | Val: 1.5631600481101526
2-th component log probs | Train: 1.330160999543644 | Val: 1.2926715000820557
3-th component log probs | Train: 1.314295188862297 | Val: 1.2732575173415117
4-th component log probs | Train: 1.3702445430713621 | Val: 1.405543823335968
5-th component log probs | Train: 1.3695600438489615 | Val: 1.3633414450726602
6-th component log probs | Train: 1.4239483474649945 | Val: 1.458747630259495
7-th component log probs | Train: 1.3886242512087128 | Val: 1.4180971179614288
8-th component log probs | Train: 1.5202877662023322 | Val: 1.6225327611716436
9-th component log probs | Train: 1.4697081605612587 | Val: 1.4998649074033383
KEYWORD NR_SAMPLES:20000 DIM:50 AVG_DIFF:0.0018
Fitting PCA...
0-th component log probs | Train: 1.8593513320286656 | Val: 1.8968591791753646
1-th component log probs | Train: 2.056030759641248 | Val: 2.0524441645780156
2-th component log probs | Train: 1.8096215509346734 | Val: 1.7852321558199016
3-th component log probs | Train: 1.7804769936052556 | Val: 1.7451733914019016
4-th component log probs | Train: 1.8581048522371766 | Val: 1.8952016186626024
5-th component log probs | Train: 1.8322231749376499 | Val: 1.8328269501488919
6-th component log probs | Train: 1.9039131144408343 | Val: 1.9390177100062291
7-th component log probs | Train: 1.868570125623645 | Val: 1.893519758158866
8-th component log probs | Train: 2.024168527049057 | Val: 2.1160829178743845
9-th component log probs | Train: 1.9661694130391263 | Val: 2.0058618548773786
KEYWORD NR_SAMPLES:20000 DIM:100 AVG_DIFF:0.0017
Fitting PCA...
0-th component log probs | Train: 2.1105457257594176 | Val: 2.1411347888614247
1-th component log probs | Train: 2.294488409079772 | Val: 2.2717132419042185
2-th component log probs | Train: 2.055664970423805 | Val: 2.0270264886854457
3-th component log probs | Train: 2.0196665707385564 | Val: 1.9769218983140253
4-th component log probs | Train: 2.1130372521237972 | Val: 2.138311697326613
5-th component log probs | Train: 2.074821781374293 | Val: 2.070206230195242
6-th component log probs | Train: 2.1531663647542874 | Val: 2.1778773427276836
7-th component log probs | Train: 2.1178153046170873 | Val: 2.1307367117075904
8-th component log probs | Train: 2.274392901327279 | Val: 2.34562826689948
9-th component log probs | Train: 2.2050351828733294 | Val: 2.2348298470035965
KEYWORD NR_SAMPLES:20000 DIM:150 AVG_DIFF:0.0012
Fitting PCA...
0-th component log probs | Train: 2.2920970219840933 | Val: 2.3074761039887375
1-th component log probs | Train: 2.469451099698503 | Val: 2.4260898462687592
2-th component log probs | Train: 2.2393199945565923 | Val: 2.197492815560754
3-th component log probs | Train: 2.19346890898956 | Val: 2.141876388661272
4-th component log probs | Train: 2.2978077454474097 | Val: 2.306290768464906
5-th component log probs | Train: 2.2507174763349957 | Val: 2.237631311511354
6-th component log probs | Train: 2.3348728736937776 | Val: 2.3446564769562155
7-th component log probs | Train: 2.2959459003446034 | Val: 2.292133050243102
8-th component log probs | Train: 2.4564230902699955 | Val: 2.5015003214400395
9-th component log probs | Train: 2.378275582990606 | Val: 2.3893531159921264
KEYWORD NR_SAMPLES:20000 DIM:200 AVG_DIFF:0.0009
Fitting PCA...
0-th component log probs | Train: 2.4426073948186993 | Val: 2.4422977334700726
1-th component log probs | Train: 2.6158013714810533 | Val: 2.5449953477429688
2-th component log probs | Train: 2.3891816378906623 | Val: 2.3344846839781472
3-th component log probs | Train: 2.338447379214827 | Val: 2.2754247875705143
4-th component log probs | Train: 2.4506630608935627 | Val: 2.445078367711502
5-th component log probs | Train: 2.3977832837832405 | Val: 2.371546158701572
6-th component log probs | Train: 2.488101665474701 | Val: 2.475859354026429
7-th component log probs | Train: 2.444423480587003 | Val: 2.424574297011869
8-th component log probs | Train: 2.60823972492686 | Val: 2.6246556735655755
9-th component log probs | Train: 2.5233033855698808 | Val: 2.514288649237064
KEYWORD NR_SAMPLES:20000 DIM:250 AVG_DIFF:0.0014
Fitting PCA...
0-th component log probs | Train: 2.5754236224850833 | Val: 2.5598297156322403
1-th component log probs | Train: 2.747345975932968 | Val: 2.6447229508947494
2-th component log probs | Train: 2.522189696232642 | Val: 2.4531307319472138
3-th component log probs | Train: 2.4684637716619284 | Val: 2.3915030433197804
4-th component log probs | Train: 2.585902268205754 | Val: 2.5642399261243987
5-th component log probs | Train: 2.528714340509269 | Val: 2.487608441010626
6-th component log probs | Train: 2.6243512460951024 | Val: 2.591791019363115
7-th component log probs | Train: 2.5759435548926226 | Val: 2.5377266313266458
8-th component log probs | Train: 2.744230460106017 | Val: 2.7267159040060673
9-th component log probs | Train: 2.65364997371243 | Val: 2.6167379934275545
KEYWORD NR_SAMPLES:20000 DIM:300 AVG_DIFF:0.0028
Fitting PCA...
0-th component log probs | Train: 2.6965466698546363 | Val: 2.6606808101255623
1-th component log probs | Train: 2.8680074943081806 | Val: 2.7329460671222243
2-th component log probs | Train: 2.6417975543282552 | Val: 2.561157365867776
3-th component log probs | Train: 2.5883963172683653 | Val: 2.499622144102308
4-th component log probs | Train: 2.707178545023092 | Val: 2.665850362175818
5-th component log probs | Train: 2.6489696906986255 | Val: 2.592817025293235
6-th component log probs | Train: 2.7459028705489965 | Val: 2.6913835534753603
7-th component log probs | Train: 2.6968922385456318 | Val: 2.63889970178858
8-th component log probs | Train: 2.8673822608794226 | Val: 2.8140490445258277
9-th component log probs | Train: 2.772572299788129 | Val: 2.711615468919085
KEYWORD NR_SAMPLES:20000 DIM:350 AVG_DIFF:0.0052
Fitting PCA...
0-th component log probs | Train: 2.8069537036072814 | Val: 2.749734133713211
1-th component log probs | Train: 2.97659054413196 | Val: 2.8122029528866817
2-th component log probs | Train: 2.749982562893093 | Val: 2.6552637508691848
3-th component log probs | Train: 2.697811770265144 | Val: 2.597077998304405
4-th component log probs | Train: 2.816650510156779 | Val: 2.754534655773477
5-th component log probs | Train: 2.758684537852627 | Val: 2.6849118208150786
6-th component log probs | Train: 2.8558453490013513 | Val: 2.775832513678039
7-th component log probs | Train: 2.8061381162502426 | Val: 2.726701742553348
8-th component log probs | Train: 2.980165605515053 | Val: 2.8902160585783547
9-th component log probs | Train: 2.882373112574335 | Val: 2.7961860168395947
KEYWORD NR_SAMPLES:20000 DIM:400 AVG_DIFF:0.0087
Fitting PCA...
0-th component log probs | Train: 2.9056099660325074 | Val: 2.8252499686347026
1-th component log probs | Train: 3.0755844582911918 | Val: 2.8782275579874397
2-th component log probs | Train: 2.84706450592003 | Val: 2.7357555773957904
3-th component log probs | Train: 2.796182966524328 | Val: 2.680890606358607
4-th component log probs | Train: 2.915199927738775 | Val: 2.830095186645189
5-th component log probs | Train: 2.8570828641096995 | Val: 2.7649280816701025
6-th component log probs | Train: 2.9546659951493437 | Val: 2.848843583148009
7-th component log probs | Train: 2.9044737789893125 | Val: 2.802708743414163
8-th component log probs | Train: 3.081271677777898 | Val: 2.9522703142836937
9-th component log probs | Train: 2.9816613722395786 | Val: 2.868493237942353
KEYWORD NR_SAMPLES:20000 DIM:450 AVG_DIFF:0.0138
Fitting PCA...
0-th component log probs | Train: 2.9995838712905725 | Val: 2.894397655089941
1-th component log probs | Train: 3.167875422736424 | Val: 2.93696405076342
2-th component log probs | Train: 2.94007797843821 | Val: 2.8107912369750196
3-th component log probs | Train: 2.889811124142503 | Val: 2.7597732008887577
4-th component log probs | Train: 3.0089719563522643 | Val: 2.8985096564931982
5-th component log probs | Train: 2.9503098075657572 | Val: 2.838291457446317
6-th component log probs | Train: 3.0474423347652895 | Val: 2.9119322391048876
7-th component log probs | Train: 2.9979343224787907 | Val: 2.8727884595262125
8-th component log probs | Train: 3.177692394181279 | Val: 3.0062285743765194
9-th component log probs | Train: 3.0755483426772026 | Val: 2.933346443730293
KEYWORD NR_SAMPLES:20000 DIM:500 AVG_DIFF:0.0206
0-th component log probs | Train: 3.0227673088711775 | Val: 2.912231219582084
1-th component log probs | Train: 3.1896432737434166 | Val: 2.950661942836157
2-th component log probs | Train: 2.963554264957293 | Val: 2.829365459411627
3-th component log probs | Train: 2.9131305278409636 | Val: 2.778829084011504
4-th component log probs | Train: 3.032420815053945 | Val: 2.916941963999672
5-th component log probs | Train: 2.973263684899051 | Val: 2.856498788455944
6-th component log probs | Train: 3.0702117790856756 | Val: 2.927605330384524
7-th component log probs | Train: 3.0205884510146195 | Val: 2.8897039139360046
8-th component log probs | Train: 3.2012286991574093 | Val: 3.0201480525355557
9-th component log probs | Train: 3.0983950152906545 | Val: 2.9488607708443855
KEYWORD NR_SAMPLES:20000 DIM:512 AVG_DIFF:0.0225
best average differences at 200 dimensions: 0.000903615013423629
2022-01-09 06:52.22 [info     ] Training complete              train_loss=0.9367741346359253
2022-01-09 06:52.22 [info     ] Starting evaluating            dataset=10000
2022-01-09 06:52.24 [info     ] Testing complete               test_loss=0.5642709732055664
{'dataset_size': 20000,
 'end_test_accuracy': 0.8128980994224548,
 'end_test_loss': 0.5642709732055664,
 'end_train_accuracy': 0.7936801314353943,
 'end_train_loss': 0.9367741346359253,
 'end_val_accuracy': 0.8171775341033936,
 'end_val_loss': 0.5595975518226624}
2022-01-09 06:52.24 [info     ] Start Predict                  dataset=20000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 06:53.00 [info     ] Starting training              dataset=30000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
30000
Fitting PCA...
0-th component log probs | Train: 1.4400988617091726 | Val: 1.4265415507121506
1-th component log probs | Train: 1.5660964468714396 | Val: 1.5595773664134052
2-th component log probs | Train: 1.3749889123264336 | Val: 1.3246883551873294
3-th component log probs | Train: 1.3407602437449084 | Val: 1.2772793598602805
4-th component log probs | Train: 1.4243614871203831 | Val: 1.409833866354318
5-th component log probs | Train: 1.4046083223507009 | Val: 1.3471679489437798
6-th component log probs | Train: 1.4821587450425968 | Val: 1.496737471217797
7-th component log probs | Train: 1.4619481254996034 | Val: 1.4229995366248505
8-th component log probs | Train: 1.582372796795084 | Val: 1.6941720631069146
9-th component log probs | Train: 1.4840197800748094 | Val: 1.505594836958104
KEYWORD NR_SAMPLES:30000 DIM:50 AVG_DIFF:0.0025
Fitting PCA...
0-th component log probs | Train: 1.9633389344207695 | Val: 1.9529660190973601
1-th component log probs | Train: 2.1072586612966018 | Val: 2.108642833132317
2-th component log probs | Train: 1.8997856355277287 | Val: 1.860269534098755
3-th component log probs | Train: 1.844862067189874 | Val: 1.7885678629779993
4-th component log probs | Train: 1.9554892184695392 | Val: 1.9525139186353198
5-th component log probs | Train: 1.916795910256923 | Val: 1.8636185531370713
6-th component log probs | Train: 2.0164786591623645 | Val: 2.034828480523875
7-th component log probs | Train: 1.9952391441385506 | Val: 1.9497451618371326
8-th component log probs | Train: 2.112537838881067 | Val: 2.2107149016000136
9-th component log probs | Train: 2.024744304673827 | Val: 2.0663045072734776
KEYWORD NR_SAMPLES:30000 DIM:100 AVG_DIFF:0.0021
Fitting PCA...
0-th component log probs | Train: 2.2256896313906918 | Val: 2.2135864230363036
1-th component log probs | Train: 2.3582676659278627 | Val: 2.346719017189185
2-th component log probs | Train: 2.164242305759546 | Val: 2.124918437615745
3-th component log probs | Train: 2.096220393895204 | Val: 2.0420001874412446
4-th component log probs | Train: 2.2245448066051856 | Val: 2.2153133520430366
5-th component log probs | Train: 2.1703823565835987 | Val: 2.115674578540803
6-th component log probs | Train: 2.2811477060347993 | Val: 2.2972219533202782
7-th component log probs | Train: 2.2520737432761906 | Val: 2.204073242739954
8-th component log probs | Train: 2.370149760675922 | Val: 2.4494801853261374
9-th component log probs | Train: 2.276693737463794 | Val: 2.311753295504733
KEYWORD NR_SAMPLES:30000 DIM:150 AVG_DIFF:0.0018
Fitting PCA...
0-th component log probs | Train: 2.4077928203133125 | Val: 2.3873201236618797
1-th component log probs | Train: 2.5300012706682136 | Val: 2.507770029883072
2-th component log probs | Train: 2.3510211870074946 | Val: 2.30565692570827
3-th component log probs | Train: 2.2722510797529787 | Val: 2.213145144645705
4-th component log probs | Train: 2.410506979076743 | Val: 2.39393777150406
5-th component log probs | Train: 2.3469570668913615 | Val: 2.2913900556824447
6-th component log probs | Train: 2.467792236349954 | Val: 2.47139780077363
7-th component log probs | Train: 2.4269687350211084 | Val: 2.3723981923585793
8-th component log probs | Train: 2.5469137017117105 | Val: 2.611060561225052
9-th component log probs | Train: 2.4477350587541093 | Val: 2.470417692560839
KEYWORD NR_SAMPLES:30000 DIM:200 AVG_DIFF:0.0017
Fitting PCA...
0-th component log probs | Train: 2.555570467554353 | Val: 2.526876501793017
1-th component log probs | Train: 2.6689410704519907 | Val: 2.6344692061464796
2-th component log probs | Train: 2.5000571591737324 | Val: 2.448345424993132
3-th component log probs | Train: 2.4155911659409415 | Val: 2.3518025567845413
4-th component log probs | Train: 2.560321752415517 | Val: 2.535208440574512
5-th component log probs | Train: 2.4898600999120584 | Val: 2.430500686162515
6-th component log probs | Train: 2.616615048468148 | Val: 2.607699131801744
7-th component log probs | Train: 2.5691613872039647 | Val: 2.504386379590564
8-th component log probs | Train: 2.691168080319457 | Val: 2.740738760062583
9-th component log probs | Train: 2.5849915351744404 | Val: 2.5981580855054722
KEYWORD NR_SAMPLES:30000 DIM:250 AVG_DIFF:0.0020
Fitting PCA...
0-th component log probs | Train: 2.684464067927393 | Val: 2.646331155020729
1-th component log probs | Train: 2.7949103841795684 | Val: 2.742590213212194
2-th component log probs | Train: 2.630781660441089 | Val: 2.5704687835415396
3-th component log probs | Train: 2.542139310117417 | Val: 2.471934290450803
4-th component log probs | Train: 2.6907744206322772 | Val: 2.6544603601137053
5-th component log probs | Train: 2.617237551387938 | Val: 2.5474809934300797
6-th component log probs | Train: 2.747943579660303 | Val: 2.72548319712588
7-th component log probs | Train: 2.6969799795325256 | Val: 2.6178608047730254
8-th component log probs | Train: 2.8173921795000325 | Val: 2.8509208867055453
9-th component log probs | Train: 2.7087976345816434 | Val: 2.7101956002823466
KEYWORD NR_SAMPLES:30000 DIM:300 AVG_DIFF:0.0027
Fitting PCA...
0-th component log probs | Train: 2.7994819888367264 | Val: 2.75216352979154
1-th component log probs | Train: 2.9083567863036786 | Val: 2.839979078785901
2-th component log probs | Train: 2.74683165464061 | Val: 2.6793799505449742
3-th component log probs | Train: 2.6576629235368388 | Val: 2.577771045907197
4-th component log probs | Train: 2.8053761853298274 | Val: 2.7593403885277503
5-th component log probs | Train: 2.7321109083630457 | Val: 2.6523642608354674
6-th component log probs | Train: 2.864504481790102 | Val: 2.8265389086124446
7-th component log probs | Train: 2.8114099777805195 | Val: 2.719219603615769
8-th component log probs | Train: 2.932713862317905 | Val: 2.9502051805201
9-th component log probs | Train: 2.8207004028625104 | Val: 2.8096896952814565
KEYWORD NR_SAMPLES:30000 DIM:350 AVG_DIFF:0.0037
Fitting PCA...
0-th component log probs | Train: 2.9038469930179107 | Val: 2.8462021911039685
1-th component log probs | Train: 3.011207050903365 | Val: 2.9253648083198973
2-th component log probs | Train: 2.85203821893995 | Val: 2.7750652577400365
3-th component log probs | Train: 2.762676655703973 | Val: 2.6742606520270584
4-th component log probs | Train: 2.910129108000831 | Val: 2.851750455006038
5-th component log probs | Train: 2.836775176980517 | Val: 2.7476309852963348
6-th component log probs | Train: 2.968810030984645 | Val: 2.9174146548341278
7-th component log probs | Train: 2.916528294065691 | Val: 2.812295083197846
8-th component log probs | Train: 3.036354027711425 | Val: 3.0354920957375082
9-th component log probs | Train: 2.9220028067047483 | Val: 2.895249263469061
KEYWORD NR_SAMPLES:30000 DIM:400 AVG_DIFF:0.0050
Fitting PCA...
0-th component log probs | Train: 2.9978541833874184 | Val: 2.9302571911768087
1-th component log probs | Train: 3.104109541843636 | Val: 2.9994798003985066
2-th component log probs | Train: 2.9466877205713122 | Val: 2.860655293963877
3-th component log probs | Train: 2.8569909411643897 | Val: 2.759510798405209
4-th component log probs | Train: 3.003941415634763 | Val: 2.9326963560388477
5-th component log probs | Train: 2.931092520534625 | Val: 2.830801885772928
6-th component log probs | Train: 3.0629026052057315 | Val: 2.9978769709581563
7-th component log probs | Train: 3.0104930932986784 | Val: 2.8951992733396996
8-th component log probs | Train: 3.130290772201313 | Val: 3.110736462786735
9-th component log probs | Train: 3.014907407734472 | Val: 2.9742799643880766
KEYWORD NR_SAMPLES:30000 DIM:450 AVG_DIFF:0.0067
Fitting PCA...
0-th component log probs | Train: 3.088675717137118 | Val: 3.0110924314904555
1-th component log probs | Train: 3.192390330813774 | Val: 3.067971967797604
2-th component log probs | Train: 3.0381226074918755 | Val: 2.94308112808206
3-th component log probs | Train: 2.9494515103110452 | Val: 2.843035942379238
4-th component log probs | Train: 3.0939159044766638 | Val: 3.0101029295708503
5-th component log probs | Train: 3.0214910586395036 | Val: 2.9093273182233625
6-th component log probs | Train: 3.151864669323461 | Val: 3.072101717088327
7-th component log probs | Train: 3.0994658915788342 | Val: 2.9722465439077164
8-th component log probs | Train: 3.2213337725859517 | Val: 3.1846110871752416
9-th component log probs | Train: 3.1034183552445653 | Val: 3.0467146214283614
KEYWORD NR_SAMPLES:30000 DIM:500 AVG_DIFF:0.0089
0-th component log probs | Train: 3.111382051514852 | Val: 3.031540356233827
1-th component log probs | Train: 3.213342938925434 | Val: 3.0853131155573132
2-th component log probs | Train: 3.0615006748962466 | Val: 2.9638578455125986
3-th component log probs | Train: 2.972548285144254 | Val: 2.8642787708613437
4-th component log probs | Train: 3.1162393605109986 | Val: 3.0290905625400715
5-th component log probs | Train: 3.0436964488592673 | Val: 2.9295834599396002
6-th component log probs | Train: 3.1737758667737768 | Val: 3.0890968043435927
7-th component log probs | Train: 3.1213274320032975 | Val: 2.992018648223413
8-th component log probs | Train: 3.244161705900682 | Val: 3.2026676889081878
9-th component log probs | Train: 3.124788917890834 | Val: 3.0644280711732383
KEYWORD NR_SAMPLES:30000 DIM:512 AVG_DIFF:0.0094
best average differences at 200 dimensions: 0.001744728420056734
2022-01-09 07:49.48 [info     ] Training complete              train_loss=0.8051874041557312
2022-01-09 07:49.48 [info     ] Starting evaluating            dataset=10000
2022-01-09 07:49.51 [info     ] Testing complete               test_loss=0.49648794531822205
{'dataset_size': 30000,
 'end_test_accuracy': 0.8322054147720337,
 'end_test_loss': 0.49648794531822205,
 'end_train_accuracy': 0.8333998918533325,
 'end_train_loss': 0.8051874041557312,
 'end_val_accuracy': 0.8391719460487366,
 'end_val_loss': 0.4831371009349823}
2022-01-09 07:49.51 [info     ] Start Predict                  dataset=10000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 07:50.23 [info     ] Starting training              dataset=40000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
40000
Fitting PCA...
0-th component log probs | Train: 1.5158415301243484 | Val: 1.4677737122182972
1-th component log probs | Train: 1.6126880583221026 | Val: 1.513518448403299
2-th component log probs | Train: 1.4437426283002546 | Val: 1.3939158879512334
3-th component log probs | Train: 1.380027100544595 | Val: 1.325199715379525
4-th component log probs | Train: 1.5192264564847238 | Val: 1.4736817368470139
5-th component log probs | Train: 1.4508084106161427 | Val: 1.3954024786765953
6-th component log probs | Train: 1.5938649225335881 | Val: 1.5241217663637237
7-th component log probs | Train: 1.5038917777765959 | Val: 1.4476831130260586
8-th component log probs | Train: 1.5916463820488782 | Val: 1.5435295826848041
9-th component log probs | Train: 1.52681733953587 | Val: 1.4917748007591365
KEYWORD NR_SAMPLES:40000 DIM:50 AVG_DIFF:0.0034
Fitting PCA...
0-th component log probs | Train: 2.060193027887549 | Val: 2.011141175673394
1-th component log probs | Train: 2.184842360626634 | Val: 2.0688181795894476
2-th component log probs | Train: 1.9999811225491304 | Val: 1.945993770175107
3-th component log probs | Train: 1.9095457089357208 | Val: 1.8545802437951977
4-th component log probs | Train: 2.0691834490197962 | Val: 2.019729508396316
5-th component log probs | Train: 1.9938048172971947 | Val: 1.9531923817908814
6-th component log probs | Train: 2.1662146000237517 | Val: 2.087095094157068
7-th component log probs | Train: 2.0551784429420596 | Val: 1.999165115454315
8-th component log probs | Train: 2.1450439591255877 | Val: 2.079503692759699
9-th component log probs | Train: 2.092360928986343 | Val: 2.0462146650077218
KEYWORD NR_SAMPLES:40000 DIM:100 AVG_DIFF:0.0042
Fitting PCA...
0-th component log probs | Train: 2.3356918041829386 | Val: 2.2822372957492174
1-th component log probs | Train: 2.4548864895172766 | Val: 2.3279517438313992
2-th component log probs | Train: 2.287106989082969 | Val: 2.22051628660875
3-th component log probs | Train: 2.1797546166612687 | Val: 2.1193671775495453
4-th component log probs | Train: 2.3550414897654055 | Val: 2.2904460501908304
5-th component log probs | Train: 2.2642516528597456 | Val: 2.218136411861715
6-th component log probs | Train: 2.4526276868153394 | Val: 2.3521119733582547
7-th component log probs | Train: 2.3330990059437275 | Val: 2.2634104383969538
8-th component log probs | Train: 2.412426751112974 | Val: 2.334433803579251
9-th component log probs | Train: 2.362829232218977 | Val: 2.306140758526477
KEYWORD NR_SAMPLES:40000 DIM:150 AVG_DIFF:0.0058
Fitting PCA...
0-th component log probs | Train: 2.524465831981253 | Val: 2.4680232776381357
1-th component log probs | Train: 2.632186781832006 | Val: 2.5008208547536652
2-th component log probs | Train: 2.4800889982693124 | Val: 2.4035392398962894
3-th component log probs | Train: 2.3657278655203524 | Val: 2.2998644294917865
4-th component log probs | Train: 2.547014609074575 | Val: 2.4717315545984526
5-th component log probs | Train: 2.448229598996267 | Val: 2.3990709514500788
6-th component log probs | Train: 2.6423831004228355 | Val: 2.53088369712153
7-th component log probs | Train: 2.5164836466530307 | Val: 2.445377378960668
8-th component log probs | Train: 2.5952867089727722 | Val: 2.5134459479521505
9-th component log probs | Train: 2.5395711449589546 | Val: 2.4799582858112674
KEYWORD NR_SAMPLES:40000 DIM:200 AVG_DIFF:0.0066
Fitting PCA...
0-th component log probs | Train: 2.6781940810022067 | Val: 2.6125789649109774
1-th component log probs | Train: 2.7725200767027873 | Val: 2.631380961161615
2-th component log probs | Train: 2.635728156107152 | Val: 2.5464059213977843
3-th component log probs | Train: 2.5160253013419025 | Val: 2.4398980844079095
4-th component log probs | Train: 2.7008564428535564 | Val: 2.6106199831353973
5-th component log probs | Train: 2.5950575283727777 | Val: 2.5350524716669685
6-th component log probs | Train: 2.793861817378974 | Val: 2.6693316297739185
7-th component log probs | Train: 2.6643052145872357 | Val: 2.583477668787659
8-th component log probs | Train: 2.7414668726184397 | Val: 2.6501477903099993
9-th component log probs | Train: 2.6809788523312736 | Val: 2.615943812340998
KEYWORD NR_SAMPLES:40000 DIM:250 AVG_DIFF:0.0084
Fitting PCA...
0-th component log probs | Train: 2.809079760612421 | Val: 2.737239034633795
1-th component log probs | Train: 2.8952895779745895 | Val: 2.7448038987464387
2-th component log probs | Train: 2.766222877222125 | Val: 2.6703532402918717
3-th component log probs | Train: 2.644899529339777 | Val: 2.561743759493343
4-th component log probs | Train: 2.8311598979126043 | Val: 2.7311535191424836
5-th component log probs | Train: 2.721904361683728 | Val: 2.651841353615584
6-th component log probs | Train: 2.9220019442954834 | Val: 2.78946020338711
7-th component log probs | Train: 2.7902709712292704 | Val: 2.7001372598605755
8-th component log probs | Train: 2.8675098673856074 | Val: 2.7690619815911486
9-th component log probs | Train: 2.8042104150654144 | Val: 2.7329331699345083
KEYWORD NR_SAMPLES:40000 DIM:300 AVG_DIFF:0.0099
Fitting PCA...
0-th component log probs | Train: 2.924503002735454 | Val: 2.8453754677303658
1-th component log probs | Train: 3.0055812671971496 | Val: 2.845909307943338
2-th component log probs | Train: 2.883706340484299 | Val: 2.7807262922109675
3-th component log probs | Train: 2.7615521788358715 | Val: 2.6695568104729634
4-th component log probs | Train: 2.94582295976159 | Val: 2.835974421270074
5-th component log probs | Train: 2.83543464373804 | Val: 2.757100044453652
6-th component log probs | Train: 3.0349178887514983 | Val: 2.8933026658482026
7-th component log probs | Train: 2.90387877273808 | Val: 2.8054258187562198
8-th component log probs | Train: 2.978959361980898 | Val: 2.8738969480073964
9-th component log probs | Train: 2.9154524278620286 | Val: 2.8360058439286857
KEYWORD NR_SAMPLES:40000 DIM:350 AVG_DIFF:0.0116
Fitting PCA...
0-th component log probs | Train: 3.0274190739663784 | Val: 2.9438775247218665
1-th component log probs | Train: 3.1063713671456585 | Val: 2.938618437809474
2-th component log probs | Train: 2.988459183910368 | Val: 2.878062911285407
3-th component log probs | Train: 2.866845903298485 | Val: 2.767731125319286
4-th component log probs | Train: 3.0502170636475094 | Val: 2.932040669784912
5-th component log probs | Train: 2.938958893272554 | Val: 2.851694816541673
6-th component log probs | Train: 3.136331860979443 | Val: 2.986903632149581
7-th component log probs | Train: 3.0064194936678015 | Val: 2.8987270430420478
8-th component log probs | Train: 3.0800295408234417 | Val: 2.96878158628099
9-th component log probs | Train: 3.017359072712024 | Val: 2.9314021813502404
KEYWORD NR_SAMPLES:40000 DIM:400 AVG_DIFF:0.0132
Fitting PCA...
0-th component log probs | Train: 3.1212803788556562 | Val: 3.0305955820871393
1-th component log probs | Train: 3.198333526385283 | Val: 3.0205236970819294
2-th component log probs | Train: 3.0847001000563843 | Val: 2.963742390655779
3-th component log probs | Train: 2.9630243502198863 | Val: 2.8561303868840886
4-th component log probs | Train: 3.1444049353002423 | Val: 3.0152624391901344
5-th component log probs | Train: 3.0327815886788447 | Val: 2.9368132197384322
6-th component log probs | Train: 3.2285427181245656 | Val: 3.0680080481925374
7-th component log probs | Train: 3.0999443009977163 | Val: 2.9831248299228683
8-th component log probs | Train: 3.1714770028531385 | Val: 3.0541167863538963
9-th component log probs | Train: 3.11058385846468 | Val: 3.0154082452741524
KEYWORD NR_SAMPLES:40000 DIM:450 AVG_DIFF:0.0154
Fitting PCA...
0-th component log probs | Train: 3.2133497279710195 | Val: 3.116494746131019
1-th component log probs | Train: 3.2856430559795506 | Val: 3.103052139589092
2-th component log probs | Train: 3.1780392624943103 | Val: 3.0488426349943722
3-th component log probs | Train: 3.0566091170940513 | Val: 2.941778040139789
4-th component log probs | Train: 3.2353402061600165 | Val: 3.099081889600718
5-th component log probs | Train: 3.1240723063714677 | Val: 3.0205410053556694
6-th component log probs | Train: 3.3164518104974516 | Val: 3.147213067027947
7-th component log probs | Train: 3.189713645981577 | Val: 3.06529091661113
8-th component log probs | Train: 3.261138872962105 | Val: 3.139074190987985
9-th component log probs | Train: 3.1999133351032945 | Val: 3.098997311818711
KEYWORD NR_SAMPLES:40000 DIM:500 AVG_DIFF:0.0171
0-th component log probs | Train: 3.238695432985551 | Val: 3.1404607135482205
1-th component log probs | Train: 3.307991942505769 | Val: 3.1255576965564487
2-th component log probs | Train: 3.203250194864464 | Val: 3.0720895517550697
3-th component log probs | Train: 3.0817521997169033 | Val: 2.9653097799440387
4-th component log probs | Train: 3.2596660520343748 | Val: 3.1225317013558866
5-th component log probs | Train: 3.148619851895282 | Val: 3.0431679460817285
6-th component log probs | Train: 3.3397881704813965 | Val: 3.1692177669060126
7-th component log probs | Train: 3.2135015733274965 | Val: 3.087884144127599
8-th component log probs | Train: 3.285500749773792 | Val: 3.1628766759613964
9-th component log probs | Train: 3.2234375297577116 | Val: 3.1215443799985447
KEYWORD NR_SAMPLES:40000 DIM:512 AVG_DIFF:0.0174
best average differences at 50 dimensions: 0.003434473937904569
2022-01-09 09:04.39 [info     ] Training complete              train_loss=0.6811107993125916
2022-01-09 09:04.39 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:04.41 [info     ] Testing complete               test_loss=0.4676226079463959
{'dataset_size': 40000,
 'end_test_accuracy': 0.8449442386627197,
 'end_test_loss': 0.4676226079463959,
 'end_train_accuracy': 0.866225004196167,
 'end_train_loss': 0.6811107993125916,
 'end_val_accuracy': 0.847034215927124,
 'end_val_loss': 0.45544394850730896}

wandb: Waiting for W&B process to finish, PID 31219... (success).
wandb: - 0.58MB of 0.58MB uploaded (0.00MB deduped)wandb: \ 0.58MB of 0.58MB uploaded (0.00MB deduped)wandb: | 0.58MB of 0.58MB uploaded (0.00MB deduped)wandb: / 0.58MB of 0.97MB uploaded (0.00MB deduped)wandb: - 0.58MB of 0.97MB uploaded (0.00MB deduped)wandb: \ 0.58MB of 0.97MB uploaded (0.00MB deduped)wandb: | 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: / 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: - 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: \ 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: | 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: / 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb: - 0.97MB of 0.97MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:           accuracy_0 
wandb:           accuracy_1 
wandb:          accuracy_10 
wandb:          accuracy_11 
wandb:          accuracy_12 
wandb:          accuracy_13 
wandb:           accuracy_2 
wandb:           accuracy_3 
wandb:           accuracy_4 
wandb:           accuracy_5 
wandb:           accuracy_6 
wandb:           accuracy_7 
wandb:           accuracy_8 
wandb:           accuracy_9 
wandb:              class_0 
wandb:              class_1 
wandb:              class_2 
wandb:              class_3 
wandb:              class_4 
wandb:              class_5 
wandb:              class_6 
wandb:              class_7 
wandb:              class_8 
wandb:              class_9 
wandb:         dataset_size 
wandb:    end_test_accuracy 
wandb:        end_test_loss 
wandb:   end_train_accuracy 
wandb:       end_train_loss 
wandb:     end_val_accuracy 
wandb:         end_val_loss 
wandb:                epoch 
wandb:               loss_0 
wandb:               loss_1 
wandb:              loss_10 
wandb:              loss_11 
wandb:              loss_12 
wandb:              loss_13 
wandb:               loss_2 
wandb:               loss_3 
wandb:               loss_4 
wandb:               loss_5 
wandb:               loss_6 
wandb:               loss_7 
wandb:               loss_8 
wandb:               loss_9 
wandb:                 lr_0 
wandb:                 lr_1 
wandb:                lr_10 
wandb:                lr_11 
wandb:                lr_12 
wandb:                lr_13 
wandb:                 lr_2 
wandb:                 lr_3 
wandb:                 lr_4 
wandb:                 lr_5 
wandb:                 lr_6 
wandb:                 lr_7 
wandb:                 lr_8 
wandb:                 lr_9 
wandb:       val_accuracy_0 
wandb:       val_accuracy_1 
wandb:      val_accuracy_10 
wandb:      val_accuracy_11 
wandb:      val_accuracy_12 
wandb:      val_accuracy_13 
wandb:       val_accuracy_2 
wandb:       val_accuracy_3 
wandb:       val_accuracy_4 
wandb:       val_accuracy_5 
wandb:       val_accuracy_6 
wandb:       val_accuracy_7 
wandb:       val_accuracy_8 
wandb:       val_accuracy_9 
wandb:           val_loss_0 
wandb:           val_loss_1 
wandb:          val_loss_10 
wandb:          val_loss_11 
wandb:          val_loss_12 
wandb:          val_loss_13 
wandb:           val_loss_2 
wandb:           val_loss_3 
wandb:           val_loss_4 
wandb:           val_loss_5 
wandb:           val_loss_6 
wandb:           val_loss_7 
wandb:           val_loss_8 
wandb:           val_loss_9 
wandb: 
wandb: Run summary:
wandb:           accuracy_0 0.63281
wandb:           accuracy_1 0.42969
wandb:          accuracy_10 0.73627
wandb:          accuracy_11 0.79368
wandb:          accuracy_12 0.8334
wandb:          accuracy_13 0.86623
wandb:           accuracy_2 0.72768
wandb:           accuracy_3 0.57187
wandb:           accuracy_4 0.76082
wandb:           accuracy_5 0.78164
wandb:           accuracy_6 0.71289
wandb:           accuracy_7 0.7309
wandb:           accuracy_8 0.74773
wandb:           accuracy_9 0.73663
wandb:              class_0 0.10063
wandb:              class_1 0.10028
wandb:              class_2 0.10005
wandb:              class_3 0.09982
wandb:              class_4 0.10047
wandb:              class_5 0.09863
wandb:              class_6 0.1001
wandb:              class_7 0.09942
wandb:              class_8 0.10007
wandb:              class_9 0.10053
wandb:         dataset_size 40000
wandb:    end_test_accuracy 0.84494
wandb:        end_test_loss 0.46762
wandb:   end_train_accuracy 0.86623
wandb:       end_train_loss 0.68111
wandb:     end_val_accuracy 0.84703
wandb:         end_val_loss 0.45544
wandb:                epoch 87
wandb:               loss_0 1.9036
wandb:               loss_1 2.56639
wandb:              loss_10 1.15565
wandb:              loss_11 0.93677
wandb:              loss_12 0.80519
wandb:              loss_13 0.68111
wandb:               loss_2 1.62966
wandb:               loss_3 2.07654
wandb:               loss_4 1.5029
wandb:               loss_5 1.33938
wandb:               loss_6 1.33596
wandb:               loss_7 1.23457
wandb:               loss_8 1.16487
wandb:               loss_9 1.19228
wandb:                 lr_0 0.001
wandb:                 lr_1 0.001
wandb:                lr_10 1e-05
wandb:                lr_11 0.0
wandb:                lr_12 1e-05
wandb:                lr_13 1e-05
wandb:                 lr_2 0.0001
wandb:                 lr_3 0.001
wandb:                 lr_4 0.0001
wandb:                 lr_5 0.0001
wandb:                 lr_6 0.0001
wandb:                 lr_7 0.0001
wandb:                 lr_8 0.0001
wandb:                 lr_9 0.0001
wandb:       val_accuracy_0 0.20631
wandb:       val_accuracy_1 0.23836
wandb:      val_accuracy_10 0.74283
wandb:      val_accuracy_11 0.81718
wandb:      val_accuracy_12 0.83917
wandb:      val_accuracy_13 0.84703
wandb:       val_accuracy_2 0.33987
wandb:       val_accuracy_3 0.35997
wandb:       val_accuracy_4 0.41262
wandb:       val_accuracy_5 0.43342
wandb:       val_accuracy_6 0.51095
wandb:       val_accuracy_7 0.63157
wandb:       val_accuracy_8 0.68073
wandb:       val_accuracy_9 0.71547
wandb:           val_loss_0 4.14204
wandb:           val_loss_1 2.45651
wandb:          val_loss_10 0.77102
wandb:          val_loss_11 0.5596
wandb:          val_loss_12 0.48314
wandb:          val_loss_13 0.45544
wandb:           val_loss_2 2.2456
wandb:           val_loss_3 2.12282
wandb:           val_loss_4 1.88183
wandb:           val_loss_5 1.97674
wandb:           val_loss_6 1.56014
wandb:           val_loss_7 1.13946
wandb:           val_loss_8 0.99717
wandb:           val_loss_9 0.86897
wandb: 
wandb: Synced 6 W&B file(s), 28 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced cifar10_hu_greedy_l2_run2: https://wandb.ai/fanconic/hidden_uncertainty/runs/17v60iqm
wandb: Find logs at: ./wandb/run-20220109_050323-17v60iqm/logs/debug.log
wandb: 
wandb: Tracking run with wandb version 0.12.7
wandb: Syncing run cifar10_hu_greedy_l2_run3
wandb:  View project at https://wandb.ai/fanconic/hidden_uncertainty
wandb:  View run at https://wandb.ai/fanconic/hidden_uncertainty/runs/giq2dm7j
wandb: Run data is saved locally in /scratch_net/airfox/fanconic/semproj2/hidden_uncertainty_active_learning/wandb/run-20220109_090441-giq2dm7j
wandb: Run `wandb offline` to turn off syncing.

Cuda is available:  True
Files already downloaded and verified
Files already downloaded and verified
2022-01-09 09:05.09 [info     ] Starting training              dataset=100 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
100
Fitting PCA...
0-th component log probs | Train: 4.966373350153426 | Val: -2214.9641783246975
1-th component log probs | Train: 5.042662013424481 | Val: -3291.249455507799
2-th component log probs | Train: 5.008639677500124 | Val: -2257.3345817838667
3-th component log probs | Train: 4.9814874584023325 | Val: -2212.9534999364264
4-th component log probs | Train: 5.002704638444106 | Val: -1796.8599321831136
5-th component log probs | Train: 5.008087458069847 | Val: -2378.497802404533
6-th component log probs | Train: 5.0001598325632655 | Val: -1718.4279944961943
7-th component log probs | Train: 4.9983495336492325 | Val: -2883.6678278494564
8-th component log probs | Train: 4.998193887460987 | Val: -1674.8240922492853
9-th component log probs | Train: 4.998009253139348 | Val: -2725.41692494203
KEYWORD NR_SAMPLES:100 DIM:50 AVG_DIFF:5635044.0641
0-th component log probs | Train: 30.147011349870848 | Val: -1641.182991715084
1-th component log probs | Train: 30.176159223398816 | Val: -2222.948543456249
2-th component log probs | Train: 30.162768168892136 | Val: -1622.566372638851
3-th component log probs | Train: 30.152022187295085 | Val: -1609.167663579537
4-th component log probs | Train: 30.16059797507605 | Val: -1290.5040938140833
5-th component log probs | Train: 30.162676386981627 | Val: -1671.8482841040784
6-th component log probs | Train: 30.159964979055122 | Val: -1298.7867821839045
7-th component log probs | Train: 30.15879073889486 | Val: -1981.0643036823885
8-th component log probs | Train: 30.158097576384638 | Val: -1435.0155434662054
9-th component log probs | Train: 30.159904387152046 | Val: -1965.535601179056
KEYWORD NR_SAMPLES:100 DIM:100 AVG_DIFF:2987044.6229
best average differences at 100 dimensions: 2987044.6229430065
2022-01-09 09:06.07 [info     ] Training complete              train_loss=1.860182285308838
2022-01-09 09:06.07 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:06.09 [info     ] Testing complete               test_loss=2.283449411392212
{'dataset_size': 100,
 'end_test_accuracy': 0.12778662145137787,
 'end_test_loss': 2.283449411392212,
 'end_train_accuracy': 0.7126736044883728,
 'end_train_loss': 1.860182285308838,
 'end_val_accuracy': 0.22233280539512634,
 'end_val_loss': 3.2249832153320312}
2022-01-09 09:06.09 [info     ] Start Predict                  dataset=39900
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:06.37 [info     ] Starting training              dataset=200 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
200
Fitting PCA...
0-th component log probs | Train: 4.206281280945619 | Val: -383.5655681148716
1-th component log probs | Train: 3.9175345430367856 | Val: -606.3001711561686
2-th component log probs | Train: 4.08862643262781 | Val: -531.3767810655756
3-th component log probs | Train: 4.088278469616673 | Val: -1013.2183073417378
4-th component log probs | Train: 4.7225388703412365 | Val: -694.784617516094
5-th component log probs | Train: 3.7618190273328853 | Val: -522.6099999062086
6-th component log probs | Train: 3.698981631867248 | Val: -276.6635630708263
7-th component log probs | Train: 4.226002715360245 | Val: -909.3062637967994
8-th component log probs | Train: 4.570801087093506 | Val: -535.1751224401348
9-th component log probs | Train: 4.654421260513506 | Val: -938.2832752774782
KEYWORD NR_SAMPLES:200 DIM:50 AVG_DIFF:470434.7621
Fitting PCA...
0-th component log probs | Train: 5.0700639503460065 | Val: -272.2550728440744
1-th component log probs | Train: 4.917364958898849 | Val: -468.9135410945019
2-th component log probs | Train: 5.016474372786767 | Val: -354.06578988731104
3-th component log probs | Train: 5.015723118608393 | Val: -675.1375394417248
4-th component log probs | Train: 5.346424859504035 | Val: -416.52768652487646
5-th component log probs | Train: 4.83727265665548 | Val: -432.65775072286493
6-th component log probs | Train: 4.800483934998477 | Val: -242.20686556087446
7-th component log probs | Train: 5.0821456314418745 | Val: -633.6421595259785
8-th component log probs | Train: 5.2544712885784275 | Val: -360.307024246933
9-th component log probs | Train: 5.30605401511408 | Val: -600.8041573100484
KEYWORD NR_SAMPLES:200 DIM:100 AVG_DIFF:223233.9317
Fitting PCA...
0-th component log probs | Train: 5.368463213361073 | Val: -209.60711227260214
1-th component log probs | Train: 5.267358955191607 | Val: -351.79687920202224
2-th component log probs | Train: 5.3330980127990575 | Val: -265.55722134757053
3-th component log probs | Train: 5.3367141180755855 | Val: -490.8419072687024
4-th component log probs | Train: 5.558746662248664 | Val: -303.71961369289363
5-th component log probs | Train: 5.212530173424942 | Val: -334.7537196941292
6-th component log probs | Train: 5.183329043187189 | Val: -202.01085620231956
7-th component log probs | Train: 5.379974355554185 | Val: -469.1992827413711
8-th component log probs | Train: 5.490181933677499 | Val: -271.5906428692637
9-th component log probs | Train: 5.531228807810556 | Val: -436.06417037639795
KEYWORD NR_SAMPLES:200 DIM:150 AVG_DIFF:124444.9495
0-th component log probs | Train: 14.86381528794817 | Val: -190.3396690321925
1-th component log probs | Train: 14.788776547395672 | Val: -323.1934201786503
2-th component log probs | Train: 14.836135413037075 | Val: -238.92453043793117
3-th component log probs | Train: 14.841659151744022 | Val: -430.91165712936544
4-th component log probs | Train: 15.008335195615437 | Val: -263.24059426584074
5-th component log probs | Train: 14.74692895166185 | Val: -315.6531735892557
6-th component log probs | Train: 14.71840381459057 | Val: -203.85542436512287
7-th component log probs | Train: 14.874110623101204 | Val: -410.9356917225708
8-th component log probs | Train: 14.95331795781378 | Val: -241.1231193665616
9-th component log probs | Train: 14.987825479014589 | Val: -380.8505888693312
KEYWORD NR_SAMPLES:200 DIM:200 AVG_DIFF:105736.9322
best average differences at 200 dimensions: 105736.93224604714
2022-01-09 09:07.43 [info     ] Training complete              train_loss=2.574024200439453
2022-01-09 09:07.43 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:07.45 [info     ] Testing complete               test_loss=2.238952159881592
{'dataset_size': 200,
 'end_test_accuracy': 0.1978503167629242,
 'end_test_loss': 2.238952159881592,
 'end_train_accuracy': 0.37109375,
 'end_train_loss': 2.574024200439453,
 'end_val_accuracy': 0.22312897443771362,
 'end_val_loss': 3.211169481277466}
2022-01-09 09:07.45 [info     ] Start Predict                  dataset=39800
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:08.13 [info     ] Starting training              dataset=400 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
400
Fitting PCA...
0-th component log probs | Train: 3.5559694943613582 | Val: -357.4564946416445
1-th component log probs | Train: 2.311336953440579 | Val: -18.899104433043938
2-th component log probs | Train: 3.616157358717041 | Val: -558.7364439480298
3-th component log probs | Train: 3.006412665947125 | Val: -389.3811682166481
4-th component log probs | Train: 3.6037365475928964 | Val: -493.03279965056106
5-th component log probs | Train: 2.6794574308632235 | Val: -170.04314085129124
6-th component log probs | Train: 3.421533846460621 | Val: -425.4905169741884
7-th component log probs | Train: 2.545392012137699 | Val: -152.23281336179858
8-th component log probs | Train: 3.2159537967823844 | Val: -161.05039509440502
9-th component log probs | Train: 2.2019996576465704 | Val: -17.195363607470785
KEYWORD NR_SAMPLES:400 DIM:50 AVG_DIFF:111275.0820
Fitting PCA...
0-th component log probs | Train: 4.70792843448435 | Val: -290.7168093741753
1-th component log probs | Train: 3.7499401419031004 | Val: -213.9113404586083
2-th component log probs | Train: 4.756879302905722 | Val: -481.0205161945619
3-th component log probs | Train: 4.430323467047251 | Val: -466.11415515373596
4-th component log probs | Train: 4.7516376746168465 | Val: -374.9163608923969
5-th component log probs | Train: 4.228098512687964 | Val: -254.08477266414556
6-th component log probs | Train: 4.622728723019393 | Val: -386.47622094504413
7-th component log probs | Train: 4.1198476943371185 | Val: -283.3811142467675
8-th component log probs | Train: 4.516921176115967 | Val: -175.45874167396397
9-th component log probs | Train: 3.5289477184089577 | Val: -219.9028749188405
KEYWORD NR_SAMPLES:400 DIM:100 AVG_DIFF:112084.5532
Fitting PCA...
0-th component log probs | Train: 5.119631909167063 | Val: -221.4675022569179
1-th component log probs | Train: 4.437956554264212 | Val: -206.24923391885307
2-th component log probs | Train: 5.155393450095851 | Val: -366.564265202067
3-th component log probs | Train: 4.93391508846511 | Val: -370.0623898591841
4-th component log probs | Train: 5.154522748842454 | Val: -289.25980860966075
5-th component log probs | Train: 4.794360715941305 | Val: -217.2494312410428
6-th component log probs | Train: 5.055936221356022 | Val: -309.1502732848559
7-th component log probs | Train: 4.711740999781486 | Val: -241.1668935731146
8-th component log probs | Train: 4.988504724359114 | Val: -144.9175311519676
9-th component log probs | Train: 4.2800306156640975 | Val: -210.46362047253834
KEYWORD NR_SAMPLES:400 DIM:150 AVG_DIFF:73828.0299
Fitting PCA...
0-th component log probs | Train: 5.330742418154922 | Val: -178.58047009678054
1-th component log probs | Train: 4.802363442524224 | Val: -179.93194349967015
2-th component log probs | Train: 5.358449713983538 | Val: -297.060272227054
3-th component log probs | Train: 5.191858502752485 | Val: -301.5208753484092
4-th component log probs | Train: 5.359043607134009 | Val: -236.1843223368661
5-th component log probs | Train: 5.086056764869232 | Val: -182.16500160830893
6-th component log probs | Train: 5.27893763819987 | Val: -255.41334892261747
7-th component log probs | Train: 5.019655122480546 | Val: -202.21546068525384
8-th component log probs | Train: 5.23143496631047 | Val: -120.90781514432342
9-th component log probs | Train: 4.6848864018112275 | Val: -184.28694043051019
KEYWORD NR_SAMPLES:400 DIM:200 AVG_DIFF:50941.4362
Fitting PCA...
0-th component log probs | Train: 5.458943280385113 | Val: -149.7108025183403
1-th component log probs | Train: 5.029622217054155 | Val: -156.2258217568247
2-th component log probs | Train: 5.482131553704574 | Val: -249.56561486263277
3-th component log probs | Train: 5.348736832111028 | Val: -254.04562569062065
4-th component log probs | Train: 5.48336587435309 | Val: -198.96513781627763
5-th component log probs | Train: 5.264241587492836 | Val: -156.10266644143545
6-th component log probs | Train: 5.415423110269381 | Val: -216.728727965185
7-th component log probs | Train: 5.209092419079529 | Val: -172.8654184837691
8-th component log probs | Train: 5.379690725299957 | Val: -104.27857560660755
9-th component log probs | Train: 4.936487980303157 | Val: -160.0335740412846
KEYWORD NR_SAMPLES:400 DIM:250 AVG_DIFF:37055.2838
Fitting PCA...
0-th component log probs | Train: 5.545471584045008 | Val: -129.10529985069954
1-th component log probs | Train: 5.184944712918573 | Val: -137.4536843754158
2-th component log probs | Train: 5.5654643299448185 | Val: -215.149322585464
3-th component log probs | Train: 5.454180892011593 | Val: -218.987569001616
4-th component log probs | Train: 5.566873989734939 | Val: -171.58261426190967
5-th component log probs | Train: 5.3841262588648515 | Val: -136.93075137447096
6-th component log probs | Train: 5.50799010904274 | Val: -187.28422311484692
7-th component log probs | Train: 5.33701685327464 | Val: -150.63370857183529
8-th component log probs | Train: 5.479536586905994 | Val: -91.31752533507802
9-th component log probs | Train: 5.108229865005339 | Val: -139.58364184177918
KEYWORD NR_SAMPLES:400 DIM:300 AVG_DIFF:28100.2304
Fitting PCA...
0-th component log probs | Train: 5.608007595135667 | Val: -113.30738849889187
1-th component log probs | Train: 5.297963253049141 | Val: -121.95303567049633
2-th component log probs | Train: 5.625401483005627 | Val: -188.63095595083468
3-th component log probs | Train: 5.530083871767233 | Val: -192.18928652271043
4-th component log probs | Train: 5.6269129694861455 | Val: -150.65740282988116
5-th component log probs | Train: 5.47013742134939 | Val: -121.91126871006851
6-th component log probs | Train: 5.574977932211095 | Val: -164.97395696378618
7-th component log probs | Train: 5.4294681613885505 | Val: -133.67697265100048
8-th component log probs | Train: 5.551579240612094 | Val: -81.13540479318182
9-th component log probs | Train: 5.232665261451941 | Val: -123.45666693782609
KEYWORD NR_SAMPLES:400 DIM:350 AVG_DIFF:22032.6098
0-th component log probs | Train: 7.332041061531592 | Val: -104.46202902311643
1-th component log probs | Train: 7.060700697827274 | Val: -114.33587681886762
2-th component log probs | Train: 7.347556436806227 | Val: -173.02317003250153
3-th component log probs | Train: 7.264154499737061 | Val: -177.70342716801142
4-th component log probs | Train: 7.348969679488446 | Val: -138.92348891900244
5-th component log probs | Train: 7.211775496977467 | Val: -116.63100853137797
6-th component log probs | Train: 7.302447580657134 | Val: -151.7192962869492
7-th component log probs | Train: 7.176127025220332 | Val: -126.07817369160072
8-th component log probs | Train: 7.2827496695126595 | Val: -76.91239400387038
9-th component log probs | Train: 7.003806709293605 | Val: -114.95195646158223
KEYWORD NR_SAMPLES:400 DIM:400 AVG_DIFF:19572.0970
best average differences at 400 dimensions: 19572.09697452762
2022-01-09 09:09.45 [info     ] Training complete              train_loss=2.1003875732421875
2022-01-09 09:09.45 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:09.47 [info     ] Testing complete               test_loss=2.103696346282959
{'dataset_size': 400,
 'end_test_accuracy': 0.27766719460487366,
 'end_test_loss': 2.103696346282959,
 'end_train_accuracy': 0.5714285969734192,
 'end_train_loss': 2.1003875732421875,
 'end_val_accuracy': 0.2851313650608063,
 'end_val_loss': 2.4894630908966064}
2022-01-09 09:09.47 [info     ] Start Predict                  dataset=39600
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:10.17 [info     ] Starting training              dataset=600 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
600
Fitting PCA...
0-th component log probs | Train: 2.3467272615613717 | Val: -92.78911352196734
1-th component log probs | Train: 1.9390507754171722 | Val: -2.4412445806048675
2-th component log probs | Train: 2.647782753184206 | Val: -280.19252227908686
3-th component log probs | Train: 1.9396055469231799 | Val: -8.431589285802817
4-th component log probs | Train: 2.940760657154581 | Val: -325.4191681860606
5-th component log probs | Train: 2.1463928107226393 | Val: -20.321511305807967
6-th component log probs | Train: 2.8464246749817885 | Val: -153.88408673628166
7-th component log probs | Train: 2.0646479324925533 | Val: -4.681639837615805
8-th component log probs | Train: 1.9540273905378247 | Val: -0.8080795001086839
9-th component log probs | Train: 1.9360572949713413 | Val: -3.124031227549719
KEYWORD NR_SAMPLES:600 DIM:50 AVG_DIFF:22214.4464
Fitting PCA...
0-th component log probs | Train: 4.014328996131767 | Val: -245.1303414285967
1-th component log probs | Train: 2.935738210894758 | Val: -86.51673295741719
2-th component log probs | Train: 4.201644981211232 | Val: -427.4426653210615
3-th component log probs | Train: 3.6038310292520173 | Val: -207.22305704570107
4-th component log probs | Train: 4.358592435716869 | Val: -415.53163443525324
5-th component log probs | Train: 3.711415811926045 | Val: -210.2344268802297
6-th component log probs | Train: 4.2467090843039195 | Val: -275.1326768099465
7-th component log probs | Train: 3.3508709424410963 | Val: -151.2310832455878
8-th component log probs | Train: 3.302936387685236 | Val: -90.35731708276688
9-th component log probs | Train: 2.9561142389376838 | Val: -93.27950795023187
KEYWORD NR_SAMPLES:600 DIM:100 AVG_DIFF:64290.2185
Fitting PCA...
0-th component log probs | Train: 4.643219676136425 | Val: -218.33857532006698
1-th component log probs | Train: 3.813553134311141 | Val: -166.02526060694626
2-th component log probs | Train: 4.773734838703031 | Val: -356.7274167208303
3-th component log probs | Train: 4.357196435034037 | Val: -203.43636952265638
4-th component log probs | Train: 4.879051835038725 | Val: -343.88310004019155
5-th component log probs | Train: 4.422486552580466 | Val: -203.83999604446242
6-th component log probs | Train: 4.795238841018717 | Val: -237.37511771588476
7-th component log probs | Train: 4.143576806349579 | Val: -177.71744995509096
8-th component log probs | Train: 4.115290431033835 | Val: -110.60701049166491
9-th component log probs | Train: 3.845001676003595 | Val: -156.0785233390772
KEYWORD NR_SAMPLES:600 DIM:150 AVG_DIFF:54789.2307
Fitting PCA...
0-th component log probs | Train: 4.968758137421201 | Val: -187.318682479293
1-th component log probs | Train: 4.312796162179572 | Val: -167.84202037117615
2-th component log probs | Train: 5.067708576619609 | Val: -297.46962407241074
3-th component log probs | Train: 4.751352759107205 | Val: -180.35134285703433
4-th component log probs | Train: 5.147848403535569 | Val: -283.1733212820743
5-th component log probs | Train: 4.796590341249653 | Val: -182.04162641394709
6-th component log probs | Train: 5.080779390486472 | Val: -203.6831967446293
7-th component log probs | Train: 4.573225841501868 | Val: -165.63976617895236
8-th component log probs | Train: 4.554136572911753 | Val: -106.1416834688894
9-th component log probs | Train: 4.337669158374714 | Val: -159.16146188988648
KEYWORD NR_SAMPLES:600 DIM:200 AVG_DIFF:42198.1593
Fitting PCA...
0-th component log probs | Train: 5.167621544694974 | Val: -164.12611262289678
1-th component log probs | Train: 4.627852649188645 | Val: -157.17212860947396
2-th component log probs | Train: 5.247253675620587 | Val: -254.51847243706993
3-th component log probs | Train: 4.991969341789751 | Val: -159.42196192800708
4-th component log probs | Train: 5.311235588584711 | Val: -241.45374904221404
5-th component log probs | Train: 5.027619700072362 | Val: -160.22376044249597
6-th component log probs | Train: 5.255580754539036 | Val: -176.8424607889266
7-th component log probs | Train: 4.841959636808301 | Val: -150.76831454940154
8-th component log probs | Train: 4.827211425528749 | Val: -98.98990611889766
9-th component log probs | Train: 4.649013450964594 | Val: -148.87471955644142
KEYWORD NR_SAMPLES:600 DIM:250 AVG_DIFF:32927.2537
Fitting PCA...
0-th component log probs | Train: 5.301915371576529 | Val: -145.65110194067546
1-th component log probs | Train: 4.8440592559147175 | Val: -144.19344334786024
2-th component log probs | Train: 5.368285376306463 | Val: -221.75760722470048
3-th component log probs | Train: 5.154863669100268 | Val: -142.34693085439906
4-th component log probs | Train: 5.421605054178958 | Val: -210.2035568962744
5-th component log probs | Train: 5.183733044662135 | Val: -143.2526306326347
6-th component log probs | Train: 5.373821228636731 | Val: -156.09520148334138
7-th component log probs | Train: 5.025516206629404 | Val: -136.30107712404688
8-th component log probs | Train: 5.014129826667696 | Val: -90.86841063795498
9-th component log probs | Train: 4.862333347081454 | Val: -137.36439466484927
KEYWORD NR_SAMPLES:600 DIM:300 AVG_DIFF:26233.6861
Fitting PCA...
0-th component log probs | Train: 5.3986565378139035 | Val: -130.67736154420692
1-th component log probs | Train: 5.001740309145079 | Val: -131.94115545476328
2-th component log probs | Train: 5.455438025496109 | Val: -196.8634846191686
3-th component log probs | Train: 5.272375833803186 | Val: -128.1553110772102
4-th component log probs | Train: 5.501276474178039 | Val: -186.15464955132467
5-th component log probs | Train: 5.29686319606361 | Val: -128.86238890132805
6-th component log probs | Train: 5.459326685511143 | Val: -139.455378036919
7-th component log probs | Train: 5.159001114832351 | Val: -123.66513850572241
8-th component log probs | Train: 5.149736157426947 | Val: -83.87862274608389
9-th component log probs | Train: 5.017802481055151 | Val: -125.71997750014724
KEYWORD NR_SAMPLES:600 DIM:350 AVG_DIFF:21335.0979
Fitting PCA...
0-th component log probs | Train: 5.471681705955229 | Val: -118.58269119304352
1-th component log probs | Train: 5.122302744586849 | Val: -121.0779212230797
2-th component log probs | Train: 5.521327508797734 | Val: -176.8356394192177
3-th component log probs | Train: 5.361095948482925 | Val: -116.45806963588996
4-th component log probs | Train: 5.561556958628075 | Val: -166.8902752522793
5-th component log probs | Train: 5.382355946984005 | Val: -116.97329630662699
6-th component log probs | Train: 5.524023424262997 | Val: -125.97058684851703
7-th component log probs | Train: 5.260433540100656 | Val: -112.9157452470743
8-th component log probs | Train: 5.25299933200596 | Val: -77.66937871170605
9-th component log probs | Train: 5.1365801099461486 | Val: -115.32734624787949
KEYWORD NR_SAMPLES:600 DIM:400 AVG_DIFF:17676.4617
Fitting PCA...
0-th component log probs | Train: 5.528835260189603 | Val: -108.58068185587359
1-th component log probs | Train: 5.2173175909503025 | Val: -111.61816679918174
2-th component log probs | Train: 5.5728710173757054 | Val: -160.52282527189877
3-th component log probs | Train: 5.430473829800729 | Val: -106.70964043443459
4-th component log probs | Train: 5.6087093979182026 | Val: -151.06962226872085
5-th component log probs | Train: 5.449305838243437 | Val: -106.99669313553653
6-th component log probs | Train: 5.574913536539387 | Val: -114.85597261969312
7-th component log probs | Train: 5.340375827353775 | Val: -103.80773502085862
8-th component log probs | Train: 5.334022603506132 | Val: -72.19522742687737
9-th component log probs | Train: 5.229949417089703 | Val: -106.56624608462363
KEYWORD NR_SAMPLES:600 DIM:450 AVG_DIFF:14895.2983
Fitting PCA...
0-th component log probs | Train: 5.574738650312372 | Val: -100.30544326103926
1-th component log probs | Train: 5.294093691698605 | Val: -103.447282275253
2-th component log probs | Train: 5.6143246843249175 | Val: -146.94573305827785
3-th component log probs | Train: 5.4861983715409455 | Val: -98.54025551493564
4-th component log probs | Train: 5.6466253598751335 | Val: -137.97194364627276
5-th component log probs | Train: 5.503130203003733 | Val: -98.75183727960177
6-th component log probs | Train: 5.6159712868369285 | Val: -105.46851768048232
7-th component log probs | Train: 5.404932435226955 | Val: -95.94382840247302
8-th component log probs | Train: 5.39928519860609 | Val: -67.59254760505229
9-th component log probs | Train: 5.305458881698814 | Val: -98.77213910656522
KEYWORD NR_SAMPLES:600 DIM:500 AVG_DIFF:12739.8055
0-th component log probs | Train: 5.584437830351676 | Val: -98.51463675534112
1-th component log probs | Train: 5.310352370258134 | Val: -101.65999485252495
2-th component log probs | Train: 5.623092028215201 | Val: -144.00480807840523
3-th component log probs | Train: 5.497971994079398 | Val: -96.763524463985
4-th component log probs | Train: 5.654638020218371 | Val: -135.14981715950594
5-th component log probs | Train: 5.5145062901317425 | Val: -96.96667128079004
6-th component log probs | Train: 5.62468903579053 | Val: -103.42690556153833
7-th component log probs | Train: 5.4185979850013 | Val: -94.22119953896198
8-th component log probs | Train: 5.413088839913478 | Val: -66.5526252825204
9-th component log probs | Train: 5.321454836705843 | Val: -97.09015334255977
KEYWORD NR_SAMPLES:600 DIM:512 AVG_DIFF:12294.1022
best average differences at 512 dimensions: 12294.102205135356
2022-01-09 09:12.36 [info     ] Training complete              train_loss=1.5725213289260864
2022-01-09 09:12.36 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:12.38 [info     ] Testing complete               test_loss=1.9030287265777588
{'dataset_size': 600,
 'end_test_accuracy': 0.3396695852279663,
 'end_test_loss': 1.9030287265777588,
 'end_train_accuracy': 0.7395833730697632,
 'end_train_loss': 1.5725213289260864,
 'end_val_accuracy': 0.365744411945343,
 'end_val_loss': 2.1209516525268555}
2022-01-09 09:12.38 [info     ] Start Predict                  dataset=39400
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:13.06 [info     ] Starting training              dataset=800 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
800
Fitting PCA...
0-th component log probs | Train: 1.7720667382682413 | Val: -0.1809007104916415
1-th component log probs | Train: 1.7545221926987662 | Val: 0.08707404514728229
2-th component log probs | Train: 2.05086311259365 | Val: -9.648572098488023
3-th component log probs | Train: 1.8154672637370304 | Val: -0.336128198399112
4-th component log probs | Train: 2.3084538925364138 | Val: -35.528565276179876
5-th component log probs | Train: 1.8782368936862384 | Val: -0.5752779090288276
6-th component log probs | Train: 2.3789424948396776 | Val: -25.033278133751875
7-th component log probs | Train: 1.8382788470715963 | Val: -0.7338775568709698
8-th component log probs | Train: 1.7822617363458242 | Val: 0.7494571265167687
9-th component log probs | Train: 1.667753553143156 | Val: 0.2785939187743455
KEYWORD NR_SAMPLES:800 DIM:50 AVG_DIFF:234.6803
Fitting PCA...
0-th component log probs | Train: 3.307482414271687 | Val: -120.81040101732303
1-th component log probs | Train: 2.49908613766136 | Val: -8.039582226878219
2-th component log probs | Train: 3.687813514362481 | Val: -183.75163516617755
3-th component log probs | Train: 3.2344002442409256 | Val: -125.12712849682543
4-th component log probs | Train: 3.929668840982674 | Val: -203.89306218984362
5-th component log probs | Train: 3.1819628124407773 | Val: -114.54908405811382
6-th component log probs | Train: 3.954109809205604 | Val: -186.57783706372118
7-th component log probs | Train: 2.788656636254781 | Val: -45.5799913363637
8-th component log probs | Train: 2.620774923739467 | Val: -11.038616316778018
9-th component log probs | Train: 2.31812158115155 | Val: -2.729918905529934
KEYWORD NR_SAMPLES:800 DIM:100 AVG_DIFF:16303.1439
Fitting PCA...
0-th component log probs | Train: 4.14133129823656 | Val: -140.97416332331312
1-th component log probs | Train: 3.355130701899774 | Val: -76.85344537009696
2-th component log probs | Train: 4.411373784777029 | Val: -181.53306913765283
3-th component log probs | Train: 4.089302911115685 | Val: -148.6880010668779
4-th component log probs | Train: 4.574325615310922 | Val: -189.60557677267605
5-th component log probs | Train: 4.037190962737462 | Val: -136.23538107413722
6-th component log probs | Train: 4.590155772919597 | Val: -175.05998882841124
7-th component log probs | Train: 3.7023673554649545 | Val: -118.28616242018369
8-th component log probs | Train: 3.5198606401787713 | Val: -57.329837729877134
9-th component log probs | Train: 3.037020939635886 | Val: -52.06223791854001
KEYWORD NR_SAMPLES:800 DIM:150 AVG_DIFF:19668.4382
Fitting PCA...
0-th component log probs | Train: 4.584384310436099 | Val: -130.38403857506154
1-th component log probs | Train: 3.943820776935503 | Val: -98.25346713821153
2-th component log probs | Train: 4.791310291373051 | Val: -161.08112902490538
3-th component log probs | Train: 4.541635036493056 | Val: -140.55608424431765
4-th component log probs | Train: 4.914086141525231 | Val: -163.30848835656738
5-th component log probs | Train: 4.4967422582911025 | Val: -130.97104633982846
6-th component log probs | Train: 4.922510023643479 | Val: -155.2192286285843
7-th component log probs | Train: 4.226719043161084 | Val: -125.71662913789439
8-th component log probs | Train: 4.077161064919222 | Val: -68.28466997146002
9-th component log probs | Train: 3.667219971462168 | Val: -87.59409445497903
KEYWORD NR_SAMPLES:800 DIM:200 AVG_DIFF:17997.3644
Fitting PCA...
0-th component log probs | Train: 4.856145688237696 | Val: -118.38364839095806
1-th component log probs | Train: 4.32004588199804 | Val: -100.18576587702107
2-th component log probs | Train: 5.022955918479736 | Val: -143.45993965136066
3-th component log probs | Train: 4.8207128881271055 | Val: -127.86231544161217
4-th component log probs | Train: 5.122166835291657 | Val: -143.49271629465593
5-th component log probs | Train: 4.782556004753117 | Val: -118.98685570677729
6-th component log probs | Train: 5.127335160969609 | Val: -136.28577784684944
7-th component log probs | Train: 4.559419877118683 | Val: -118.73283693427834
8-th component log probs | Train: 4.43477836879023 | Val: -70.22752623161921
9-th component log probs | Train: 4.091898966388103 | Val: -94.26923467633704
KEYWORD NR_SAMPLES:800 DIM:250 AVG_DIFF:15361.4740
Fitting PCA...
0-th component log probs | Train: 5.040048394331523 | Val: -107.59830297478008
1-th component log probs | Train: 4.581934069524135 | Val: -96.31488712288497
2-th component log probs | Train: 5.179789810764825 | Val: -128.3580825796613
3-th component log probs | Train: 5.00999200072798 | Val: -116.15016736581464
4-th component log probs | Train: 5.262458967581196 | Val: -127.00411613843043
5-th component log probs | Train: 4.977029869980237 | Val: -108.49237710786711
6-th component log probs | Train: 5.266072015115788 | Val: -121.58418289062303
7-th component log probs | Train: 4.786066327327794 | Val: -109.83514726202719
8-th component log probs | Train: 4.679889705975401 | Val: -67.64153659071967
9-th component log probs | Train: 4.3887901223593255 | Val: -92.17917297032291
KEYWORD NR_SAMPLES:800 DIM:300 AVG_DIFF:12953.4237
Fitting PCA...
0-th component log probs | Train: 5.172875922559149 | Val: -98.22176949005667
1-th component log probs | Train: 4.774471054152931 | Val: -91.02929285138495
2-th component log probs | Train: 5.293114921762204 | Val: -115.71085474642268
3-th component log probs | Train: 5.146872734174809 | Val: -105.68357989225862
4-th component log probs | Train: 5.363778700837106 | Val: -113.94289905850198
5-th component log probs | Train: 5.117852961909428 | Val: -98.8292724553372
6-th component log probs | Train: 5.3666808146130105 | Val: -109.18511591665968
7-th component log probs | Train: 4.9512534022758645 | Val: -101.08496505543742
8-th component log probs | Train: 4.859220035229357 | Val: -64.12400441305196
9-th component log probs | Train: 4.606651588748418 | Val: -87.80642816065524
KEYWORD NR_SAMPLES:800 DIM:350 AVG_DIFF:10949.7908
Fitting PCA...
0-th component log probs | Train: 5.273448984822025 | Val: -90.20339488702864
1-th component log probs | Train: 4.921326202336972 | Val: -85.37630991060108
2-th component log probs | Train: 5.37875455570993 | Val: -105.01620170889855
3-th component log probs | Train: 5.250475549605189 | Val: -96.76517221741062
4-th component log probs | Train: 5.440372485298299 | Val: -103.33848982678501
5-th component log probs | Train: 5.2247054505503066 | Val: -90.56530968959369
6-th component log probs | Train: 5.44257687133379 | Val: -99.1252239350705
7-th component log probs | Train: 5.077368052563778 | Val: -93.13404750854774
8-th component log probs | Train: 4.996051301739337 | Val: -60.57462088498211
9-th component log probs | Train: 4.773792672346924 | Val: -82.83071052588069
KEYWORD NR_SAMPLES:800 DIM:400 AVG_DIFF:9342.6267
Fitting PCA...
0-th component log probs | Train: 5.352188713339024 | Val: -83.40014831245018
1-th component log probs | Train: 5.037278640930607 | Val: -79.90837814889552
2-th component log probs | Train: 5.445749354710344 | Val: -95.99766647386208
3-th component log probs | Train: 5.331635330397501 | Val: -89.04285843536336
4-th component log probs | Train: 5.5004584908904155 | Val: -94.23391727887714
5-th component log probs | Train: 5.308510125549469 | Val: -83.51194090822659
6-th component log probs | Train: 5.502145386631706 | Val: -90.7286376995445
7-th component log probs | Train: 5.176689532149072 | Val: -86.14108368603712
8-th component log probs | Train: 5.103997642888293 | Val: -57.34050330143364
9-th component log probs | Train: 4.905927311103461 | Val: -77.87808694398342
KEYWORD NR_SAMPLES:800 DIM:450 AVG_DIFF:8047.7880
Fitting PCA...
0-th component log probs | Train: 5.415484229123871 | Val: -77.75260162710491
1-th component log probs | Train: 5.131297196817405 | Val: -74.91992346474441
2-th component log probs | Train: 5.499715749293886 | Val: -88.4576035876871
3-th component log probs | Train: 5.396969599663452 | Val: -82.44532778595233
4-th component log probs | Train: 5.548825483467432 | Val: -86.60193962556228
5-th component log probs | Train: 5.376058777154918 | Val: -77.34082656187934
6-th component log probs | Train: 5.550208391015394 | Val: -83.61049410153502
7-th component log probs | Train: 5.2569999333933 | Val: -80.08747201914612
8-th component log probs | Train: 5.1914117565259374 | Val: -54.24120354793769
9-th component log probs | Train: 5.0129084827201265 | Val: -73.19479029256321
KEYWORD NR_SAMPLES:800 DIM:500 AVG_DIFF:7008.5212
0-th component log probs | Train: 5.428883140538815 | Val: -76.4357466352989
1-th component log probs | Train: 5.151249633157203 | Val: -73.83389261043415
2-th component log probs | Train: 5.511140088462711 | Val: -86.79086402213548
3-th component log probs | Train: 5.410798332004011 | Val: -81.00424384029925
4-th component log probs | Train: 5.559081426066675 | Val: -84.90781605521651
5-th component log probs | Train: 5.390365671806042 | Val: -75.98205823298888
6-th component log probs | Train: 5.56040843593496 | Val: -82.07233847303681
7-th component log probs | Train: 5.274066714888374 | Val: -78.71551293082352
8-th component log probs | Train: 5.2099825125837755 | Val: -53.504105125162
9-th component log probs | Train: 5.035655438429658 | Val: -72.10910543253011
KEYWORD NR_SAMPLES:800 DIM:512 AVG_DIFF:6786.5827
best average differences at 50 dimensions: 234.68026451413849
2022-01-09 09:15.05 [info     ] Training complete              train_loss=1.6774789094924927
2022-01-09 09:15.05 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:15.07 [info     ] Testing complete               test_loss=1.8886419534683228
{'dataset_size': 800,
 'end_test_accuracy': 0.350119411945343,
 'end_test_loss': 1.8886419534683228,
 'end_train_accuracy': 0.667067289352417,
 'end_train_loss': 1.6774789094924927,
 'end_val_accuracy': 0.39729300141334534,
 'end_val_loss': 1.9279991388320923}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:15.07 [info     ] Start Predict                  dataset=39200
2022-01-09 09:15.24 [info     ] Starting training              dataset=1000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
1000
Fitting PCA...
0-th component log probs | Train: 1.7597736327125988 | Val: -0.3955991427291898
1-th component log probs | Train: 1.8786313555591883 | Val: -0.0017848977565266505
2-th component log probs | Train: 1.7199957687771694 | Val: 0.314668029590252
3-th component log probs | Train: 1.6055455912489844 | Val: 1.041097111039278
4-th component log probs | Train: 2.0435330977544988 | Val: -3.285736658587478
5-th component log probs | Train: 1.7626106939597153 | Val: 0.6921272388301908
6-th component log probs | Train: 2.0224301141888565 | Val: -0.6529136804961814
7-th component log probs | Train: 1.8450733879915817 | Val: -0.23807293786887063
8-th component log probs | Train: 1.7465463192522965 | Val: 0.9416593333153911
9-th component log probs | Train: 1.7126333103996283 | Val: 0.4720091015083029
KEYWORD NR_SAMPLES:1000 DIM:50 AVG_DIFF:5.3706
Fitting PCA...
0-th component log probs | Train: 2.9278281020840438 | Val: -82.75038372256455
1-th component log probs | Train: 2.596277714014102 | Val: -7.782867103768582
2-th component log probs | Train: 2.783864010490795 | Val: -58.27916242512578
3-th component log probs | Train: 2.5111170490351693 | Val: -22.930736885621968
4-th component log probs | Train: 3.4357406581903316 | Val: -154.12097130194954
5-th component log probs | Train: 2.577029570851862 | Val: -12.43825881166
6-th component log probs | Train: 3.1837412609685836 | Val: -50.563900248114756
7-th component log probs | Train: 2.637021836111045 | Val: -13.69395039238746
8-th component log probs | Train: 2.473795966376805 | Val: -2.5180894216912466
9-th component log probs | Train: 2.3226542967293926 | Val: -1.4871485175160344
KEYWORD NR_SAMPLES:1000 DIM:100 AVG_DIFF:4006.8983
Fitting PCA...
0-th component log probs | Train: 3.84421198089538 | Val: -125.472674127788
1-th component log probs | Train: 3.343450481131061 | Val: -62.856461789027065
2-th component log probs | Train: 3.729059246851411 | Val: -111.64429944308439
3-th component log probs | Train: 3.522323985079856 | Val: -85.4990327534711
4-th component log probs | Train: 4.221407391586041 | Val: -166.11776151395813
5-th component log probs | Train: 3.470429893050318 | Val: -72.10467177987508
6-th component log probs | Train: 4.002318835859523 | Val: -82.83372618123695
7-th component log probs | Train: 3.4770457091794524 | Val: -84.07092605446016
8-th component log probs | Train: 3.2623333201137394 | Val: -38.25166128974317
9-th component log probs | Train: 2.937397515695269 | Val: -28.967348866428253
KEYWORD NR_SAMPLES:1000 DIM:150 AVG_DIFF:9501.4598
Fitting PCA...
0-th component log probs | Train: 4.349030562089177 | Val: -123.26774700346674
1-th component log probs | Train: 3.9140498624157023 | Val: -83.92683299333774
2-th component log probs | Train: 4.257553396670108 | Val: -114.32602755042524
3-th component log probs | Train: 4.096990160546004 | Val: -96.61402499270393
4-th component log probs | Train: 4.638835564924963 | Val: -155.3722965832932
5-th component log probs | Train: 4.037035410129277 | Val: -85.17430656693566
6-th component log probs | Train: 4.455967630880056 | Val: -84.95735081446594
7-th component log probs | Train: 4.03495242289781 | Val: -99.95271514561165
8-th component log probs | Train: 3.8545434983895905 | Val: -54.266849752392915
9-th component log probs | Train: 3.564796837882357 | Val: -62.93482809522366
KEYWORD NR_SAMPLES:1000 DIM:200 AVG_DIFF:10837.7536
Fitting PCA...
0-th component log probs | Train: 4.6627940634940215 | Val: -113.46475121797879
1-th component log probs | Train: 4.290656189770322 | Val: -85.93512397945521
2-th component log probs | Train: 4.586804052364019 | Val: -107.92873008002256
3-th component log probs | Train: 4.457932937806008 | Val: -94.09152666425994
4-th component log probs | Train: 4.896126891546131 | Val: -140.50476791507043
5-th component log probs | Train: 4.398786248596014 | Val: -85.29193389809386
6-th component log probs | Train: 4.742079145316408 | Val: -81.05039142075503
7-th component log probs | Train: 4.394203765559472 | Val: -100.61918289645833
8-th component log probs | Train: 4.243870278622097 | Val: -58.31158779548061
9-th component log probs | Train: 3.9980747208628467 | Val: -72.67544915073805
KEYWORD NR_SAMPLES:1000 DIM:250 AVG_DIFF:10183.2569
Fitting PCA...
0-th component log probs | Train: 4.8756762345005225 | Val: -104.4973912121369
1-th component log probs | Train: 4.551390697173077 | Val: -83.59560014140777
2-th component log probs | Train: 4.811183976881923 | Val: -100.41782386211177
3-th component log probs | Train: 4.704108985341767 | Val: -88.95130384944729
4-th component log probs | Train: 5.071817276277314 | Val: -126.63396647307674
5-th component log probs | Train: 4.648970635565334 | Val: -81.3122490244131
6-th component log probs | Train: 4.939013377667233 | Val: -75.2529440772533
7-th component log probs | Train: 4.643332025331246 | Val: -96.10946687180052
8-th component log probs | Train: 4.5156512993691384 | Val: -57.76507525955286
9-th component log probs | Train: 4.304201778778198 | Val: -73.25697612944651
KEYWORD NR_SAMPLES:1000 DIM:300 AVG_DIFF:9078.9087
Fitting PCA...
0-th component log probs | Train: 5.030221676656617 | Val: -95.87575026564048
1-th component log probs | Train: 4.745059315089976 | Val: -79.6287510191412
2-th component log probs | Train: 4.974292462194329 | Val: -92.9713303840047
3-th component log probs | Train: 4.882708257496583 | Val: -82.74461253631408
4-th component log probs | Train: 5.1989067272938705 | Val: -114.3266754201818
5-th component log probs | Train: 4.831830895701255 | Val: -76.87027886818011
6-th component log probs | Train: 5.082264262438698 | Val: -69.8725970096727
7-th component log probs | Train: 4.825923690618691 | Val: -90.79940211077064
8-th component log probs | Train: 4.7149360946116605 | Val: -55.86338615264464
9-th component log probs | Train: 4.531170000885043 | Val: -71.3008078177128
KEYWORD NR_SAMPLES:1000 DIM:350 AVG_DIFF:7971.7103
Fitting PCA...
0-th component log probs | Train: 5.147364688935444 | Val: -88.4147210984888
1-th component log probs | Train: 4.893294346329087 | Val: -74.84038868748917
2-th component log probs | Train: 5.098133781479873 | Val: -85.97746385770499
3-th component log probs | Train: 5.01814308377142 | Val: -77.00584010395069
4-th component log probs | Train: 5.295257880572958 | Val: -104.20837271895974
5-th component log probs | Train: 4.971291004369559 | Val: -72.20141211615484
6-th component log probs | Train: 5.191253446522208 | Val: -64.95739447803722
7-th component log probs | Train: 4.9652811207267495 | Val: -84.7073719307641
8-th component log probs | Train: 4.867661606234099 | Val: -53.27225404214696
9-th component log probs | Train: 4.705718761533778 | Val: -68.07975528152588
KEYWORD NR_SAMPLES:1000 DIM:400 AVG_DIFF:6972.0686
Fitting PCA...
0-th component log probs | Train: 5.239339079578118 | Val: -81.93681995482258
1-th component log probs | Train: 5.0107618479798965 | Val: -70.37897163306262
2-th component log probs | Train: 5.195332475257481 | Val: -79.9175742339662
3-th component log probs | Train: 5.124330658946383 | Val: -72.00171272651995
4-th component log probs | Train: 5.370943929078231 | Val: -95.73018572201656
5-th component log probs | Train: 5.081444117179918 | Val: -67.7405011324228
6-th component log probs | Train: 5.277314204261858 | Val: -60.45718674209052
7-th component log probs | Train: 5.075697341915595 | Val: -79.13528791610996
8-th component log probs | Train: 4.988353403814474 | Val: -50.71004497589114
9-th component log probs | Train: 4.843966141527383 | Val: -64.5881189461766
KEYWORD NR_SAMPLES:1000 DIM:450 AVG_DIFF:6133.6043
Fitting PCA...
0-th component log probs | Train: 5.313537964251134 | Val: -76.19294037200093
1-th component log probs | Train: 5.106198207581137 | Val: -66.07332135661379
2-th component log probs | Train: 5.273809903994086 | Val: -74.41922264102999
3-th component log probs | Train: 5.209957992540143 | Val: -67.36240119266826
4-th component log probs | Train: 5.4319632141505165 | Val: -88.3451449878142
5-th component log probs | Train: 5.170628085971039 | Val: -63.619549937075014
6-th component log probs | Train: 5.347006738479436 | Val: -56.383540023736174
7-th component log probs | Train: 5.165238556849524 | Val: -73.93443396043929
8-th component log probs | Train: 5.086438501602501 | Val: -48.003561869931964
9-th component log probs | Train: 4.9562963107052385 | Val: -61.23576887996773
KEYWORD NR_SAMPLES:1000 DIM:500 AVG_DIFF:5412.1148
0-th component log probs | Train: 5.329246376667087 | Val: -74.9021328025363
1-th component log probs | Train: 5.126528557156634 | Val: -65.11823138304285
2-th component log probs | Train: 5.290440519395347 | Val: -73.1383735543298
3-th component log probs | Train: 5.228094107055362 | Val: -66.29717226158161
4-th component log probs | Train: 5.444908555532875 | Val: -86.7081422997388
5-th component log probs | Train: 5.189569453354812 | Val: -62.664569659065265
6-th component log probs | Train: 5.361821121010839 | Val: -55.46361107822434
7-th component log probs | Train: 5.1842871193794835 | Val: -72.74438397766286
8-th component log probs | Train: 5.107313772443542 | Val: -47.389637446980565
9-th component log probs | Train: 4.980211202800302 | Val: -60.40196392648554
KEYWORD NR_SAMPLES:1000 DIM:512 AVG_DIFF:5253.8082
best average differences at 50 dimensions: 5.370615071427959
2022-01-09 09:17.42 [info     ] Training complete              train_loss=1.5621895790100098
2022-01-09 09:17.42 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:17.44 [info     ] Testing complete               test_loss=1.742347240447998
{'dataset_size': 1000,
 'end_test_accuracy': 0.3782842457294464,
 'end_test_loss': 1.742347240447998,
 'end_train_accuracy': 0.689453125,
 'end_train_loss': 1.5621895790100098,
 'end_val_accuracy': 0.4272491931915283,
 'end_val_loss': 1.872679352760315}
2022-01-09 09:17.45 [info     ] Start Predict                  dataset=39000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:18.03 [info     ] Starting training              dataset=2000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
2000
Fitting PCA...
0-th component log probs | Train: 1.6517060913541788 | Val: 1.050518356508661
1-th component log probs | Train: 1.7297478614297288 | Val: 1.0524536967327538
2-th component log probs | Train: 1.5720624096802938 | Val: 1.009309264281508
3-th component log probs | Train: 1.5070443492476535 | Val: 1.2080996723432202
4-th component log probs | Train: 1.653938925349358 | Val: 0.8942234719959455
5-th component log probs | Train: 1.5713341460966923 | Val: 1.2336914422431058
6-th component log probs | Train: 1.707234557824201 | Val: 1.2842055999016326
7-th component log probs | Train: 1.7761229141300758 | Val: 0.5132432457024964
8-th component log probs | Train: 1.718175906728041 | Val: 1.304141970613122
9-th component log probs | Train: 1.6313850687738005 | Val: 1.0717994115209837
KEYWORD NR_SAMPLES:2000 DIM:50 AVG_DIFF:0.4176
Fitting PCA...
0-th component log probs | Train: 2.1949114059181984 | Val: 1.09780558286899
1-th component log probs | Train: 2.2765995383196778 | Val: 0.9344791682721737
2-th component log probs | Train: 2.089793167718339 | Val: 0.9698997994368804
3-th component log probs | Train: 2.0337251273731853 | Val: 1.313328212540732
4-th component log probs | Train: 2.2424842033674537 | Val: 0.40490018662697935
5-th component log probs | Train: 2.1216832547628295 | Val: 1.3292957210139773
6-th component log probs | Train: 2.2626719512806606 | Val: 1.3764795215463688
7-th component log probs | Train: 2.297016327060301 | Val: 0.24383495242964567
8-th component log probs | Train: 2.286593247190286 | Val: 1.2812486907041456
9-th component log probs | Train: 2.1589235520592402 | Val: 1.090786428117069
KEYWORD NR_SAMPLES:2000 DIM:100 AVG_DIFF:1.5935
Fitting PCA...
0-th component log probs | Train: 2.5963285416899575 | Val: -0.17470398123138053
1-th component log probs | Train: 2.6763239243075954 | Val: -0.9598286023961076
2-th component log probs | Train: 2.4983400384165013 | Val: -0.7962376979699943
3-th component log probs | Train: 2.4384078522193757 | Val: 0.014965317011841662
4-th component log probs | Train: 2.74841779543647 | Val: -9.375601551810885
5-th component log probs | Train: 2.527154005621388 | Val: 0.04950313005863381
6-th component log probs | Train: 2.68308774777357 | Val: -0.10769255899460214
7-th component log probs | Train: 2.653995181300345 | Val: -0.6803351181120306
8-th component log probs | Train: 2.7150556569687336 | Val: -0.6538548988609348
9-th component log probs | Train: 2.5445901417290417 | Val: 0.028867538982703028
KEYWORD NR_SAMPLES:2000 DIM:150 AVG_DIFF:22.7343
Fitting PCA...
0-th component log probs | Train: 2.985880002234429 | Val: -5.718339394320459
1-th component log probs | Train: 3.099235839204286 | Val: -11.09110298807188
2-th component log probs | Train: 2.9300757587613027 | Val: -12.022654305383686
3-th component log probs | Train: 2.911798030156821 | Val: -12.280051509929727
4-th component log probs | Train: 3.330281174764644 | Val: -39.38243780184774
5-th component log probs | Train: 2.9980832326074762 | Val: -12.008521641036381
6-th component log probs | Train: 3.1090578672374747 | Val: -6.679535578694484
7-th component log probs | Train: 2.966033576046375 | Val: -3.233981081191608
8-th component log probs | Train: 3.186766137002072 | Val: -10.731872236865184
9-th component log probs | Train: 2.9460186146955625 | Val: -6.973123033787992
KEYWORD NR_SAMPLES:2000 DIM:200 AVG_DIFF:320.7455
Fitting PCA...
0-th component log probs | Train: 3.3784675823514285 | Val: -15.6402742239559
1-th component log probs | Train: 3.5347332998782006 | Val: -24.710923645111947
2-th component log probs | Train: 3.400180162460379 | Val: -32.28469446455045
3-th component log probs | Train: 3.409152102608105 | Val: -31.01944269765231
4-th component log probs | Train: 3.7900224507171845 | Val: -51.66874890083989
5-th component log probs | Train: 3.477073567824643 | Val: -27.248239005639398
6-th component log probs | Train: 3.5455079870116526 | Val: -17.746903259088217
7-th component log probs | Train: 3.2636162314985704 | Val: -9.22865951838832
8-th component log probs | Train: 3.631385139761457 | Val: -21.60545631714975
9-th component log probs | Train: 3.382672842575343 | Val: -22.608240789146766
KEYWORD NR_SAMPLES:2000 DIM:250 AVG_DIFF:955.9838
Fitting PCA...
0-th component log probs | Train: 3.7217477245541235 | Val: -23.592455692877795
1-th component log probs | Train: 3.8810032611264367 | Val: -32.7176391850549
2-th component log probs | Train: 3.773019627801665 | Val: -42.29296467431804
3-th component log probs | Train: 3.790986786401909 | Val: -38.92632528733858
4-th component log probs | Train: 4.121614317216178 | Val: -55.30305693293468
5-th component log probs | Train: 3.8441237427464765 | Val: -34.67646860369073
6-th component log probs | Train: 3.8894296987398396 | Val: -24.018742528413547
7-th component log probs | Train: 3.5618799348632586 | Val: -18.404733457403573
8-th component log probs | Train: 3.9704246150655833 | Val: -26.90526964502797
9-th component log probs | Train: 3.747377486647391 | Val: -31.977322835023564
KEYWORD NR_SAMPLES:2000 DIM:300 AVG_DIFF:1453.8458
Fitting PCA...
0-th component log probs | Train: 3.9966495453656776 | Val: -28.298507855446598
1-th component log probs | Train: 4.146463773649949 | Val: -35.833527366669486
2-th component log probs | Train: 4.0590130701065394 | Val: -46.454034301223544
3-th component log probs | Train: 4.078806100749145 | Val: -42.19093677299153
4-th component log probs | Train: 4.3681602604952765 | Val: -55.20434679145828
5-th component log probs | Train: 4.12303700574497 | Val: -37.938813010020155
6-th component log probs | Train: 4.15487232054765 | Val: -26.909686475279173
7-th component log probs | Train: 3.83096560647321 | Val: -26.13739080260519
8-th component log probs | Train: 4.227652994025121 | Val: -29.292441217132136
9-th component log probs | Train: 4.030387093099619 | Val: -36.431395902633895
KEYWORD NR_SAMPLES:2000 DIM:350 AVG_DIFF:1727.5779
Fitting PCA...
0-th component log probs | Train: 4.215646123665264 | Val: -30.09907757784625
1-th component log probs | Train: 4.3557561651883 | Val: -37.216700148177495
2-th component log probs | Train: 4.281776675178129 | Val: -47.33855458838358
3-th component log probs | Train: 4.302185503631835 | Val: -43.23726420023141
4-th component log probs | Train: 4.55786816028927 | Val: -53.9830145112934
5-th component log probs | Train: 4.339625758313899 | Val: -38.88715896431858
6-th component log probs | Train: 4.36252979610942 | Val: -28.207004792132647
7-th component log probs | Train: 4.05664759730373 | Val: -29.872821424410485
8-th component log probs | Train: 4.428684301189865 | Val: -30.18238721686225
9-th component log probs | Train: 4.253265825791134 | Val: -38.53294109884395
KEYWORD NR_SAMPLES:2000 DIM:400 AVG_DIFF:1836.6586
Fitting PCA...
0-th component log probs | Train: 4.393677133313135 | Val: -30.882422348728383
1-th component log probs | Train: 4.523645096884702 | Val: -37.28714642957971
2-th component log probs | Train: 4.459706223141284 | Val: -46.84242588148725
3-th component log probs | Train: 4.480196314074209 | Val: -43.04336057288982
4-th component log probs | Train: 4.708688427317124 | Val: -52.05193529062146
5-th component log probs | Train: 4.512292639710963 | Val: -38.59109374890277
6-th component log probs | Train: 4.530119518936867 | Val: -28.327106104455158
7-th component log probs | Train: 4.241312530555835 | Val: -31.857699732406136
8-th component log probs | Train: 4.5901578854626 | Val: -30.191420906258575
9-th component log probs | Train: 4.432590242925346 | Val: -39.02875313066025
KEYWORD NR_SAMPLES:2000 DIM:450 AVG_DIFF:1844.3996
Fitting PCA...
0-th component log probs | Train: 4.5407706267098025 | Val: -30.697883842470638
1-th component log probs | Train: 4.662053204322597 | Val: -36.664079110488714
2-th component log probs | Train: 4.605847488397956 | Val: -45.57414929602014
3-th component log probs | Train: 4.625548951715525 | Val: -42.01347417334984
4-th component log probs | Train: 4.831689376420064 | Val: -49.71692191700884
5-th component log probs | Train: 4.653633646381063 | Val: -37.73405099526316
6-th component log probs | Train: 4.667488860659958 | Val: -27.93667825698329
7-th component log probs | Train: 4.39795997714447 | Val: -32.389436495150896
8-th component log probs | Train: 4.722579474465526 | Val: -29.76019456300107
9-th component log probs | Train: 4.580322053901787 | Val: -38.397232915500915
KEYWORD NR_SAMPLES:2000 DIM:500 AVG_DIFF:1786.7586
0-th component log probs | Train: 4.572498245093261 | Val: -30.52447355581234
1-th component log probs | Train: 4.691780854255724 | Val: -36.369911560192165
2-th component log probs | Train: 4.637042656364294 | Val: -45.18481806736401
3-th component log probs | Train: 4.656596902537754 | Val: -41.665259947507735
4-th component log probs | Train: 4.8579610864527005 | Val: -49.10241794140756
5-th component log probs | Train: 4.683862003754029 | Val: -37.49293656258796
6-th component log probs | Train: 4.696972787188206 | Val: -27.757279523780962
7-th component log probs | Train: 4.4320472183316495 | Val: -32.33102988199758
8-th component log probs | Train: 4.750940113608343 | Val: -29.5503697425707
9-th component log probs | Train: 4.6118818368375 | Val: -38.15082368409858
KEYWORD NR_SAMPLES:2000 DIM:512 AVG_DIFF:1764.6428
best average differences at 50 dimensions: 0.4175762030323208
2022-01-09 09:22.38 [info     ] Training complete              train_loss=1.2662088871002197
2022-01-09 09:22.38 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:22.40 [info     ] Testing complete               test_loss=1.394713044166565
{'dataset_size': 2000,
 'end_test_accuracy': 0.5236862897872925,
 'end_test_loss': 1.394713044166565,
 'end_train_accuracy': 0.75244140625,
 'end_train_loss': 1.2662088871002197,
 'end_val_accuracy': 0.5301552414894104,
 'end_val_loss': 1.5570883750915527}
2022-01-09 09:22.40 [info     ] Start Predict                  dataset=38000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:23.01 [info     ] Starting training              dataset=4000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
4000
Fitting PCA...
0-th component log probs | Train: 1.52856361320378 | Val: 1.4496576829025265
1-th component log probs | Train: 1.6394103375055789 | Val: 1.4555982089564792
2-th component log probs | Train: 1.441484130424427 | Val: 1.2936266837985195
3-th component log probs | Train: 1.399798960123773 | Val: 1.2834953692675526
4-th component log probs | Train: 1.4872009698926325 | Val: 1.3319855497498652
5-th component log probs | Train: 1.4814526556802685 | Val: 1.3156275472460328
6-th component log probs | Train: 1.5600056977788925 | Val: 1.4076366244909428
7-th component log probs | Train: 1.5045894633070864 | Val: 1.2957989689004807
8-th component log probs | Train: 1.6322691192683474 | Val: 1.4831785355065463
9-th component log probs | Train: 1.5678140130634808 | Val: 1.4454889556784325
KEYWORD NR_SAMPLES:4000 DIM:50 AVG_DIFF:0.0231
Fitting PCA...
0-th component log probs | Train: 2.0135934299636506 | Val: 1.8841782729179994
1-th component log probs | Train: 2.1166698687726435 | Val: 1.889951685640475
2-th component log probs | Train: 1.9194207904067007 | Val: 1.6595525480423834
3-th component log probs | Train: 1.864501816913687 | Val: 1.6804036185000282
4-th component log probs | Train: 1.9838150921278648 | Val: 1.7146482023416567
5-th component log probs | Train: 1.9662498192472995 | Val: 1.6976485123512983
6-th component log probs | Train: 2.048770412263266 | Val: 1.8049668699874406
7-th component log probs | Train: 1.985191748063365 | Val: 1.7223850172936195
8-th component log probs | Train: 2.137684822535221 | Val: 1.8540696735898574
9-th component log probs | Train: 2.0388163169500744 | Val: 1.8627178240691435
KEYWORD NR_SAMPLES:4000 DIM:100 AVG_DIFF:0.0554
Fitting PCA...
0-th component log probs | Train: 2.3210042987209047 | Val: 2.0312490499363647
1-th component log probs | Train: 2.390012154169917 | Val: 2.055030822649364
2-th component log probs | Train: 2.228178460259478 | Val: 1.7302580960181473
3-th component log probs | Train: 2.14691758349417 | Val: 1.8221510285186315
4-th component log probs | Train: 2.2998022390416724 | Val: 1.7724431489532784
5-th component log probs | Train: 2.270985321270987 | Val: 1.775555452095726
6-th component log probs | Train: 2.3557249457818754 | Val: 1.8850124933665646
7-th component log probs | Train: 2.2772562868277917 | Val: 1.8769712565499423
8-th component log probs | Train: 2.4521607771330802 | Val: 1.9154590876712287
9-th component log probs | Train: 2.3180031176139724 | Val: 2.0304649735754072
KEYWORD NR_SAMPLES:4000 DIM:150 AVG_DIFF:0.1826
Fitting PCA...
0-th component log probs | Train: 2.5672499576649352 | Val: 2.0354753311199865
1-th component log probs | Train: 2.6125879380497663 | Val: 2.1055407292948107
2-th component log probs | Train: 2.482355882025929 | Val: 1.603611648483241
3-th component log probs | Train: 2.382832602873668 | Val: 1.8393265403861117
4-th component log probs | Train: 2.560178171758325 | Val: 1.600093019509108
5-th component log probs | Train: 2.5339595994869444 | Val: 1.630985425956069
6-th component log probs | Train: 2.6216783293079535 | Val: 1.7021203681043078
7-th component log probs | Train: 2.5104745994997404 | Val: 1.8840361919430881
8-th component log probs | Train: 2.7128330234255227 | Val: 1.6912002430615138
9-th component log probs | Train: 2.5476423445812952 | Val: 2.0869042966419453
KEYWORD NR_SAMPLES:4000 DIM:200 AVG_DIFF:0.5839
Fitting PCA...
0-th component log probs | Train: 2.7844190456257563 | Val: 1.8628998533459242
1-th component log probs | Train: 2.8082633864764395 | Val: 2.0519479081571275
2-th component log probs | Train: 2.7075835329204008 | Val: 1.1866562684662163
3-th component log probs | Train: 2.592240713194871 | Val: 1.6993506140605037
4-th component log probs | Train: 2.7992351725702043 | Val: 0.9751758331201106
5-th component log probs | Train: 2.784870661392665 | Val: 0.8254079851058924
6-th component log probs | Train: 2.8609931327293032 | Val: 1.1344621380652853
7-th component log probs | Train: 2.7156121430637974 | Val: 1.7793624457348327
8-th component log probs | Train: 2.9564610531498308 | Val: 1.1495151478642924
9-th component log probs | Train: 2.751767926079056 | Val: 2.034175780321478
KEYWORD NR_SAMPLES:4000 DIM:250 AVG_DIFF:1.9336
Fitting PCA...
0-th component log probs | Train: 2.9866691113211803 | Val: 1.4668659518493765
1-th component log probs | Train: 2.9854890084597896 | Val: 1.920011428148062
2-th component log probs | Train: 2.919511083361682 | Val: 0.27984814554219545
3-th component log probs | Train: 2.7880712860900574 | Val: 1.3186205604667443
4-th component log probs | Train: 3.0412863865544546 | Val: -0.8561930381982968
5-th component log probs | Train: 3.0438694219705065 | Val: -1.8949439920124165
6-th component log probs | Train: 3.091931380075863 | Val: -0.15920545835907743
7-th component log probs | Train: 2.9024503604895506 | Val: 1.5064499689634825
8-th component log probs | Train: 3.183277541096063 | Val: 0.03473878049822036
9-th component log probs | Train: 2.9342011067390414 | Val: 1.8687252065388502
KEYWORD NR_SAMPLES:4000 DIM:300 AVG_DIFF:7.5722
Fitting PCA...
0-th component log probs | Train: 3.1815325311217255 | Val: 0.6465205399142844
1-th component log probs | Train: 3.1501068727297814 | Val: 1.609167983079829
2-th component log probs | Train: 3.1366026478275915 | Val: -1.9782834071416469
3-th component log probs | Train: 2.984083701475906 | Val: 0.17932867445984246
4-th component log probs | Train: 3.302482100624046 | Val: -4.807784143869869
5-th component log probs | Train: 3.3232127343830253 | Val: -6.652426874852057
6-th component log probs | Train: 3.3266918337696887 | Val: -2.6075568385566066
7-th component log probs | Train: 3.0712756523853377 | Val: 0.9873735129544312
8-th component log probs | Train: 3.4089286832732792 | Val: -1.8799090458422163
9-th component log probs | Train: 3.103326108365804 | Val: 1.511157695024342
KEYWORD NR_SAMPLES:4000 DIM:350 AVG_DIFF:27.8184
Fitting PCA...
0-th component log probs | Train: 3.3763019246748964 | Val: -0.740189639565813
1-th component log probs | Train: 3.309542891993887 | Val: 1.0251641101980469
2-th component log probs | Train: 3.3654194632095624 | Val: -6.015954918671672
3-th component log probs | Train: 3.192333709975653 | Val: -2.2574969024225413
4-th component log probs | Train: 3.553976247191715 | Val: -9.007115058905411
5-th component log probs | Train: 3.5857051003022824 | Val: -11.502367719533755
6-th component log probs | Train: 3.55899401877686 | Val: -5.789186321620546
7-th component log probs | Train: 3.2371382216132143 | Val: 0.052431186411716665
8-th component log probs | Train: 3.6247238050799453 | Val: -4.109569873599496
9-th component log probs | Train: 3.2673525461704624 | Val: 0.8621192066377033
KEYWORD NR_SAMPLES:4000 DIM:400 AVG_DIFF:68.8441
Fitting PCA...
0-th component log probs | Train: 3.5658165044451606 | Val: -2.554844740865631
1-th component log probs | Train: 3.46400080782494 | Val: 0.13899907930363908
2-th component log probs | Train: 3.5844536855049816 | Val: -9.836559959025696
3-th component log probs | Train: 3.4094536863684506 | Val: -5.831454227546347
4-th component log probs | Train: 3.776663290975781 | Val: -12.101619016436041
5-th component log probs | Train: 3.8111063358849613 | Val: -14.893183177590888
6-th component log probs | Train: 3.770979167008541 | Val: -8.671680283087227
7-th component log probs | Train: 3.4007589535467857 | Val: -1.2783044060263948
8-th component log probs | Train: 3.8214985929214897 | Val: -5.908034145013599
9-th component log probs | Train: 3.4280211442401063 | Val: -0.17213765456517585
KEYWORD NR_SAMPLES:4000 DIM:450 AVG_DIFF:120.0345
Fitting PCA...
0-th component log probs | Train: 3.7478007805132685 | Val: -4.186601028891141
1-th component log probs | Train: 3.6217836016789735 | Val: -0.9290576140710646
2-th component log probs | Train: 3.7838829165414074 | Val: -12.637854950136925
3-th component log probs | Train: 3.618395620059685 | Val: -9.013652967156364
4-th component log probs | Train: 3.9689272567522975 | Val: -13.998946056912082
5-th component log probs | Train: 4.003747876217229 | Val: -16.930315749898266
6-th component log probs | Train: 3.956744011148814 | Val: -10.543428660977707
7-th component log probs | Train: 3.5710417991510264 | Val: -3.0707154903048344
8-th component log probs | Train: 3.995929827197392 | Val: -7.15825831855717
9-th component log probs | Train: 3.591832398765263 | Val: -1.4777480199561468
KEYWORD NR_SAMPLES:4000 DIM:500 AVG_DIFF:167.8471
0-th component log probs | Train: 3.7896343873145097 | Val: -4.505919161976785
1-th component log probs | Train: 3.659589556495475 | Val: -1.1809523924942673
2-th component log probs | Train: 3.8286028085543786 | Val: -13.264795007439021
3-th component log probs | Train: 3.665243945944894 | Val: -9.620173006797094
4-th component log probs | Train: 4.01068751720356 | Val: -14.295334488201554
5-th component log probs | Train: 4.045864338214136 | Val: -17.17338429144205
6-th component log probs | Train: 3.9979702992129074 | Val: -10.86779651363194
7-th component log probs | Train: 3.611618949487225 | Val: -3.4719560169242647
8-th component log probs | Train: 4.034930435603317 | Val: -7.41802825666279
9-th component log probs | Train: 3.6311747309707223 | Val: -1.7951344146309771
KEYWORD NR_SAMPLES:4000 DIM:512 AVG_DIFF:177.8084
best average differences at 50 dimensions: 0.023099241432443653
2022-01-09 09:30.00 [info     ] Training complete              train_loss=1.193537712097168
2022-01-09 09:30.00 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:30.02 [info     ] Testing complete               test_loss=1.065051794052124
{'dataset_size': 4000,
 'end_test_accuracy': 0.6304737329483032,
 'end_test_loss': 1.065051794052124,
 'end_train_accuracy': 0.7529761791229248,
 'end_train_loss': 1.193537712097168,
 'end_val_accuracy': 0.6416202187538147,
 'end_val_loss': 1.1425325870513916}
2022-01-09 09:30.02 [info     ] Start Predict                  dataset=36000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:30.26 [info     ] Starting training              dataset=6000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
6000
Fitting PCA...
0-th component log probs | Train: 1.4597100940571002 | Val: 1.5317902984057277
1-th component log probs | Train: 1.5602802216332043 | Val: 1.4673176781542625
2-th component log probs | Train: 1.3996638616505475 | Val: 1.3067292157078285
3-th component log probs | Train: 1.3300221596915054 | Val: 1.2885374927498996
4-th component log probs | Train: 1.4126025218719667 | Val: 1.3648849624493264
5-th component log probs | Train: 1.3862440694067522 | Val: 1.3922182669933063
6-th component log probs | Train: 1.506190376731418 | Val: 1.4652092435157327
7-th component log probs | Train: 1.460681093143889 | Val: 1.314822040072561
8-th component log probs | Train: 1.5791916645675803 | Val: 1.7333319607268676
9-th component log probs | Train: 1.4856811110455068 | Val: 1.3498645216487277
KEYWORD NR_SAMPLES:6000 DIM:50 AVG_DIFF:0.0092
Fitting PCA...
0-th component log probs | Train: 1.9348222754848854 | Val: 1.9970326802710123
1-th component log probs | Train: 2.0354199403203395 | Val: 1.9461159069758258
2-th component log probs | Train: 1.8752097089453954 | Val: 1.7456786518461525
3-th component log probs | Train: 1.7686270296065165 | Val: 1.7324411349851347
4-th component log probs | Train: 1.8766550004281768 | Val: 1.808106719909871
5-th component log probs | Train: 1.8505826548809385 | Val: 1.8184873189630788
6-th component log probs | Train: 1.9719194382636582 | Val: 1.8977504082719467
7-th component log probs | Train: 1.9114070992794105 | Val: 1.7787233949791783
8-th component log probs | Train: 2.056664202027477 | Val: 2.1798487053526907
9-th component log probs | Train: 1.940696826900176 | Val: 1.8315901007428572
KEYWORD NR_SAMPLES:6000 DIM:100 AVG_DIFF:0.0086
Fitting PCA...
0-th component log probs | Train: 2.209351789391383 | Val: 2.204545166209507
1-th component log probs | Train: 2.2985770789794477 | Val: 2.1484269798246904
2-th component log probs | Train: 2.158562317134427 | Val: 1.9049561245104365
3-th component log probs | Train: 2.0276159752560576 | Val: 1.9349630362233932
4-th component log probs | Train: 2.1549432006875455 | Val: 1.9920885619130404
5-th component log probs | Train: 2.1253049501243586 | Val: 2.0063262015567527
6-th component log probs | Train: 2.2524281087819027 | Val: 2.0921335447512566
7-th component log probs | Train: 2.1695988013868837 | Val: 1.957200489494776
8-th component log probs | Train: 2.3358297229903267 | Val: 2.3831405112494504
9-th component log probs | Train: 2.2044348326427268 | Val: 2.033868970775313
KEYWORD NR_SAMPLES:6000 DIM:150 AVG_DIFF:0.0238
Fitting PCA...
0-th component log probs | Train: 2.425168006471249 | Val: 2.333585971034666
1-th component log probs | Train: 2.5015191283156093 | Val: 2.264792865176866
2-th component log probs | Train: 2.379746726015414 | Val: 1.9839979202005396
3-th component log probs | Train: 2.2371003052455802 | Val: 2.072180714574302
4-th component log probs | Train: 2.3754679232027005 | Val: 2.099473192224256
5-th component log probs | Train: 2.350648064054624 | Val: 2.101771220661422
6-th component log probs | Train: 2.4782637352050556 | Val: 2.184665008688067
7-th component log probs | Train: 2.3786785006688675 | Val: 2.074594283393745
8-th component log probs | Train: 2.556059428235341 | Val: 2.5119834320207137
9-th component log probs | Train: 2.4107254483550498 | Val: 2.1652971525004343
KEYWORD NR_SAMPLES:6000 DIM:200 AVG_DIFF:0.0627
Fitting PCA...
0-th component log probs | Train: 2.613339637371451 | Val: 2.412623075185716
1-th component log probs | Train: 2.6794906306818302 | Val: 2.339478815129272
2-th component log probs | Train: 2.5721712774050163 | Val: 1.998106840375726
3-th component log probs | Train: 2.4207488382075817 | Val: 2.1579115344017255
4-th component log probs | Train: 2.568860439818214 | Val: 2.1424593588538396
5-th component log probs | Train: 2.55142421328067 | Val: 2.1148652273695085
6-th component log probs | Train: 2.673428707617495 | Val: 2.2136201091675884
7-th component log probs | Train: 2.559142043614981 | Val: 2.1453800688904976
8-th component log probs | Train: 2.7515161893356233 | Val: 2.598266302971224
9-th component log probs | Train: 2.588309746627754 | Val: 2.2416958219804393
KEYWORD NR_SAMPLES:6000 DIM:250 AVG_DIFF:0.1453
Fitting PCA...
0-th component log probs | Train: 2.780930801863681 | Val: 2.459369870928654
1-th component log probs | Train: 2.841337703925675 | Val: 2.3792585501579726
2-th component log probs | Train: 2.7486269860648136 | Val: 1.9260290804440587
3-th component log probs | Train: 2.5874024976325223 | Val: 2.2023080638215125
4-th component log probs | Train: 2.7436262894099532 | Val: 2.112594596796216
5-th component log probs | Train: 2.7327743939636067 | Val: 2.041309071644592
6-th component log probs | Train: 2.8531641552038067 | Val: 2.135843188419547
7-th component log probs | Train: 2.721283417287609 | Val: 2.177946436917505
8-th component log probs | Train: 2.926130229976549 | Val: 2.62391902244271
9-th component log probs | Train: 2.7520470468385527 | Val: 2.288510548417112
KEYWORD NR_SAMPLES:6000 DIM:300 AVG_DIFF:0.3134
Fitting PCA...
0-th component log probs | Train: 2.9319506810911897 | Val: 2.4600324189057234
1-th component log probs | Train: 2.9861446089439605 | Val: 2.3776425869520756
2-th component log probs | Train: 2.9072138642382774 | Val: 1.7505606237513152
3-th component log probs | Train: 2.7407713132164067 | Val: 2.1763883335828003
4-th component log probs | Train: 2.9018079103621672 | Val: 1.9986021453064844
5-th component log probs | Train: 2.9049995284898085 | Val: 1.7690566553033582
6-th component log probs | Train: 3.0161232751081712 | Val: 1.9523018914073107
7-th component log probs | Train: 2.866741547508899 | Val: 2.172936906331939
8-th component log probs | Train: 3.087534834135424 | Val: 2.5869578578422034
9-th component log probs | Train: 2.9003571499548526 | Val: 2.2795372577121578
KEYWORD NR_SAMPLES:6000 DIM:350 AVG_DIFF:0.6605
Fitting PCA...
0-th component log probs | Train: 3.0720731810089394 | Val: 2.398828058246197
1-th component log probs | Train: 3.1171670765886543 | Val: 2.317191740947723
2-th component log probs | Train: 3.0597394003145313 | Val: 1.4480794824077559
3-th component log probs | Train: 2.8803864626938784 | Val: 2.0954204943391064
4-th component log probs | Train: 3.053624482650884 | Val: 1.7110934976406766
5-th component log probs | Train: 3.0728272415931683 | Val: 1.1956312779663265
6-th component log probs | Train: 3.1685218351252593 | Val: 1.6181472849159015
7-th component log probs | Train: 2.998498384135691 | Val: 2.101632824854171
8-th component log probs | Train: 3.2347556510888387 | Val: 2.4683018656435567
9-th component log probs | Train: 3.0352149828980988 | Val: 2.211963036291042
KEYWORD NR_SAMPLES:6000 DIM:400 AVG_DIFF:1.4106
Fitting PCA...
0-th component log probs | Train: 3.2030023613375422 | Val: 2.265662001106241
1-th component log probs | Train: 3.2391316159389096 | Val: 2.194602873515655
2-th component log probs | Train: 3.205727523752193 | Val: 0.842677801357456
3-th component log probs | Train: 3.0126624741514347 | Val: 1.8953163552981906
4-th component log probs | Train: 3.2007669899959192 | Val: 1.126099723694271
5-th component log probs | Train: 3.240880208116487 | Val: 0.17955338106129695
6-th component log probs | Train: 3.318230637424486 | Val: 1.0523928586824136
7-th component log probs | Train: 3.1208802624248535 | Val: 1.958368037843488
8-th component log probs | Train: 3.373916966064817 | Val: 2.245247863339914
9-th component log probs | Train: 3.15899599935956 | Val: 2.093318502252912
KEYWORD NR_SAMPLES:6000 DIM:450 AVG_DIFF:3.1373
Fitting PCA...
0-th component log probs | Train: 3.3316526702889244 | Val: 2.0440446076458154
1-th component log probs | Train: 3.360502631794304 | Val: 1.991756086661605
2-th component log probs | Train: 3.353802137031171 | Val: -0.029925089908846018
3-th component log probs | Train: 3.1467124721623008 | Val: 1.5138489381323286
4-th component log probs | Train: 3.3534363859350207 | Val: 0.23527064702077038
5-th component log probs | Train: 3.422438677437474 | Val: -1.568332536145921
6-th component log probs | Train: 3.469168523448845 | Val: 0.197353034803931
7-th component log probs | Train: 3.241499904471644 | Val: 1.7314561200291059
8-th component log probs | Train: 3.5123960174538857 | Val: 1.9586376351203516
9-th component log probs | Train: 3.280987109722504 | Val: 1.8754988866045135
KEYWORD NR_SAMPLES:6000 DIM:500 AVG_DIFF:6.9653
0-th component log probs | Train: 3.3634670346874413 | Val: 1.9798184280334084
1-th component log probs | Train: 3.3904681306290367 | Val: 1.9270108861436992
2-th component log probs | Train: 3.3903961665150275 | Val: -0.2797443644255199
3-th component log probs | Train: 3.1789370884805317 | Val: 1.395359088864218
4-th component log probs | Train: 3.391103361574848 | Val: -0.006655078694286222
5-th component log probs | Train: 3.4655909458871563 | Val: -1.9747532618338688
6-th component log probs | Train: 3.5054004744638223 | Val: -0.0419812523667341
7-th component log probs | Train: 3.271049598622669 | Val: 1.66784856631198
8-th component log probs | Train: 3.5465088854488016 | Val: 1.8977034136240039
9-th component log probs | Train: 3.3108004126252757 | Val: 1.8159132409664307
KEYWORD NR_SAMPLES:6000 DIM:512 AVG_DIFF:8.1957
best average differences at 100 dimensions: 0.008584674585673604
2022-01-09 09:39.56 [info     ] Training complete              train_loss=1.191688895225525
2022-01-09 09:39.56 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:39.58 [info     ] Testing complete               test_loss=0.9489527344703674
{'dataset_size': 6000,
 'end_test_accuracy': 0.6769506335258484,
 'end_test_loss': 0.9489527344703674,
 'end_train_accuracy': 0.7342641949653625,
 'end_train_loss': 1.191688895225525,
 'end_val_accuracy': 0.6915804147720337,
 'end_val_loss': 0.9838892221450806}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:39.59 [info     ] Start Predict                  dataset=34000
2022-01-09 09:40.23 [info     ] Starting training              dataset=8000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
8000
Fitting PCA...
0-th component log probs | Train: 1.4096392704130098 | Val: 1.4859496919842003
1-th component log probs | Train: 1.5266171773218211 | Val: 1.4149996095310309
2-th component log probs | Train: 1.315931545778441 | Val: 1.2602174127705212
3-th component log probs | Train: 1.3109909589520246 | Val: 1.285284250039787
4-th component log probs | Train: 1.352435069029486 | Val: 1.3491449880339523
5-th component log probs | Train: 1.3516321326739695 | Val: 1.3936716098763082
6-th component log probs | Train: 1.4497895567229317 | Val: 1.4723524700344222
7-th component log probs | Train: 1.4365633656235262 | Val: 1.3303562375643514
8-th component log probs | Train: 1.462955757937938 | Val: 1.571550307734205
9-th component log probs | Train: 1.4463008158751487 | Val: 1.441724835408655
KEYWORD NR_SAMPLES:8000 DIM:50 AVG_DIFF:0.0047
Fitting PCA...
0-th component log probs | Train: 1.8718389342419028 | Val: 1.9399798333870542
1-th component log probs | Train: 1.9904908334670723 | Val: 1.887832108556056
2-th component log probs | Train: 1.7681939977711334 | Val: 1.7062703451930745
3-th component log probs | Train: 1.7446024309303612 | Val: 1.7307562294903935
4-th component log probs | Train: 1.8012950687225548 | Val: 1.806129050532239
5-th component log probs | Train: 1.7988065008115879 | Val: 1.8376572585167787
6-th component log probs | Train: 1.9103831982351316 | Val: 1.9184309224336347
7-th component log probs | Train: 1.8730865652980586 | Val: 1.777694028313245
8-th component log probs | Train: 1.926630901197013 | Val: 2.026831288826247
9-th component log probs | Train: 1.899647027331279 | Val: 1.9163555535146377
KEYWORD NR_SAMPLES:8000 DIM:100 AVG_DIFF:0.0040
Fitting PCA...
0-th component log probs | Train: 2.1295938688408538 | Val: 2.1653379328463083
1-th component log probs | Train: 2.24438525406919 | Val: 2.113093329087875
2-th component log probs | Train: 2.0288854916554877 | Val: 1.9025791941276933
3-th component log probs | Train: 1.9820540379418 | Val: 1.943849617976263
4-th component log probs | Train: 2.0570643992245627 | Val: 2.0187725564164736
5-th component log probs | Train: 2.0538190793042808 | Val: 2.0386818426284026
6-th component log probs | Train: 2.1683421843199886 | Val: 2.1264480636310084
7-th component log probs | Train: 2.116848979165628 | Val: 1.9745173888789673
8-th component log probs | Train: 2.1797964471595006 | Val: 2.245024631037143
9-th component log probs | Train: 2.1486587756403663 | Val: 2.1353322866417503
KEYWORD NR_SAMPLES:8000 DIM:150 AVG_DIFF:0.0064
Fitting PCA...
0-th component log probs | Train: 2.328195554135427 | Val: 2.3126528186557707
1-th component log probs | Train: 2.4368902801687593 | Val: 2.255667150188877
2-th component log probs | Train: 2.229169840411443 | Val: 2.0291929044625436
3-th component log probs | Train: 2.172094421806846 | Val: 2.0873251870489753
4-th component log probs | Train: 2.2568676907882885 | Val: 2.1568857491651796
5-th component log probs | Train: 2.254199198128907 | Val: 2.16841407880812
6-th component log probs | Train: 2.372238934842228 | Val: 2.2626887318049795
7-th component log probs | Train: 2.3072147482215657 | Val: 2.107189142073841
8-th component log probs | Train: 2.379175359294465 | Val: 2.388656124703995
9-th component log probs | Train: 2.3382591592243505 | Val: 2.27691014467988
KEYWORD NR_SAMPLES:8000 DIM:200 AVG_DIFF:0.0153
Fitting PCA...
0-th component log probs | Train: 2.4981061156566438 | Val: 2.4179444011913667
1-th component log probs | Train: 2.605345826809543 | Val: 2.3475053391553566
2-th component log probs | Train: 2.4040535142437545 | Val: 2.1191513350595588
3-th component log probs | Train: 2.3368029216222506 | Val: 2.197944597614318
4-th component log probs | Train: 2.4306047374099937 | Val: 2.2535165160683612
5-th component log probs | Train: 2.432877548509466 | Val: 2.255479916158917
6-th component log probs | Train: 2.550225912523295 | Val: 2.352267674022705
7-th component log probs | Train: 2.4744067377428345 | Val: 2.2020645182373606
8-th component log probs | Train: 2.5520484254561433 | Val: 2.4949388450129177
9-th component log probs | Train: 2.5031462133085447 | Val: 2.384945262320227
KEYWORD NR_SAMPLES:8000 DIM:250 AVG_DIFF:0.0367
Fitting PCA...
0-th component log probs | Train: 2.6502925172801173 | Val: 2.4999957300958355
1-th component log probs | Train: 2.7570721499571516 | Val: 2.414563237110165
2-th component log probs | Train: 2.5601259354533052 | Val: 2.1755245758610666
3-th component log probs | Train: 2.4859896529605705 | Val: 2.2905236468492385
4-th component log probs | Train: 2.588331332022445 | Val: 2.322202206812291
5-th component log probs | Train: 2.5940100591368105 | Val: 2.3098895178917553
6-th component log probs | Train: 2.7098590880855067 | Val: 2.4134648501367697
7-th component log probs | Train: 2.6251239658476857 | Val: 2.2748688963152897
8-th component log probs | Train: 2.7050979851233956 | Val: 2.5826507653414486
9-th component log probs | Train: 2.652263625518852 | Val: 2.4791177830602824
KEYWORD NR_SAMPLES:8000 DIM:300 AVG_DIFF:0.0733
Fitting PCA...
0-th component log probs | Train: 2.789772974393784 | Val: 2.568518033814489
1-th component log probs | Train: 2.8944604887913656 | Val: 2.4537498981159653
2-th component log probs | Train: 2.703389438136391 | Val: 2.210025775957695
3-th component log probs | Train: 2.6218730186798664 | Val: 2.3587991392302246
4-th component log probs | Train: 2.7304388775349597 | Val: 2.3645116906172645
5-th component log probs | Train: 2.7417566127029493 | Val: 2.3238663846896004
6-th component log probs | Train: 2.8545606178093696 | Val: 2.4418972565700536
7-th component log probs | Train: 2.7587625929888344 | Val: 2.327709489508672
8-th component log probs | Train: 2.844865435606871 | Val: 2.6430299066841187
9-th component log probs | Train: 2.788857170354569 | Val: 2.5445794609096484
KEYWORD NR_SAMPLES:8000 DIM:350 AVG_DIFF:0.1321
Fitting PCA...
0-th component log probs | Train: 2.9156588976574986 | Val: 2.6095897340016974
1-th component log probs | Train: 3.020303647819695 | Val: 2.4532787495954738
2-th component log probs | Train: 2.832858768569079 | Val: 2.201134229411371
3-th component log probs | Train: 2.7453112579440573 | Val: 2.4009600764208976
4-th component log probs | Train: 2.8593843665870513 | Val: 2.370503194384162
5-th component log probs | Train: 2.8795680019891154 | Val: 2.2837271252495652
6-th component log probs | Train: 2.985012052173557 | Val: 2.418721355916773
7-th component log probs | Train: 2.8800123748545468 | Val: 2.3532002204018867
8-th component log probs | Train: 2.9723754090716454 | Val: 2.6811901470771757
9-th component log probs | Train: 2.9119692958491274 | Val: 2.581447614576603
KEYWORD NR_SAMPLES:8000 DIM:400 AVG_DIFF:0.2319
Fitting PCA...
0-th component log probs | Train: 3.0299905332918957 | Val: 2.611166575410441
1-th component log probs | Train: 3.1325517799792695 | Val: 2.424052589010827
2-th component log probs | Train: 2.9517665823571737 | Val: 2.1395956252437855
3-th component log probs | Train: 2.856764369905435 | Val: 2.4209622278818244
4-th component log probs | Train: 2.978654919351709 | Val: 2.322679677813171
5-th component log probs | Train: 3.0058204690254002 | Val: 2.1672990815162
6-th component log probs | Train: 3.1051488382200882 | Val: 2.33853771087525
7-th component log probs | Train: 2.9885837038674836 | Val: 2.3518793418206916
8-th component log probs | Train: 3.0904205822620936 | Val: 2.6647005969737725
9-th component log probs | Train: 3.0220121499852297 | Val: 2.5910543601590628
KEYWORD NR_SAMPLES:8000 DIM:450 AVG_DIFF:0.4020
Fitting PCA...
0-th component log probs | Train: 3.1407821353907632 | Val: 2.5846241021690974
1-th component log probs | Train: 3.2417399611748707 | Val: 2.3564043650258935
2-th component log probs | Train: 3.0680616783920596 | Val: 2.0118020163360884
3-th component log probs | Train: 2.9648486299866654 | Val: 2.4130121355057383
4-th component log probs | Train: 3.0935377890074482 | Val: 2.226201092641586
5-th component log probs | Train: 3.1331546122350544 | Val: 1.9468974048393146
6-th component log probs | Train: 3.221805279434369 | Val: 2.209694569921059
7-th component log probs | Train: 3.094861781583048 | Val: 2.3149406056928212
8-th component log probs | Train: 3.2015148200059564 | Val: 2.6344419591605934
9-th component log probs | Train: 3.1282020934634023 | Val: 2.5712915422352896
KEYWORD NR_SAMPLES:8000 DIM:500 AVG_DIFF:0.6937
0-th component log probs | Train: 3.167644080119973 | Val: 2.567636195928778
1-th component log probs | Train: 3.2680628016661144 | Val: 2.3363341386112064
2-th component log probs | Train: 3.0961285615240106 | Val: 1.9738320104613325
3-th component log probs | Train: 2.991109407582361 | Val: 2.4081181805933074
4-th component log probs | Train: 3.1212679960594225 | Val: 2.1924510036459526
5-th component log probs | Train: 3.1642114204206138 | Val: 1.887365490277776
6-th component log probs | Train: 3.249953111267061 | Val: 2.1676950783532445
7-th component log probs | Train: 3.1205246115369514 | Val: 2.300041390876818
8-th component log probs | Train: 3.2284917560244772 | Val: 2.6220903991572633
9-th component log probs | Train: 3.1530401693365406 | Val: 2.5652266631966976
KEYWORD NR_SAMPLES:8000 DIM:512 AVG_DIFF:0.7878
best average differences at 100 dimensions: 0.004022479523943659
2022-01-09 09:52.24 [info     ] Training complete              train_loss=1.1810202598571777
2022-01-09 09:52.24 [info     ] Starting evaluating            dataset=10000
2022-01-09 09:52.26 [info     ] Testing complete               test_loss=0.8323015570640564
{'dataset_size': 8000,
 'end_test_accuracy': 0.7137739062309265,
 'end_test_loss': 0.8323015570640564,
 'end_train_accuracy': 0.7318750023841858,
 'end_train_loss': 1.1810202598571777,
 'end_val_accuracy': 0.7269108295440674,
 'end_val_loss': 0.8405500054359436}
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 09:52.26 [info     ] Start Predict                  dataset=32000
2022-01-09 09:52.51 [info     ] Starting training              dataset=10000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
10000
Fitting PCA...
0-th component log probs | Train: 1.3611446668262173 | Val: 1.3559684736500344
1-th component log probs | Train: 1.5080533202955246 | Val: 1.4521218829424685
2-th component log probs | Train: 1.3391765456233224 | Val: 1.2879698332461753
3-th component log probs | Train: 1.303733969472656 | Val: 1.3116974666383268
4-th component log probs | Train: 1.383457934481894 | Val: 1.3802505582142577
5-th component log probs | Train: 1.3595244716982138 | Val: 1.4150432899265404
6-th component log probs | Train: 1.4240787586954347 | Val: 1.4875838938546562
7-th component log probs | Train: 1.3992773064780926 | Val: 1.4038129487907245
8-th component log probs | Train: 1.5059994581447853 | Val: 1.6362852300338044
9-th component log probs | Train: 1.425492319730503 | Val: 1.470869949337806
KEYWORD NR_SAMPLES:10000 DIM:50 AVG_DIFF:0.0032
Fitting PCA...
0-th component log probs | Train: 1.80779091882342 | Val: 1.8055742798390526
1-th component log probs | Train: 1.9556329941372788 | Val: 1.9157960944310444
2-th component log probs | Train: 1.7834578640544476 | Val: 1.7374284863970895
3-th component log probs | Train: 1.7345924533944765 | Val: 1.7579396759712849
4-th component log probs | Train: 1.8311162830581251 | Val: 1.831602386046002
5-th component log probs | Train: 1.801533059315901 | Val: 1.8527497137731619
6-th component log probs | Train: 1.8848002986941081 | Val: 1.9308527965205387
7-th component log probs | Train: 1.83944428037689 | Val: 1.8365228797677997
8-th component log probs | Train: 1.9591978683297586 | Val: 2.079092617335752
9-th component log probs | Train: 1.8768022824296862 | Val: 1.922591241728128
KEYWORD NR_SAMPLES:10000 DIM:100 AVG_DIFF:0.0025
Fitting PCA...
0-th component log probs | Train: 2.060803605136192 | Val: 2.0380843283603096
1-th component log probs | Train: 2.198635941065679 | Val: 2.1337165498386823
2-th component log probs | Train: 2.0323387497746737 | Val: 1.9631617181687413
3-th component log probs | Train: 1.9743892174150441 | Val: 1.9797008423747506
4-th component log probs | Train: 2.083747063739854 | Val: 2.0575720862844964
5-th component log probs | Train: 2.051523918134934 | Val: 2.0753398345912233
6-th component log probs | Train: 2.141848899231321 | Val: 2.1528975863306106
7-th component log probs | Train: 2.083589903812443 | Val: 2.05570968511858
8-th component log probs | Train: 2.209421929945832 | Val: 2.3010494194009783
9-th component log probs | Train: 2.116220819303533 | Val: 2.132718094724297
KEYWORD NR_SAMPLES:10000 DIM:150 AVG_DIFF:0.0020
Fitting PCA...
0-th component log probs | Train: 2.253352907159359 | Val: 2.1984758909135054
1-th component log probs | Train: 2.385537351111859 | Val: 2.2749995539744545
2-th component log probs | Train: 2.224306057271061 | Val: 2.1131640174868376
3-th component log probs | Train: 2.1582495743788046 | Val: 2.135370861115212
4-th component log probs | Train: 2.2775360817002577 | Val: 2.209621201803817
5-th component log probs | Train: 2.2416387704605163 | Val: 2.2221110186498882
6-th component log probs | Train: 2.340038742797321 | Val: 2.294497794981109
7-th component log probs | Train: 2.266780586550352 | Val: 2.199285008159064
8-th component log probs | Train: 2.400643587963109 | Val: 2.449881597460602
9-th component log probs | Train: 2.303495353036566 | Val: 2.2867910673919893
KEYWORD NR_SAMPLES:10000 DIM:200 AVG_DIFF:0.0042
Fitting PCA...
0-th component log probs | Train: 2.4155437519107914 | Val: 2.3285969296588385
1-th component log probs | Train: 2.54420099704804 | Val: 2.3838903229766024
2-th component log probs | Train: 2.3878468508876285 | Val: 2.238265218728229
3-th component log probs | Train: 2.3161590475318405 | Val: 2.261708739810603
4-th component log probs | Train: 2.4435035710433906 | Val: 2.328455877720009
5-th component log probs | Train: 2.4079941911088008 | Val: 2.3360109242799116
6-th component log probs | Train: 2.507376656709511 | Val: 2.407738978582259
7-th component log probs | Train: 2.4253193545012617 | Val: 2.3184804020589835
8-th component log probs | Train: 2.564071578147351 | Val: 2.575210484718938
9-th component log probs | Train: 2.46323373279061 | Val: 2.4071693974448323
KEYWORD NR_SAMPLES:10000 DIM:250 AVG_DIFF:0.0102
Fitting PCA...
0-th component log probs | Train: 2.561925609803513 | Val: 2.43005738341873
1-th component log probs | Train: 2.687846795078541 | Val: 2.473815010521974
2-th component log probs | Train: 2.5337360615139928 | Val: 2.333036099856406
3-th component log probs | Train: 2.459901001386279 | Val: 2.369467033531933
4-th component log probs | Train: 2.5917328554631975 | Val: 2.4238622759413575
5-th component log probs | Train: 2.5592099977408522 | Val: 2.4235955939783733
6-th component log probs | Train: 2.660111174675895 | Val: 2.4940081328844803
7-th component log probs | Train: 2.569093851655414 | Val: 2.4166493910909392
8-th component log probs | Train: 2.7115785490161324 | Val: 2.6738777601816004
9-th component log probs | Train: 2.6077483779616255 | Val: 2.501963594951022
KEYWORD NR_SAMPLES:10000 DIM:300 AVG_DIFF:0.0222
Fitting PCA...
0-th component log probs | Train: 2.693585200939207 | Val: 2.5168185518995885
1-th component log probs | Train: 2.8184571154830067 | Val: 2.5379950569836542
2-th component log probs | Train: 2.6663299583347224 | Val: 2.412136709345106
3-th component log probs | Train: 2.589365992209916 | Val: 2.4634679887998643
4-th component log probs | Train: 2.7251383171114916 | Val: 2.50187515883374
5-th component log probs | Train: 2.6971685844185354 | Val: 2.4883317112179606
6-th component log probs | Train: 2.796858700783463 | Val: 2.5579542931573624
7-th component log probs | Train: 2.698445802317207 | Val: 2.4994439491408595
8-th component log probs | Train: 2.845489871910692 | Val: 2.7495275044824177
9-th component log probs | Train: 2.739523470424967 | Val: 2.58232134123161
KEYWORD NR_SAMPLES:10000 DIM:350 AVG_DIFF:0.0414
Fitting PCA...
0-th component log probs | Train: 2.8119333130112003 | Val: 2.5828691243822264
1-th component log probs | Train: 2.9388564112413333 | Val: 2.5736344323973364
2-th component log probs | Train: 2.7849871255476906 | Val: 2.4758832789628102
3-th component log probs | Train: 2.7067221808784847 | Val: 2.5384972840222897
4-th component log probs | Train: 2.8444743861823953 | Val: 2.5601045244023934
5-th component log probs | Train: 2.822610573357516 | Val: 2.533238440777249
6-th component log probs | Train: 2.9217571281420773 | Val: 2.5989241255580358
7-th component log probs | Train: 2.8164008086572894 | Val: 2.5647786817772116
8-th component log probs | Train: 2.9684229282084424 | Val: 2.7997908655163446
9-th component log probs | Train: 2.857475972715582 | Val: 2.6485338558241263
KEYWORD NR_SAMPLES:10000 DIM:400 AVG_DIFF:0.0714
Fitting PCA...
0-th component log probs | Train: 2.9183867737789617 | Val: 2.6280070545981515
1-th component log probs | Train: 3.046217727171855 | Val: 2.5912095695601094
2-th component log probs | Train: 2.8920841094387395 | Val: 2.5103176424379603
3-th component log probs | Train: 2.8113884430061225 | Val: 2.5979214161612574
4-th component log probs | Train: 2.952828956180349 | Val: 2.594838865155462
5-th component log probs | Train: 2.939283610888848 | Val: 2.535550278190218
6-th component log probs | Train: 3.0338630553370165 | Val: 2.6019658129701706
7-th component log probs | Train: 2.9215637366063305 | Val: 2.6098435934058
8-th component log probs | Train: 3.079450363311658 | Val: 2.827176307691395
9-th component log probs | Train: 2.963883959357148 | Val: 2.6897339087660495
KEYWORD NR_SAMPLES:10000 DIM:450 AVG_DIFF:0.1196
Fitting PCA...
0-th component log probs | Train: 3.0199340489934134 | Val: 2.6576492276117585
1-th component log probs | Train: 3.1490509932457282 | Val: 2.5802612088191204
2-th component log probs | Train: 2.9944590537962723 | Val: 2.5310922270435983
3-th component log probs | Train: 2.910935749569069 | Val: 2.643072837989699
4-th component log probs | Train: 3.0566542209852274 | Val: 2.6017446414463548
5-th component log probs | Train: 3.051855747486162 | Val: 2.5109138656815477
6-th component log probs | Train: 3.14217386551415 | Val: 2.5798473733683855
7-th component log probs | Train: 3.0213616017277687 | Val: 2.640034296752611
8-th component log probs | Train: 3.184987668378761 | Val: 2.839687438115492
9-th component log probs | Train: 3.0650295032619783 | Val: 2.7068624289147425
KEYWORD NR_SAMPLES:10000 DIM:500 AVG_DIFF:0.1950
0-th component log probs | Train: 3.044415173575315 | Val: 2.6625523170265017
1-th component log probs | Train: 3.173518537094595 | Val: 2.570507062205643
2-th component log probs | Train: 3.0191366535553024 | Val: 2.531307599925548
3-th component log probs | Train: 2.935226593327539 | Val: 2.649264597371026
4-th component log probs | Train: 3.0816786674737746 | Val: 2.6010264441822106
5-th component log probs | Train: 3.0785984932017474 | Val: 2.497303462577542
6-th component log probs | Train: 3.1690349317030804 | Val: 2.57015996787769
7-th component log probs | Train: 3.0448236015128924 | Val: 2.6438261834658947
8-th component log probs | Train: 3.21024329721961 | Val: 2.836787802411788
9-th component log probs | Train: 3.0890800736493826 | Val: 2.7097826940022585
KEYWORD NR_SAMPLES:10000 DIM:512 AVG_DIFF:0.2201
best average differences at 150 dimensions: 0.0020363832278662533
2022-01-09 10:11.46 [info     ] Training complete              train_loss=1.1016148328781128
2022-01-09 10:11.46 [info     ] Starting evaluating            dataset=10000
2022-01-09 10:11.48 [info     ] Testing complete               test_loss=0.7665243148803711
{'dataset_size': 10000,
 'end_test_accuracy': 0.7439291477203369,
 'end_test_loss': 0.7665243148803711,
 'end_train_accuracy': 0.7547770738601685,
 'end_train_loss': 1.1016148328781128,
 'end_val_accuracy': 0.7529856562614441,
 'end_val_loss': 0.7615336775779724}
2022-01-09 10:11.48 [info     ] Start Predict                  dataset=30000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 10:12.21 [info     ] Starting training              dataset=20000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
20000
Fitting PCA...
0-th component log probs | Train: 1.3653385907689095 | Val: 1.3801243124014075
1-th component log probs | Train: 1.5242722565976745 | Val: 1.5612331825236188
2-th component log probs | Train: 1.327060241202537 | Val: 1.2940783484814025
3-th component log probs | Train: 1.2892183112008069 | Val: 1.2799172138703003
4-th component log probs | Train: 1.3755760978056049 | Val: 1.386717713965229
5-th component log probs | Train: 1.3440136570243642 | Val: 1.3482670080386427
6-th component log probs | Train: 1.4220758886995801 | Val: 1.4648816138749117
7-th component log probs | Train: 1.3867421276530425 | Val: 1.4089191406197603
8-th component log probs | Train: 1.459978504979339 | Val: 1.6149135317765242
9-th component log probs | Train: 1.4551592916266798 | Val: 1.507440093091477
KEYWORD NR_SAMPLES:20000 DIM:50 AVG_DIFF:0.0032
Fitting PCA...
0-th component log probs | Train: 1.8535586834357527 | Val: 1.8814162489984763
1-th component log probs | Train: 2.022434314075236 | Val: 2.05720022592161
2-th component log probs | Train: 1.8086883039957113 | Val: 1.7923077093037016
3-th component log probs | Train: 1.757092695875315 | Val: 1.7584333650124473
4-th component log probs | Train: 1.8580300327828196 | Val: 1.8826557910023383
5-th component log probs | Train: 1.8163440526366827 | Val: 1.8392872419138937
6-th component log probs | Train: 1.9067821232386115 | Val: 1.9554547321871556
7-th component log probs | Train: 1.8651943188815623 | Val: 1.8938268404495069
8-th component log probs | Train: 1.9566707094679725 | Val: 2.1099164515180853
9-th component log probs | Train: 1.950695674265501 | Val: 2.01548530731994
KEYWORD NR_SAMPLES:20000 DIM:100 AVG_DIFF:0.0034
Fitting PCA...
0-th component log probs | Train: 2.101963445513861 | Val: 2.129804462236332
1-th component log probs | Train: 2.2613684635296845 | Val: 2.2867096904789124
2-th component log probs | Train: 2.0594403591828168 | Val: 2.043767346158407
3-th component log probs | Train: 1.9944535955163976 | Val: 1.9855685780690335
4-th component log probs | Train: 2.104774606438085 | Val: 2.1278526642524502
5-th component log probs | Train: 2.0543167296251195 | Val: 2.0738953302994516
6-th component log probs | Train: 2.1562776552510474 | Val: 2.1957925523093365
7-th component log probs | Train: 2.107233827493727 | Val: 2.1230998010587077
8-th component log probs | Train: 2.200372798031666 | Val: 2.339374831300344
9-th component log probs | Train: 2.1906328397486714 | Val: 2.2425234673557566
KEYWORD NR_SAMPLES:20000 DIM:150 AVG_DIFF:0.0026
Fitting PCA...
0-th component log probs | Train: 2.28537952076175 | Val: 2.2981884448407364
1-th component log probs | Train: 2.434036682143689 | Val: 2.43536920785795
2-th component log probs | Train: 2.240169655230137 | Val: 2.211740295730893
3-th component log probs | Train: 2.1647341878442723 | Val: 2.1459507360771535
4-th component log probs | Train: 2.28387431322928 | Val: 2.2974798049515512
5-th component log probs | Train: 2.2270594349374346 | Val: 2.2392382427815622
6-th component log probs | Train: 2.337233109703525 | Val: 2.364772781988043
7-th component log probs | Train: 2.282047635202919 | Val: 2.286630513123414
8-th component log probs | Train: 2.3787515369996166 | Val: 2.4981859180795087
9-th component log probs | Train: 2.360948467851778 | Val: 2.397546705202913
KEYWORD NR_SAMPLES:20000 DIM:200 AVG_DIFF:0.0018
Fitting PCA...
0-th component log probs | Train: 2.435508764914039 | Val: 2.426086262724785
1-th component log probs | Train: 2.577884410447166 | Val: 2.5495171083333235
2-th component log probs | Train: 2.390108030092067 | Val: 2.34370642807014
3-th component log probs | Train: 2.307620177897822 | Val: 2.2735792701438147
4-th component log probs | Train: 2.43381287553898 | Val: 2.4291677187018763
5-th component log probs | Train: 2.369330441883333 | Val: 2.3647002816233975
6-th component log probs | Train: 2.49052003474647 | Val: 2.494127767205972
7-th component log probs | Train: 2.4260567988321355 | Val: 2.410009581543257
8-th component log probs | Train: 2.5265236776868862 | Val: 2.6201059855733364
9-th component log probs | Train: 2.5040431611384104 | Val: 2.5188971791354353
KEYWORD NR_SAMPLES:20000 DIM:250 AVG_DIFF:0.0013
Fitting PCA...
0-th component log probs | Train: 2.567822974433398 | Val: 2.5372206574284277
1-th component log probs | Train: 2.706608180870148 | Val: 2.6510573088878244
2-th component log probs | Train: 2.5204027717180035 | Val: 2.4547834763309813
3-th component log probs | Train: 2.4349206945668183 | Val: 2.385896806433703
4-th component log probs | Train: 2.5660044448006913 | Val: 2.5406173193359654
5-th component log probs | Train: 2.4973486477106333 | Val: 2.4725741203709775
6-th component log probs | Train: 2.624662794608709 | Val: 2.604281525663341
7-th component log probs | Train: 2.5553771375640344 | Val: 2.522269927407606
8-th component log probs | Train: 2.6585659547706655 | Val: 2.7253079443863975
9-th component log probs | Train: 2.6318688244183974 | Val: 2.627080461548487
KEYWORD NR_SAMPLES:20000 DIM:300 AVG_DIFF:0.0018
Fitting PCA...
0-th component log probs | Train: 2.687777805920826 | Val: 2.6390435814085462
1-th component log probs | Train: 2.8252965768162546 | Val: 2.743143572518657
2-th component log probs | Train: 2.6408571840413213 | Val: 2.5542625918883743
3-th component log probs | Train: 2.5526414350752358 | Val: 2.489481199649253
4-th component log probs | Train: 2.6870560388237807 | Val: 2.639866122462515
5-th component log probs | Train: 2.615126886719779 | Val: 2.573367153994965
6-th component log probs | Train: 2.7441445564379072 | Val: 2.699049709768506
7-th component log probs | Train: 2.6737889444048184 | Val: 2.6209092507782215
8-th component log probs | Train: 2.7780336260833938 | Val: 2.816601394324862
9-th component log probs | Train: 2.7496821153628717 | Val: 2.7189010069448822
KEYWORD NR_SAMPLES:20000 DIM:350 AVG_DIFF:0.0032
Fitting PCA...
0-th component log probs | Train: 2.79593811938684 | Val: 2.7287219298916865
1-th component log probs | Train: 2.9323983563926004 | Val: 2.8216686823190384
2-th component log probs | Train: 2.749117610795971 | Val: 2.646953391170237
3-th component log probs | Train: 2.660525662183376 | Val: 2.5841827215029496
4-th component log probs | Train: 2.7964888267912293 | Val: 2.730765764918607
5-th component log probs | Train: 2.7221802771288965 | Val: 2.664982356909109
6-th component log probs | Train: 2.8541446961192514 | Val: 2.7837737369430955
7-th component log probs | Train: 2.782404169946259 | Val: 2.7100616043670467
8-th component log probs | Train: 2.887439562713494 | Val: 2.8952108534394005
9-th component log probs | Train: 2.858371013821476 | Val: 2.8036340491191885
KEYWORD NR_SAMPLES:20000 DIM:400 AVG_DIFF:0.0054
Fitting PCA...
0-th component log probs | Train: 2.8934644552959345 | Val: 2.809354749826262
1-th component log probs | Train: 3.030295434412649 | Val: 2.8881308292293917
2-th component log probs | Train: 2.8460640372160126 | Val: 2.727647454090334
3-th component log probs | Train: 2.757356696670285 | Val: 2.6683371771440405
4-th component log probs | Train: 2.8936772876128094 | Val: 2.8074807139003384
5-th component log probs | Train: 2.819433260073787 | Val: 2.7432228770281806
6-th component log probs | Train: 2.9521585557674928 | Val: 2.853770051249115
7-th component log probs | Train: 2.879469897680951 | Val: 2.785179121877319
8-th component log probs | Train: 2.9867265456629415 | Val: 2.9664270944475066
9-th component log probs | Train: 2.9559960178640714 | Val: 2.8765616709221544
KEYWORD NR_SAMPLES:20000 DIM:450 AVG_DIFF:0.0088
Fitting PCA...
0-th component log probs | Train: 2.986101236985702 | Val: 2.880788291339477
1-th component log probs | Train: 3.1221020667673245 | Val: 2.945483069588527
2-th component log probs | Train: 2.9385043079608453 | Val: 2.8025423506382663
3-th component log probs | Train: 2.8496710812362904 | Val: 2.747286217396972
4-th component log probs | Train: 2.9872285496239197 | Val: 2.877560471905511
5-th component log probs | Train: 2.912420902080745 | Val: 2.8158642245084025
6-th component log probs | Train: 3.044499964563414 | Val: 2.9173162436150113
7-th component log probs | Train: 2.9711172552209137 | Val: 2.8548254030875193
8-th component log probs | Train: 3.080666951366015 | Val: 3.032872690518463
9-th component log probs | Train: 3.0488108052617093 | Val: 2.9406125884055236
KEYWORD NR_SAMPLES:20000 DIM:500 AVG_DIFF:0.0136
0-th component log probs | Train: 3.0090816312118873 | Val: 2.897644078561228
1-th component log probs | Train: 3.145309336321562 | Val: 2.958862943513959
2-th component log probs | Train: 2.9652199216969164 | Val: 2.8212969045005556
3-th component log probs | Train: 2.874897633171067 | Val: 2.767304035068476
4-th component log probs | Train: 3.013173383871737 | Val: 2.8944693640571852
5-th component log probs | Train: 2.9383806719234395 | Val: 2.834391205331025
6-th component log probs | Train: 3.0687562101208563 | Val: 2.9255999270289976
7-th component log probs | Train: 2.995387121750687 | Val: 2.8669390076757075
8-th component log probs | Train: 3.1056535352778893 | Val: 3.0495045351431505
9-th component log probs | Train: 3.0720458763223792 | Val: 2.9534503158581784
KEYWORD NR_SAMPLES:20000 DIM:512 AVG_DIFF:0.0159
best average differences at 250 dimensions: 0.0013497214429942692
2022-01-09 10:56.57 [info     ] Training complete              train_loss=0.9420745968818665
2022-01-09 10:56.57 [info     ] Starting evaluating            dataset=10000
2022-01-09 10:56.59 [info     ] Testing complete               test_loss=0.5613342523574829
{'dataset_size': 20000,
 'end_test_accuracy': 0.8154856562614441,
 'end_test_loss': 0.5613342523574829,
 'end_train_accuracy': 0.7882887125015259,
 'end_train_loss': 0.9420745968818665,
 'end_val_accuracy': 0.8211584687232971,
 'end_val_loss': 0.5524855852127075}
2022-01-09 10:56.59 [info     ] Start Predict                  dataset=20000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 10:57.32 [info     ] Starting training              dataset=30000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
30000
Fitting PCA...
0-th component log probs | Train: 1.451870553078377 | Val: 1.4836539751451314
1-th component log probs | Train: 1.5569983641503475 | Val: 1.585520296934335
2-th component log probs | Train: 1.3716252568544558 | Val: 1.3209166642701529
3-th component log probs | Train: 1.3266393586514205 | Val: 1.305040989776361
4-th component log probs | Train: 1.4306282605074871 | Val: 1.426194093423576
5-th component log probs | Train: 1.4077886641555457 | Val: 1.381422763804155
6-th component log probs | Train: 1.4531336398955412 | Val: 1.4859610539723471
7-th component log probs | Train: 1.4684324237070328 | Val: 1.4425002162825413
8-th component log probs | Train: 1.525353845862569 | Val: 1.5751321444650344
9-th component log probs | Train: 1.4724308030060347 | Val: 1.4993081749384487
KEYWORD NR_SAMPLES:30000 DIM:50 AVG_DIFF:0.0011
Fitting PCA...
0-th component log probs | Train: 1.9676347712961955 | Val: 1.9822776698633477
1-th component log probs | Train: 2.092087033267029 | Val: 2.099073553797843
2-th component log probs | Train: 1.8944747527353045 | Val: 1.8341412608242318
3-th component log probs | Train: 1.8296824501633986 | Val: 1.7989021663077793
4-th component log probs | Train: 1.9559960055018006 | Val: 1.9565908676511954
5-th component log probs | Train: 1.9179276305094848 | Val: 1.8826732859119955
6-th component log probs | Train: 1.989059081245946 | Val: 2.023636672239185
7-th component log probs | Train: 1.9980099846735029 | Val: 1.957750221251889
8-th component log probs | Train: 2.051704408396293 | Val: 2.1040404049052124
9-th component log probs | Train: 1.9999733034591871 | Val: 2.0152179698414923
KEYWORD NR_SAMPLES:30000 DIM:100 AVG_DIFF:0.0012
Fitting PCA...
0-th component log probs | Train: 2.2238261510509933 | Val: 2.2249886326872375
1-th component log probs | Train: 2.340994419799002 | Val: 2.3379376413550075
2-th component log probs | Train: 2.162460704738183 | Val: 2.092025423036999
3-th component log probs | Train: 2.0821970360497946 | Val: 2.0485420172818234
4-th component log probs | Train: 2.224075034935405 | Val: 2.2163197934628225
5-th component log probs | Train: 2.1698821307980114 | Val: 2.134117129590976
6-th component log probs | Train: 2.252544927475755 | Val: 2.274760305249648
7-th component log probs | Train: 2.252494835660119 | Val: 2.205112910746983
8-th component log probs | Train: 2.3133454619473097 | Val: 2.3521603411168766
9-th component log probs | Train: 2.248815929852411 | Val: 2.2581416300715453
KEYWORD NR_SAMPLES:30000 DIM:150 AVG_DIFF:0.0012
Fitting PCA...
0-th component log probs | Train: 2.403791475729757 | Val: 2.396431220993116
1-th component log probs | Train: 2.51207893421729 | Val: 2.5004596052317485
2-th component log probs | Train: 2.3516470674428427 | Val: 2.2715018697112517
3-th component log probs | Train: 2.2596664070362817 | Val: 2.2191096449802643
4-th component log probs | Train: 2.41240137453929 | Val: 2.398865005739211
5-th component log probs | Train: 2.3474044359779103 | Val: 2.3071383598087967
6-th component log probs | Train: 2.436797256818851 | Val: 2.4508397956943426
7-th component log probs | Train: 2.4270178675025815 | Val: 2.3774439628630644
8-th component log probs | Train: 2.4941086027594705 | Val: 2.5252236644299275
9-th component log probs | Train: 2.419242162627949 | Val: 2.4227682047422716
KEYWORD NR_SAMPLES:30000 DIM:200 AVG_DIFF:0.0014
Fitting PCA...
0-th component log probs | Train: 2.552167743022708 | Val: 2.535807494962369
1-th component log probs | Train: 2.6542807658257197 | Val: 2.630784571511898
2-th component log probs | Train: 2.502634017852514 | Val: 2.412139328021439
3-th component log probs | Train: 2.404322447509103 | Val: 2.354258363862552
4-th component log probs | Train: 2.56188125722116 | Val: 2.5396258538518013
5-th component log probs | Train: 2.4917386029404383 | Val: 2.444722060297441
6-th component log probs | Train: 2.5861807790672326 | Val: 2.5872174473866685
7-th component log probs | Train: 2.5713293021988477 | Val: 2.5136904992132907
8-th component log probs | Train: 2.642975209959935 | Val: 2.6628246220033227
9-th component log probs | Train: 2.5609783901513823 | Val: 2.5557889689201136
KEYWORD NR_SAMPLES:30000 DIM:250 AVG_DIFF:0.0018
Fitting PCA...
0-th component log probs | Train: 2.6803438367560295 | Val: 2.6488047238498194
1-th component log probs | Train: 2.779209958095498 | Val: 2.7378452278220076
2-th component log probs | Train: 2.6327142709167854 | Val: 2.5276661675567946
3-th component log probs | Train: 2.5313746058861506 | Val: 2.472140084404051
4-th component log probs | Train: 2.6918894852584048 | Val: 2.660129164802693
5-th component log probs | Train: 2.617344500017711 | Val: 2.5604161199174356
6-th component log probs | Train: 2.7160255043527335 | Val: 2.7051468048167657
7-th component log probs | Train: 2.6961146715233473 | Val: 2.628611490515354
8-th component log probs | Train: 2.7728663325681775 | Val: 2.7784452999895506
9-th component log probs | Train: 2.6854670865286376 | Val: 2.6673138217626597
KEYWORD NR_SAMPLES:30000 DIM:300 AVG_DIFF:0.0027
Fitting PCA...
0-th component log probs | Train: 2.796799258428382 | Val: 2.7503693854764153
1-th component log probs | Train: 2.8924462694201214 | Val: 2.8351731272623293
2-th component log probs | Train: 2.7492100192036464 | Val: 2.629929725400825
3-th component log probs | Train: 2.647094570322896 | Val: 2.576674629158493
4-th component log probs | Train: 2.808525720865059 | Val: 2.7619578917504346
5-th component log probs | Train: 2.731503639906642 | Val: 2.661776512177203
6-th component log probs | Train: 2.8334512915375063 | Val: 2.805482644765314
7-th component log probs | Train: 2.8101718363648893 | Val: 2.7296621249022643
8-th component log probs | Train: 2.887641021452288 | Val: 2.8776109299027515
9-th component log probs | Train: 2.798091148708888 | Val: 2.7660154927262224
KEYWORD NR_SAMPLES:30000 DIM:350 AVG_DIFF:0.0040
Fitting PCA...
0-th component log probs | Train: 2.9021002244645753 | Val: 2.844615104729519
1-th component log probs | Train: 2.9965145213932565 | Val: 2.921372868801498
2-th component log probs | Train: 2.854008086853247 | Val: 2.7221841038010037
3-th component log probs | Train: 2.752199589546473 | Val: 2.672718165274411
4-th component log probs | Train: 2.913574606662328 | Val: 2.854810712170087
5-th component log probs | Train: 2.835628363626351 | Val: 2.754475435185934
6-th component log probs | Train: 2.9389840491991936 | Val: 2.8961498727732287
7-th component log probs | Train: 2.914332077173523 | Val: 2.824547523701975
8-th component log probs | Train: 2.991926866811117 | Val: 2.9648594994757986
9-th component log probs | Train: 2.903175110666664 | Val: 2.857887341378983
KEYWORD NR_SAMPLES:30000 DIM:400 AVG_DIFF:0.0055
Fitting PCA...
0-th component log probs | Train: 2.996797955137837 | Val: 2.9257880402183125
1-th component log probs | Train: 3.090217345436541 | Val: 2.9974710143170307
2-th component log probs | Train: 2.949137742300521 | Val: 2.8048202791291463
3-th component log probs | Train: 2.847748154331248 | Val: 2.7579312523029964
4-th component log probs | Train: 3.008259472688291 | Val: 2.936774834484476
5-th component log probs | Train: 2.9293312340178903 | Val: 2.8386969347011157
6-th component log probs | Train: 3.0335094289873954 | Val: 2.973658068821315
7-th component log probs | Train: 3.0084661094596523 | Val: 2.906624579886519
8-th component log probs | Train: 3.086256738051819 | Val: 3.039365561126598
9-th component log probs | Train: 2.996294209990462 | Val: 2.937108856497159
KEYWORD NR_SAMPLES:30000 DIM:450 AVG_DIFF:0.0076
Fitting PCA...
0-th component log probs | Train: 3.088615166756957 | Val: 3.005786955107369
1-th component log probs | Train: 3.1783991531891638 | Val: 3.0663227445591823
2-th component log probs | Train: 3.0410989326184072 | Val: 2.8837890311600303
3-th component log probs | Train: 2.93963898484244 | Val: 2.8399035716070133
4-th component log probs | Train: 3.0976331997391964 | Val: 3.014502421573128
5-th component log probs | Train: 3.0197788611828558 | Val: 2.9159402928658547
6-th component log probs | Train: 3.1240956615538713 | Val: 3.0462567440197295
7-th component log probs | Train: 3.0976188777545683 | Val: 2.9832006572828966
8-th component log probs | Train: 3.174902732768156 | Val: 3.109631028216119
9-th component log probs | Train: 3.0857208957769404 | Val: 3.0123351432990333
KEYWORD NR_SAMPLES:30000 DIM:500 AVG_DIFF:0.0101
0-th component log probs | Train: 3.112144470474657 | Val: 3.0259250849781965
1-th component log probs | Train: 3.199620319098161 | Val: 3.0821177931201857
2-th component log probs | Train: 3.063810007252709 | Val: 2.9028375970515174
3-th component log probs | Train: 2.962319045601898 | Val: 2.8589080011789783
4-th component log probs | Train: 3.119872129158288 | Val: 3.032465912035005
5-th component log probs | Train: 3.041638721371604 | Val: 2.93419467984992
6-th component log probs | Train: 3.1460491009810947 | Val: 3.0630735559221423
7-th component log probs | Train: 3.119029214644545 | Val: 3.001666470187094
8-th component log probs | Train: 3.1969502544863406 | Val: 3.1271100470293884
9-th component log probs | Train: 3.1074962784793225 | Val: 3.0310478388979596
KEYWORD NR_SAMPLES:30000 DIM:512 AVG_DIFF:0.0108
best average differences at 50 dimensions: 0.0010526750637645727
2022-01-09 12:02.07 [info     ] Training complete              train_loss=0.7998254895210266
2022-01-09 12:02.07 [info     ] Starting evaluating            dataset=10000
2022-01-09 12:02.09 [info     ] Testing complete               test_loss=0.48877155780792236
{'dataset_size': 30000,
 'end_test_accuracy': 0.8425557613372803,
 'end_test_loss': 0.48877155780792236,
 'end_train_accuracy': 0.8337219953536987,
 'end_train_loss': 0.7998254895210266,
 'end_val_accuracy': 0.8449442386627197,
 'end_val_loss': 0.472983717918396}
2022-01-09 12:02.09 [info     ] Start Predict                  dataset=10000
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2022-01-09 12:02.40 [info     ] Starting training              dataset=40000 epoch=100
/itet-stor/fanconic/net_scratch/conda_envs/pytcu10/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
40000
Fitting PCA...
0-th component log probs | Train: 1.5171675230903712 | Val: 1.475412761970116
1-th component log probs | Train: 1.600632811490816 | Val: 1.5361826382126142
2-th component log probs | Train: 1.4401559588882027 | Val: 1.3890388576812822
3-th component log probs | Train: 1.3688033174131227 | Val: 1.3557339017489245
4-th component log probs | Train: 1.4949326761910189 | Val: 1.4644034647664437
5-th component log probs | Train: 1.4781883965469793 | Val: 1.446420831319051
6-th component log probs | Train: 1.584659579574257 | Val: 1.5176251943286805
7-th component log probs | Train: 1.5020389572804091 | Val: 1.4470000965684846
8-th component log probs | Train: 1.5737319297297694 | Val: 1.5432054688998698
9-th component log probs | Train: 1.5533078350495249 | Val: 1.5239456060128773
KEYWORD NR_SAMPLES:40000 DIM:50 AVG_DIFF:0.0020
Fitting PCA...
0-th component log probs | Train: 2.058084505730657 | Val: 2.0113182077247607
1-th component log probs | Train: 2.178907792560867 | Val: 2.0761942423400552
2-th component log probs | Train: 1.9791004426568466 | Val: 1.92723913163799
3-th component log probs | Train: 1.8926496830312 | Val: 1.8896276329872121
4-th component log probs | Train: 2.053126835130554 | Val: 2.0185807956192168
5-th component log probs | Train: 2.020211492220117 | Val: 1.987213155797853
6-th component log probs | Train: 2.149132042720648 | Val: 2.0759999958755704
7-th component log probs | Train: 2.0456054714764456 | Val: 1.9827682476899984
8-th component log probs | Train: 2.117797637422888 | Val: 2.0883821572083985
9-th component log probs | Train: 2.1179682700445226 | Val: 2.0757340404840954
KEYWORD NR_SAMPLES:40000 DIM:100 AVG_DIFF:0.0030
Fitting PCA...
0-th component log probs | Train: 2.3401061941409567 | Val: 2.2788070770715576
1-th component log probs | Train: 2.4536717732256887 | Val: 2.3325496599768036
2-th component log probs | Train: 2.2677429328192704 | Val: 2.209245059576138
3-th component log probs | Train: 2.1623568486189986 | Val: 2.1542180193845044
4-th component log probs | Train: 2.338150100194111 | Val: 2.3005606375762673
5-th component log probs | Train: 2.295164143727903 | Val: 2.2621886896535073
6-th component log probs | Train: 2.4337486218486357 | Val: 2.3533218018258
7-th component log probs | Train: 2.323514969890286 | Val: 2.2412003552440067
8-th component log probs | Train: 2.3933611929238814 | Val: 2.345318470936058
9-th component log probs | Train: 2.391751731628616 | Val: 2.3377629893064302
KEYWORD NR_SAMPLES:40000 DIM:150 AVG_DIFF:0.0043
Fitting PCA...
0-th component log probs | Train: 2.531898370937056 | Val: 2.4549613254146987
1-th component log probs | Train: 2.633177099239057 | Val: 2.503611790266079
2-th component log probs | Train: 2.4669470413331167 | Val: 2.391177328341674
3-th component log probs | Train: 2.3505784558080896 | Val: 2.3371060992978174
4-th component log probs | Train: 2.535595409896705 | Val: 2.4867485314383133
5-th component log probs | Train: 2.4821687604142837 | Val: 2.443439745350779
6-th component log probs | Train: 2.628003171543656 | Val: 2.5337564506648858
7-th component log probs | Train: 2.506219132473405 | Val: 2.411909132882413
8-th component log probs | Train: 2.580628982957521 | Val: 2.5177460701652685
9-th component log probs | Train: 2.5709689435881433 | Val: 2.5074890304860413
KEYWORD NR_SAMPLES:40000 DIM:200 AVG_DIFF:0.0058
Fitting PCA...
0-th component log probs | Train: 2.6818780836762692 | Val: 2.5885126881789686
1-th component log probs | Train: 2.7693277994489347 | Val: 2.6273850766604525
2-th component log probs | Train: 2.620105929201164 | Val: 2.5279844282800794
3-th component log probs | Train: 2.500539914315 | Val: 2.4713757683034254
4-th component log probs | Train: 2.6874560473213522 | Val: 2.6214189812422832
5-th component log probs | Train: 2.6287716660443685 | Val: 2.5745948618339347
6-th component log probs | Train: 2.778222362928154 | Val: 2.670164822266341
7-th component log probs | Train: 2.648456440136256 | Val: 2.541076477775672
8-th component log probs | Train: 2.7260480112408483 | Val: 2.647507830686541
9-th component log probs | Train: 2.7081144101723242 | Val: 2.6283692291654717
KEYWORD NR_SAMPLES:40000 DIM:250 AVG_DIFF:0.0081
Fitting PCA...
0-th component log probs | Train: 2.8106212484258486 | Val: 2.706934620378393
1-th component log probs | Train: 2.889955387158192 | Val: 2.7412601610169793
2-th component log probs | Train: 2.7512370533784205 | Val: 2.6497152610133705
3-th component log probs | Train: 2.629890239540909 | Val: 2.591369473563833
4-th component log probs | Train: 2.8167951905212627 | Val: 2.7419059847265412
5-th component log probs | Train: 2.7552688100166023 | Val: 2.6920957445393525
6-th component log probs | Train: 2.9080049179547176 | Val: 2.7867865639048914
7-th component log probs | Train: 2.7722368143620044 | Val: 2.659226839771041
8-th component log probs | Train: 2.8518222520333065 | Val: 2.7629984884909935
9-th component log probs | Train: 2.8295986047851684 | Val: 2.7389291605596506
KEYWORD NR_SAMPLES:40000 DIM:300 AVG_DIFF:0.0098
Fitting PCA...
0-th component log probs | Train: 2.9247185169735075 | Val: 2.810614857203216
1-th component log probs | Train: 2.9984418101074324 | Val: 2.8370188423917035
2-th component log probs | Train: 2.8667560715466944 | Val: 2.755399656707341
3-th component log probs | Train: 2.7446896417825988 | Val: 2.696517225482471
4-th component log probs | Train: 2.9306879275313023 | Val: 2.847434177849078
5-th component log probs | Train: 2.8676665919542366 | Val: 2.7928886453899664
6-th component log probs | Train: 3.0209753383002416 | Val: 2.889256852002592
7-th component log probs | Train: 2.882647465732765 | Val: 2.7623613637939934
8-th component log probs | Train: 2.964428237310098 | Val: 2.8669184729125843
9-th component log probs | Train: 2.9383489171214374 | Val: 2.842437097778495
KEYWORD NR_SAMPLES:40000 DIM:350 AVG_DIFF:0.0117
Fitting PCA...
0-th component log probs | Train: 3.026907058466958 | Val: 2.906537548156228
1-th component log probs | Train: 3.097066333301922 | Val: 2.92576474773364
2-th component log probs | Train: 2.9707830060113536 | Val: 2.851303020117453
3-th component log probs | Train: 2.8494185812224817 | Val: 2.791955736168333
4-th component log probs | Train: 3.034012503863768 | Val: 2.940854688329277
5-th component log probs | Train: 2.970477230665962 | Val: 2.885089389517971
6-th component log probs | Train: 3.1223363890844897 | Val: 2.9810467176513606
7-th component log probs | Train: 2.9826845675896845 | Val: 2.8547226636261627
8-th component log probs | Train: 3.065294243957563 | Val: 2.959095221305831
9-th component log probs | Train: 3.037388009815341 | Val: 2.9336550538751034
KEYWORD NR_SAMPLES:40000 DIM:400 AVG_DIFF:0.0136
Fitting PCA...
0-th component log probs | Train: 3.1198639605095253 | Val: 2.9898603874003573
1-th component log probs | Train: 3.186404050421646 | Val: 3.008670237256679
2-th component log probs | Train: 3.0651834589530758 | Val: 2.936352663794569
3-th component log probs | Train: 2.944927976368831 | Val: 2.876125466591946
4-th component log probs | Train: 3.126789814285407 | Val: 3.024846918961299
5-th component log probs | Train: 3.063978681529589 | Val: 2.968957356840973
6-th component log probs | Train: 3.2140947419633297 | Val: 3.06345839058368
7-th component log probs | Train: 3.074333919548251 | Val: 2.938306158148247
8-th component log probs | Train: 3.157724711069099 | Val: 3.0444426539308163
9-th component log probs | Train: 3.128121567311209 | Val: 3.0146936304022556
KEYWORD NR_SAMPLES:40000 DIM:450 AVG_DIFF:0.0156
Fitting PCA...
0-th component log probs | Train: 3.211443103718128 | Val: 3.0758790377269487
1-th component log probs | Train: 3.2712882892235293 | Val: 3.086733845964492
2-th component log probs | Train: 3.15877123329181 | Val: 3.021268653385094
3-th component log probs | Train: 3.0389528479506214 | Val: 2.962129485434805
4-th component log probs | Train: 3.2179699031324693 | Val: 3.108499803970203
5-th component log probs | Train: 3.1541067953819666 | Val: 3.051718281538147
6-th component log probs | Train: 3.302544015489192 | Val: 3.144463787869823
7-th component log probs | Train: 3.1633111498762614 | Val: 3.0214617162818556
8-th component log probs | Train: 3.2480435603906206 | Val: 3.125286031465331
9-th component log probs | Train: 3.213821075002029 | Val: 3.093648490702506
KEYWORD NR_SAMPLES:40000 DIM:500 AVG_DIFF:0.0174
0-th component log probs | Train: 3.2362687955803966 | Val: 3.1007913681116532
1-th component log probs | Train: 3.2939391777435234 | Val: 3.1099630522399884
2-th component log probs | Train: 3.183709951665802 | Val: 3.0455098510829406
3-th component log probs | Train: 3.064288874030309 | Val: 2.986139910948779
4-th component log probs | Train: 3.2419635019319406 | Val: 3.1325327310652127
5-th component log probs | Train: 3.1783809349106216 | Val: 3.0745394863079127
6-th component log probs | Train: 3.3259230336564083 | Val: 3.1673551773365207
7-th component log probs | Train: 3.1871435889296893 | Val: 3.045505130258657
8-th component log probs | Train: 3.2722170756992703 | Val: 3.149906841414302
9-th component log probs | Train: 3.237087177923422 | Val: 3.1171855026990243
KEYWORD NR_SAMPLES:40000 DIM:512 AVG_DIFF:0.0175
best average differences at 50 dimensions: 0.001993915382263797
2022-01-09 13:27.47 [info     ] Training complete              train_loss=0.6734663248062134
2022-01-09 13:27.47 [info     ] Starting evaluating            dataset=10000
2022-01-09 13:27.49 [info     ] Testing complete               test_loss=0.48343566060066223
{'dataset_size': 40000,
 'end_test_accuracy': 0.840167224407196,
 'end_test_loss': 0.48343566060066223,
 'end_train_accuracy': 0.8672000169754028,
 'end_train_loss': 0.6734663248062134,
 'end_val_accuracy': 0.8502189517021179,
 'end_val_loss': 0.4593256711959839}

wandb: Waiting for W&B process to finish, PID 21152... (success).
wandb: - 0.57MB of 0.57MB uploaded (0.00MB deduped)wandb: \ 0.57MB of 0.57MB uploaded (0.00MB deduped)wandb: | 0.57MB of 0.57MB uploaded (0.00MB deduped)wandb: / 0.57MB of 0.57MB uploaded (0.00MB deduped)wandb: - 0.57MB of 0.96MB uploaded (0.00MB deduped)wandb: \ 0.57MB of 0.96MB uploaded (0.00MB deduped)wandb: | 0.57MB of 0.96MB uploaded (0.00MB deduped)wandb: / 0.96MB of 0.96MB uploaded (0.00MB deduped)wandb: - 0.96MB of 0.96MB uploaded (0.00MB deduped)wandb: \ 0.96MB of 0.96MB uploaded (0.00MB deduped)wandb: | 0.96MB of 0.96MB uploaded (0.00MB deduped)wandb: / 0.96MB of 0.96MB uploaded (0.00MB deduped)wandb: - 0.96MB of 0.96MB uploaded (0.00MB deduped)wandb: \ 0.96MB of 0.96MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:           accuracy_0 
wandb:           accuracy_1 
wandb:          accuracy_10 
wandb:          accuracy_11 
wandb:          accuracy_12 
wandb:          accuracy_13 
wandb:           accuracy_2 
wandb:           accuracy_3 
wandb:           accuracy_4 
wandb:           accuracy_5 
wandb:           accuracy_6 
wandb:           accuracy_7 
wandb:           accuracy_8 
wandb:           accuracy_9 
wandb:              class_0 
wandb:              class_1 
wandb:              class_2 
wandb:              class_3 
wandb:              class_4 
wandb:              class_5 
wandb:              class_6 
wandb:              class_7 
wandb:              class_8 
wandb:              class_9 
wandb:         dataset_size 
wandb:    end_test_accuracy 
wandb:        end_test_loss 
wandb:   end_train_accuracy 
wandb:       end_train_loss 
wandb:     end_val_accuracy 
wandb:         end_val_loss 
wandb:                epoch 
wandb:               loss_0 
wandb:               loss_1 
wandb:              loss_10 
wandb:              loss_11 
wandb:              loss_12 
wandb:              loss_13 
wandb:               loss_2 
wandb:               loss_3 
wandb:               loss_4 
wandb:               loss_5 
wandb:               loss_6 
wandb:               loss_7 
wandb:               loss_8 
wandb:               loss_9 
wandb:                 lr_0 
wandb:                 lr_1 
wandb:                lr_10 
wandb:                lr_11 
wandb:                lr_12 
wandb:                lr_13 
wandb:                 lr_2 
wandb:                 lr_3 
wandb:                 lr_4 
wandb:                 lr_5 
wandb:                 lr_6 
wandb:                 lr_7 
wandb:                 lr_8 
wandb:                 lr_9 
wandb:       val_accuracy_0 
wandb:       val_accuracy_1 
wandb:      val_accuracy_10 
wandb:      val_accuracy_11 
wandb:      val_accuracy_12 
wandb:      val_accuracy_13 
wandb:       val_accuracy_2 
wandb:       val_accuracy_3 
wandb:       val_accuracy_4 
wandb:       val_accuracy_5 
wandb:       val_accuracy_6 
wandb:       val_accuracy_7 
wandb:       val_accuracy_8 
wandb:       val_accuracy_9 
wandb:           val_loss_0 
wandb:           val_loss_1 
wandb:          val_loss_10 
wandb:          val_loss_11 
wandb:          val_loss_12 
wandb:          val_loss_13 
wandb:           val_loss_2 
wandb:           val_loss_3 
wandb:           val_loss_4 
wandb:           val_loss_5 
wandb:           val_loss_6 
wandb:           val_loss_7 
wandb:           val_loss_8 
wandb:           val_loss_9 
wandb: 
wandb: Run summary:
wandb:           accuracy_0 0.71267
wandb:           accuracy_1 0.37109
wandb:          accuracy_10 0.75478
wandb:          accuracy_11 0.78829
wandb:          accuracy_12 0.83372
wandb:          accuracy_13 0.8672
wandb:           accuracy_2 0.57143
wandb:           accuracy_3 0.73958
wandb:           accuracy_4 0.66707
wandb:           accuracy_5 0.68945
wandb:           accuracy_6 0.75244
wandb:           accuracy_7 0.75298
wandb:           accuracy_8 0.73426
wandb:           accuracy_9 0.73188
wandb:              class_0 0.10068
wandb:              class_1 0.10053
wandb:              class_2 0.09925
wandb:              class_3 0.09942
wandb:              class_4 0.10168
wandb:              class_5 0.09963
wandb:              class_6 0.1001
wandb:              class_7 0.10015
wandb:              class_8 0.09957
wandb:              class_9 0.099
wandb:         dataset_size 40000
wandb:    end_test_accuracy 0.84017
wandb:        end_test_loss 0.48344
wandb:   end_train_accuracy 0.8672
wandb:       end_train_loss 0.67347
wandb:     end_val_accuracy 0.85022
wandb:         end_val_loss 0.45933
wandb:                epoch 100
wandb:               loss_0 1.86018
wandb:               loss_1 2.57402
wandb:              loss_10 1.10161
wandb:              loss_11 0.94207
wandb:              loss_12 0.79983
wandb:              loss_13 0.67347
wandb:               loss_2 2.10039
wandb:               loss_3 1.57252
wandb:               loss_4 1.67748
wandb:               loss_5 1.56219
wandb:               loss_6 1.26621
wandb:               loss_7 1.19354
wandb:               loss_8 1.19169
wandb:               loss_9 1.18102
wandb:                 lr_0 0.001
wandb:                 lr_1 0.001
wandb:                lr_10 1e-05
wandb:                lr_11 0.0
wandb:                lr_12 0.0
wandb:                lr_13 0.0
wandb:                 lr_2 0.001
wandb:                 lr_3 0.0001
wandb:                 lr_4 0.0001
wandb:                 lr_5 0.0001
wandb:                 lr_6 0.0001
wandb:                 lr_7 0.0001
wandb:                 lr_8 0.0001
wandb:                 lr_9 0.0001
wandb:       val_accuracy_0 0.22233
wandb:       val_accuracy_1 0.22313
wandb:      val_accuracy_10 0.75299
wandb:      val_accuracy_11 0.82116
wandb:      val_accuracy_12 0.84494
wandb:      val_accuracy_13 0.85022
wandb:       val_accuracy_2 0.28513
wandb:       val_accuracy_3 0.36574
wandb:       val_accuracy_4 0.39729
wandb:       val_accuracy_5 0.42725
wandb:       val_accuracy_6 0.53016
wandb:       val_accuracy_7 0.64162
wandb:       val_accuracy_8 0.69158
wandb:       val_accuracy_9 0.72691
wandb:           val_loss_0 3.22498
wandb:           val_loss_1 3.21117
wandb:          val_loss_10 0.76153
wandb:          val_loss_11 0.55249
wandb:          val_loss_12 0.47298
wandb:          val_loss_13 0.45933
wandb:           val_loss_2 2.48946
wandb:           val_loss_3 2.12095
wandb:           val_loss_4 1.928
wandb:           val_loss_5 1.87268
wandb:           val_loss_6 1.55709
wandb:           val_loss_7 1.14253
wandb:           val_loss_8 0.98389
wandb:           val_loss_9 0.84055
wandb: 
wandb: Synced 6 W&B file(s), 28 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced cifar10_hu_greedy_l2_run3: https://wandb.ai/fanconic/hidden_uncertainty/runs/giq2dm7j
wandb: Find logs at: ./wandb/run-20220109_090441-giq2dm7j/logs/debug.log
wandb: 
